<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <!-- SEO Meta Tags -->
    <title>Genesis Frequencies: Sacred 37Hz 73Hz Healing Tones from Biblical Gematria | Free Meditation App</title>
    <meta name="description" content="Transform your meditation with Genesis 1:1 sacred frequencies. Free online generator with 49 biblical healing tones (37Hz, 73Hz, 2701Hz) plus 432Hz, 528Hz Solfeggio frequencies. Unlock deep relaxation, spiritual awakening, and divine alignment. Try now - no download required.">
    <meta name="keywords" content="frequency generator, 432Hz, 432Hz frequency, 432Hz music, 528Hz, 528Hz frequency, 528Hz love frequency, 528Hz meditation, Solfeggio frequencies, 396Hz, 417Hz, 639Hz, 741Hz, 852Hz, 963Hz, binaural beats, binaural beats generator, Hz generator, tone generator, relaxation frequencies, sound therapy, meditation music, sleep frequencies, focus frequencies, meditation frequencies, relaxation sounds, chakra meditation, spiritual frequencies, 7.83Hz, Schumann resonance, genesis frequency, biblical frequencies, 37Hz, 73Hz, 2701Hz, sacred frequencies, Hebrew gematria, mindfulness sounds, calming frequencies, ambient tones">
    <meta name="author" content="Quantum Merlin">
    <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
    <link rel="canonical" href="https://genesis.quantummerlin.com/">
    <meta name="language" content="English">
    <meta name="geo.region" content="US">
    <meta name="geo.placename" content="United States">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://genesis.quantummerlin.com/">
    <meta property="og:title" content="Biblical Genesis Frequency Generator | Sacred Healing Frequencies">
    <meta property="og:description" content="🎵 Transform your meditation with biblical healing frequencies. 49 sacred tones including 37Hz, 73Hz, 528Hz Solfeggio. Free online generator based on Genesis 1:1 gematria. Deep relaxation, spiritual awakening & divine alignment. Try now!">
    <meta property="og:image" content="https://genesis.quantummerlin.com/Genesis.png">
    <meta property="og:site_name" content="Genesis Frequencies by Quantum Merlin">
    <meta property="og:locale" content="en_US">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Genesis Frequencies - Sacred Healing Sound Generator">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://genesis.quantummerlin.com/">
    <meta name="twitter:title" content="Biblical Genesis Frequency Generator | Sacred Healing Frequencies">
    <meta name="twitter:description" content="🎵 Transform meditation with biblical healing frequencies. 49 sacred tones (37Hz, 73Hz, 528Hz). Free online generator from Genesis 1:1. Try now!">
    <meta name="twitter:creator" content="@QuantumMerlin">
    <meta name="twitter:site" content="@QuantumMerlin">
    <meta name="twitter:image" content="https://genesis.quantummerlin.com/Genesis.png">
    
    <!-- Additional SEO -->
    <meta name="subject" content="Biblical Frequency Meditation and Spiritual Wellness">
    <meta name="classification" content="Wellness, Spirituality, Meditation, Relaxation">
    <meta name="rating" content="General">
    <meta name="referrer" content="origin-when-cross-origin">
    
    <!-- Structured Data for Google -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Genesis Frequencies - Biblical Healing Sound Generator",
        "alternateName": "Genesis Frequency Generator",
        "description": "Transform your meditation with 49 sacred healing frequencies derived from Genesis 1:1 biblical mathematics and Hebrew gematria. Features 37Hz, 73Hz, 2701Hz Trinity frequencies, 432Hz, 528Hz Solfeggio tones, angel numbers, and binaural beats for deep relaxation, spiritual awakening, and divine alignment.",
        "url": "https://genesis.quantummerlin.com",
        "applicationCategory": "LifestyleApplication",
        "operatingSystem": "Any (Web Browser)",
        "browserRequirements": "Requires JavaScript. Requires HTML5.",
        "softwareVersion": "1.0",
        "datePublished": "2025-01-01",
        "inLanguage": "en-US",
        "isAccessibleForFree": true,
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock",
            "priceValidUntil": "2030-12-31"
        },
        "creator": {
            "@type": "Organization",
            "name": "Quantum Merlin",
            "url": "https://quantummerlin.com"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Quantum Merlin",
            "url": "https://quantummerlin.com"
        },
        "keywords": "genesis frequencies, biblical frequencies, 37Hz, 73Hz, 2701Hz, frequency generator, 432Hz music, 528Hz love frequency, Solfeggio frequencies, healing tones, meditation music, binaural beats, sound therapy, spiritual awakening, chakra healing, Hebrew gematria, sacred geometry, angel numbers, sleep sounds, relaxation music, divine alignment",
        "featureList": [
            "49 Sacred Frequency Tracks",
            "Genesis 1:1 Biblical Frequencies (37Hz, 73Hz, 2701Hz)",
            "Full Solfeggio Scale (396Hz-963Hz)",
            "432Hz Healing Music",
            "Angel Number Frequencies (111-999)",
            "Individual Volume Controls (Premium)",
            "Custom Session Durations (Premium)",
            "WAV Export for Offline Use (Premium)",
            "Achievement & Progress Tracking",
            "Offline PWA Support"
        ],
        "screenshot": "https://genesis.quantummerlin.com/Genesis.png",
        "image": "https://genesis.quantummerlin.com/Genesis.png",
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.9",
            "ratingCount": "847",
            "bestRating": "5",
            "worstRating": "1"
        }
    }
    </script>

    <!-- FAQ Schema for Rich Snippets -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "What are Genesis Frequencies?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Genesis Frequencies are sacred healing tones derived from the mathematical structure of Genesis 1:1 in Hebrew. The primary frequencies are 37Hz, 73Hz, and 2701Hz, which represent the gematria (numerical value) of the first verse of the Bible. These frequencies are believed to carry the vibrational blueprint of creation itself."
                }
            },
            {
                "@type": "Question",
                "name": "How do I use the Genesis Frequency Generator?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Simply select a frequency track from the 49 available options, set your desired duration (5-10 minutes recommended for beginners), put on headphones for best results, press PLAY, and focus on your intention. The frequencies work best during meditation, prayer, or relaxation practices."
                }
            },
            {
                "@type": "Question",
                "name": "What is the 528Hz love frequency?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "528Hz is one of the Solfeggio frequencies known as the 'love frequency' or 'miracle tone.' It's associated with DNA repair, transformation, and miracles. Combined with the Genesis Trinity frequencies (37Hz + 73Hz), it creates a powerful healing resonance for the heart chakra and emotional balance."
                }
            },
            {
                "@type": "Question",
                "name": "Is the Genesis Frequency Generator free to use?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! The Genesis Frequency Generator is completely free to use with access to all 49 frequency tracks. Premium features like individual volume controls, custom durations, and WAV export are available for a one-time payment of $9.99 with lifetime access."
                }
            },
            {
                "@type": "Question",
                "name": "What are the benefits of 432Hz music?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "432Hz is known as the natural tuning frequency that resonates with the universe. Benefits include deep relaxation, reduced anxiety, improved sleep quality, enhanced meditation states, and alignment with natural rhythms. It's mathematically consistent with patterns found in nature, sacred geometry, and the cosmos."
                }
            },
            {
                "@type": "Question",
                "name": "Can I use Genesis Frequencies for sleep?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Absolutely! Many tracks are specifically designed for deep relaxation and sleep, including Earth Resonance (7.83Hz Schumann resonance), Delta Wave frequencies, and specific Solfeggio combinations. Set a duration of 30-60 minutes and let the frequencies guide you into restful sleep."
                }
            }
        ]
    }
    </script>
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Genesis Frequencies">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#6B46C1">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">

    <link rel="manifest" href="/manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="/Genesis.png">
    <link rel="apple-touch-icon" href="/Genesis.png">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        /* Hide scrollbars but keep scroll functionality */
        * {
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE/Edge */
        }
        *::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: url('/Genesis.png') center center/cover fixed;
            min-height: 100vh;
            min-height: -webkit-fill-available;
            padding: 8px;
            padding-top: max(20px, env(safe-area-inset-top));
            padding-bottom: max(8px, env(safe-area-inset-bottom));
            padding-left: max(8px, env(safe-area-inset-left));
            padding-right: max(8px, env(safe-area-inset-right));
            color: #ffffff;
            overflow-x: hidden;
            position: relative;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Extra padding for PWA standalone mode */
        @media all and (display-mode: standalone) {
            body {
                padding-top: max(30px, calc(env(safe-area-inset-top) + 15px));
            }
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 30%, rgba(139, 92, 246, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(251, 191, 36, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 50% 50%, rgba(26, 0, 51, 0.6) 0%, rgba(26, 0, 51, 0.9) 100%);
            pointer-events: none;
            z-index: 1;
            animation: backgroundShift 20s ease-in-out infinite;
        }

        @keyframes backgroundShift {
            0%, 100% {
                background-position: 0% 0%;
            }
            25% {
                background-position: 100% 0%;
            }
            50% {
                background-position: 100% 100%;
            }
            75% {
                background-position: 0% 100%;
            }
        }

        /* Respect user's motion preferences */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        @media (min-width: 768px) {
            body {
                padding: 20px;
            }

            .container {
                margin: 0 auto;
                border-radius: 28px;
                padding: 25px;
            }
        }

        @media (max-width: 767px) {
            body {
                padding: 4px;
                background-attachment: scroll;
            }

            .container {
                margin: 0;
                border-radius: 16px;
                padding: 8px;
                max-width: none;
                width: calc(100vw - 8px);
                box-sizing: border-box;
            }

            .header {
                padding: 8px 0 16px 0;
            }

            .header h1 {
                font-size: 22px;
                line-height: 1.2;
            }

            .header p {
                font-size: 14px;
                line-height: 1.4;
            }

            .section {
                margin-bottom: 20px;
            }

            .section-title {
                font-size: 18px;
                margin-bottom: 12px;
            }

            .welcome-content {
                font-size: 14px;
                line-height: 1.5;
            }

            .welcome-content h3 {
                font-size: 16px;
            }

            .welcome-content ul, .welcome-content ol {
                padding-left: 16px;
            }

            .welcome-content li {
                margin-bottom: 6px;
            }

            .trinity-base {
                padding: 16px;
                margin: 16px 0;
            }

            .trinity-title {
                font-size: 16px;
                margin-bottom: 12px;
            }

            .trinity-frequencies {
                gap: 12px;
            }

            .trinity-freq {
                padding: 8px 12px;
            }

            .trinity-freq .hz {
                font-size: 18px;
            }

            .trinity-freq .label {
                font-size: 12px;
            }

            .visualizer {
                height: 120px;
                margin: 16px 0;
            }

            .frequency-vibration {
                height: 80px;
            }

            .recipes {
                display: grid;
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .recipe-card {
                padding: 12px;
                font-size: 14px;
            }

            .recipe-header {
                font-size: 16px;
                margin-bottom: 8px;
            }

            .recipe-freqs {
                font-size: 12px;
                margin-bottom: 8px;
            }

            .recipe-description {
                font-size: 13px;
                line-height: 1.4;
            }

            .controls {
                padding: 16px;
            }

            .frequency-controls {
                gap: 12px;
            }

            .control-group {
                padding: 12px;
                border-radius: 8px;
            }

            .control-group input[type="number"] {
                font-size: 16px;
                padding: 8px;
            }

            .control-group input[type="range"] {
                height: 6px;
            }

            .range-value {
                font-size: 12px;
            }

            .duration-input-container input {
                font-size: 16px;
                padding: 10px;
            }

            .duration-buttons {
                gap: 6px;
                flex-wrap: wrap;
            }

            .duration-btn {
                font-size: 14px;
                padding: 8px 12px;
                min-width: 44px;
            }

            .button-group {
                gap: 8px;
                flex-wrap: wrap;
            }

            .button {
                font-size: 16px;
                padding: 12px 20px;
                min-height: 48px;
                min-width: 120px;
            }

            .status {
                font-size: 14px;
                padding: 12px;
                margin: 12px 0;
            }

            .instructions-panel {
                padding: 16px !important;
                margin: 0 8px 16px 8px !important;
                border-radius: 12px !important;
            }

            .instructions-header h2 {
                font-size: 20px !important;
            }

            .accordion-content {
                padding: 12px 4px 0 4px !important;
                font-size: 14px !important;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 4px;
                overflow-x: hidden;
            }

            .container {
                padding: 8px;
                border-radius: 12px;
                width: 100%;
                max-width: 100%;
                overflow-x: hidden;
            }

            .section {
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
                padding: 4px;
                margin-bottom: 12px;
                overflow-x: hidden;
            }

            .frequency-controls {
                gap: 0px;
                width: 100%;
                max-width: 100%;
                overflow-x: hidden;
                box-sizing: border-box;
            }

            .control-group {
                padding: 4px;
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
                overflow-x: hidden;
                overflow-y: visible;
            }

            .control-group > div {
                gap: 4px;
                width: 100%;
                max-width: 100%;
                display: flex;
                align-items: center;
                box-sizing: border-box;
            }

            .control-group input[type="number"] {
                flex: 1 1 auto;
                min-width: 0;
                width: 100%;
                box-sizing: border-box;
            }

            .control-group span {
                flex: 0 0 auto;
                width: 30px;
                text-align: right;
                font-size: 12px !important;
            }

            input[type="number"],
            input[type="text"],
            input[type="range"] {
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
                margin: 0;
                padding: 8px;
            }

            input[type="range"] {
                padding: 0;
                margin: 10px auto 6px auto;
                width: 92%;
                max-width: 92%;
                display: block;
            }

            .button-group {
                flex-direction: column;
                gap: 8px;
                width: 100%;
                max-width: 100%;
                padding: 0;
                margin: 0 auto;
            }

            .button {
                font-size: 14px;
                padding: 10px 12px;
                min-height: 44px;
                min-width: 0;
                width: 100%;
                max-width: 100%;
                box-sizing: border-box;
            }

            .duration-buttons {
                flex-direction: row;
                flex-wrap: wrap;
                gap: 4px;
                justify-content: space-between;
            }

            .duration-btn {
                font-size: 12px;
                padding: 6px 8px;
                min-width: 48%;
                flex: 0 0 48%;
                box-sizing: border-box;
            }

            .status {
                font-size: 12px;
                padding: 8px;
                margin: 8px 0;
            }

            .range-value {
                font-size: 11px;
            }

            .instructions-panel {
                padding: 12px !important;
                margin: 0 4px 12px 4px !important;
            }

            .instructions-header h2 {
                font-size: 18px !important;
            }

            .accordion-content {
                font-size: 12px !important;
            }
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: rgba(26, 0, 51, 0.95);
            backdrop-filter: blur(30px);
            border-radius: 28px;
            padding: 20px;
            box-shadow:
                0 25px 70px rgba(0, 0, 0, 0.6),
                0 0 0 1px rgba(139, 92, 246, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            animation: slideUp 0.5s ease-out;
            position: relative;
            z-index: 2;
            overflow: hidden;
            width: 100%;
            box-sizing: border-box;
        }

        .container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 30% 20%, rgba(251, 191, 36, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 70% 80%, rgba(139, 92, 246, 0.05) 0%, transparent 50%);
            pointer-events: none;
            animation: particleFloat 15s ease-in-out infinite;
        }

        @keyframes particleFloat {
            0%, 100% {
                transform: translateY(0px) rotate(0deg);
                opacity: 0.3;
            }
            50% {
                transform: translateY(-10px) rotate(180deg);
                opacity: 0.6;
            }
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('/Genesis.png') center center/cover;
            border-radius: 28px;
            opacity: 0.12;
            z-index: -1;
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulseGlow {
            0%, 100% {
                text-shadow: 0 0 20px rgba(251, 191, 36, 0.8),
                             0 0 40px rgba(251, 191, 36, 0.5),
                             0 0 60px rgba(251, 191, 36, 0.3);
            }
            50% {
                text-shadow: 0 0 30px rgba(251, 191, 36, 1),
                             0 0 60px rgba(251, 191, 36, 0.8),
                             0 0 90px rgba(251, 191, 36, 0.5);
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -200% center;
            }
            100% {
                background-position: 200% center;
            }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            background: url('/Genesis.png') center center/cover;
            border-radius: 20px;
            padding: 30px 20px;
            box-shadow: 
                0 10px 40px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.70);
            border-radius: 20px;
            z-index: 0;
        }
        
        .header > * {
            position: relative;
            z-index: 1;
        }

        .logo-container {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .logo-image {
            width: 120px;
            height: 120px;
            object-fit: contain;
            filter: drop-shadow(0 0 20px rgba(251, 191, 36, 0.6));
            animation: logoGlow 3s ease-in-out infinite;
        }

        @keyframes logoGlow {
            0%, 100% {
                filter: drop-shadow(0 0 20px rgba(251, 191, 36, 0.6));
            }
            50% {
                filter: drop-shadow(0 0 30px rgba(251, 191, 36, 0.9));
            }
        }

        .hebrew-header {
            font-size: 32px;
            color: #fbbf24;
            font-weight: 700;
            margin-bottom: 10px;
            letter-spacing: 6px;
            animation: pulseGlow 3s ease-in-out infinite;
            text-shadow: 0 0 30px rgba(251, 191, 36, 0.6);
        }

        .hebrew-translation {
            font-size: 16px;
            color: #ffffff;
            font-weight: 500;
            margin-bottom: 20px;
            font-style: italic;
            opacity: 0.95;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .main-title {
            font-size: 36px;
            font-weight: 800;
            background: linear-gradient(90deg, 
                #ffffff 0%, 
                #fbbf24 25%, 
                #c4b5fd 50%, 
                #fbbf24 75%, 
                #ffffff 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 4s linear infinite;
            margin-bottom: 20px;
            line-height: 1.3;
            filter: drop-shadow(0 0 25px rgba(251, 191, 36, 0.5));
            letter-spacing: 1px;
        }

        .subtitle {
            font-size: 28px;
            font-weight: 700;
            background: linear-gradient(90deg, 
                #fbbf24 0%, 
                #c4b5fd 25%, 
                #ffffff 50%, 
                #c4b5fd 75%, 
                #fbbf24 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 4s linear infinite;
            margin-bottom: 20px;
            line-height: 1.4;
            text-shadow: 0 2px 20px rgba(139, 92, 246, 0.7);
            letter-spacing: 0.5px;
            text-align: center;
        }

        .gematria {
            font-size: 14px;
            color: #fbbf24;
            font-weight: 600;
            margin-bottom: 20px;
            text-shadow: 0 2px 5px rgba(251, 191, 36, 0.3);
        }
        
        .divider {
            height: 2px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(251, 191, 36, 0.3) 10%, 
                rgba(251, 191, 36, 0.8) 50%, 
                rgba(251, 191, 36, 0.3) 90%, 
                transparent 100%);
            margin: 15px auto;
            width: 80%;
            border-radius: 2px;
        }

        .trinity-base {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px;
            padding: 15px;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }

        .trinity-base::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.75);
            border-radius: 14px;
            z-index: 0;
        }

        .trinity-base > * {
            position: relative;
            z-index: 1;
        }

        .trinity-title {
            font-size: 18px;
            font-weight: 600;
            color: #c4b5fd;
            margin-bottom: 10px;
        }

        .trinity-frequencies {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            text-align: center;
        }

        .trinity-freq {
            text-align: center;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            border: 1px solid rgba(139, 92, 246, 0.2);
            position: relative;
            overflow: hidden;
        }

        .trinity-freq::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.80);
            z-index: 0;
        }

        .trinity-freq > * {
            position: relative;
            z-index: 1;
        }

        .trinity-freq .hz {
            font-size: 20px;
            font-weight: 700;
            color: #fbbf24;
            text-shadow: 0 2px 5px rgba(251, 191, 36, 0.3);
        }

        .trinity-freq .label {
            font-size: 12px;
            color: #a78bfa;
            margin-top: 2px;
        }

        .trinity-arrow {
            color: #c4b5fd;
            font-size: 18px;
        }

        .section {
            background: rgba(255, 255, 255, 0.03);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(139, 92, 246, 0.2);
            position: relative;
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
        }

        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.85);
            border-radius: 20px;
            z-index: 0;
        }

        .section > * {
            position: relative;
            z-index: 1;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #ffffff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            text-align: center;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .section-title::before {
            content: '✨';
            font-size: 16px;
        }

        .section-title::after {
            content: '✨';
            font-size: 16px;
        }

        .controls {
            display: grid;
            gap: 15px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            overflow-x: hidden;
        }
        
        .frequency-controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        @media (min-width: 768px) {
            .frequency-controls {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05), url('/Genesis.png') center center/cover;
            border-radius: 12px;
            border: 1px solid rgba(139, 92, 246, 0.1);
            text-align: center;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
        }

        .control-group::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.85);
            z-index: 0;
        }

        .control-group > * {
            position: relative;
            z-index: 1;
        }

        .duration-control {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(168, 85, 247, 0.1) 100%);
            border: 2px solid rgba(139, 92, 246, 0.3);
        }

        .duration-input-wrapper {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .duration-buttons {
            display: flex;
            gap: 8px;
            justify-content: flex-start;
        }

        .duration-btn {
            padding: 14px 20px;
            border: 3px solid #fbbf24;
            border-radius: 12px;
            background: linear-gradient(135deg, rgba(26, 0, 51, 0.6), rgba(26, 0, 51, 0.8));
            color: #fbbf24;
            font-size: 22px;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            box-shadow: 0 4px 16px rgba(251, 191, 36, 0.5);
        }

        .duration-btn:hover {
            background: linear-gradient(135deg, rgba(26, 0, 51, 0.4), rgba(26, 0, 51, 0.6));
            border-color: #fde047;
            color: #fde047;
            transform: scale(1.1);
            box-shadow: 0 6px 24px rgba(251, 191, 36, 0.8);
        }

        .duration-btn:hover::before {
            background: rgba(26, 0, 51, 0.65);
        }

        label {
            font-size: 14px;
            font-weight: 500;
            color: #a78bfa;
            text-align: center;
        }

        input[type="number"],
        input[type="range"],
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 8px;
            text-align: center;
            background: rgba(26, 0, 51, 0.9);
            color: #fbbf24;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #fbbf24;
            box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.1);
            background: rgba(26, 0, 51, 0.95);
        }

        input[type="range"] {
            padding: 0;
            margin: 8px auto;
            height: 40px;
            width: 92%;
            max-width: 92%;
            box-sizing: border-box;
            -webkit-appearance: none;
            appearance: none;
            display: block;
        }

        input[type="range"]::-webkit-slider-container {
            width: 100%;
            max-width: 100%;
        }

        #duration {
            font-size: 18px;
            text-align: center;
            font-weight: 600;
            background: rgba(26, 0, 51, 0.95);
            border: 2px solid rgba(139, 92, 246, 0.3);
            color: #fbbf24;
            letter-spacing: 2px;
        }

        #duration:focus {
            border-color: #fbbf24;
            box-shadow: 0 0 10px rgba(251, 191, 36, 0.3);
            background: rgba(26, 0, 51, 0.98);
        }

        option {
            text-align: center !important;
            text-align-last: center;
        }

        label[for^="volume"] {
            display: none;
        }

        .range-value {
            text-align: center;
            font-size: 14px;
            color: #fbbf24;
            font-weight: 600;
            margin-top: 5px;
        }

        .button {
            padding: 12px 20px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            will-change: transform;
        }

        .button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('Genesis.png') center center/cover;
            opacity: 0.15;
            z-index: 0;
        }

        .button > * {
            position: relative;
            z-index: 1;
        }

        .button-primary {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.3);
        }

        .button-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4);
        }

        .button-primary:active {
            transform: translateY(0);
        }

        .button-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #a78bfa;
            border: 2px solid rgba(139, 92, 246, 0.3);
        }

        .button-secondary:hover {
            background: rgba(139, 92, 246, 0.2);
            border-color: #a78bfa;
        }

        .button-danger {
            background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
            color: #fff;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .recipes {
            display: grid;
            gap: 10px;
        }

        .category-tab {
            background: rgba(139, 92, 246, 0.1);
            border: 2px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            margin-bottom: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .category-tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.82);
            z-index: 0;
            pointer-events: none;
        }

        .category-tab > * {
            position: relative;
            z-index: 1;
        }

        .category-header {
            padding: 18px 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(139, 92, 246, 0.15);
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            border-radius: 16px;
            border: 1px solid rgba(139, 92, 246, 0.2);
            box-shadow: 
                0 2px 12px rgba(139, 92, 246, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .category-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.70);
            z-index: 0;
            transition: background 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .category-header > * {
            position: relative;
            z-index: 1;
        }

        .category-header:hover {
            background: rgba(139, 92, 246, 0.25);
            border-color: rgba(139, 92, 246, 0.35);
            transform: translateY(-2px);
            box-shadow: 
                0 4px 20px rgba(139, 92, 246, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .category-header:hover::before {
            background: rgba(26, 0, 51, 0.60);
        }

        .category-title {
            font-size: 16px;
            font-weight: 700;
            color: #fbbf24;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex: 1;
        }

        .category-icon {
            font-size: 20px;
        }

        .category-arrow {
            font-size: 18px;
            color: #a78bfa;
            transition: transform 0.3s ease;
        }

        .category-tab.expanded .category-arrow {
            transform: rotate(90deg);
        }

        .category-content {
            display: none;
            transition: all 0.4s ease;
        }

        .category-tab.expanded .category-content {
            display: block;
        }

        .category-tracks {
            padding: 10px;
            display: grid;
            gap: 8px;
        }

        .recipe-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 14px;
            padding: 14px 16px;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 12px;
            align-items: center;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 1px 8px rgba(0, 0, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.03);
        }

        .recipe-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.88);
            z-index: 0;
            transition: background 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .recipe-item > * {
            position: relative;
            z-index: 1;
        }

        .recipe-item:hover {
            background: rgba(139, 92, 246, 0.1), url('Genesis.png') center center/cover;
            border-color: #a78bfa;
            transform: translateY(-2px);
            box-shadow: 
                0 4px 16px rgba(139, 92, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
        }

        .recipe-item:hover::before {
            background: rgba(26, 0, 51, 0.75);
        }

        .recipe-item.active {
            background: rgba(139, 92, 246, 0.2), url('Genesis.png') center center/cover;
            border-color: #fbbf24;
            box-shadow: 
                0 0 20px rgba(251, 191, 36, 0.25),
                0 4px 16px rgba(139, 92, 246, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .recipe-item.active::before {
            background: rgba(26, 0, 51, 0.70);
        }

        .recipe-info {
            text-align: left;
            cursor: default;
        }

        .recipe-name {
            font-size: 16px;
            font-weight: 600;
            color: #c4b5fd;
            margin-bottom: 4px;
        }

        .recipe-freqs {
            font-size: 13px;
            color: #a78bfa;
            margin-bottom: 0;
        }

        .recipe-buttons {
            display: flex;
            gap: 8px;
            align-items: center;
            pointer-events: all;
            position: relative;
            z-index: 5;
        }

        .track-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 2px solid rgba(139, 92, 246, 0.5);
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(107, 70, 193, 0.3));
            color: #c4b5fd;
            font-size: 19px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 2px 8px rgba(0, 0, 0, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .track-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: transparent;
            z-index: 0;
            transition: background 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .track-btn > * {
            position: relative;
            z-index: 1;
        }

        .track-btn:hover {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.5), rgba(107, 70, 193, 0.5));
            border-color: #fbbf24;
            color: #fbbf24;
            transform: scale(1.15) rotate(5deg);
            box-shadow: 
                0 4px 16px rgba(139, 92, 246, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .track-btn:hover::before {
            background: transparent;
        }

        .track-btn.play-btn:hover {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.4), rgba(22, 163, 74, 0.4));
            border-color: #22c55e;
            color: #22c55e;
            box-shadow:
                0 4px 16px rgba(34, 197, 94, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .track-btn.play-btn.playing {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.5), rgba(22, 163, 74, 0.5));
            border-color: #22c55e;
            color: #ffffff;
            box-shadow:
                0 0 20px rgba(34, 197, 94, 0.6),
                0 4px 16px rgba(34, 197, 94, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: pulsePlaying 2s ease-in-out infinite;
        }

        .track-btn.play-btn.playing::before {
            background: transparent;
        }

        @keyframes pulsePlaying {
            0%, 100% {
                transform: scale(1);
                box-shadow:
                    0 0 20px rgba(34, 197, 94, 0.6),
                    0 4px 16px rgba(34, 197, 94, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
            }
            50% {
                transform: scale(1.05);
                box-shadow:
                    0 0 30px rgba(34, 197, 94, 0.8),
                    0 6px 20px rgba(34, 197, 94, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
        }

        .track-btn.info-btn {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.3), rgba(251, 191, 36, 0.2));
            border: 2px solid #fbbf24;
            color: #fbbf24;
            box-shadow: 
                0 0 12px rgba(251, 191, 36, 0.4),
                0 2px 8px rgba(0, 0, 0, 0.3);
            animation: infoGlow 2s ease-in-out infinite;
            pointer-events: all;
            z-index: 10;
            position: relative;
        }

        .track-btn.info-btn::before {
            display: none;
        }

        @keyframes infoGlow {
            0%, 100% {
                box-shadow: 
                    0 0 12px rgba(251, 191, 36, 0.4),
                    0 2px 8px rgba(0, 0, 0, 0.3);
                border-color: #fbbf24;
            }
            50% {
                box-shadow: 
                    0 0 20px rgba(251, 191, 36, 0.6),
                    0 0 30px rgba(251, 191, 36, 0.3),
                    0 2px 8px rgba(0, 0, 0, 0.3);
                border-color: #ffd700;
            }
        }

        .track-btn.info-btn:hover {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.5), rgba(251, 191, 36, 0.4));
            border-color: #ffd700;
            color: #ffffff;
            transform: scale(1.1);
            box-shadow: 
                0 0 25px rgba(251, 191, 36, 0.7),
                0 4px 16px rgba(251, 191, 36, 0.4);
            animation: none;
        }

        .info-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.92);
            display: none;
            z-index: 9999;
            padding: 20px;
            box-sizing: border-box;
            align-items: center;
            justify-content: center;
            overflow-y: hidden;
        }

        .info-modal.active {
            display: flex !important;
            animation: fadeInModal 0.3s ease;
        }
        
        @keyframes fadeInModal {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Upgrade modal sits on top, not dimmed */
        .upgrade-modal {
            display: none;
            position: fixed;
            inset: 0;
            z-index: 11000;
            background: rgba(0,0,0,0.65);
            align-items: center;
            justify-content: center;
            padding: 20px;
            box-sizing: border-box;
        }

        .upgrade-modal-content {
            position: relative;
            z-index: 11001;
        }

        /* Ensure other info-modals do not force higher stacking */
        .info-modal .info-modal-content {
            position: relative;
            z-index: 10001;
        }

        /* Force hide all modals except active one */
        .info-modal:not(.active) {
            display: none !important;
        }

        .info-modal.active {
            display: flex !important;
            opacity: 1 !important;
            visibility: visible !important;
            z-index: 10000 !important;
        }
        
        /* Safari/WebKit compatibility for welcome modals */
        #immersiveWelcome.active,
        #frequencyBenefitsModal.active,
        #howToUseModal.active,
        #pwaTipModal.active,
        #upgradeBenefitsModal.active {
            display: flex !important;
            opacity: 1 !important;
            visibility: visible !important;
            -webkit-transform: translateZ(0);
            transform: translateZ(0);
        }
        
        /* Welcome flow header styles */
        .welcome-header {
            color: #ffd700 !important;
            font-size: 32px !important;
            font-weight: 800 !important;
            text-align: center !important;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.5), 0 2px 4px rgba(0,0,0,0.5) !important;
            margin-bottom: 25px !important;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .info-modal-content {
            background: linear-gradient(135deg, rgba(26,0,51,0.98), rgba(139,92,246,0.95));
            border-radius: 20px;
            padding: 20px;
            width: 90%;
            max-width: 400px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow:
                0 25px 80px rgba(0, 0, 0, 0.6),
                0 0 30px rgba(139, 92, 246, 0.3),
                0 0 0 2px rgba(251, 191, 36, 0.4);
            border: 2px solid rgba(251, 191, 36, 0.5);
            box-sizing: border-box;
            margin: 0;
            flex-shrink: 0;
        }

        @media (min-width: 768px) {
            .info-modal-content {
                width: 80%;
                max-width: 550px;
                padding: 40px;
            }
        }

        @media (max-height: 700px) {
            .info-modal-content {
                max-height: 90vh;
            }
        }

        @keyframes slideUpModal {
            from {
                transform: translateY(30px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .info-modal-header {
            color: #fbbf24;
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 15px;
            padding-right: 40px;
            text-align: center;
            background: linear-gradient(90deg, #fbbf24 0%, #c4b5fd 50%, #fbbf24 100%);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: shimmer 3s linear infinite;
            text-shadow: 0 0 20px rgba(251, 191, 36, 0.5);
        }

        .info-modal-freqs {
            color: #c4b5fd;
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 25px;
            padding: 15px 20px;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(168, 85, 247, 0.2));
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(139, 92, 246, 0.3);
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .info-modal-body {
            color: #ffffff;
            font-size: 16px;
            line-height: 1.8;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
        }

        .info-modal-body h3 {
            color: #fbbf24;
            font-size: 20px;
            font-weight: 700;
            margin-top: 25px;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid rgba(251, 191, 36, 0.3);
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
        }

        .info-modal-body p {
            margin-bottom: 18px;
            color: #e2e8f0;
        }

        .info-modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            border: 2px solid rgba(251, 191, 36, 0.4);
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(139, 92, 246, 0.2));
            color: #fbbf24;
            font-size: 24px;
            font-weight: 700;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .info-modal-close:hover {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.4), rgba(139, 92, 246, 0.4));
            border-color: #fbbf24;
            color: #1a0033;
            transform: rotate(90deg) scale(1.1);
            box-shadow: 0 4px 16px rgba(251, 191, 36, 0.4);
        }

        .status {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
            margin-top: 15px;
            font-size: 14px;
            font-weight: 500;
            position: relative;
            overflow: hidden;
        }

        .status::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('Genesis.png') center center/cover;
            opacity: 0.1;
            z-index: 0;
        }

        .status > * {
            position: relative;
            z-index: 1;
        }

        .status.playing {
            background: rgba(34, 197, 94, 0.1);
            color: #22c55e;
            border: 1px solid rgba(34, 197, 94, 0.3);
        }

        .status.stopped {
            background: rgba(148, 163, 184, 0.1);
            color: #94a3b8;
            border: 1px solid rgba(148, 163, 184, 0.3);
        }

        .status.floating {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            margin: 0;
            border-radius: 0;
            z-index: 1000;
            backdrop-filter: blur(20px);
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
        }

        @media (min-width: 768px) {
            .status.floating {
                bottom: 20px;
                left: 20px;
                right: auto;
                width: 400px;
                border-radius: 8px;
            }
        }

        .visualizer {
            height: 120px;
            background: rgba(255, 255, 255, 0.02), url('Genesis.png') center center/cover;
            border-radius: 12px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .visualizer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(26, 0, 51, 0.85);
            z-index: 0;
        }

        .visualizer > * {
            position: relative;
            z-index: 1;
        }

        .visualizer-content {
            text-align: center;
            color: #c4b5fd;
            font-size: 14px;
        }

        .frequency-vibration {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
        }

        .vibration-wave {
            position: absolute;
            width: 100%;
            height: 80px;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .vibration-wave svg {
            width: 100%;
            height: 100%;
        }

        .vibration-wave:nth-child(1) {
            animation: wave1 1s ease-in-out infinite;
        }

        .vibration-wave:nth-child(2) {
            animation: wave2 0.5s ease-in-out infinite;
        }

        .vibration-wave:nth-child(3) {
            animation: wave3 1.5s ease-in-out infinite;
            opacity: 0.4;
        }

        @keyframes wave1 {
            0%, 100% {
                transform: translateY(-50%) scaleY(0.8);
            }
            50% {
                transform: translateY(-50%) scaleY(1.2);
            }
        }

        @keyframes wave2 {
            0%, 100% {
                transform: translateY(-50%) scaleY(0.7);
            }
            50% {
                transform: translateY(-50%) scaleY(1.3);
            }
        }

        @keyframes wave3 {
            0%, 100% {
                transform: translateY(-50%) scaleY(0.9);
            }
            50% {
                transform: translateY(-50%) scaleY(1.1);
            }
        }

        .sacred-geometry {
            display: none;
        }
        
        .add-to-home {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.95) 0%, rgba(107, 70, 193, 0.95) 100%);
            padding: 15px;
            text-align: center;
            color: #fff;
            font-size: 14px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            z-index: 2000040;
            animation: slideDownBanner 0.5s ease-out;
        }
        
        @media (max-width: 768px) {
            .add-to-home {
                display: block;
            }
        }
        
        @keyframes slideDownBanner {
            from {
                transform: translateY(-100%);
            }
            to {
                transform: translateY(0);
            }
        }
        
        .add-to-home-content {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .add-to-home-icon {
            font-size: 24px;
        }
        
        .add-to-home-text {
            font-weight: 600;
            line-height: 1.4;
        }
        
        .add-to-home-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.3s;
        }
        
        .add-to-home-close:hover {
            opacity: 1;
        }

        

        @media (max-width: 480px) {
            body {
                padding: 5px;
            }

            .container {
                padding: 12px;
                border-radius: 16px;
                margin: 0;
            }

            .header {
                padding: 8px 0 12px 0;
                text-align: center;
            }

            .header h1 {
                font-size: 24px;
                margin-bottom: 8px;
                color: #ffffff;
                text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            }

            .header p {
                font-size: 14px;
                color: #e0e7ff;
                line-height: 1.4;
            }

            .info-modal {
                padding: 8px;
            }

            .info-modal-content {
                padding: 20px 16px;
                max-width: 95vw;
                width: 95%;
                border-radius: 16px;
                margin: 10px auto;
            }

            .info-modal-header {
                font-size: 22px;
                margin-bottom: 16px;
                color: #fbbf24;
                text-shadow: 0 1px 2px rgba(0,0,0,0.7);
            }

            .info-modal-body {
                font-size: 15px;
                color: #ffffff;
                line-height: 1.6;
            }

            .info-modal-body h3 {
                color: #d4d4ff;
                font-size: 16px;
                font-weight: 600;
            }

            .info-modal-body p {
                color: #f0f0ff;
                margin-bottom: 12px;
                line-height: 1.5;
            }

            /* Improve button visibility on mobile */
            .button {
                font-size: 16px;
                padding: 14px 24px;
                min-height: 48px;
                border-radius: 25px;
                font-weight: 600;
                text-align: center;
                display: inline-flex;
                align-items: center;
                justify-content: center;
                white-space: nowrap;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            }

            .button:active {
                transform: scale(0.98);
            }

            .info-modal-close {
                width: 40px;
                height: 40px;
                font-size: 22px;
            }
        }

        /* Freemium Styles */
        .premium-lock {
            position: relative;
            opacity: 0.7;
            transition: all 0.3s ease;
        }
        
        .premium-lock:hover {
            opacity: 0.85;
            transform: scale(1.01);
        }

        .premium-lock input[type="number"],
        .premium-lock input[type="range"],
        .premium-lock button {
            pointer-events: none;
            opacity: 0.5;
        }

        .premium-lock::after {
            content: '🔒 Premium';
            position: absolute;
            top: 8px;
            right: 8px;
            font-size: 12px;
            font-weight: 700;
            color: #fbbf24;
            background: linear-gradient(135deg, rgba(139,92,246,0.95), rgba(107,70,193,0.95));
            border-radius: 12px;
            padding: 6px 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
            z-index: 10;
            box-shadow: 0 2px 8px rgba(251,191,36,0.3);
            pointer-events: none;
        }
        
        /* Premium unlocked styles - fully enabled controls */
        .premium-unlocked {
            opacity: 1 !important;
            pointer-events: auto !important;
        }
        
        .premium-unlocked::after {
            display: none !important;
        }
        
        .premium-unlocked input[type="number"],
        .premium-unlocked input[type="range"],
        .premium-unlocked button {
            pointer-events: auto !important;
            opacity: 1 !important;
        }
        
        .premium-unlocked > div:first-child::after {
            display: none !important;
        }

        .premium-lock > div:first-child {
            position: relative;
        }

        .premium-lock > div:first-child::after {
            content: '🔒';
            position: absolute;
            right: -30px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 16px;
            color: #fbbf24;
            background: rgba(26, 0, 51, 0.9);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            pointer-events: none;
        }
        
        /* Toggle Switch */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(107, 114, 128, 0.5);
            transition: 0.3s;
            border-radius: 26px;
        }
        
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 3px;
            bottom: 3px;
            background-color: white;
            transition: 0.3s;
            border-radius: 50%;
        }
        
        .toggle-switch input:checked + .toggle-slider {
            background: linear-gradient(90deg, #8b5cf6, #a78bfa);
        }
        
        .toggle-switch input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }
        
        .toggle-switch input:disabled + .toggle-slider {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Upgrade Modal */
        .upgrade-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            animation: fadeIn 0.3s ease-out;
            align-items: flex-start;
            justify-content: center;
            padding: 40px 20px 20px 20px;
            box-sizing: border-box;
        }

        .upgrade-modal-content {
            background: linear-gradient(135deg, rgba(26,0,51,0.95), rgba(139,92,246,0.9));
            border: 2px solid rgba(251,191,36,0.5);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: calc(100vh - 80px);
            overflow-y: auto;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 10001;
        }

        .upgrade-modal-header {
            color: #fbbf24;
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 20px;
            text-align: center;
            background: transparent !important;
        }

        .upgrade-modal-body {
            color: #e0e7ff;
            font-size: 16px;
            line-height: 1.6;
            margin-bottom: 25px;
        }

        .upgrade-features {
            background: rgba(251,191,36,0.1);
            border: 1px solid rgba(251,191,36,0.3);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .upgrade-features h3 {
            color: #fbbf24;
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
        }

        .upgrade-features ul {
            list-style: none;
            padding: 0;
        }

        .upgrade-features li {
            color: #d1d5db;
            margin-bottom: 8px;
            padding-left: 20px;
            position: relative;
        }

        .upgrade-features li::before {
            content: '✔';
            position: absolute;
            left: 0;
        }

        .upgrade-btn {
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            color: #1a0033;
            border: none;
            border-radius: 25px;
            padding: 15px 30px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(251,191,36,0.3);
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin: 10px;
            animation: upgradeGlow 3s ease-in-out infinite;
        }

        @keyframes upgradeGlow {
            0%, 100% {
                box-shadow: 0 4px 15px rgba(251,191,36,0.3);
            }
            50% {
                box-shadow: 0 4px 25px rgba(251,191,36,0.6), 0 0 30px rgba(251,191,36,0.4);
            }
        }

        @keyframes companionShimmer {
            0%, 100% {
                box-shadow: 0 2px 12px rgba(139,92,246,0.15);
            }
            50% {
                box-shadow: 0 2px 20px rgba(139,92,246,0.35), 0 0 25px rgba(251,191,36,0.3);
            }
        }

        .upgrade-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(251,191,36,0.4);
        }

        .upgrade-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            color: #c4b5fd;
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .upgrade-close:hover {
            background: rgba(139, 92, 246, 0.2);
        }

        /* Duration input with side lock */
        .duration-input-container {
            position: relative;
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .duration-input-container input {
            flex: 1;
            padding-right: 40px; /* Make room for lock icon */
            opacity: 0.7;
            cursor: pointer;
        }

        .duration-input-container input:hover {
            opacity: 0.9;
        }



        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Mobile optimizations for iPhone SE */
        @media (max-width: 320px) {
            body {
                padding: 2px;
            }

            .container {
                padding: 8px;
                border-radius: 8px;
            }

            .header h1 {
                font-size: 18px;
                line-height: 1.2;
            }

            .header p {
                font-size: 12px;
            }

            .info-modal-content {
                padding: 12px 8px;
                max-width: 99vw;
                border-radius: 8px;
            }

            .info-modal-header {
                font-size: 18px;
                margin-bottom: 10px;
            }

            .info-modal-body {
                font-size: 13px;
            }

            .button {
                font-size: 14px !important;
                padding: 10px 16px !important;
                min-height: 40px;
            }
        }

        @media (max-width: 375px) {
            body {
                padding: 3px;
            }

            .container {
                padding: 8px;
                border-radius: 10px;
            }

            .header h1 {
                font-size: 18px;
                line-height: 1.2;
            }

            .header p {
                font-size: 12px;
                line-height: 1.3;
            }

            .welcome-content {
                font-size: 13px;
            }

            .welcome-content h3 {
                font-size: 15px;
            }

            .trinity-title {
                font-size: 14px;
            }

            .trinity-freq .hz {
                font-size: 16px;
            }

            .trinity-freq .label {
                font-size: 11px;
            }

            .visualizer {
                height: 100px;
            }

            .frequency-vibration {
                height: 60px;
            }

            .recipes {
                gap: 6px;
            }

            .recipe-card {
                padding: 10px;
                font-size: 13px;
            }

            .recipe-header {
                font-size: 14px;
            }

            .recipe-freqs {
                font-size: 11px;
            }

            .controls {
                padding: 12px;
            }

            .frequency-controls {
                gap: 8px;
            }

            .control-group {
                padding: 10px;
            }

            .duration-buttons {
                gap: 4px;
            }

            .duration-btn {
                font-size: 16px;
                padding: 12px 16px;
                min-width: 60px;
                font-weight: 600;
                border-radius: 8px;
                border: 2px solid rgba(139, 92, 246, 0.3);
                background: rgba(139, 92, 246, 0.1);
                color: #c4b5fd;
                transition: all 0.2s ease;
            }

            .duration-btn:hover, .duration-btn:active {
                background: rgba(139, 92, 246, 0.2);
                border-color: rgba(139, 92, 246, 0.5);
                transform: scale(1.05);
            }

            .duration-btn.active {
                background: rgba(251, 191, 36, 0.2);
                border-color: #fbbf24;
                color: #fbbf24;
                font-weight: 700;
            }

            .button-group {
                gap: 6px;
            }

            .button {
                font-size: 15px !important;
                padding: 10px 16px !important;
                min-height: 42px;
                min-width: 100px;
            }

            .status {
                font-size: 13px;
                padding: 10px;
            }

            .info-modal-content {
                padding: 14px 10px;
                max-width: 96vw;
                width: 95%;
                border-radius: 10px;
                margin: 10px auto;
            }

            .info-modal-header {
                font-size: 18px;
                margin-bottom: 10px;
            }

            .info-modal-body {
                font-size: 13px;
            }

            .instructions-panel {
                padding: 12px !important;
                margin: 0 4px 12px 4px !important;
            }

            .instructions-header h2 {
                font-size: 18px !important;
            }

            .accordion-content {
                padding: 10px 2px 0 2px !important;
                font-size: 13px !important;
            }
        }

        @media (max-width: 320px) {
            body {
                padding: 2px;
            }

            .container {
                padding: 8px;
                border-radius: 8px;
            }

            .header h1 {
                font-size: 18px;
                line-height: 1.2;
            }

            .header p {
                font-size: 12px;
            }

            .info-modal-content {
                padding: 12px 8px;
                max-width: 99vw;
                border-radius: 8px;
            }

            .info-modal-header {
                font-size: 18px;
                margin-bottom: 10px;
            }

            .info-modal-body {
                font-size: 13px;
            }

            .button {
                font-size: 14px !important;
                padding: 10px 16px !important;
                min-height: 40px;
            }
        }

        

        /* Ensure no horizontal overflow anywhere */
        .section, .controls, .frequency-controls, .control-group,
        .duration-input-wrapper, .duration-input-container {
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
            overflow-x: hidden;
        }

        /* Align the top row: number input + Hz span */
        .control-group > div {
            display: flex;
            align-items: center;
            gap: 8px;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        /* Critical: allow the number input to shrink */
        .control-group input[type="number"] {
            flex: 1 1 auto;
            min-width: 0;
            width: 100%;
            box-sizing: border-box;
        }

        /* Keep Hz narrow but not stretching layout */
        .control-group span {
            flex: 0 0 auto;
            width: 30px;
            text-align: right;
            color: #a78bfa;
            font-size: 14px;
            font-weight: 500;
        }

        /* Normalize range sizing - account for browser chrome and thumb */
        .control-group input[type="range"] {
            display: block;
            width: 92%;
            max-width: 92%;
            box-sizing: border-box;
            margin: 10px auto 6px auto;
            padding: 0;
        }

        /* Range value below the slider */
        .range-value {
            width: 100%;
            text-align: center;
            box-sizing: border-box;
        }

        /* So the background overlay can't "clip" content or grab events */
        .control-group::before {
            pointer-events: none;
        }

        /* Duration row */
        .duration-input-container {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .duration-input-container input {
            flex: 1 1 auto;
            min-width: 0;
            width: 100%;
            box-sizing: border-box;
        }

        /* Buttons wrap nicely on small phones */
        @media (max-width: 375px) {
            .duration-buttons {
                display: grid;
                grid-template-columns: repeat(2, minmax(0, 1fr));
                gap: 6px;
            }
            .control-group {
                padding: 8px;
                border-radius: 10px;
            }
            .range-value {
                font-size: 12px;
            }
        }

        /* Extra hardening (Safari iOS quirks) */
        input[type="number"], input[type="text"] {
            min-width: 0;
        }

        /* Achievement Animations */
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(34,197,94,0.3); }
            50% { box-shadow: 0 0 40px rgba(34,197,94,0.6); }
        }

        @keyframes pulse-intense {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px rgba(251,191,36,0.4); }
            50% { transform: scale(1.02); box-shadow: 0 0 50px rgba(251,191,36,0.7); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            75% { transform: translateX(3px); }
        }

        @keyframes sparkle {
            0%, 100% { transform: scale(1) rotate(0deg); opacity: 1; }
            50% { transform: scale(1.3) rotate(180deg); opacity: 0.7; }
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulse-text {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes gradient-shift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulse-text {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Responsive Grid for Achievements */
        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        @media (max-width: 768px) {
            .achievements-grid {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
            }
        }

        /* Achievement Card Hover Effects */
        .achievement-card {
            transition: all 0.3s ease;
        }

        .achievement-card.locked:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(139,92,246,0.3);
        }

        .achievement-card.unlocked:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(34,197,94,0.5);
        }

        /* ---------------------------------------------------------------
           LUCIDE ICONS - Professional Icon System
        --------------------------------------------------------------- */
        .lucide-icon {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
            vertical-align: middle;
            display: inline-block;
        }
        
        .lucide-icon-sm { width: 16px; height: 16px; }
        .lucide-icon-lg { width: 24px; height: 24px; }
        .lucide-icon-xl { width: 32px; height: 32px; }
        
        .icon-gold { color: #fbbf24; }
        .icon-purple { color: #a78bfa; }
        .icon-green { color: #22c55e; }
        .icon-blue { color: #3b82f6; }
        .icon-pink { color: #ec4899; }

        /* ---------------------------------------------------------------
           NOW PLAYING STICKY FOOTER
        --------------------------------------------------------------- */
        .now-playing-bar {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, rgba(26, 0, 51, 0.98) 0%, rgba(139, 92, 246, 0.95) 100%);
            padding: 12px 20px;
            z-index: 2000050;
            box-shadow: 0 -4px 30px rgba(139, 92, 246, 0.4);
            border-top: 2px solid rgba(251, 191, 36, 0.5);
            animation: slideUpNowPlaying 0.3s ease-out;
        }
        
        .now-playing-bar.active {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 15px;
        }
        
        @keyframes slideUpNowPlaying {
            from { transform: translateY(100%); }
            to { transform: translateY(0); }
        }
        
        .now-playing-info {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }
        
        .now-playing-icon {
            font-size: 24px;
            animation: pulseGlow 2s ease-in-out infinite;
        }
        
        @keyframes pulseGlow {
            0%, 100% { 
                text-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
                transform: scale(1);
            }
            50% { 
                text-shadow: 0 0 20px rgba(251, 191, 36, 0.8), 0 0 30px rgba(139, 92, 246, 0.5);
                transform: scale(1.1);
            }
        }
        
        .now-playing-text {
            display: flex;
            flex-direction: column;
        }
        
        .now-playing-label {
            font-size: 11px;
            color: #a78bfa;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .now-playing-track {
            font-size: 16px;
            font-weight: 700;
            color: #fbbf24;
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.3);
        }
        
        .now-playing-time {
            font-size: 18px;
            font-weight: 700;
            color: #fff;
            font-family: monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 6px 12px;
            border-radius: 8px;
            min-width: 70px;
            text-align: center;
        }
        
        .now-playing-controls {
            display: flex;
            gap: 10px;
        }
        
        .now-playing-btn {
            background: rgba(251, 191, 36, 0.2);
            border: 1px solid rgba(251, 191, 36, 0.4);
            color: #fbbf24;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .now-playing-btn:hover {
            background: rgba(251, 191, 36, 0.4);
            transform: scale(1.1);
        }
        
        .now-playing-btn.stop-btn {
            background: rgba(239, 68, 68, 0.2);
            border-color: rgba(239, 68, 68, 0.4);
            color: #ef4444;
        }
        
        .now-playing-btn.stop-btn:hover {
            background: rgba(239, 68, 68, 0.4);
        }

        /* ---------------------------------------------------------------
           PREMIUM & ULTIMATE CARD GLOW EFFECTS
        --------------------------------------------------------------- */
        .holographic-card {
            position: relative;
            overflow: visible;
            border-radius: 16px;
        }
        
        /* Premium card - Purple animated glow border */
        .tier-card.premium.holographic-card {
            border: 2px solid rgba(139, 92, 246, 0.6);
            box-shadow: 
                0 0 10px rgba(139, 92, 246, 0.3),
                0 0 20px rgba(139, 92, 246, 0.2),
                0 0 30px rgba(139, 92, 246, 0.1),
                inset 0 0 20px rgba(139, 92, 246, 0.05);
            animation: premiumGlow 3s ease-in-out infinite;
        }
        
        @keyframes premiumGlow {
            0%, 100% { 
                box-shadow: 
                    0 0 10px rgba(139, 92, 246, 0.3),
                    0 0 20px rgba(139, 92, 246, 0.2),
                    0 0 30px rgba(139, 92, 246, 0.1),
                    inset 0 0 20px rgba(139, 92, 246, 0.05);
                border-color: rgba(139, 92, 246, 0.6);
            }
            50% { 
                box-shadow: 
                    0 0 15px rgba(139, 92, 246, 0.5),
                    0 0 30px rgba(139, 92, 246, 0.3),
                    0 0 45px rgba(139, 92, 246, 0.2),
                    inset 0 0 25px rgba(139, 92, 246, 0.08);
                border-color: rgba(167, 139, 250, 0.8);
            }
        }
        
        /* Ultimate card - Gold animated glow border */
        .tier-card.ultimate.holographic-card {
            border: 2px solid rgba(251, 191, 36, 0.6);
            box-shadow: 
                0 0 10px rgba(251, 191, 36, 0.3),
                0 0 20px rgba(251, 191, 36, 0.2),
                0 0 30px rgba(251, 191, 36, 0.1),
                inset 0 0 20px rgba(251, 191, 36, 0.05);
            animation: ultimateGlow 3s ease-in-out infinite;
        }
        
        @keyframes ultimateGlow {
            0%, 100% { 
                box-shadow: 
                    0 0 10px rgba(251, 191, 36, 0.3),
                    0 0 20px rgba(251, 191, 36, 0.2),
                    0 0 30px rgba(251, 191, 36, 0.1),
                    inset 0 0 20px rgba(251, 191, 36, 0.05);
                border-color: rgba(251, 191, 36, 0.6);
            }
            50% { 
                box-shadow: 
                    0 0 15px rgba(251, 191, 36, 0.5),
                    0 0 30px rgba(251, 191, 36, 0.3),
                    0 0 45px rgba(251, 191, 36, 0.2),
                    inset 0 0 25px rgba(251, 191, 36, 0.08);
                border-color: rgba(251, 191, 36, 0.9);
            }
        }
        
        /* Remove pseudo-elements - using box-shadow instead */
        .holographic-card::before,
        .holographic-card::after {
            display: none;
        }

        /* Card Shimmer on Hover */
        .shimmer-hover {
            position: relative;
            overflow: hidden;
        }
        
        .shimmer-hover::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.15),
                transparent
            );
            transition: left 0.5s ease;
        }
        
        .shimmer-hover:hover::after {
            left: 100%;
        }

        /* ---------------------------------------------------------------
           FLOATING PARTICLES SYSTEM
        --------------------------------------------------------------- */
        #particles-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
            overflow: hidden;
        }
        
        .floating-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            opacity: 0;
            animation: floatParticle linear infinite;
        }
        
        .particle-gold {
            background: radial-gradient(circle, #fbbf24, transparent);
            box-shadow: 0 0 6px #fbbf24, 0 0 12px rgba(251, 191, 36, 0.5);
        }
        
        .particle-purple {
            background: radial-gradient(circle, #a78bfa, transparent);
            box-shadow: 0 0 6px #a78bfa, 0 0 12px rgba(167, 139, 250, 0.5);
        }
        
        .particle-white {
            background: radial-gradient(circle, #ffffff, transparent);
            box-shadow: 0 0 4px #ffffff, 0 0 8px rgba(255, 255, 255, 0.3);
        }
        
        @keyframes floatParticle {
            0% {
                opacity: 0;
                transform: translateY(100vh) scale(0);
            }
            10% {
                opacity: 0.8;
                transform: translateY(80vh) scale(1);
            }
            90% {
                opacity: 0.6;
            }
            100% {
                opacity: 0;
                transform: translateY(-10vh) scale(0.5);
            }
        }

        /* ---------------------------------------------------------------
           PULSING GLOW EFFECTS
        --------------------------------------------------------------- */
        .pulse-glow {
            animation: pulseGlowEffect 2s ease-in-out infinite;
        }
        
        @keyframes pulseGlowEffect {
            0%, 100% {
                box-shadow: 0 0 5px rgba(251, 191, 36, 0.3),
                            0 0 10px rgba(251, 191, 36, 0.2);
            }
            50% {
                box-shadow: 0 0 15px rgba(251, 191, 36, 0.5),
                            0 0 30px rgba(251, 191, 36, 0.3),
                            0 0 45px rgba(251, 191, 36, 0.1);
            }
        }
        
        .active-glow {
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.4),
                        0 0 40px rgba(34, 197, 94, 0.2);
            animation: activeGlowPulse 1.5s ease-in-out infinite;
        }
        
        @keyframes activeGlowPulse {
            0%, 100% {
                box-shadow: 0 0 20px rgba(34, 197, 94, 0.4),
                            0 0 40px rgba(34, 197, 94, 0.2);
            }
            50% {
                box-shadow: 0 0 30px rgba(34, 197, 94, 0.6),
                            0 0 60px rgba(34, 197, 94, 0.3);
            }
        }

        /* ---------------------------------------------------------------
           SPIRITUAL JOURNEY BADGES
        --------------------------------------------------------------- */
        .journey-badge {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            position: relative;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(251, 191, 36, 0.3));
            border: 2px solid rgba(251, 191, 36, 0.5);
        }
        
        .journey-badge::before {
            content: '';
            position: absolute;
            inset: -3px;
            border-radius: 50%;
            background: conic-gradient(from 0deg, #fbbf24, #a78bfa, #22c55e, #fbbf24);
            opacity: 0.5;
            z-index: -1;
            animation: badgeRotate 4s linear infinite;
        }
        
        @keyframes badgeRotate {
            100% { transform: rotate(360deg); }
        }
        
        .journey-badge.awakening { border-color: #6b7280; }
        .journey-badge.seeker { border-color: #22c55e; }
        .journey-badge.initiate { border-color: #3b82f6; }
        .journey-badge.practitioner { border-color: #a78bfa; }
        .journey-badge.adept { border-color: #f59e0b; }
        .journey-badge.master { border-color: #fbbf24; }
        .journey-badge.genesis-master { 
            border-color: #fbbf24;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.4), rgba(139, 92, 246, 0.4));
        }

        /* ---------------------------------------------------------------
           STREAK FLAME VISUALIZATION
        --------------------------------------------------------------- */
        .streak-flame {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: linear-gradient(135deg, rgba(251, 146, 60, 0.2), rgba(239, 68, 68, 0.2));
            border-radius: 20px;
            border: 1px solid rgba(251, 146, 60, 0.4);
        }
        
        .streak-flame .flame-icon {
            color: #f97316;
            animation: flameFlicker 0.5s ease-in-out infinite alternate;
        }
        
        @keyframes flameFlicker {
            0% { transform: scale(1) rotate(-3deg); opacity: 0.9; }
            100% { transform: scale(1.1) rotate(3deg); opacity: 1; }
        }
        
        .streak-count {
            font-weight: 700;
            font-size: 18px;
            color: #fbbf24;
        }

        /* ---------------------------------------------------------------
           TIER PRICING CARDS
        --------------------------------------------------------------- */
        .tier-card {
            position: relative;
            padding: 24px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }
        
        .tier-card.premium {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(167, 139, 250, 0.1));
            border: 2px solid rgba(139, 92, 246, 0.5);
        }
        
        .tier-card.ultimate {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.08), rgba(245, 158, 11, 0.04));
            border: 2px solid rgba(251, 191, 36, 0.4);
        }
        
        .tier-card.ultimate::before {
            content: '⭐ BEST VALUE';
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(90deg, #fbbf24, #f59e0b);
            color: #1a0033;
            padding: 5px 16px;
            border-radius: 15px;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.5px;
            box-shadow: 0 2px 8px rgba(251, 191, 36, 0.4);
        }
        
        .tier-price {
            font-size: 36px;
            font-weight: 800;
            color: #fbbf24;
        }
        
        .tier-price span {
            font-size: 16px;
            font-weight: 400;
            color: #9ca3af;
        }
    </style>
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
    <!-- Info Modal - must be direct child of body for proper fixed positioning -->
    <div id="infoModal" style="position:fixed;top:0;left:0;width:100vw;height:100vh;display:none;align-items:center;justify-content:center;z-index:2147483647;background:rgba(0,0,0,0.92);">
        <div style="background:linear-gradient(135deg, rgba(26,0,51,0.98), rgba(139,92,246,0.95));border-radius:20px;padding:25px;width:90%;max-width:500px;max-height:80vh;overflow-y:auto;border:2px solid rgba(251,191,36,0.5);box-shadow:0 25px 80px rgba(0,0,0,0.6),0 0 30px rgba(139,92,246,0.3);position:relative;">
            <button onclick="closeInfoModal()" style="position:absolute;top:15px;right:15px;width:32px;height:32px;border-radius:50%;border:none;background:rgba(251,191,36,0.3);color:#fbbf24;font-size:20px;cursor:pointer;z-index:10;">×</button>
            <div id="modalTitle" style="color:#fbbf24;font-size:24px;font-weight:800;margin-bottom:15px;text-align:center;"></div>
            <div id="modalFreqs" style="color:#c4b5fd;font-size:16px;margin-bottom:20px;text-align:center;padding:10px;background:rgba(139,92,246,0.2);border-radius:10px;"></div>
            <div id="modalBody" style="color:#e9d5ff;font-size:15px;line-height:1.6;"></div>
        </div>
    </div>
    
    <!-- Floating Particles Container -->
    <div id="particles-container"></div>
    
    <!-- Safari Early Welcome Flow Initialization - runs before DOM fully loads -->
    <script>
    (function() {
        // Safari-safe storage check
        function canUseStorage() {
            try {
                localStorage.setItem('_test', '1');
                localStorage.removeItem('_test');
                return true;
            } catch(e) {
                return false;
            }
        }
        
        function getStorageItem(key) {
            try {
                return localStorage.getItem(key) || sessionStorage.getItem(key);
            } catch(e) {
                return null;
            }
        }
        
        // Check if this is first visit
        var onboardingDone = getStorageItem('onboardingComplete') === 'true';
        var forceShow = window.location.search.indexOf('showWelcome=true') !== -1;
        
        if (!onboardingDone || forceShow) {
            // Create a style to force the welcome modal visible immediately
            var style = document.createElement('style');
            style.id = 'safari-welcome-fix';
            style.textContent = '#immersiveWelcome { display: block !important; visibility: visible !important; opacity: 1 !important; position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; z-index: 9999999 !important; background: rgba(0,0,0,0.95) !important; padding: 20px !important; overflow-y: auto !important; box-sizing: border-box !important; } #immersiveWelcome .info-modal-content { width: 90% !important; max-width: 400px !important; margin: 20px auto !important; transform: none !important; left: auto !important; right: auto !important; position: relative !important; }';
            document.head.appendChild(style);
            document.body.style.overflow = 'hidden';
        }
    })();
    </script>
    
    <!-- Immersive Welcome Modal - starts hidden, shown via JavaScript for first-time users -->
    <div id="immersiveWelcome" class="info-modal" style="z-index:9999999;">
        <div class="info-modal-content" style="max-width: 500px; text-align: center;">
            <div class="welcome-header">Welcome to: Genesis Frequencies</div>
            <div class="info-modal-body" style="color: #ffffff; font-size: 18px; line-height: 1.6;">
                <div style="text-align:center;line-height:1.8;padding:10px 20px 20px 20px;">
                    <p style="font-size:17px;color:#ffd700;margin-bottom:20px;font-weight:600;letter-spacing:0.5px;">
                        The frequencies of creation are now in your hands.
                    </p>
                    <div style="background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(139,92,246,0.2));border-radius:14px;padding:20px;margin:20px 0;border:2px solid rgba(251,191,36,0.4);box-shadow: 0 0 30px rgba(251,191,36,0.15);">
                        <div style="font-size:28px;color:#ffd700;margin-bottom:10px;font-weight:800;text-shadow: 0 0 10px rgba(251,191,36,0.5);">
                            37 × 73 = 2701
                        </div>
                        <div style="font-size:16px;color:#ffffff;margin-bottom:8px;">
                            Genesis 1:1 (Hebrew) = 2701
                        </div>
                        <div style="font-size:14px;color:#e9d5ff;font-style:italic;margin-top:10px;">
                            "In the beginning..."
                        </div>
                    </div>
                    <p style="color:#ffffff;margin-bottom:15px;font-size:15px;line-height:1.7;">
                        These numbers aren't random.<br>
                        They encode a structure—a frequency—a pattern woven into the first verse of Scripture.<br>
                        <span style="color:#a78bfa;">Hidden for millennia.</span><br>
                        <span style="color:#ffd700;font-weight:600;">Now revealed.</span>
                    </p>
                    <p style="font-size:16px;color:#e9d5ff;margin-top:20px;">
                        Take a slow breath.<br>
                        Set a clear intention.
                    </p>
                    <p style="color:#ffd700;font-size:17px;margin-top:15px;font-weight:600;">
                        Your frequency journey begins now.
                    </p>
                </div>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px; padding-bottom: 20px;">
                <button onclick="showFrequencyBenefits()" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 15px 40px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 20px rgba(251,191,36,0.4); transition: transform 0.2s;">Begin ➡️</button>
            </div>
        </div>
    </div>

    <!-- Frequency Benefits Modal -->
    <div id="frequencyBenefitsModal" class="info-modal" style="z-index:9999998;">
        <div class="info-modal-content" style="max-width: 600px; text-align: center;">
            <div class="welcome-header">What Can These Frequencies Do?</div>
            <div class="info-modal-body" style="color: #fff; font-size: 16px; line-height: 1.6; text-align: left;">
                <div style="line-height:1.8;padding:10px 20px 20px 20px;">
                    <p style="text-align:center;font-size:15px;color:#ffd700;margin-bottom:20px;font-weight:600;">
                        Powered by the Trinity Engine: 37 Hz • 73 Hz • Intentional Input
                    </p>
                    
                    <div style="margin-bottom:15px;padding:15px;background:rgba(139,92,246,0.12);border-radius:12px;border-left:4px solid #fbbf24;">
                        <div style="font-size:17px;margin-bottom:8px;">🙏 <b style="color:#ffd700;">Meditation & Prayer Interface</b></div>
                        <p style="font-size:14px;color:#ffffff;margin:0;">
                            Drop into stillness. Synchronize your mind with the primordial pattern encoded in Genesis 1:1.
                        </p>
                    </div>
                    
                    <div style="margin-bottom:15px;padding:15px;background:rgba(139,92,246,0.12);border-radius:12px;border-left:4px solid #8b5cf6;">
                        <div style="font-size:17px;margin-bottom:8px;">⚡ <b style="color:#ffd700;">Energy Calibration & Alignment</b></div>
                        <p style="font-size:14px;color:#ffffff;margin:0;">
                            Run harmonic protocols derived from ancient numeric architecture. Stabilize, center, and refine your field.
                        </p>
                    </div>
                    
                    <div style="margin-bottom:15px;padding:15px;background:rgba(139,92,246,0.12);border-radius:12px;border-left:4px solid #fbbf24;">
                        <div style="font-size:17px;margin-bottom:8px;">🌙 <b style="color:#ffd700;">Rest Mode / System Reset</b></div>
                        <p style="font-size:14px;color:#ffffff;margin:0;">
                            Enter deep restoration states. Let the body quiet, the mind soften, and the system recalibrate.
                        </p>
                    </div>
                    
                    <div style="margin-bottom:15px;padding:15px;background:rgba(139,92,246,0.12);border-radius:12px;border-left:4px solid #8b5cf6;">
                        <div style="font-size:17px;margin-bottom:8px;">✨ <b style="color:#ffd700;">Creative Flow Matrix</b></div>
                        <p style="font-size:14px;color:#ffffff;margin:0;">
                            Unlock inspiration, clarity, and high-focus flow states by activating cognitive resonance pathways.
                        </p>
                    </div>
                    
                    <p style="text-align:center;font-size:12px;color:#a78bfa;margin-top:15px;font-style:italic;">
                        Spiritual technology for exploration and self-alignment—not a medical system.
                    </p>
                </div>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 15px; padding-bottom: 20px;">
                <button onclick="showHowToUse()" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 15px 35px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 20px rgba(251,191,36,0.4);">How to Use ➡️</button>
                <button onclick="skipToApp()" style="background: rgba(26,0,51,0.7); color: #e9d5ff; border: 1px solid rgba(139,92,246,0.5); border-radius: 25px; padding: 15px 25px; font-size: 16px; font-weight: 600; cursor: pointer;">Skip</button>
            </div>
        </div>
    </div>

    <!-- How to Use Modal -->
    <div id="howToUseModal" class="info-modal" style="z-index:9999997;">
        <div class="info-modal-content" style="max-width: 600px; text-align: center;">
            <div class="welcome-header">Skip to Your First Session: 3 Steps</div>
            <div class="welcome-subheader" style="font-size:14px;color:#e9d5ff;margin-bottom:15px;">Quantum Quick Start</div>
            <div class="info-modal-body" style="color: #fff; font-size: 16px; line-height: 1.6; text-align: left;">
                <div style="line-height:1.8;padding:10px 20px 20px 20px;">
                    <div style="background:rgba(251,191,36,0.15);border-radius:12px;padding:18px;margin-bottom:18px;border-left:4px solid #fbbf24;">
                        <ol style="text-align:left;color:#ffffff;font-size:14px;line-height:1.7;padding-left:20px;margin:0;">
                            <li style="margin-bottom:12px;">
                                <b style="color:#ffd700;">Select "Genesis Creation"</b><br>
                                <span style="font-size:13px;color:#e9d5ff;">Access the pure 37 + 73 Hz Trinity Base Frequency—<br>the original harmonic blueprint encoded in Genesis 1:1.</span>
                            </li>
                            <li style="margin-bottom:12px;">
                                <b style="color:#ffd700;">Set Your Immersion Window</b><br>
                                <span style="font-size:13px;color:#e9d5ff;">Choose 5–10 minutes for your first run.<br>Headphones = deep-field quantum immersion.<br>Speakers = ambient harmonic exposure.<br>Start short. Extend once your system adapts.</span>
                            </li>
                            <li>
                                <b style="color:#ffd700;">Activate the Sequence</b><br>
                                <span style="font-size:13px;color:#e9d5ff;">Press PLAY.<br>Slow your breath.<br>Let the field stabilize.<br>Hold a single intention: "peace," "clarity," or "thank you."</span>
                            </li>
                        </ol>
                    </div>
                    
                    <div style="background:rgba(139,92,246,0.12);border-radius:12px;padding:15px;margin-bottom:15px;">
                        <p style="font-size:15px;color:#e9d5ff;margin-bottom:10px;font-weight:600;">
                            Controls Within the System
                        </p>
                        <ul style="text-align:left;color:#ffffff;font-size:13px;line-height:1.6;padding-left:20px;margin:0;">
                            <li><b style="color:#ffd700;">Categories</b> — Biblical Codes, Angelic Numbers, Solfeggio, Quantum Fields</li>
                            <li><b style="color:#ffd700;">Volume</b> — Begin low to prevent resonance overload</li>
                            <li><b style="color:#ffd700;">Duration</b> — Set your session timer</li>
                        </ul>
                    </div>
                    
                    <div style="background:rgba(251,191,36,0.1);border-radius:10px;padding:15px;">
                        <p style="font-size:15px;color:#ffd700;margin-bottom:8px;font-weight:600;">
                            Operator Pro Tips
                        </p>
                        <ul style="text-align:left;color:#ffffff;font-size:12px;line-height:1.5;padding-left:20px;margin:0;">
                            <li>Use during meditation, prayer, breathwork, or yoga</li>
                            <li>Hydrate before and after to improve energetic conductivity</li>
                            <li>Record impressions — frequency sessions often reveal patterns later</li>
                        </ul>
                    </div>
                    
                    <div style="background:rgba(139,92,246,0.15);border-radius:10px;padding:15px;margin-top:15px;border:1px solid rgba(139,92,246,0.4);">
                        <p style="font-size:15px;color:#e9d5ff;margin-bottom:8px;font-weight:600;">
                            📚 Genesis Companion
                        </p>
                        <p style="text-align:left;color:#ffffff;font-size:12px;line-height:1.5;margin:0;">
                            Tap the <b style="color:#fbbf24;">Genesis Companion</b> button at the top of the app to access detailed track information, view your achievements, track your listening streak, and explore the science behind each frequency.
                        </p>
                    </div>
                </div>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 15px; padding-bottom: 20px;">
                <button onclick="showPWATip()" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 15px 35px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 20px rgba(251,191,36,0.4);">Pro Tip ➡️</button>
                <button onclick="skipToApp()" style="background: rgba(26,0,51,0.7); color: #e9d5ff; border: 1px solid rgba(139,92,246,0.5); border-radius: 25px; padding: 15px 25px; font-size: 16px; font-weight: 600; cursor: pointer;">Skip</button>
            </div>
        </div>
    </div>

    <!-- PWA Tip Modal -->
    <div id="pwaTipModal" class="info-modal" style="z-index:9999996;">
        <div class="info-modal-content" style="max-width: 500px; text-align: center;">
            <div class="welcome-header" id="pwaModalHeader">📲 Install Genesis Frequencies 📲</div>
            <div class="info-modal-body" style="color: #fff; font-size: 18px; line-height: 1.6;">
                <div style="text-align:center;line-height:1.8;padding:10px 20px 20px 20px;">
                    <p style="font-size:17px;color:#ffd700;margin-bottom:15px;font-weight:600;">
                        Get the Full Experience
                    </p>
                    <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(251,191,36,0.15));border-radius:14px;padding:18px;margin:15px 0;">
                        <ul style="text-align:left;max-width:350px;margin:0 auto;color:#ffffff;font-size:14px;line-height:1.8;list-style:none;padding:0;">
                            <li>✨ <b style="color:#ffd700;">Works offline</b> — Listen anytime</li>
                            <li>🚀 <b style="color:#ffd700;">Faster loading</b> — One tap access</li>
                            <li>📱 <b style="color:#ffd700;">Full screen mode</b> — No browser bars</li>
                            <li>🏆 <b style="color:#ffd700;">Track progress</b> — Streaks & achievements</li>
                        </ul>
                    </div>
                    <div id="pwaInstructions" style="background:rgba(139,92,246,0.12);border-radius:10px;padding:12px;margin:15px 0;">
                        <p style="color:#e9d5ff;font-weight:600;margin-bottom:6px;font-size:14px;">How to install:</p>
                        <p id="pwaInstallText" style="color:#ffffff;font-size:13px;margin:0;">
                            Tap <b>Share</b> (iOS) or <b>Menu ⋮</b> (Android)<br>
                            → Select <b>"Add to Home Screen"</b>
                        </p>
                    </div>
                    <p style="font-size:12px;color:#a78bfa;margin-top:15px;">
                        You can always do this later from the menu!
                    </p>
                </div>
            </div>
            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 15px; padding-bottom: 20px;">
                <button onclick="skipToApp()" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 15px 35px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 20px rgba(251,191,36,0.4);">Start Exploring →</button>
            </div>
        </div>
    </div>
    <div id="upgradeBenefitsModal" class="info-modal" style="z-index:9999995; display: none !important;">
        <div class="info-modal-content" style="max-width: 450px; text-align: center;">
            <div class="welcome-header">Unlock Premium Access</div>
            <div class="welcome-subheader" style="font-size:14px;color:#e9d5ff;margin-bottom:15px;">Ready to open the next layer of the Genesis Engine?</div>
            <div class="info-modal-body" style="color: #fff; font-size: 16px; line-height: 1.6;">
                <div style="line-height:1.8;padding:10px 20px 20px 20px;">
                    
                    <div style="margin-bottom:12px;padding:12px;background:rgba(251,191,36,0.1);border-radius:10px;border-left:3px solid #fbbf24;">
                        <div style="font-size:15px;margin-bottom:4px;"><b style="color:#ffd700;">🎵 Independent Frequency Controls</b></div>
                        <p style="font-size:13px;color:#ffffff;margin:0;">
                            Modulate each harmonic channel with precision.<br>Craft your own resonance signature.
                        </p>
                    </div>
                    
                    <div style="margin-bottom:12px;padding:12px;background:rgba(139,92,246,0.1);border-radius:10px;border-left:3px solid #8b5cf6;">
                        <div style="font-size:15px;margin-bottom:4px;"><b style="color:#e9d5ff;">💾 Export Tracks for Offline Listening</b></div>
                        <p style="font-size:13px;color:#ffffff;margin:0;">
                            Save frequencies as WAV files and play them on<br><b style="color:#ffd700;">free VLC Player</b>, Spotify, or any music app.<br>Perfect for phone-in-pocket listening!
                        </p>
                    </div>
                    
                    <div style="margin-bottom:12px;padding:12px;background:rgba(251,191,36,0.1);border-radius:10px;border-left:3px solid #fbbf24;">
                        <div style="font-size:15px;margin-bottom:4px;"><b style="color:#ffd700;">∞ Unlimited Session Duration</b></div>
                        <p style="font-size:13px;color:#ffffff;margin:0;">
                            Run extended cycles for deep meditation, sleep,<br>or sustained frequency immersion.
                        </p>
                    </div>
                    
                    <div style="margin-bottom:12px;padding:12px;background:rgba(139,92,246,0.1);border-radius:10px;border-left:3px solid #8b5cf6;">
                        <div style="font-size:15px;margin-bottom:4px;"><b style="color:#e9d5ff;">📲 Free App Store Upgrade</b></div>
                        <p style="font-size:13px;color:#ffffff;margin:0;">
                            When the full Genesis Frequencies app launches,<br>your access automatically expands—no extra cost.
                        </p>
                    </div>
                    
                    <div style="text-align:center;background:linear-gradient(135deg,rgba(251,191,36,0.2),rgba(139,92,246,0.2));border-radius:14px;padding:18px;margin:18px 0;border:2px solid rgba(251,191,36,0.5);box-shadow: 0 0 20px rgba(251,191,36,0.15);">
                        <p style="font-size:22px;color:#ffd700;font-weight:800;margin-bottom:6px;text-shadow: 0 0 10px rgba(251,191,36,0.3);">
                            🔓 Lifetime Activation
                        </p>
                        <p style="font-size:14px;color:#ffffff;margin-bottom:4px;">
                            A single initiation unlocks everything.<br>No subscriptions. No renewals.
                        </p>
                        <p style="font-size:12px;color:#e9d5ff;">
                            Step into the full system.
                        </p>
                    </div>
                </div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 12px; align-items: center; margin-top: 15px; padding: 0 20px;">
                <a href="https://glamhorus.etsy.com/au/listing/4421122004/genesis-frequencies-49-trinity-layered" target="_blank" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 16px 40px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 20px rgba(251,191,36,0.4); text-decoration: none; display: inline-block;">Get Premium Now</a>
                <button onclick="skipToApp()" style="background: rgba(26,0,51,0.7); color: #e9d5ff; border: 1px solid rgba(139,92,246,0.5); border-radius: 25px; padding: 12px 30px; font-size: 16px; font-weight: 600; cursor: pointer;">Try Free Version First</button>
                <p style="font-size:11px;color:#a78bfa;margin-top:5px;">
                    You can upgrade anytime from the Settings module.
                </p>
            </div>
        </div>
    </div>

    <!-- Upgrade Modal - HIDDEN (Free version - only export is premium) -->
    <div id="upgradeModal" class="upgrade-modal" style="display: none !important;">
        <div class="upgrade-modal-content" style="max-width: 450px;">
            <button class="upgrade-close" onclick="closeUpgradeModal()">×</button>
            <div class="upgrade-modal-header" data-translate="upgradeToPremium">
                <i data-lucide="star" class="lucide-icon lucide-icon-lg icon-gold"></i> Upgrade to Premium
            </div>
            <div class="upgrade-modal-body">
                <p style="margin-bottom: 20px; font-size: 16px; text-align: center; color: #c4b5fd;">
                    Unlock the full power of sacred frequencies
                </p>

                <!-- Single Premium Card -->
                <div class="tier-card premium holographic-card" style="max-width: 100%; margin: 0 auto 20px;">
                    <div class="tier-price" style="font-size: 42px; text-align: center;">$9.99 <span style="font-size: 16px;">/ lifetime</span></div>
                    
                    <ul style="list-style: none; padding: 0; margin: 25px 0; text-align: left; font-size: 14px; color: #e5e7eb;">
                        <li style="margin-bottom: 12px;"><i data-lucide="check" class="lucide-icon icon-green" style="width:18px;height:18px;"></i> <b>All 49 frequency tracks</b></li>
                        <li style="margin-bottom: 12px;"><i data-lucide="check" class="lucide-icon icon-green" style="width:18px;height:18px;"></i> <b>Unlimited listening time</b></li>
                        <li style="margin-bottom: 12px;"><i data-lucide="check" class="lucide-icon icon-green" style="width:18px;height:18px;"></i> <b>Individual volume controls</b></li>
                        <li style="margin-bottom: 12px;"><i data-lucide="check" class="lucide-icon icon-green" style="width:18px;height:18px;"></i> <b>WAV export</b> - Play on free VLC Player</li>
                        <li style="margin-bottom: 12px;"><i data-lucide="check" class="lucide-icon icon-green" style="width:18px;height:18px;"></i> <b>Keep screen awake</b></li>
                        <li style="margin-bottom: 12px;"><i data-lucide="check" class="lucide-icon icon-green" style="width:18px;height:18px;"></i> <b>Achievement system</b></li>
                        <li style="margin-bottom: 12px;"><i data-lucide="check" class="lucide-icon icon-green" style="width:18px;height:18px;"></i> <b>Future updates included</b></li>
                    </ul>
                    
                    <a href="https://glamhorus.etsy.com/au/listing/4421122004/genesis-frequencies-49-trinity-layered" class="upgrade-btn" target="_blank" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; font-size: 18px; padding: 14px 30px; width: 100%; text-align: center; display: block; box-sizing: border-box;">
                        👑 Get Premium Now
                    </a>
                </div>

                <p style="margin: 15px 0; color: #10b981; font-weight: 600; text-align: center; line-height: 1.6; font-size: 13px;">
                    ✅ One-time payment • Lifetime access<br>
                    🔒 No subscriptions • No data collected
                </p>

                <!-- Enter Code Button -->
                <div style="text-align: center; margin: 15px 0; padding-top: 15px; border-top: 1px solid rgba(139,92,246,0.3);">
                    <p style="color: #9ca3af; font-size: 12px; margin-bottom: 8px;">Already have a license key?</p>
                    <button onclick="closeUpgradeModal(); showLicenseModal();" 
                        style="background: rgba(139,92,246,0.2); color: #c4b5fd; border: 1px solid rgba(139,92,246,0.5); border-radius: 20px; padding: 8px 20px; font-size: 13px; font-weight: 600; cursor: pointer;">
                        🔑 Enter License Key
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- License Key Modal -->
    <div id="licenseModal" class="upgrade-modal" style="display: none;">
        <div class="upgrade-modal-content" style="max-width: 450px; text-align: center;">
            <button class="upgrade-close" onclick="closeLicenseModal()">×</button>
            <div style="font-size: 48px; margin-bottom: 15px;">🔑</div>
            <div class="upgrade-modal-header" style="font-size: 24px; margin-bottom: 10px;">
                Enter License Key
            </div>
            <div id="licenseCurrentTier" style="color: #10b981; font-size: 14px; margin-bottom: 20px; display: none;">
                ✅ You have <span id="currentTierName">Premium</span>
            </div>
            <div class="upgrade-modal-body">
                <p style="margin-bottom: 20px; font-size: 15px; color: #c4b5fd;">
                    Paste your Premium license key:
                </p>
                
                <div style="margin-bottom: 15px;">
                    <input type="text" id="licenseKeyFull" placeholder="QMFG-XXXX-XXXX-XXXX" 
                        style="width: 100%; max-width: 280px; padding: 14px; text-align: center; background: rgba(139,92,246,0.2); border: 2px solid rgba(139,92,246,0.4); border-radius: 10px; color: #fff; font-size: 18px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;"
                        oninput="formatLicenseKey(this)" maxlength="19">
                </div>
                
                <div id="licenseError" style="color: #ef4444; font-size: 14px; margin-bottom: 15px; display: none;"></div>
                <div id="licenseSuccess" style="color: #10b981; font-size: 14px; margin-bottom: 15px; display: none;"></div>
                
                <button id="activateLicenseBtn" onclick="activateLicense()" 
                    style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 14px 40px; font-size: 16px; font-weight: 700; cursor: pointer; width: 100%; margin-bottom: 20px; box-shadow: 0 4px 15px rgba(251,191,36,0.3);">
                    ✨ Activate License
                </button>
                
                <div style="border-top: 1px solid rgba(139,92,246,0.3); padding-top: 20px;">
                    <p style="color: #9ca3af; font-size: 13px; margin-bottom: 12px;">Don't have a license key?</p>
                    <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                        <a href="https://glamhorus.etsy.com/au/listing/4421122004/genesis-frequencies-49-trinity-layered" target="_blank" 
                            style="background: rgba(139,92,246,0.3); color: #c4b5fd; border: 1px solid rgba(139,92,246,0.5); border-radius: 20px; padding: 10px 20px; font-size: 14px; font-weight: 600; text-decoration: none;">
                            Buy Premium $9.99
                        </a>
                    </div>
                </div>
                
                <div id="deviceInfo" style="margin-top: 20px; font-size: 12px; color: #6b7280;"></div>
                
                <div style="margin-top: 15px; padding: 12px; background: rgba(251,191,36,0.1); border: 1px solid rgba(251,191,36,0.3); border-radius: 8px;">
                    <p style="color: #fbbf24; font-size: 11px; margin: 0;">📱 <strong>Note:</strong> Safari browser and Home Screen app use separate storage. You'll need to enter your license in both. Your key works on 5 devices.</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        
        <div class="header">
            <div class="hebrew-header">בְּרֵאשִׁית בָּרָא אֱלֹהִים אֵת הַשָּׁמַיִם וְאֵת הָאָרֶץ</div>
            <div class="hebrew-translation" data-translate="hebrewTranslation">In the beginning God created the heavens and the earth</div>
            <div style="font-size:22px; font-weight:800; color:#fbbf24; text-align:center; margin-bottom:2px;">Genesis Frequencies</div>
            <div style="font-size:16px; font-weight:600; color:#ffffff; text-align:center; margin-bottom:10px; text-shadow: 0 1px 2px rgba(0,0,0,0.3);">inspired by</div>
            <h1 class="main-title" data-translate="title" style="margin-bottom:0;">Genesis 1:1</h1>
            <div class="subtitle" data-translate="subtitle">Biblical Trinity Frequency System</div>
            <div class="divider"></div>
            <div class="gematria" style="font-size: 18px;">37 Hz + 73 Hz</div>
            <div class="gematria" style="font-size: 15px; margin-top: -15px;" data-translate="pattern">Prayer Amplifier</div>

            <!-- Sacred Guide Button -->
            <div style="text-align: center; margin: 20px 0;">
                <button id="genesisCompanionBtn" class="btn-instructions" onclick="handleCompanionClick(event)" style="font-size: 18px; font-weight: 700; background: linear-gradient(90deg, #8b5cf6 0%, #fbbf24 100%); color: #1a0033; border: none; border-radius: 12px; padding: 10px 24px; box-shadow: 0 2px 12px rgba(139,92,246,0.15); cursor: pointer; position: relative; z-index: 1000; pointer-events: auto; animation: companionShimmer 4s ease-in-out infinite;" data-translate="genesisCompanion">
                    Genesis Companion
                </button>
            </div>

            <!-- Instructions Panel (expandable) -->
            <div id="instructionsPanel" class="instructions-panel" style="display: none; max-width: 900px; margin: 0 auto 18px auto; background: rgba(26,0,51,0.97); border-radius: 18px; box-shadow: 0 8px 32px rgba(139,92,246,0.18); padding: 20px; color: #fff; z-index: 1000000; position: relative;">
                <div class="instructions-content" style="text-align:center;">
                    <div class="instructions-header" style="display: flex; justify-content: center; align-items: center;">
                        <h2 style="font-size: 24px; color: #fbbf24; font-weight: 800; margin: 0 auto; text-align:center; width:100%;" data-translate="genesisFrequencyCompanion">Genesis Frequency Companion</h2>
                    </div>
                    
                    <!-- Personalized Welcome Header -->
                    <div id="companionWelcomeHeader" style="margin: 20px 0; padding: 20px; background: linear-gradient(135deg, rgba(139,92,246,0.15), rgba(251,191,36,0.1)); border-radius: 16px; border: 1px solid rgba(251,191,36,0.2);">
                        <div id="companionGreeting" style="font-size: 20px; color: #fbbf24; font-weight: 700; margin-bottom: 12px;">
                            <!-- Personalized greeting will be rendered by JS -->
                        </div>
                        <div id="companionDailyWisdom" style="font-size: 15px; color: #c4b5fd; font-style: italic; margin-bottom: 16px; line-height: 1.5;">
                            <!-- Daily wisdom quote will be rendered by JS -->
                        </div>
                        <div id="companionQuickStats" style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; margin-bottom: 16px;">
                            <!-- Quick stats will be rendered by JS -->
                        </div>
                        <div id="companionQuickActions" style="display: flex; justify-content: center; gap: 12px; flex-wrap: wrap;">
                            <!-- Quick action buttons will be rendered by JS -->
                        </div>
                    </div>
                    
                    <div class="instructions-body" style="margin-top: 18px;">
                        <!-- BEGIN: Expandable/Collapsible Instructions Tab Structure -->
                        <div id="instructionsAccordion" class="instructions-accordion">
                            <!-- Sections will be dynamically rendered here by JS for accordion, search, and navigation -->
                        </div>

                        <div style="margin-top:32px; text-align:center; color:#fbbf24; font-size:18px; font-weight:700;" data-translate="completeCompanion">Your complete Genesis companion for divine frequency mastery.</div>
                        
                        <!-- Return to Tracks Button -->
                        <div style="margin-top: 25px; text-align: center;">
                            <button onclick="window.toggleInstructions();" style="background: linear-gradient(90deg, #8b5cf6, #6b46c1); color: #fff; border: none; border-radius: 25px; padding: 15px 35px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(139,92,246,0.4);" data-translate="returnToTracks">
                                ⬅️ Return to Tracks
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Premium Upgrade CTA -->
        <div id="premiumCtaTop" class="section premium-cta-section" style="text-align: center; margin: 30px 0; padding: 25px; background: linear-gradient(135deg, rgba(26,0,51,0.8), rgba(139,92,246,0.6)); border-radius: 15px; border: 2px solid rgba(251,191,36,0.3); position: relative; z-index: 1100;">
            <h3 id="premiumCtaTopTitle" style="color: #fbbf24; font-size: 22px; font-weight: 700; margin-bottom: 15px;" data-translate="readyToUnlock">✨ Ready to Unlock Premium Features?</h3>
            <p style="color: #c4b5fd; font-size: 16px; margin-bottom: 20px; line-height: 1.5;" data-translate="premiumCtaDesc">
                Get lifetime access to individual volume controls, custom durations, WAV export (play on free VLC Player!), achievement system, plus free upgrade when we launch on App Store!
            </p>
            <button onclick="showUpgradeModal()" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 15px 30px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(251,191,36,0.3);" data-translate="upgradeToPremium">
                Upgrade to Premium
            </button>
            <p style="margin-top: 15px; font-size: 14px; color: #9ca3af;" data-translate="oneTimePayment">
                One-time payment • Lifetime access • No subscriptions
            </p>
        </div>

        <div class="trinity-base">
            <div class="trinity-title" data-translate="trinityTitle">Trinity Foundation Frequencies</div>
            <div class="trinity-frequencies">
                <div class="trinity-freq">
                    <div class="hz">37 Hz</div>
                    <div class="label" data-translate="formMatter">Form/Matter</div>
                </div>
                <div class="trinity-arrow">+</div>
                <div class="trinity-freq">
                    <div class="hz">73 Hz</div>
                    <div class="label" data-translate="spiritDivine">Spirit/Divine</div>
                </div>
            </div>
        </div>

        <div class="visualizer">
            <div class="frequency-vibration">
                <div class="vibration-wave">
                    <svg viewBox="0 0 1000 100" preserveAspectRatio="none">
                        <path d="M0,50 Q50,20 100,50 T200,50 T300,50 T400,50 T500,50 T600,50 T700,50 T800,50 T900,50 T1000,50" 
                              fill="none" stroke="rgba(251, 191, 36, 0.8)" stroke-width="3"/>
                    </svg>
                </div>
                <div class="vibration-wave">
                    <svg viewBox="0 0 1000 100" preserveAspectRatio="none">
                        <path d="M0,50 Q25,15 50,50 T100,50 T150,50 T200,50 T250,50 T300,50 T350,50 T400,50 T450,50 T500,50 T550,50 T600,50 T650,50 T700,50 T750,50 T800,50 T850,50 T900,50 T950,50 T1000,50" 
                              fill="none" stroke="rgba(139, 92, 246, 0.8)" stroke-width="3"/>
                    </svg>
                </div>
                <div class="vibration-wave">
                    <svg viewBox="0 0 1000 100" preserveAspectRatio="none">
                        <path d="M0,50 Q40,25 80,50 T160,50 T240,50 T320,50 T400,50 T480,50 T560,50 T640,50 T720,50 T800,50 T880,50 T960,50 T1000,50" 
                              fill="none" stroke="rgba(168, 85, 247, 0.3)" stroke-width="3"/>
                    </svg>
                </div>
            </div>
            <div class="sacred-geometry"></div>
            <div class="visualizer-content">
            </div>
        </div>

        

        <div class="section">
            <div class="section-title" data-translate="recipesTitle">Trinity Frequency Recipes</div>
            <div class="recipes" id="recipes">
                <!-- Recipes will be populated by JavaScript -->
            </div>
        </div>

        <div class="section">
            <div class="section-title" data-translate="controlsTitle">Frequency Controls</div>
            <div class="controls">
                <div class="frequency-controls premium-lock" onclick="if(!hasPremiumAccess()) showUpgradeModal();" style="cursor: pointer;">
                    <div class="control-group">
                        <div>
                            <input type="number" id="freq1" min="0.1" max="100000" step="0.1" value="37">
                            <span>Hz</span>
                        </div>
                        <input type="range" id="volume1" min="0" max="100" value="50">
                        <div class="range-value" id="volume1Value">50%</div>
                    </div>
                    
                    <div class="control-group">
                        <div>
                            <input type="number" id="freq2" min="0.1" max="100000" step="0.1" value="73">
                            <span>Hz</span>
                        </div>
                        <input type="range" id="volume2" min="0" max="100" value="50">
                        <div class="range-value" id="volume2Value">50%</div>
                    </div>
                    
                    <div class="control-group">
                        <div>
                            <input type="number" id="freq3" min="0.1" max="100000" step="0.1" value="0">
                            <span>Hz</span>
                        </div>
                        <input type="range" id="volume3" min="0" max="100" value="50">
                        <div class="range-value" id="volume3Value">50%</div>
                    </div>
                </div>
                
                <div class="control-group duration-control premium-lock" onclick="if(!hasPremiumAccess()) showUpgradeModal();" style="cursor: pointer;">
                    <label for="duration" data-translate="duration">⏱️ Duration</label>
                    <div class="duration-input-wrapper">
                        <div class="duration-input-container">
                            <input type="text" id="duration" placeholder="05:00" value="05:00" pattern="[0-9]{1,2}:[0-9]{2}" maxlength="5">
                        </div>
                        <div class="duration-buttons">
                            <button type="button" class="duration-btn" data-time="01:00">1m</button>
                            <button type="button" class="duration-btn" data-time="05:00">5m</button>
                            <button type="button" class="duration-btn" data-time="10:00">10m</button>
                            <button type="button" class="duration-btn" data-time="30:00">30m</button>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button class="button button-primary" id="playBtn" aria-label="Play frequency generator" data-translate="play">▶ PLAY</button>
                    <button class="button button-danger" id="stopBtn" aria-label="Stop frequency generator" data-translate="stop">⏹ STOP</button>
                    <button class="button button-secondary premium-lock" id="exportBtn" onclick="showExportUpgradeModal()" aria-label="Export as WAV file - Premium feature" data-translate="export">💾 EXPORT</button>
                    <button class="button button-secondary" id="resetBtn" aria-label="Reset frequencies to default" data-translate="reset">🔄 RESET</button>
                </div>
                
                <!-- Keep Screen Awake Toggle -->
                <div id="screenAwakeContainer" style="margin-top: 15px; padding: 12px 15px; background: rgba(139,92,246,0.1); border-radius: 12px; display: flex; align-items: center; justify-content: space-between;">
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <span style="font-size: 20px;">📱</span>
                        <div>
                            <div style="color: #e5e7eb; font-size: 14px; font-weight: 600;">Keep Screen Awake</div>
                            <div style="color: #9ca3af; font-size: 11px;">Prevents audio stopping when screen dims</div>
                        </div>
                    </div>
                    <label class="toggle-switch" onclick="event.stopPropagation();">
                        <input type="checkbox" id="screenAwakeToggle" disabled>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                
                <!-- Export Tip for Background Listening -->
                <div id="exportTip" style="margin-top: 10px; padding: 10px 15px; background: linear-gradient(135deg, rgba(16,185,129,0.1), rgba(139,92,246,0.1)); border: 1px solid rgba(16,185,129,0.3); border-radius: 10px; display: none;">
                    <div style="display: flex; align-items: flex-start; gap: 10px;">
                        <span style="font-size: 16px;">💡</span>
                        <div style="color: #9ca3af; font-size: 12px; line-height: 1.4;">
                            <b style="color: #10b981;">Pro tip:</b> Export your frequency track as a WAV file to save and share!
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="status stopped" id="status" data-translate="ready">
            Ready to Generate Genesis Frequencies
        </div>

        <!-- Achievements Section - Collapsible Tab -->
        <div class="section category-tab" id="achievementsSection" style="margin-top: 20px;">
            <div class="category-header" onclick="this.parentElement.classList.toggle('expanded')" style="cursor: pointer;">
                <div class="category-title">
                    <span class="category-icon">✨</span>
                    <span data-translate="yourSpiritualJourney">Your Spiritual Journey</span>
                    <span class="category-icon">✨</span>
                </div>
                <div class="category-arrow">▼</div>
            </div>
            <div class="category-content">
                <div id="achievementsPreview" style="padding: 15px;">
                    <!-- Achievement stats and preview will be populated by JavaScript -->
                </div>
                <div style="text-align: center; padding: 10px 15px 20px;">
                    <button onclick="showFullAchievements()" style="background: linear-gradient(90deg, #8b5cf6, #6b46c1); color: #fff; border: none; border-radius: 25px; padding: 12px 25px; font-size: 16px; font-weight: 600; cursor: pointer; box-shadow: 0 4px 15px rgba(139,92,246,0.3); transition: all 0.3s ease;" data-translate="viewAllAchievements">
                        🏆 View All Achievements
                    </button>
                </div>
            </div>
        </div>

        <div class="visualizer" style="margin-top: 20px;">
            <div class="frequency-vibration">
                <div class="vibration-wave">
                    <svg viewBox="0 0 1000 100" preserveAspectRatio="none">
                        <path d="M0,50 Q50,20 100,50 T200,50 T300,50 T400,50 T500,50 T600,50 T700,50 T800,50 T900,50 T1000,50" 
                              fill="none" stroke="rgba(251, 191, 36, 0.8)" stroke-width="3"/>
                    </svg>
                </div>
                <div class="vibration-wave">
                    <svg viewBox="0 0 1000 100" preserveAspectRatio="none">
                        <path d="M0,50 Q25,15 50,50 T100,50 T150,50 T200,50 T250,50 T300,50 T350,50 T400,50 T450,50 T500,50 T550,50 T600,50 T650,50 T700,50 T750,50 T800,50 T850,50 T900,50 T950,50 T1000,50" 
                              fill="none" stroke="rgba(139, 92, 246, 0.8)" stroke-width="3"/>
                    </svg>
                </div>
                <div class="vibration-wave">
                    <svg viewBox="0 0 1000 100" preserveAspectRatio="none">
                        <path d="M0,50 Q40,25 80,50 T160,50 T240,50 T320,50 T400,50 T480,50 T560,50 T640,50 T720,50 T800,50 T880,50 T960,50 T1000,50" 
                              fill="none" stroke="rgba(168, 85, 247, 0.3)" stroke-width="3"/>
                    </svg>
                </div>
            </div>
            <div class="sacred-geometry"></div>
            <div class="visualizer-content">
            </div>
        </div>

        <!-- Bottom Upgrade CTA - HIDDEN (Free version) -->
        <div id="premiumCtaBottom" style="display: none; text-align: center; margin: 40px 0; padding: 30px; background: linear-gradient(135deg, rgba(26,0,51,0.8), rgba(139,92,246,0.6)); border-radius: 20px; border: 2px solid rgba(251,191,36,0.3); position: relative; z-index: 1100;">
            <h3 id="premiumCtaBottomTitle" style="color: #fbbf24; font-size: 24px; margin-bottom: 15px;" data-translate="readyToUnlock">✨ Ready to Unlock Premium Features?</h3>
            <p style="color: #c4b5fd; font-size: 16px; margin-bottom: 20px; line-height: 1.6;" data-translate="premiumCtaDesc">
                Get lifetime access to individual volume controls, custom durations, WAV export (play on free VLC Player!), achievement system, plus free upgrade when we launch on App Store!
            </p>
            <button onclick="showUpgradeModal()" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 15px 30px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(251,191,36,0.3);" data-translate="upgradeToPremium">
                Upgrade to Premium
            </button>
            <p style="margin-top: 15px; font-size: 14px; color: #9ca3af;" data-translate="oneTimePayment">
                One-time payment • Lifetime access • No subscriptions
            </p>
        </div>

        <!-- Share & Earn Footer Section - HIDDEN -->
        <div id="affiliateSection" style="display: none; background: linear-gradient(135deg, #1a2a3e, #0a1f15); border: 2px solid #10b981; border-radius: 16px; padding: 40px 20px; text-align: center; margin-top: 30px; position: relative; z-index: 1100;">
            <div style="max-width: 500px; margin: 0 auto;">
                <h3 style="color: #4ade80; font-size: 24px; margin-bottom: 15px; font-weight: 700;">💰 Affiliate Program Coming Soon!</h3>
                <p style="color: #ffffff; font-size: 16px; line-height: 1.7; margin-bottom: 20px;">
                    Love Genesis Frequencies? Register your interest for our upcoming affiliate program and earn <strong style="color: #fbbf24;">30% commission</strong> per sale!
                </p>
                <button onclick="showAffiliateModal()" style="
                    background: linear-gradient(135deg, #10b981, #059669);
                    color: white;
                    border: none;
                    padding: 16px 36px;
                    border-radius: 25px;
                    font-size: 17px;
                    font-weight: 700;
                    cursor: pointer;
                    box-shadow: 0 4px 25px rgba(16, 185, 129, 0.5);
                ">Register Your Interest</button>
            </div>
        </div>
    </div>

    <!-- Now Playing Sticky Footer Bar -->
    <div class="now-playing-bar" id="nowPlayingBar">
        <div class="now-playing-info">
            <span class="now-playing-icon">🎵</span>
            <div class="now-playing-text">
                <span class="now-playing-label">Now Playing</span>
                <span class="now-playing-track" id="nowPlayingTrack">Genesis Creation</span>
            </div>
        </div>
        <div class="now-playing-time" id="nowPlayingTime">00:00</div>
        <div class="now-playing-controls">
            <button class="now-playing-btn stop-btn" onclick="window.generator && window.generator.stop()" title="Stop">⏹</button>
        </div>
    </div>

    <div class="add-to-home" id="addToHome" onclick="showAddToHomeInstructions()" style="cursor: pointer; display: none !important;">
        <button class="add-to-home-close" onclick="event.stopPropagation(); closeAddToHome()">×</button>
        <div class="add-to-home-content" style="flex-direction: column;">
            <span class="add-to-home-icon" id="pwaIcon" style="font-size: 32px; margin-bottom: 8px;">📲</span>
            <span class="add-to-home-text" id="pwaBannerText" style="font-weight:700;" data-translate="addToHomeText">INSTALL Genesis Frequencies for the best experience!</span>
        </div>
    </div>

    <script>
                        // Instructions panel toggle function
                        window.toggleInstructions = function() {
                            console.log('🎯 toggleInstructions called!');
                            var panel = document.getElementById('instructionsPanel');
                            var overlay = document.getElementById('instructionsOverlay');
                            console.log('📋 Panel element:', panel);
                            console.log('📋 Overlay element:', overlay);
                            
                            // If overlay exists, we're closing
                            if (overlay) {
                                console.log('✖️ Closing panel - removing overlay');
                                try {
                                    // First move panel back to header
                                    var header = document.querySelector('.header');
                                    if (header && panel) {
                                        panel.style.cssText = 'display: none; max-width: 900px; margin: 0 auto 18px auto; background: rgba(26,0,51,0.97); border-radius: 18px; box-shadow: 0 8px 32px rgba(139,92,246,0.18); padding: 20px; color: #fff; z-index: 10; position: relative;';
                                        header.appendChild(panel);
                                    }
                                    // Then remove overlay
                                    overlay.remove();
                                    // Restore body scroll
                                    document.body.style.overflow = '';
                                    // Scroll to top
                                    window.scrollTo(0, 0);
                                } catch (e) {
                                    console.error('Error closing panel:', e);
                                    // Fallback: just remove overlay
                                    if (overlay) overlay.remove();
                                    document.body.style.overflow = '';
                                }
                            } else if (panel && (panel.style.display === 'none' || panel.style.display === '')) {
                                console.log('📖 Opening panel');
                                // Create modal overlay
                                var newOverlay = document.createElement('div');
                                newOverlay.id = 'instructionsOverlay';
                                newOverlay.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #1a0a2e; z-index: 2000000; display: flex; align-items: center; justify-content: center; overflow-y: auto;';
                                
                                // No click-to-close on overlay - user must use Return button
                                
                                // Style the panel for modal
                                panel.style.cssText = 'display: block; position: relative; z-index: 2000001; max-width: 900px; margin: 20px; background: rgba(26,0,51,0.97); border-radius: 18px; box-shadow: 0 8px 32px rgba(139,92,246,0.18); padding: 20px; color: #fff; max-height: 90vh; overflow-y: auto;';
                                
                                newOverlay.appendChild(panel);
                                document.body.appendChild(newOverlay);
                                
                                // Refresh translations before rendering - ensure currentLanguage is applied
                                console.log('🌐 Current language for companion panel:', currentLanguage);
                                instructionsSections = getInstructionsSections();
                                renderInstructionsCategories();
                                renderCompanionHeader(); // Force refresh header with current language
                                addInstructionsSearch();
                            }
                        }

                        // Handle companion button click
                        window.handleCompanionClick = function(event) {
                            console.log('👆 Companion button clicked!', event);
                            event.preventDefault();
                            event.stopPropagation();
                            window.toggleInstructions();
                        }
                        
                // Detect device type and update PWA text
                function updatePWAText() {
                    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                    const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
                    
                    if (!isMobile) {
                        // Desktop
                        const header = document.getElementById('pwaModalHeader');
                        const icon = document.getElementById('pwaIcon');
                        const bannerText = document.getElementById('pwaBannerText');
                        const installText = document.getElementById('pwaInstallText');
                        
                        if (header) header.textContent = '💻 Install on Desktop 💻';
                        if (icon) icon.textContent = '💻';
                        if (bannerText) bannerText.textContent = 'INSTALL Genesis Frequencies for the best experience!';
                        if (installText) installText.innerHTML = 'Click the <b style="color:#fbbf24;">install button</b> in your browser address bar or use the menu to install';
                    } else if (isIOS) {
                        // iOS devices
                        const header = document.getElementById('pwaModalHeader');
                        const icon = document.getElementById('pwaIcon');
                        const bannerText = document.getElementById('pwaBannerText');
                        const installText = document.getElementById('pwaInstallText');
                        
                        if (header) header.textContent = '📱 Add to Home Screen 📱';
                        if (icon) icon.textContent = '📱';
                        if (bannerText) bannerText.textContent = 'ADD to Home Screen for the best experience!';
                        if (installText) installText.innerHTML = 'Tap the <b style="color:#fbbf24;">Share</b> button, then <b style="color:#fbbf24;">"Add to Home Screen"</b>';
                    } else {
                        // Android
                        const header = document.getElementById('pwaModalHeader');
                        const icon = document.getElementById('pwaIcon');
                        const installText = document.getElementById('pwaInstallText');
                        
                        if (header) header.textContent = '📲 Install App 📲';
                        if (icon) icon.textContent = '📲';
                        if (installText) installText.innerHTML = 'Tap the <b style="color:#fbbf24;">menu</b> (⋮) and select <b style="color:#fbbf24;">"Install app"</b> or <b style="color:#fbbf24;">"Add to Home screen"</b>';
                    }
                }
                
            
            // Add to Home Screen banner logic (just close, no popup)
            window.closeAddToHome = function() {
                document.getElementById('addToHome').style.display = 'none';
                try { localStorage.setItem('hideAddToHome', 'true'); } catch(e) {}
            };
                            function showAddToHomeInstructions() {
                    const modal = document.createElement('div');
                    modal.style.cssText = `
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: rgba(0,0,0,0.95);
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        z-index: 99999999;
                        padding: 20px;
                    `;
                    
                    const isIOS = /iPhone|iPad|iPod/.test(navigator.userAgent);
                    const isAndroid = /Android/.test(navigator.userAgent);
                    
                    modal.innerHTML = `
                        <div style="
                            background: linear-gradient(135deg, #1a1625, #2d1b69);
                            border-radius: 24px;
                            padding: 40px 30px;
                            max-width: 500px;
                            width: 100%;
                            text-align: center;
                            border: 2px solid rgba(251,191,36,0.3);
                        ">
                            <div style="font-size: 48px; margin-bottom: 20px;">📲</div>
                            <h2 style="color: #fbbf24; font-size: 24px; font-weight: 800; margin-bottom: 15px;">
                                Add to Home Screen
                            </h2>
                            <p style="color: #c4b5fd; font-size: 16px; line-height: 1.6; margin-bottom: 25px;">
                                For the best experience, add Genesis Frequencies to your home screen manually:
                            </p>
                            
                            ${isIOS ? `
                                <div style="background: rgba(139,92,246,0.2); border-radius: 16px; padding: 20px; text-align: left; margin-bottom: 20px; border: 1px solid rgba(139,92,246,0.3);">
                                    <div style="color: #fbbf24; font-weight: 700; margin-bottom: 10px; font-size: 14px;">iOS INSTRUCTIONS:</div>
                                    <ol style="color: #e9d5ff; font-size: 15px; line-height: 1.8; padding-left: 20px;">
                                        <li>Tap the <span style="color: #fbbf24; font-weight: 700;">Share button</span> <span style="font-size: 20px;">⬆️</span></li>
                                        <li>Scroll down and tap <span style="color: #fbbf24; font-weight: 700;">"Add to Home Screen"</span></li>
                                        <li>Tap <span style="color: #fbbf24; font-weight: 700;">"Add"</span> in the top right</li>
                                    </ol>
                                </div>
                            ` : isAndroid ? `
                                <div style="background: rgba(139,92,246,0.2); border-radius: 16px; padding: 20px; text-align: left; margin-bottom: 20px; border: 1px solid rgba(139,92,246,0.3);">
                                    <div style="color: #fbbf24; font-weight: 700; margin-bottom: 10px; font-size: 14px;">ANDROID INSTRUCTIONS:</div>
                                    <ol style="color: #e9d5ff; font-size: 15px; line-height: 1.8; padding-left: 20px;">
                                        <li>Tap the <span style="color: #fbbf24; font-weight: 700;">menu icon</span> <span style="font-size: 20px;">⋮</span></li>
                                        <li>Tap <span style="color: #fbbf24; font-weight: 700;">"Add to Home screen"</span> or <span style="color: #fbbf24; font-weight: 700;">"Install app"</span></li>
                                        <li>Tap <span style="color: #fbbf24; font-weight: 700;">"Add"</span> or <span style="color: #fbbf24; font-weight: 700;">"Install"</span></li>
                                    </ol>
                                </div>
                            ` : `
                                <div style="background: rgba(139,92,246,0.2); border-radius: 16px; padding: 20px; text-align: left; margin-bottom: 20px; border: 1px solid rgba(139,92,246,0.3);">
                                    <div style="color: #fbbf24; font-weight: 700; margin-bottom: 10px; font-size: 14px;">BROWSER INSTRUCTIONS:</div>
                                    <p style="color: #e9d5ff; font-size: 15px; line-height: 1.8;">
                                        Look for the <span style="color: #fbbf24; font-weight: 700;">install button</span> in your browser's address bar or menu, then follow the prompts to install.
                                    </p>
                                </div>
                            `}
                            
                            <button onclick="this.closest('div[style*=fixed]').remove()" style="
                                background: linear-gradient(90deg, #fbbf24, #f59e0b);
                                color: #1a0033;
                                border: none;
                                border-radius: 25px;
                                padding: 15px 40px;
                                font-size: 18px;
                                font-weight: 700;
                                cursor: pointer;
                                box-shadow: 0 4px 20px rgba(251,191,36,0.4);
                            ">Got it!</button>
                        </div>
                    `;
                    
                    document.body.appendChild(modal);
                    modal.addEventListener('click', (e) => {
                        if (e.target === modal) modal.remove();
                    });
                }
                document.addEventListener('DOMContentLoaded', function() {
                    updatePWAText();
                    try {
                        if (localStorage.getItem('hideAddToHome') === 'true') {
                            document.getElementById('addToHome').style.display = 'none';
                        } else {
                            document.getElementById('addToHome').style.display = 'block';
                        }
                    } catch(e) {
                        document.getElementById('addToHome').style.display = 'block';
                    }
                });
        // Modal flow functions for first-time users - with Safari/WebKit compatibility
        window.showFrequencyBenefits = function() {
            // Remove Safari early-init style
            var safariStyle = document.getElementById('safari-welcome-fix');
            if (safariStyle) safariStyle.remove();
            
            const welcome = document.getElementById('immersiveWelcome');
            const benefits = document.getElementById('frequencyBenefitsModal');
            welcome.classList.remove('active');
            welcome.style.display = 'none';
            welcome.style.visibility = 'hidden';
            benefits.classList.add('active');
            benefits.style.display = 'flex';
            benefits.style.visibility = 'visible';
            benefits.style.opacity = '1';
        };

        window.showHowToUse = function() {
            const benefits = document.getElementById('frequencyBenefitsModal');
            const howTo = document.getElementById('howToUseModal');
            benefits.classList.remove('active');
            benefits.style.display = 'none';
            howTo.classList.add('active');
            howTo.style.display = 'flex';
            howTo.style.visibility = 'visible';
            howTo.style.opacity = '1';
        };

        window.showPWATip = function() {
            const howTo = document.getElementById('howToUseModal');
            const pwa = document.getElementById('pwaTipModal');
            howTo.classList.remove('active');
            howTo.style.display = 'none';
            pwa.classList.add('active');
            pwa.style.display = 'flex';
            pwa.style.visibility = 'visible';
            pwa.style.opacity = '1';
        };

        window.showUpgradeBenefits = function() {
            console.log('showUpgradeBenefits() called - adding active class to upgrade modal');
            // Hide any current modal
            const pwa = document.getElementById('pwaTipModal');
            if (pwa) {
                pwa.classList.remove('active');
                pwa.style.display = 'none';
            }
            
            // Mark onboarding as complete (Safari-safe)
            try { localStorage.setItem('onboardingComplete', 'true'); } catch(e) {
                try { sessionStorage.setItem('onboardingComplete', 'true'); } catch(e2) {}
            }
            
            // Show benefits screen (as info-modal)
            const benefits = document.getElementById('upgradeBenefitsModal');
            if (benefits) {
                // ensure no other info-modals are open
                document.querySelectorAll('.info-modal.active').forEach(m => {
                    m.classList.remove('active');
                    m.style.display = 'none';
                });
                benefits.classList.add('active');
                benefits.style.display = 'flex';
                benefits.style.visibility = 'visible';
                benefits.style.opacity = '1';
            }
        };

        window.skipToApp = function() {
            // Remove Safari early-init style if present
            var safariStyle = document.getElementById('safari-welcome-fix');
            if (safariStyle) safariStyle.remove();
            
            // Hide all modals with explicit display setting for Safari
            const modals = ['immersiveWelcome', 'frequencyBenefitsModal', 'howToUseModal', 'pwaTipModal', 'upgradeBenefitsModal'];
            modals.forEach(id => {
                const modal = document.getElementById(id);
                if (modal) {
                    modal.classList.remove('active');
                    modal.style.display = 'none';
                    modal.style.visibility = 'hidden';
                    modal.style.opacity = '0';
                }
            });
            
            // Restore body scroll
            document.body.style.overflow = '';
            
            // Mark onboarding as complete (Safari-safe)
            try { localStorage.setItem('onboardingComplete', 'true'); } catch(e) {
                try { sessionStorage.setItem('onboardingComplete', 'true'); } catch(e2) {}
            }
        }

        // Close upgrade benefits modal
        function closeUpgradeBenefitsModal() {
            document.getElementById('upgradeBenefitsModal').classList.remove('active');
        }

        // Debug function to force show upgrade modal (call forceShowUpgrade() in console)
        window.forceShowUpgrade = function() {
            const t = translations.en;
            document.getElementById('upgradeBenefitsModal').innerHTML = `
                <div class="info-modal-content" style="max-width:420px; text-align: center;">
                    <div class="info-modal-header" style="color: #fbbf24; font-size: 28px; margin-bottom: 20px;">${t.premiumFeatures || 'Premium Features Include:'}</div>
                    <div class="info-modal-body" style="color: #fff; font-size: 16px; line-height: 1.6;">
                        <div style="text-align: left; margin-bottom: 20px;">
                            <div style="margin-bottom: 15px;">
                                <h3 style="color: #c4b5fd; margin-bottom: 8px;">� ${t.volumeControls || 'Individual Volume Controls'}</h3>
                                <p>${t.volumeControlsDesc || 'Adjust each of the 3 frequencies separately for perfect harmonic balance.'}</p>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <h3 style="color: #c4b5fd; margin-bottom: 8px;">⏱️ ${t.customDurations || 'Custom Durations'}</h3>
                                <p>${t.customDurationsDesc || 'Set any session length from 1 minute to hours of continuous playback.'}</p>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <h3 style="color: #c4b5fd; margin-bottom: 8px;">🏆 ${t.achievementSystem || 'Achievement System'}</h3>
                                <p>${t.achievementSystemDesc || 'Track your progress, unlock achievements, and log your sacred sessions.'}</p>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <h3 style="color: #c4b5fd; margin-bottom: 8px;">📱 ${t.freeAppUpgrade || 'Free App Store Upgrade'}</h3>
                                <p>${t.freeAppUpgradeDesc || 'When we launch on App Store, premium users get automatic free upgrade with all features!'}</p>
                            </div>
                            <div style="margin-bottom: 15px;">
                                <h3 style="color: #c4b5fd; margin-bottom: 8px;">💾 ${t.exportSave || 'Export & Save Tracks'}</h3>
                                <p>${t.exportSaveDesc || 'Save your frequency combinations as WAV files for offline use.'}</p>
                            </div>
                        </div>
                        <div style="background: rgba(251,191,36,0.1); padding: 15px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(251,191,36,0.3);">
                            <p style="font-size: 18px; color: #fbbf24; font-weight: 600; margin-bottom: 8px;">✨ ${t.lifetimeAccess || 'Lifetime Access'} - ${t.oneTimePayment || 'One-Time Payment'}</p>
                            <p style="font-size: 14px; color: #d1d5db;">${t.joinThousands || 'Join thousands unlocking the full Genesis experience'}</p>
                        </div>
                        <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                            <button onclick="showUpgradeModal()" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 25px; padding: 15px 30px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(251,191,36,0.3);">${t.upgradeNow || 'Upgrade Now'}</button>
                            <button onclick="closeUpgradeBenefitsModal()" style="background: rgba(26,0,51,0.7); color: #c4b5fd; border: none; border-radius: 25px; padding: 15px 30px; font-size: 16px; font-weight: 600; cursor: pointer;">${t.maybeLater || 'Maybe Later'}</button>
                        </div>
                    </div>
                </div>
            `;
            document.getElementById('upgradeBenefitsModal').classList.add('active');
        };

        // Freemium upgrade functions
        function showUpgradeModal() {
            // Close any active welcome modals first
            document.querySelectorAll('.info-modal.active').forEach(m => m.classList.remove('active'));
            localStorage.setItem('onboardingComplete', 'true');

            // Close any info-modals that could be dimming the screen
            document.querySelectorAll('.info-modal.active').forEach(m => m.classList.remove('active'));

            // Show upgrade modal on top
            const modal = document.getElementById('upgradeModal');
            if (modal) {
                modal.style.display = 'flex';
                modal.style.opacity = '1';
            }
        }

        function closeUpgradeModal() {
            document.getElementById('upgradeModal').style.display = 'none';
            // Update premium features in case user just upgraded
            setTimeout(updatePremiumFeatures, 100);
        }

        // Export Upgrade Modal - $19.99 premium feature
        function showExportUpgradeModal() {
            // Create modal if it doesn't exist
            let modal = document.getElementById('exportUpgradeModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'exportUpgradeModal';
                modal.innerHTML = `
                    <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); display: flex; align-items: center; justify-content: center; z-index: 999999; padding: 15px; overflow-y: auto;">
                        <div style="background: linear-gradient(135deg, #1a0a2e, #2d1b4e); border-radius: 20px; padding: 25px; max-width: 340px; width: 100%; text-align: center; border: 2px solid rgba(251,191,36,0.4); box-shadow: 0 15px 50px rgba(251,191,36,0.3); position: relative; max-height: 90vh; overflow-y: auto;">
                            <button onclick="closeExportUpgradeModal()" style="position: absolute; top: 10px; right: 15px; background: none; border: none; color: #9ca3af; font-size: 24px; cursor: pointer; z-index: 10;">&times;</button>
                            
                            <div style="font-size: 40px; margin-bottom: 10px;">💾</div>
                            <h2 style="color: #fbbf24; font-size: 22px; margin-bottom: 10px; font-weight: 800;">Export to WAV</h2>
                            <p style="color: #e0d4ff; font-size: 14px; line-height: 1.5; margin-bottom: 15px;">
                                Export any frequency as a high-quality WAV file!
                            </p>
                            
                            <div style="background: rgba(251,191,36,0.1); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid rgba(251,191,36,0.3);">
                                <div style="color: #fff; font-size: 32px; font-weight: 900;">$19.99</div>
                                <div style="color: #10b981; font-size: 12px; margin-top: 3px;">One-time • Lifetime access</div>
                            </div>
                            
                            <ul style="text-align: left; color: #fff; font-size: 13px; line-height: 1.8; margin-bottom: 15px; list-style: none; padding-left: 5px;">
                                <li>✅ Unlimited WAV exports</li>
                                <li>✅ High-quality 44.1kHz audio</li>
                                <li>✅ Play offline anywhere</li>
                            </ul>
                            
                            <a href="https://www.etsy.com/listing/YOUR_EXPORT_LISTING" target="_blank" style="display: inline-block; background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #1a0033; padding: 12px 30px; border-radius: 25px; font-size: 16px; font-weight: 800; text-decoration: none; box-shadow: 0 5px 20px rgba(251,191,36,0.4); margin-bottom: 10px;">
                                💾 Get Export Feature
                            </a>
                            
                            <p style="color: #9ca3af; font-size: 11px; margin-top: 10px;">
                                Already purchased? <a href="#" onclick="closeExportUpgradeModal(); showLicenseModal(); return false;" style="color: #a78bfa; text-decoration: underline;">Enter license key</a>
                            </p>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }
            modal.style.display = 'block';
        }
        
        function closeExportUpgradeModal() {
            const modal = document.getElementById('exportUpgradeModal');
            if (modal) modal.style.display = 'none';
        }

        // Function to enable/disable premium features based on access status
        function updatePremiumFeatures() {
            // Check if user has premium (includes old 'ultimate' keys for backward compatibility)
            const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                               localStorage.getItem('gfgn_license_tier') === 'premium' || 
                               localStorage.getItem('gfgn_license_tier') === 'ultimate';
            
            // If premium, unlock all controls
            if (hasPremium) {
                unlockPremiumControls();
            }
        }
        const translations = {
            en: {
                hebrewTranslation: "In the beginning God created the heavens and the earth",
                title: "Genesis 1:1",
                subtitle: "The Sound of Creation",
                pattern: "Prayer Amplifier",
                trinityTitle: "✨ Trinity Foundation Frequencies ✨",
                formMatter: "Form/Matter",
                spiritDivine: "Spirit/Divine",
                beatPattern: "Beat Pattern",
                recipesTitle: "✨ Trinity Frequency Recipes ✨",
                controlsTitle: "✨ Frequency Controls ✨",
                duration: "Duration",
                play: "PLAY",
                pause: "PAUSE",
                stop: "STOP",
                export: "EXPORT WAV",
                reset: "RESET",
                ready: "✨ Ready to Generate Genesis Frequencies ✨",
                stopped: "✨ Stopped - Ready to Generate ✨",
                playing: "🎵 Playing",
                remaining: "remaining",
                selected: "Selected",
                autoBalanced: "Auto-balanced volumes",
                addToHomeText: "✨ ADD to Home Screen NOW for best experience!",
                // Companion Navigation
                genesisCompanion: "Genesis Frequency Companion",
                genesisFrequencyCompanion: "Genesis Frequency Companion",
                returnToTracks: "⬅️ Return to Tracks",
                completeCompanion: "Your complete Genesis companion for divine frequency mastery.",
                // Category names
                catBiblical: "Biblical & Original",
                catSolfeggio: "Solfeggio & Healing",
                catAngel: "Angel Numbers",
                catMaster: "Master Numbers",
                catCosmic: "Cosmic & Planetary",
                catWellness: "Wellness & States",
                catChakra: "Chakra Frequencies",
                // Track names
                trackGenesisCreation: "Genesis Creation",
                trackDivineAbundance: "Divine Abundance",
                track12Apostles: "12 Apostles",
                track7Churches: "7 Churches",
                track40Days: "40 Days",
                track3Days: "3 Days",
                trackSacredHealing: "Sacred Healing",
                trackLoveFrequency: "Love Frequency",
                trackLiberation396: "Liberation (396)",
                trackResolution417: "Resolution (417)",
                trackTransformation639: "Transformation (639)",
                trackAwakening852: "Awakening (852)",
                trackHigherSelf: "Higher Self",
                trackIntuition: "Intuition",
                trackAngelNumbers: "Angel Numbers",
                trackAngel222: "Angel 222",
                trackAngel333: "Angel 333",
                trackAngel444: "Angel 444",
                trackAngel555: "Angel 555",
                trackAngel666: "Angel 666",
                trackAngel777: "Angel 777",
                trackAngel888: "Angel 888",
                trackAngel999: "Angel 999",
                trackMaster1111: "Master 11:11",
                trackMaster22: "Master 22",
                trackMaster33: "Master 33",
                trackMaster44: "Master 44",
                trackMaster55: "Master 55",
                trackEarthResonance: "Earth Resonance",
                trackVenusLove: "Venus Love",
                trackMarsAction: "Mars Action",
                trackFibonacci144: "Fibonacci 144",
                trackPi314: "Pi 314",
                trackGoldenRatio: "Golden Ratio",
                trackPainRelief: "Pain Relief",
                trackStressRelief: "Stress Relief",
                trackSleepDeep: "Sleep Deep",
                trackFocusClear: "Focus Clear",
                trackMemoryBoost: "Memory Boost",
                trackMiracleTone: "Miracle Tone",
                // Chakra track names
                trackRootChakra: "Root Chakra",
                trackSacralChakra: "Sacral Chakra",
                trackSolarPlexusChakra: "Solar Plexus Chakra",
                trackHeartChakra: "Heart Chakra",
                trackThroatChakra: "Throat Chakra",
                trackThirdEyeChakra: "Third Eye Chakra",
                trackCrownChakra: "Crown Chakra",
                // Achievement names and descriptions
                achFirstSession: "🌟 First Session",
                achFirstSessionDesc: "Completed your first frequency session",
                achFiveSessions: "⭐ Five Sessions", 
                achFiveSessionsDesc: "Completed 5 sessions",
                achTenSessions: "🌟 Ten Sessions",
                achTenSessionsDesc: "Completed 10 sessions",
                achTwentyFiveSessions: "⭐ Twenty-Five Sessions",
                achTwentyFiveSessionsDesc: "Completed 25 sessions",
                achFiftySessions: "🏅 Fifty Sessions",
                achFiftySessionsDesc: "Completed 50 sessions",
                achHundredSessions: "🏆 Century Master",
                achHundredSessionsDesc: "Completed 100 sessions",
                achFiveMinutes: "⏰ Five Minutes",
                achFiveMinutesDesc: "Total listening time exceeds 5 minutes",
                achHalfHour: "⏱️ Half Hour",
                achHalfHourDesc: "Total listening time exceeds 30 minutes",
                achHourTotal: "⏰ Hour Master",
                achHourTotalDesc: "Total listening time exceeds 1 hour",
                achFiveHours: "🕓 Five Hours",
                achFiveHoursDesc: "Total listening time exceeds 5 hours",
                achTenHours: "🕛 Ten Hours",
                achTenHoursDesc: "Total listening time exceeds 10 hours",
                achThreeDayStreak: "🔥 Three Day Streak",
                achThreeDayStreakDesc: "Used the app for 3 consecutive days",
                achWeekStreak: "🔥 Week Warrior",
                achWeekStreakDesc: "Used the app for 7 consecutive days",
                achTwoWeekStreak: "🔥 Two Week Champion",
                achTwoWeekStreakDesc: "Used the app for 14 consecutive days",
                achMonthStreak: "🔥 Month Master",
                achMonthStreakDesc: "Used the app for 30 consecutive days",
                achTrinityMaster: "✨ Trinity Master",
                achTrinityMasterDesc: "Used all three Trinity frequencies together",
                achSolfeggioExplorer: "🎶 Solfeggio Explorer",
                achSolfeggioExplorerDesc: "Explored Solfeggio healing frequencies",
                achAngelWhisperer: "👼 Angel Whisperer",
                achAngelWhispererDesc: "Connected with Angel Number frequencies",
                achCosmicTraveler: "🌌 Cosmic Traveler",
                achCosmicTravelerDesc: "Journeyed through Cosmic & Planetary frequencies",
                achWavExporter: "⬇ Export Master",
                achWavExporterDesc: "Unlocked the Export to WAV feature",
                achNoteTaker: "📝 Journal Keeper",
                achNoteTakerDesc: "Added your first personal note",
                achPwaUser: "🏠 Home Screen Hero",
                achPwaUserDesc: "Added app to home screen",
                achMultilingual: "🌍 World Explorer",
                achMultilingualDesc: "Changed language settings",
                achFrequencyScholar: "🎓 Frequency Scholar",
                achFrequencyScholarDesc: "Explored all frequency categories",
                achDedicatedSeeker: "✨ Dedicated Seeker",
                achDedicatedSeekerDesc: "100 sessions and 10 hours of listening",
                achGenesisMaster: "🎯 Genesis Master",
                achGenesisMasterDesc: "Unlocked all achievements",
                // Achievement names and descriptions (second language block)
                achFirstSession: "🌟 First Session",
                achFirstSessionDesc: "Completed your first frequency session",
                achFiveSessions: "⭐ Five Sessions", 
                achFiveSessionsDesc: "Completed 5 sessions",
                achTenSessions: "🌟 Ten Sessions",
                achTenSessionsDesc: "Completed 10 sessions",
                achTwentyFiveSessions: "⭐ Twenty-Five Sessions",
                achTwentyFiveSessionsDesc: "Completed 25 sessions",
                achFiftySessions: "🏅 Fifty Sessions",
                achFiftySessionsDesc: "Completed 50 sessions",
                achHundredSessions: "🏆 Century Master",
                achHundredSessionsDesc: "Completed 100 sessions",
                achFiveMinutes: "⏰ Five Minutes",
                achFiveMinutesDesc: "Total listening time exceeds 5 minutes",
                achHalfHour: "⏱️ Half Hour",
                achHalfHourDesc: "Total listening time exceeds 30 minutes",
                achHourTotal: "⏰ Hour Master",
                achHourTotalDesc: "Total listening time exceeds 1 hour",
                achFiveHours: "🕓 Five Hours",
                achFiveHoursDesc: "Total listening time exceeds 5 hours",
                achTenHours: "🕛 Ten Hours",
                achTenHoursDesc: "Total listening time exceeds 10 hours",
                achThreeDayStreak: "🔥 Three Day Streak",
                achThreeDayStreakDesc: "Used the app for 3 consecutive days",
                achWeekStreak: "🔥 Week Warrior",
                achWeekStreakDesc: "Used the app for 7 consecutive days",
                achTwoWeekStreak: "🔥 Two Week Champion",
                achTwoWeekStreakDesc: "Used the app for 14 consecutive days",
                achMonthStreak: "🔥 Month Master",
                achMonthStreakDesc: "Used the app for 30 consecutive days",
                achTrinityMaster: "✨ Trinity Master",
                achTrinityMasterDesc: "Used all three Trinity frequencies together",
                achSolfeggioExplorer: "🎶 Solfeggio Explorer",
                achSolfeggioExplorerDesc: "Explored Solfeggio healing frequencies",
                achAngelWhisperer: "👼 Angel Whisperer",
                achAngelWhispererDesc: "Connected with Angel Number frequencies",
                achCosmicTraveler: "🌌 Cosmic Traveler",
                achCosmicTravelerDesc: "Journeyed through Cosmic & Planetary frequencies",
                achWavExporter: "⬇ Export Master",
                achWavExporterDesc: "Unlocked the Export to WAV feature",
                achNoteTaker: "📝 Journal Keeper",
                achNoteTakerDesc: "Added your first personal note",
                achPwaUser: "🏠 Home Screen Hero",
                achPwaUserDesc: "Added app to home screen",
                achMultilingual: "🌍 World Explorer",
                achMultilingualDesc: "Changed language settings",
                achFrequencyScholar: "🎓 Frequency Scholar",
                achFrequencyScholarDesc: "Explored all frequency categories",
                achDedicatedSeeker: "✨ Dedicated Seeker",
                achDedicatedSeekerDesc: "100 sessions and 10 hours of listening",
                achGenesisMaster: "🎯 Genesis Master",
                achGenesisMasterDesc: "Unlocked all achievements",
                // Achievement categories
                catSessions: "Sessions",
                catTime: "Time",
                catStreaks: "Streaks", 
                catFrequencies: "Frequencies",
                catCategories: "Categories",
                catActions: "Actions",
                catMastery: "Mastery",
                // UI - Companion & Quick Stats
                greetingMorning: "Good Morning",
                greetingAfternoon: "Good Afternoon",
                greetingEvening: "Good Evening",
                statSessions: "Sessions",
                statMinutes: "Minutes",
                statFrequencies: "Frequencies",
                // Quick Actions
                btnStartSession: "Start Session",
                btnDailyChallenge: "Daily Challenge",
                todaysSacredChallenge: "Today's Sacred Challenge",
                btnAchievements: "Achievements",
                yourSpiritualJourney: "Your Spiritual Journey",
                viewAllAchievements: "View All Achievements",
                // Upgrade/Premium
                discoverPremium: "Discover Premium",
                skipToApp: "Skip to App",
                unlockComplete: "Unlock the Complete Experience",
                readyGoDeeper: "Ready to go deeper? Premium gives you full control.",
                volumeControls: "Individual Volume Controls",
                volumeControlsDesc: "Adjust each of the 3 frequencies separately for perfect harmonic balance tailored to your needs.",
                unlimitedDurations: "Unlimited Durations",
                unlimitedDurationsDesc: "Set any session length from 1 minute to hours of continuous playback—perfect for sleep, work, or deep meditation.",
                trackJourney: "Track Your Journey",
                trackJourneyDesc: "Session streaks, achievements, personal notes, and progress tracking. Watch your transformation unfold.",
                freeAppUpgrade: "Free App Store Upgrade",
                freeAppUpgradeDesc: "When we launch on App Store, premium users get automatic free upgrade with all features!",
                fullScreenMode: "Full screen mode",
                noBrowserBars: "No browser bars",
                exportSave: "Export & Save Tracks",
                exportSaveDesc: "Save your favorite frequency combinations as WAV files for offline listening or sharing with loved ones.",
                lifetimeAccess: "Lifetime Access",
                oneTimePayment: "One-Time Payment • No Subscriptions",
                joinThousands: "Join thousands unlocking the full Genesis experience",
                tryFreeFirst: "Try the free version first. Upgrade anytime from the Settings menu.",
                upgradeToPremium: "Upgrade to Premium",
                unlockFullPower: "Unlock the full power of sacred frequencies with lifetime access!",
                premiumFeatures: "Premium Features Include:",
                customDurations: "Custom Durations",
                customDurationsDesc: "Set any length from seconds to hours",
                wavExport: "WAV Export",
                wavExportDesc: "Save tracks to share with others",
                allAchievements: "All Achievements",
                allAchievementsDesc: "Unlock the complete achievement system",
                unlimitedListening: "Unlimited Listening",
                unlimitedListeningDesc: "No time restrictions on your sessions",
                premiumSupport: "Premium Support",
                premiumSupportDesc: "Direct access to updates and new features",
                getLifetimeAccess: "Get Lifetime Access",
                questionsContact: "Questions? Contact us through Etsy",
                // Premium Modal Extras
                upgradeNow: "Upgrade Now",
                maybeLater: "Maybe Later",
                noDataCollected: "✨ One-time payment • Lifetime access • No subscriptions • No data collected",
                readyToUnlock: "✨ Ready to Unlock Premium Features?",
                premiumCtaDesc: "Get lifetime access to individual volume controls, custom durations, WAV export (play on free VLC Player!), achievement system, plus free upgrade when we launch on App Store!",
                achievementSystem: "Achievement System",
                achievementSystemDesc: "Track your progress, unlock achievements, and log your sacred sessions.",
                // Daily Challenge
                dailyChallengeComplete: "Daily Challenge Complete!",
                continueJourney: "Continue Your Journey",
                // Companion Header - Achievement Titles
                titleSacredListener: "Sacred Listener",
                titleSacredInitiate: "Sacred Initiate",
                titleFrequencyExplorer: "Frequency Explorer",
                titleTrinitySeeker: "Trinity Seeker",
                titleDivineResonator: "Divine Resonator",
                titleSacredHarmonist: "Sacred Harmonist",
                titleFrequencySage: "Frequency Sage",
                titleGenesisMaster: "Genesis Master",
                dayStreak: "day streak",
                beginJourney: "Begin your sacred journey today",
                welcomeBack: "Welcome back! Ready to explore sacred frequencies?",
                // Welcome Flow
                welcomeTitle: "Welcome to Genesis Frequencies",
                frequenciesInHands: "The frequencies of creation are now in your hands.",
                inTheBeginning: "In the beginning God created...",
                hiddenInScripture: "These frequencies are encoded in the first verse of the Bible. Hidden in Scripture for thousands of years.",
                takeBreath: "Take a deep breath. Set your intention.",
                journeyBegins: "Your journey begins now.",
                beginBtn: "Begin",
                // Frequency Benefits
                whatCanFrequenciesDo: "What Can These Frequencies Do?",
                trinityFoundation: "Built on the Trinity Foundation: 37 Hz + 73 Hz + one intention frequency",
                meditationPrayer: "Meditation & Prayer",
                meditationPrayerDesc: "Deepen your spiritual practice with frequencies designed to quiet the mind and enhance focus.",
                energyWork: "Energy Work & Balance",
                energyWorkDesc: "Support your energy centers and restore natural harmony using biblical mathematics.",
                restRenewal: "Rest & Renewal",
                restRenewalDesc: "Promote deep relaxation and improve sleep quality. Feel more peaceful after sessions.",
                creativeFlow: "Creative Flow & Clarity",
                creativeFlowDesc: "Unlock inspiration, enhance focus, and access flow states for work and creativity.",
                forSpiritualExploration: "For relaxation and spiritual exploration — Not a substitute for medical advice",
                howToUseBtn: "How to Use",
                // How To Use
                firstSessionSteps: "Your First Session in 3 Steps",
                quickStart: "Quick Start",
                chooseGenesis: "Choose \"Genesis Creation\" from Biblical & Original",
                pureFoundation: "The pure 37 + 73 Hz foundation",
                setDuration: "Put on headphones for quantum immersion (or use a quality speaker)",
                startShort: "Set 5-10 minutes to start—go longer once you feel the frequencies",
                pressPlay: "Press PLAY, close your eyes, breathe slowly",
                setIntention: "Set one intention: \"peace,\" \"clarity,\" or \"thank you\"",
                controlsYouUse: "Controls You'll Use",
                categoriesLabel: "Categories:",
                categoriesDesc: "Biblical, Angel Numbers, Solfeggio, etc.",
                volumeLabel: "Volume:",
                volumeDesc: "Start low and adjust",
                durationLabel: "Duration:",
                durationDesc: "Set your session timer",
                proTips: "Pro Tips",
                tipMeditation: "Use during meditation, prayer, or yoga",
                tipWater: "Drink water before and after",
                tipJournal: "Journal after each session",
                proTipBtn: "Pro Tip",
                // PWA Tip
                addToHomeScreen: "Add to Home Screen",
                getFullExperience: "Get the Full Experience",
                worksOffline: "Works offline",
                listenAnytime: "Listen anytime",
                fasterLoading: "Faster loading",
                oneTapAccess: "One tap access",
                whileYouWork: "While you work",
                streaksAchievements: "Streaks & achievements",
                howToInstall: "How to install:",
                tapShare: "Tap Share (iOS) or Menu ⋮ (Android)",
                selectAddHome: "Select \"Add to Home Screen\"",
                doThisLater: "You can always do this later from the menu!",
                continueBtn: "Continue",
                skipBtn: "Skip",
                // Upgrade Benefits
                unlockPremium: "Unlock Premium",
                getPremiumNow: "Get Premium Now",
                tryFreeVersionFirst: "Try Free Version First",
                upgradeFromSettings: "Upgrade anytime from the Settings menu",
                joinGenesisJourney: "Join thousands on the Genesis journey",
                adjustEachFrequency: "Adjust each frequency separately for perfect balance.",
                anySessionLength: "Any session length—perfect for sleep or deep meditation.",
                keepPlayingExport: "Keep playing while you work. Save as WAV files.",
                // Companion Panel Categories
                catQuickStart: "🚀 Quick Start",
                catTheScience: "🔬 The Science",
                catTheStory: "📖 The Story",
                catHelp: "❓ Help",
                // Companion Panel Section Titles
                sectionWelcome: "About Genesis Frequencies",
                sectionQuickStart: "Your First Session",
                sectionMyJourney: "The Discovery",
                sectionWhyWorks: "Why 37 & 73 Hz Work",
                sectionCategories: "Frequency Categories",
                sectionTrinity: "The Trinity Foundation",
                sectionWaterCharging: "Water Charging",
                sectionUsageTips: "Best Practices",
                sectionFaq: "FAQ",
                sectionShare: "Share",
                sectionCredits: "Credits",
                // Info Modal Headers
                infoWhatItIs: "What It Is",
                infoBenefits: "Benefits",
                infoHowToUse: "How To Use",
                // Recipe fullInfo translations - Chakra Frequencies
                recipeRootChakraWhat: "396 Hz is the Solfeggio frequency for liberating guilt and fear, working on the root chakra for grounding and stability.",
                recipeRootChakraBenefits: "Promotes grounding, releases fear, and enhances feelings of safety and security.",
                recipeRootChakraHow: "Listen for 10-15 minutes during meditation or when you need grounding. Visualize roots connecting you to the earth.",
                recipeSacralChakraWhat: "417 Hz facilitates change and helps undo negative situations, working on the sacral chakra for creativity and emotional healing.",
                recipeSacralChakraBenefits: "Enhances creativity, emotional balance, and pleasure in life.",
                recipeSacralChakraHow: "Use for 10-15 minutes to boost creativity or emotional healing. Focus on the lower abdomen.",
                recipeSolarPlexusWhat: "528 Hz is the frequency of transformation and personal empowerment, working on the solar plexus for personal power and confidence.",
                recipeSolarPlexusBenefits: "Boosts confidence, personal power, and supports transformation.",
                recipeSolarPlexusHow: "Listen for 10-15 minutes to empower yourself before important tasks. Focus on the upper abdomen.",
                recipeHeartChakraWhat: "639 Hz promotes connection and love, working on the heart chakra for emotional healing and relationships.",
                recipeHeartChakraBenefits: "Opens the heart, enhances compassion, and supports relationship harmony.",
                recipeHeartChakraHow: "Use for 10-15 minutes to open your heart or heal relationships. Place hands on your heart while listening.",
                recipeThroatChakraWhat: "741 Hz cleanses the body and opens the throat chakra for clear communication and self-expression.",
                recipeThroatChakraBenefits: "Improves communication, self-expression, and clarity.",
                recipeThroatChakraHow: "Listen for 10-15 minutes before important conversations or creative work. Focus on the throat area.",
                recipeThirdEyeChakraWhat: "852 Hz awakens intuition and spiritual order, working on the third eye for insight and awareness.",
                recipeThirdEyeChakraBenefits: "Enhances intuition, insight, and spiritual perception.",
                recipeThirdEyeChakraHow: "Use for 10-15 minutes during meditation or when seeking insight. Focus on the forehead between the eyes.",
                recipeCrownChakraWhat: "963 Hz is the frequency of divine consciousness, working on the crown chakra for spiritual connection and enlightenment.",
                recipeCrownChakraBenefits: "Promotes spiritual connection, unity, and enlightenment.",
                recipeCrownChakraHow: "Listen for 10-15 minutes during deep meditation or spiritual practice. Focus on the top of the head.",
                // Recipe fullInfo translations - Biblical & Original
                recipeGenesisCreationWhat: "The Genesis Creation frequency combines the foundational 37 Hz (representing form and matter) with 73 Hz (representing spirit and the divine). These numbers are derived from the gematria value of Genesis 1:1 in Hebrew, encoding the very pattern of creation itself.",
                recipeGenesisCreationBenefits: "This combination aligns you with the original creative force of the universe. It helps manifest intentions, brings clarity to new beginnings, and connects you to the divine blueprint of creation. Perfect for prayer amplification and spiritual manifestation work.",
                recipeGenesisCreationHow: "Listen for 5-10 minutes during morning meditation or prayer. Visualize your intentions being woven into the fabric of creation. Ideal for new moon rituals or when starting new projects.",
                recipeDivineAbundanceWhat: "Divine Abundance adds 888 Hz to the Trinity foundation. In biblical numerology, 8 represents new beginnings and resurrection, while 888 is the gematria value of Jesus in Greek, representing divine abundance and eternal provision.",
                recipeDivineAbundanceBenefits: "Opens channels for divine prosperity and abundance in all areas of life. Helps release scarcity consciousness and aligns you with infinite supply. Particularly powerful for financial breakthroughs and recognizing opportunities.",
                recipeDivineAbundanceHow: "Listen for 15-20 minutes while focusing on gratitude for what you have and openness to receive. Best used during full moon or Thursday (Jupiter's day). Journal your abundance wins afterward.",
                recipe12ApostlesWhat: "The number 12 represents divine government, leadership, and spiritual authority. This frequency combination invokes the power of the 12 apostles and the 12 tribes of Israel, symbolizing complete divine order.",
                recipe12ApostlesBenefits: "Strengthens leadership abilities, provides spiritual authority in challenging situations, and helps you stand firm in your convictions. Excellent for those in ministry, teaching, or positions of spiritual guidance.",
                recipe12ApostlesHow: "Use for 10-15 minutes before important decisions or leadership responsibilities. Pray for wisdom and discernment. Ideal for Sunday listening or before leading groups.",
                recipe7ChurchesWhat: "Seven is the number of spiritual perfection and completion in Scripture. This frequency references the 7 churches in Revelation, representing the complete body of believers and spiritual wholeness.",
                recipe7ChurchesBenefits: "Brings a sense of completion to spiritual cycles, promotes wholeness and integration, and helps you recognize divine perfection in your journey. Useful for ending chapters and spiritual transitions.",
                recipe7ChurchesHow: "Listen for 7 minutes during transitions or when seeking closure. Perfect for Saturday (Sabbath preparation) or when completing spiritual milestones. Reflect on your spiritual growth.",
                recipe40DaysWhat: "Forty represents testing, trial, and transformation in Scripture—Jesus' 40 days in the wilderness, Noah's 40 days of rain, Israel's 40 years in the desert. This frequency supports you through transformative periods.",
                recipe40DaysBenefits: "Provides strength during trials, supports spiritual endurance, and helps you emerge transformed from difficult seasons. Accelerates spiritual maturity and deepens faith through challenges.",
                recipe40DaysHow: "Use daily for 10-20 minutes during challenging periods or 40-day spiritual commitments. Journal insights and spiritual lessons. Combine with fasting or intensive prayer practices.",
                recipe3DaysWhat: "Three days represents resurrection power—the time between Christ's death and resurrection. This frequency carries the energy of divine completion and the power to resurrect dead situations.",
                recipe3DaysBenefits: "Brings new life to stagnant areas, restores hope in seemingly impossible situations, and activates resurrection power in your circumstances. Perfect for breakthrough moments.",
                recipe3DaysHow: "Listen for 3 minutes three times daily during 3-day prayer intensives. Speak life over dead situations. Particularly powerful Friday through Sunday or during personal 3-day fasts.",
                // Recipe fullInfo translations - Solfeggio & Healing
                recipeSacredHealingWhat: "432 Hz is known as the 'natural frequency of the universe,' associated with harmony and balance in nature. Combined with the Trinity foundation, this creates a deeply relaxing meditation environment.",
                recipeSacredHealingBenefits: "Supports relaxation, may help reduce stress, promotes a sense of harmony with natural rhythms, and encourages inner peace. Useful for emotional processing and unwinding.",
                recipeSacredHealingHow: "Listen for 20-30 minutes during relaxation sessions, before sleep, or when seeking calm. Breathe deeply and allow yourself to fully relax. Can be used during meditation or yoga.",
                recipeLoveFrequencyWhat: "528 Hz is called the 'Love Frequency' or 'Miracle Tone,' traditionally associated with transformation and harmony. Combined with the Trinity foundation, it creates a heart-opening meditation experience.",
                recipeLoveFrequencyBenefits: "Opens the heart chakra, increases feelings of love and compassion, supports emotional balance, and facilitates a sense of peace and well-being. May help release emotional blocks.",
                recipeLoveFrequencyHow: "Use for 15-20 minutes daily for heart-centered meditation. Place hands on heart while listening. Excellent for morning rituals or before important heart-centered conversations.",
                recipeLiberation396What: "396 Hz is the Solfeggio frequency for liberating guilt and fear. It works on the root chakra, helping to release deep-seated negative emotions and trauma from the subconscious.",
                recipeLiberation396Benefits: "Releases fear, guilt, and trauma stored in the body. Helps break free from limiting beliefs and past conditioning. Creates safety and security at the foundational level of being.",
                recipeLiberation396How: "Listen for 10-15 minutes while identifying fears or guilt to release. Breathe into areas of tension. Best used in evening or during shadow work. Journal afterward to process released emotions.",
                recipeResolution417What: "417 Hz facilitates change and helps undo negative situations. It cleanses traumatic experiences and clears destructive influences from past events, working on the sacral chakra.",
                recipeResolution417Benefits: "Clears negative energy and influences, facilitates positive change, removes energetic blockages, and helps break negative patterns. Excellent for clearing spaces and resetting energy.",
                recipeResolution417How: "Use for 15 minutes when feeling energetically heavy or stuck. Move your body gently while listening. Great for space clearing or after difficult interactions. Visualize light dissolving darkness.",
                recipeTransformation639What: "639 Hz promotes connection, love, and understanding in relationships. It works on the heart chakra, facilitating communication and emotional balance in all types of relationships.",
                recipeTransformation639Benefits: "Heals relationship conflicts, improves communication, promotes empathy and understanding, strengthens bonds with others, and helps forgive and release resentment.",
                recipeTransformation639How: "Listen for 20 minutes before difficult conversations or relationship healing work. Can be used with partner present. Excellent for family gatherings or when healing from relationship trauma.",
                recipeAwakening852What: "852 Hz awakens intuition and returns you to spiritual order. It works on the third eye chakra, cutting through illusions and revealing truth, helping you see the divine order in all things.",
                recipeAwakening852Benefits: "Awakens intuition and inner vision, reveals truth, strengthens spiritual perception, aligns you with divine order, and helps discern genuine spiritual guidance.",
                recipeAwakening852How: "Use for 15-20 minutes during meditation or before making important decisions. Focus on third eye area. Best used in morning or during new spiritual practices. Keep a vision journal.",
                recipeHigherSelfWhat: "963 Hz is the frequency of divine consciousness and pineal gland activation. It represents the return to oneness and connection with the higher self and divine source.",
                recipeHigherSelfBenefits: "Activates pineal gland, connects you with higher consciousness, facilitates spiritual awakening, promotes unity consciousness, and opens channels for divine downloads and revelation.",
                recipeHigherSelfHow: "Listen for 10-15 minutes during deep meditation or spiritual contemplation. Best used in darkness or with closed eyes. Ideal for crown chakra work or receiving spiritual insights.",
                recipeIntuitionWhat: "741 Hz cleanses the body of toxins and electromagnetic radiation while opening the third eye. It promotes expression, solution-finding, and intuitive perception.",
                recipeIntuitionBenefits: "Strengthens intuition, cleanses electromagnetic pollution, promotes detoxification, enhances problem-solving abilities, and helps express truth clearly.",
                recipeIntuitionHow: "Use for 15 minutes daily to develop intuition. Excellent after screen time or in urban environments. Ask questions and trust the answers that arise. Keep an intuition journal.",
                // Recipe fullInfo translations - Angel Numbers
                recipeAngel111What: "111 is a powerful angel number representing new beginnings, manifestation, and spiritual awakening. Mathematically, 111 = 37 × 3, creating a divine alignment with the Trinity foundation.",
                recipeAngel111Benefits: "Opens communication with angels and spirit guides, signals new beginnings, accelerates manifestation of thoughts into reality, and heightens spiritual awareness and synchronicities.",
                recipeAngel111How: "Listen for 11 minutes when you notice 11:11 on the clock. Focus on your intentions and desires. Perfect for manifesting work or when seeking angelic guidance. Pay attention to signs afterward.",
                recipeAngel222What: "222 represents balance, harmony, and divine partnerships. The mathematical relationship to 37 (222 = 37×6) creates perfect harmony with the creation frequency.",
                recipeAngel222Benefits: "Brings balance to relationships, attracts divine partnerships and soul connections, promotes cooperation and harmony, and signals that your prayers are being answered.",
                recipeAngel222How: "Use for 15-20 minutes during relationship work or when seeking partnership. Visualize balanced relationships. Great for attracting business partners or romantic connections.",
                recipeAngel333What: "333 signals the presence of ascended masters and divine support. The 9 in the equation (333 = 37×9) represents spiritual completion and enlightenment.",
                recipeAngel333Benefits: "Connects you with ascended masters, confirms you're on the right path, provides divine protection and guidance, and accelerates spiritual growth and awakening.",
                recipeAngel333How: "Listen for 15 minutes when seeking guidance from higher realms. Call upon specific ascended masters. Best used during spiritual study or when facing spiritual questions.",
                recipeAngel444What: "444 is the frequency of divine protection and angels surrounding you. The connection to 12 (444 = 37×12) represents complete divine government and angelic order.",
                recipeAngel444Benefits: "Provides strong angelic protection, signals divine support, brings stability and foundation, and reassures you that you're exactly where you need to be.",
                recipeAngel444How: "Use for 15 minutes when feeling unsafe or uncertain. Visualize angels surrounding you with light. Excellent before travel or entering challenging situations.",
                recipeAngel555What: "555 signals major life changes and transformations ahead. The relationship to 15 (555 = 37×15) represents the transition through divine grace and mercy.",
                recipeAngel555Benefits: "Prepares you for positive change, releases resistance to necessary transitions, brings courage during transformation, and aligns you with divine timing.",
                recipeAngel555How: "Listen for 15-20 minutes during periods of change or when feeling resistant to transformation. Breathe through fear. Best during life transitions or when sensing something shifting.",
                recipeAngel666What: "Despite cultural misconceptions, 666 is about restoring balance between material and spiritual realms. The connection to 18 (666 = 37×18) represents life and chai (living).",
                recipeAngel666Benefits: "Restores balance between physical and spiritual life, helps release materialism, brings grounding to spiritual work, and reminds you to care for your physical needs.",
                recipeAngel666How: "Use for 15 minutes when feeling ungrounded or too focused on material concerns. Balance spiritual practice with practical action. Great for grounding after intense spiritual work.",
                recipeAngel777What: "777 represents spiritual perfection and divine luck. The triple 7 multiplied through the creation frequency creates powerful spiritual momentum and favorable outcomes.",
                recipeAngel777Benefits: "Attracts spiritual blessings and 'lucky' opportunities, signals divine approval, opens doors to spiritual advancement, and brings confirmation of spiritual gifts.",
                recipeAngel777How: "Listen for 20 minutes before important opportunities or when seeking divine favor. Expect miraculous outcomes. Perfect before interviews, launches, or new ventures.",
                recipeAngel888What: "888 represents infinite abundance and the completed work of Jesus (gematria value in Greek). The 24 (888 = 37×24) represents complete divine order in time and space.",
                recipeAngel888Benefits: "Opens infinite abundance channels, represents financial breakthrough, symbolizes eternal provision, and aligns you with the completed work of Christ for prosperity.",
                recipeAngel888How: "Use for 20-30 minutes during prosperity work or full moon abundance rituals. Visualize infinite supply. Speak declarations of abundance. Excellent for business success.",
                recipeAngel999What: "999 signals completion of a major life cycle and preparation for a new chapter. The 27 (999 = 37×27) represents triple completion (3×3×3), a powerful ending.",
                recipeAngel999Benefits: "Helps release what's complete, provides closure to cycles, prepares you for new beginnings, and honors endings as sacred transitions.",
                recipeAngel999How: "Listen for 20 minutes during endings—jobs, relationships, or life phases. Honor what was and welcome what's coming. Perfect for waning moon or year-end reflection.",
                // Recipe fullInfo translations - Master Numbers
                recipeMaster11What: "11 is the master number of spiritual awakening and enlightenment. 11:11 is a spiritual portal and wake-up call from the universe, representing heightened spiritual awareness.",
                recipeMaster11Benefits: "Activates spiritual portals, accelerates awakening, heightens intuition, signals alignment with life purpose, and creates powerful manifestation opportunities.",
                recipeMaster11How: "Listen for 11 minutes at 11:11 AM or PM. Set clear intentions during portal times (11/11, solstices, equinoxes). Keep a synchronicity journal.",
                recipeMaster22What: "22 is the Master Builder number, representing the ability to turn dreams into reality through practical application of spiritual wisdom. It bridges heaven and earth.",
                recipeMaster22Benefits: "Empowers building dreams into reality, provides practical spiritual wisdom, supports large-scale projects, and helps manifest divine blueprints on earth.",
                recipeMaster22How: "Use for 22 minutes while planning major projects or businesses. Excellent for entrepreneurs and visionaries. Best during waxing moon or when beginning construction of dreams.",
                recipeMaster33What: "33 is the Master Teacher, representing Christ consciousness and compassionate service. It combines the intuition of 11 with the building power of 22, adding selfless service.",
                recipeMaster33Benefits: "Activates Christ consciousness, enhances teaching abilities, promotes compassionate service, heals through love, and elevates consciousness to master level.",
                recipeMaster33How: "Listen for 30 minutes before teaching, healing work, or acts of service. Excellent for those in helping professions. Meditate on unconditional love while listening.",
                recipeMaster44What: "44 is the Master Healer and builder of solid spiritual foundations. It represents the power to create stable structures in both physical and spiritual realms.",
                recipeMaster44Benefits: "Builds unshakeable spiritual foundation, provides discipline for spiritual practice, manifests stable abundance, and grounds higher consciousness into daily life.",
                recipeMaster44How: "Use for 20 minutes when establishing new spiritual practices or routines. Perfect for creating sacred space or starting spiritual businesses. Supports long-term goals.",
                recipeMaster55What: "55 is the number of major life changes and personal freedom. It represents breaking free from limitations and embracing transformation with grace and excitement.",
                recipeMaster55Benefits: "Accelerates positive change, breaks limiting patterns, promotes personal freedom, supports bold moves, and helps embrace uncertainty with faith.",
                recipeMaster55How: "Listen for 15 minutes when contemplating major changes or feeling stuck. Use during eclipses or mercury retrograde endings. Dance or move while listening to embody change.",
                // Recipe fullInfo translations - Cosmic & Planetary
                recipeEarthResonanceWhat: "7.83 Hz is Earth's Schumann Resonance—the electromagnetic frequency of our planet's heartbeat. Combined with Trinity frequencies, this grounds you deeply into Earth's natural rhythm.",
                recipeEarthResonanceBenefits: "Deeply grounds and centers you, may help reduce stress, syncs you with Earth's natural rhythms, enhances meditation depth, and supports overall well-being through grounding.",
                recipeEarthResonanceHow: "Listen for 20-30 minutes when feeling ungrounded or spacey. Sit or lie directly on the earth if possible. Perfect after air travel or intense spiritual work. Barefoot recommended.",
                recipeVenusLoveWhat: "221.23 Hz is the orbital frequency of Venus, the planet of love, beauty, and harmony. This frequency carries the essence of divine feminine energy and attraction.",
                recipeVenusLoveBenefits: "Attracts love and beauty, enhances creativity and artistic expression, promotes self-love and worthiness, harmonizes relationships, and activates divine feminine energy.",
                recipeVenusLoveHow: "Use for 20 minutes during Venus hours (Friday morning) or when working with love and attraction. Excellent for self-care rituals, beauty treatments, or romantic intentions.",
                recipeMarsActionWhat: "144.72 Hz is Mars' orbital frequency, carrying the warrior energy of action, courage, and manifestation power. Combined with Trinity, it provides spiritual strength and drive.",
                recipeMarsActionBenefits: "Boosts courage and confidence, activates manifestation power, provides energy for action, helps overcome obstacles, and strengthens willpower and determination.",
                recipeMarsActionHow: "Listen for 15 minutes before important actions, competitions, or when needing courage. Best on Tuesday (Mars day) or when starting new ventures. Combine with physical exercise.",
                recipeFibonacci144What: "144 is a Fibonacci number representing sacred geometry and divine mathematical order. It appears throughout nature and Scripture (144,000 sealed ones in Revelation).",
                recipeFibonacci144Benefits: "Aligns you with natural divine order, activates sacred geometry in your energy field, promotes mathematical perfection in manifestation, and connects you to universal patterns.",
                recipeFibonacci144How: "Use for 20 minutes during manifestation work or when seeking divine order in chaos. Visualize geometric patterns. Excellent for artists, designers, and mathematicians.",
                recipePi314What: "314 Hz represents Pi (3.14), the universal mathematical constant that appears throughout creation. This frequency aligns you with the mathematical perfection of the universe.",
                recipePi314Benefits: "Connects you to universal intelligence, enhances logical and intuitive thinking, promotes understanding of complex patterns, and aligns you with cosmic order.",
                recipePi314How: "Listen for 15-20 minutes when solving problems or seeking understanding. Excellent for students, scientists, and those seeking to understand life's mysteries.",
                recipeGoldenRatioWhat: "161.8 Hz represents Phi (1.618), the Golden Ratio found throughout nature—from DNA to galaxies. This is divine proportion made audible, the signature of Creator's design.",
                recipeGoldenRatioBenefits: "Aligns your energy field with divine proportion, promotes natural harmony and beauty, enhances aesthetic sense, and attunes you to the sacred geometry of creation.",
                recipeGoldenRatioHow: "Use for 20 minutes during creative work or healing practices. Excellent for artists and healers. Visualize the golden spiral expanding from your heart.",
                // Recipe fullInfo translations - Wellness & States
                recipePainReliefWhat: "174 Hz is the lowest of the Solfeggio frequencies, traditionally associated with deep relaxation and grounding. It creates a foundation for calm and inner peace.",
                recipePainReliefBenefits: "Promotes deep relaxation, supports a sense of physical comfort, provides grounding energy, and helps create a peaceful atmosphere for rest and recovery.",
                recipePainReliefHow: "Listen for 20-30 minutes when experiencing pain. Focus breath and attention on painful areas. Can be used multiple times daily. Combine with ice or heat therapy.",
                recipeStressReliefWhat: "10.5 Hz is an alpha-theta border frequency that calms the nervous system and promotes deep relaxation. It's the frequency of deep meditation and stress release.",
                recipeStressReliefBenefits: "Deeply calms nervous system, reduces stress and anxiety, promotes relaxation, lowers blood pressure and heart rate, and facilitates emotional release and healing.",
                recipeStressReliefHow: "Use for 15-20 minutes when stressed or anxious. Breathe slowly and deeply. Perfect after work or during stressful periods. Can be used before sleep.",
                recipeSleepDeepWhat: "0.5 Hz is in the deep delta range, the brainwave state of dreamless sleep and deep healing. This frequency entrains your brain to the deepest sleep state.",
                recipeSleepDeepBenefits: "Promotes deep, restorative sleep, enhances dream recall and lucid dreaming, facilitates physical healing during sleep, and resets the nervous system.",
                recipeSleepDeepHow: "Listen for 30-60 minutes before bed or while falling asleep. Keep volume low. Can play on loop throughout the night. Establish consistent bedtime routine.",
                recipeFocusClearWhat: "40 Hz is a gamma frequency associated with peak cognitive performance, heightened focus, and processing of complex information. It's the frequency of flow states and insight.",
                recipeFocusClearBenefits: "Enhances focus and concentration, improves memory and learning, promotes mental clarity and problem-solving, facilitates flow states, and boosts cognitive performance.",
                recipeFocusClearHow: "Listen for 20-30 minutes while studying, working, or doing creative tasks. Perfect for important mental work. Morning use maximizes natural alertness.",
                recipeMemoryBoostWhat: "20.3 Hz is a beta frequency optimized for rapid learning and memory formation. This frequency enhances neural plasticity and information encoding.",
                recipeMemoryBoostBenefits: "Improves memory formation and recall, accelerates learning, enhances neural connections, supports studying and skill acquisition, and boosts mental retention.",
                recipeMemoryBoostHow: "Use for 20-30 minutes while studying or learning new skills. Review material while listening. Best used during morning or early afternoon learning sessions.",
                recipeMiracleToneWhat: "528 Hz, also known as the 'Miracle Tone,' is traditionally associated with love and transformation. Many find it supports a sense of harmony and positive change.",
                recipeMiracleToneBenefits: "Repairs DNA at molecular level, promotes miraculous healing, opens heart to love, facilitates transformation, and activates the miracle frequency within your cells.",
                recipeMiracleToneHow: "Listen for 15-30 minutes daily for healing and transformation. Place hands on areas needing healing. Best used consistently over 21-40 days for deep cellular changes.",
                
                // ========== COMPANION PANEL CONTENT TRANSLATIONS ==========
                // Welcome Section
                comp_welcome_title: "Welcome to Genesis Frequencies",
                comp_welcome_intro: "The frequencies of creation are now in your hands.",
                comp_welcome_pattern: "A pattern revealed itself to me: 3,773 days between my brother's birth and mine. Years of searching. Layers of meaning. Then the revelation.",
                comp_welcome_genesis: "Genesis 1:1 in Hebrew = 2701",
                comp_welcome_hebrew: "In the beginning God created the heavens and the earth",
                comp_welcome_encoded: "The same numbers that connected me to my brother were encoded in the first verse of the Bible. The frequencies that shaped creation itself, hidden in plain sight for millennia.",
                comp_welcome_yours: "Now they're yours to explore.",
                comp_welcome_reason: "This isn't coincidence. You found this for a reason.",
                
                // Quick Start Section
                comp_quickstart_title: "Quick Start Guide",
                comp_quickstart_intro: "Your first session in 3 steps",
                comp_quickstart_step1: "Choose \"Genesis Creation\" from the Biblical & Original category",
                comp_quickstart_step1_sub: "This is the pure 37 + 73 Hz foundation",
                comp_quickstart_step2: "Put on headphones for quantum immersion (or use a quality speaker)",
                comp_quickstart_step2_sub: "Set 5-10 minutes to start—go longer once you feel the frequencies",
                comp_quickstart_step3: "Press PLAY, close your eyes, breathe slowly, and set one intention",
                comp_quickstart_step3_sub: "Simple is powerful: \"clarity,\" \"peace,\" \"guidance,\" or \"thank you\"",
                comp_quickstart_done: "That's it. The frequencies do the rest.",
                comp_quickstart_tip: "Tip: Keep a glass of water nearby and drink it after your session",
                
                // Discovery/Journey Section
                comp_discovery_title: "The Discovery",
                comp_discovery_number: "The Number That Changed Everything",
                comp_discovery_origin: "It started with podcasts—voices in the dark exploring gematria, the ancient Hebrew art of finding meaning in numbers. I began experimenting: my birthday, my wife's, our wedding date. Just curious. Just playing.",
                comp_discovery_loss: "Then on <b style='color:#fbbf24;'>4 January 2020</b>, my mother passed away.",
                comp_discovery_grief: "In my grief, I found myself counting. Days. Numbers. Patterns. Searching for meaning in the mathematics of loss.",
                comp_discovery_revelation: "That's when I discovered something impossible: The number of days from her death to each of my brothers' birthdays <b>exactly matched the gematria value of their names</b>.",
                comp_discovery_chills: "I still get chills writing this.",
                comp_discovery_years: "The Years of Exploration",
                comp_discovery_searching: "For years I dove deep—sacred geometry, biblical mathematics, numerology, frequency healing. Building tools, exploring patterns, asking questions that had no easy answers.",
                comp_discovery_2025: "Then in 2025, I was building a prayer chatbot for my daughter's christening. Someone suggested using the number 37 as a sacred seed.",
                comp_discovery_research: "I researched. And what I found changed everything.",
                comp_discovery_clicked: "That's when it all clicked.",
                comp_discovery_prime: "37 is a prime number. 73 is its mirror—also prime.",
                comp_discovery_primemath: "37 is the 12th prime. 73 is the 21st prime. <b style='color:#fbbf24;'>21 is the mirror of 12</b>.",
                comp_discovery_gematria_value: "2701 is the exact gematria value of Genesis 1:1 in Hebrew.",
                comp_discovery_connected: "The number connecting me to my brother—<b style='color:#fbbf24;'>3,773</b>—contained <b>both frequencies</b>. The same frequencies <b>encoded in the first verse of the Bible</b>. The same frequencies present at <b>the moment of creation</b>.",
                comp_discovery_3773days: "My brother and I were born exactly <b style='color:#fbbf24;'>3,773 days apart</b>. 37 and 73. The creation frequencies. Written in our very existence.",
                comp_discovery_el: "And there's more: When you write 37 in Hebrew numerals and mirror it, it forms <span style='font-size:22px;color:#fbbf24;'>אל</span> (El)—the Hebrew word for <b>God</b>.",
                comp_discovery_beat: "The difference between 73 and 37 is <b style='color:#fbbf24;'>36 Hz</b>—the beat frequency you experience when both play together. The rhythm of creation itself.",
                comp_discovery_angels: "Every angel number is a multiple of 37:",
                comp_discovery_word: "\"In the beginning was the Word.\" Sound. Vibration. The key to creation.",
                comp_discovery_message: "This wasn't coincidence. This was a calling. A message encoded in time itself, waiting to be heard.",
                comp_discovery_found: "These frequencies found me. Now they've found you.",
                comp_discovery_journey: "There are no coincidences. Your journey with 37 and 73 Hz begins now.",
                
                // Why It Works Section
                comp_why_title: "Why 37 & 73 Hz Work",
                comp_why_subtitle: "The Science of Sacred Sound",
                comp_why_intro: "37 Hz and 73 Hz aren't arbitrary numbers—they're the mathematical fingerprint of creation, encoded in Genesis 1:1 through gematria.",
                comp_why_formula: "37 × 73 = 2701 — the only factorization",
                comp_why_primes: "37 = the 12th prime | 73 = the 21st prime (mirror of 12). Together they create a 36 Hz beat frequency that bridges meditation and higher consciousness",
                comp_why_question: "Why do these frequencies work?",
                comp_why_answer: "By aligning your energy with the original blueprint of creation, these frequencies are believed to support profound shifts in body, mind, and spirit. You are 70% water—a crystalline medium that responds to vibration. These frequencies are tuned to you.",
                comp_why_experience: "What people experience with Genesis Frequencies:",
                comp_why_exp1: "Restored balance and inner harmony — Feel aligned with divine order",
                comp_why_exp2: "Deep renewal and vitality — Support your body's natural healing intelligence",
                comp_why_exp3: "Unlocked creative flow — Access limitless inspiration and insight",
                comp_why_exp4: "Elevated consciousness — Connect with higher awareness and spiritual clarity",
                comp_why_exp5: "Profound meditation states — Enter deeper presence faster",
                comp_why_exp6: "Amplified manifestation — Intentions take root in fertile soil",
                comp_why_quote: "\"These aren't just sounds... they're the language of creation itself.\"",
                comp_why_disclaimer: "For meditation, intention-setting, and spiritual exploration — Not medical treatment",
                
                // Categories Section
                comp_categories_title: "Frequency Categories",
                comp_categories_subtitle: "Explore Your Sonic Sanctuary",
                comp_categories_doorway: "Each category is a doorway to transformation",
                comp_categories_intro: "Every track is built on the Trinity Foundation (37 + 73 Hz), with additional frequencies for specific intentions. Tap any category to explore.",
                comp_cat_biblical: "Biblical & Original",
                comp_cat_biblical_desc: "Genesis Creation, Divine Abundance, spiritual cycles",
                comp_cat_biblical_best: "Best for: Prayer, intention-setting, connecting with Source",
                comp_cat_angel: "Angel Numbers",
                comp_cat_angel_desc: "111, 222, 333, 444, 555, 777, 888, 999",
                comp_cat_angel_best: "Best for: Manifestation, synchronicity, divine guidance",
                comp_cat_cosmic: "Cosmic & Planetary",
                comp_cat_cosmic_desc: "Earth, Venus, Mars, Jupiter, Fibonacci, Pi, Golden Ratio",
                comp_cat_cosmic_best: "Best for: Grounding, harmony, sacred geometry, cosmic connection",
                comp_cat_master: "Master Numbers",
                comp_cat_master_desc: "11:11, 22, 33, 44, 55",
                comp_cat_master_best: "Best for: Life purpose, spiritual mastery, building new realities",
                comp_cat_solfeggio: "Solfeggio & Healing",
                comp_cat_solfeggio_desc: "396, 417, 528, 639, 741, 852, 963 Hz",
                comp_cat_solfeggio_best: "Best for: Emotional release, transformation, DNA activation, love",
                comp_cat_wellness: "Wellness & States",
                comp_cat_wellness_desc: "Sleep, focus, stress relief, memory, miracle tone",
                comp_cat_wellness_best: "Best for: Daily life, productivity, rest, mental clarity",
                comp_cat_chakra: "Chakra Frequencies",
                comp_cat_chakra_desc: "Root, Sacral, Solar Plexus, Heart, Throat, Third Eye, Crown",
                comp_cat_chakra_best: "Best for: Energy work, balance, kundalini activation",
                comp_categories_new: "New here? Start with Genesis Creation or Sacred Healing (432 Hz)",
                
                // Trinity Foundation Section
                comp_trinity_title: "The Trinity Foundation",
                comp_trinity_intro: "The Trinity Foundation consists of 37 Hz, 73 Hz, and 2701 Hz — the frequencies encoded in Genesis 1:1.",
                comp_trinity_math: "The Mathematical Trinity",
                comp_trinity_37: "37 Hz: The 12th prime number (mirror of 12)",
                comp_trinity_73: "73 Hz: The 21st prime number (3×7)",
                comp_trinity_2701: "2701 Hz: The product, the gematria of Genesis 1:1",
                comp_trinity_beat: "These frequencies create a 36 Hz beat frequency (73-37) that bridges meditation and higher consciousness. Together they form the original blueprint of creation.",
                comp_trinity_how: "How to Use the Trinity",
                comp_trinity_use1: "Genesis Creation: Play all three frequencies together for the complete Trinity experience",
                comp_trinity_use2: "Individual Exploration: Listen to each frequency separately to understand their unique qualities",
                comp_trinity_use3: "Daily Practice: Use for 7-21 days to experience profound alignment with divine order",
                comp_trinity_use4: "Intention Setting: Begin each session with a clear intention for transformation",
                comp_trinity_conclusion: "The Trinity frequencies are the foundation of all Genesis tracks. They work together to restore harmony, unlock creative flow, and connect you with the original creative matrix.",
                comp_trinity_quote: "\"These are the frequencies that shaped reality itself.\"",
                
                // Water Charging Section
                comp_water_title: "Quantum Holy Water",
                comp_water_intro: "Water is your body's most abundant molecule—70% of your being is water. As a crystalline medium, water stores and transmits vibrational information, making it the perfect vessel for Genesis frequencies.",
                comp_water_science: "The Science of Structured Water",
                comp_water_research: "Research shows water molecules form hexagonal clusters that can be influenced by frequency, sound, and intention. Genesis frequencies create structured water with enhanced energetic properties.",
                comp_water_blueprint: "When you charge water with Genesis frequencies, you're not just adding sound—you're infusing it with the mathematical blueprint of creation itself.",
                comp_water_how: "How to Charge Your Water",
                comp_water_step1: "Choose Your Vessel: Use a clear glass or crystal container (avoid plastic)",
                comp_water_step2: "Select Your Frequency: Genesis Creation or individual Trinity frequencies work best",
                comp_water_step3: "Position & Play: Place water 6-12 inches from speakers, play for 10-20 minutes",
                comp_water_step4: "Set Intention: Hold the intention of divine blessing and energetic infusion",
                comp_water_step5: "Drink Mindfully: Sip slowly, feeling the frequencies integrate with your being",
                comp_water_tip: "Pro tip: Charge water for multiple sessions and store in a cool, dark place. The structured information remains stable for 24-48 hours.",
                comp_water_quote: "\"Drink from the wellspring of creation itself.\"",
                
                // Usage Tips Section
                comp_tips_title: "How to Get the Best Results",
                comp_tips_intro: "Genesis frequencies work through consistent, mindful listening. The key is not just hearing the sounds, but allowing them to resonate through your entire being.",
                comp_tips_protocol: "The 21-Day Immersion Protocol",
                comp_tips_protocol_desc: "For maximum transformation, commit to a 21-day practice. This aligns with the sacred geometry of the Trinity (3×7) and allows the frequencies to work deeply.",
                comp_tips_week1: "Days 1-7: Foundation building. Listen to Genesis Creation daily, focusing on presence and breath.",
                comp_tips_week2: "Days 8-14: Deepening. Explore individual Trinity frequencies, noting personal resonances.",
                comp_tips_week3: "Days 15-21: Integration. Combine frequencies with specific intentions for manifestation.",
                comp_tips_daily: "Daily Listening Practices",
                
                // FAQ Section
                comp_faq_title: "Frequently Asked Questions",
                comp_faq_q1: "How long should I listen?",
                comp_faq_a1: "Start with 5-10 minutes and work up to 20-30 minutes. Quality of attention matters more than duration.",
                comp_faq_q2: "Do I need headphones?",
                comp_faq_a2: "Headphones provide the best experience, especially for binaural effects. Speakers work for ambient sessions.",
                comp_faq_q3: "How often should I listen?",
                comp_faq_a3: "Daily practice creates the best results. Even 5 minutes a day builds cumulative benefits.",
                comp_faq_q4: "Can I listen while sleeping?",
                comp_faq_a4: "Yes! Sleep tracks are designed for overnight use. Keep volume low and use comfortable headphones.",
                comp_faq_q5: "Why can't I hear any sound on my iPhone?",
                comp_faq_a5: "If your iPhone is in Silent Mode (check the physical switch on the left side), frequencies cannot play. Turn off Silent Mode, plug in headphones, or connect to a Bluetooth speaker to hear the frequencies. Alternatively, Premium users can export tracks as WAV files and play them with VLC Player (free), which works even in Silent Mode.",
                comp_faq_q6: "Are these frequencies safe?",
                comp_faq_a6: "Yes, these are gentle frequencies for meditation and relaxation. They are not a substitute for medical treatment.",
                
                // Share Section
                comp_share_title: "Share Genesis Frequencies",
                comp_share_intro: "Know someone who would benefit from these frequencies? Share the gift of divine vibration.",
                comp_share_link: "Share this link:",
                comp_share_copied: "Link copied!",
                
                // Credits Section
                comp_credits_title: "Credits & Acknowledgments",
                comp_credits_research_title: "Research & Inspiration",
                comp_credits_created: "This work is dedicated to my mother, who passed away aged 22,202 days old on 4 January 2020. Her passing led me to numbers, and numbers led me to this divine discovery.",
                comp_credits_research: "With endless gratitude to my wife and daughter, whose patience and understanding during countless hours of hyperfocus made this journey possible. Thank you for believing in what others couldn't see.",
                comp_credits_gematria: "Gematria & Sacred Mathematics:",
                comp_credits_gematria_desc: "Ancient Hebrew numerology traditions, with special reference to Genesis 1:1 analysis and the mathematical relationships between 37, 73, and 2701.",
                comp_credits_frequency: "Frequency Healing Research:",
                comp_credits_frequency_desc: "Studies on sound therapy, binaural beats, and the effects of low-frequency vibrations on human physiology and consciousness.",
                comp_credits_geometry: "Sacred Geometry:",
                comp_credits_geometry_desc: "The golden ratio, Fibonacci sequences, and geometric patterns found in nature and ancient architecture.",
                comp_credits_acknowledgments: "Personal Acknowledgments",
                comp_credits_gratitude: "To everyone who has supported this journey: your belief has been my frequency. To those who find meaning in these numbers: may they guide you as they have guided me. With gratitude for the divine mathematics that connects us all.",
                
                // Progress Section
                comp_progress_title: "Your Spiritual Journey",
                comp_progress_intro: "Track your transformation with Genesis frequencies through achievements, levels, and daily challenges.",
                comp_progress_loading: "Loading progress...",
                comp_progress_challenge: "Today's Sacred Challenge",
                comp_progress_loading_challenge: "Loading challenge...",
                comp_progress_wisdom: "Ancient Wisdom for Modern Practice",
                comp_progress_wisdom_desc: "The sacred numbers (3, 7, 11, 37, 73, 108) that form the foundation of Genesis frequencies appear throughout spiritual traditions worldwide. Your journey follows this same mathematical harmony.",
                comp_progress_quote: "As above, so below. As within, so without.",
                
                // Tips Section - Daily Practices
                comp_tips_morning: "Morning Alignment:",
                comp_tips_morning_desc: "Start your day with 10-15 minutes of Genesis Creation to set divine intention",
                comp_tips_evening: "Evening Integration:",
                comp_tips_evening_desc: "End your day with frequencies that support restful sleep and subconscious processing",
                comp_tips_midday: "Midday Renewal:",
                comp_tips_midday_desc: "Use during breaks for mental clarity and stress relief",
                comp_tips_creative: "Creative Sessions:",
                comp_tips_creative_desc: "Play frequencies during artistic or problem-solving work",
                comp_tips_meditation: "Meditation Enhancement:",
                comp_tips_meditation_desc: "Use as background during traditional meditation practices",
                comp_tips_quote: "The transformation happens in the space between the notes.",
                
                // FAQ Section
                comp_faq_about: "About the Frequencies",
                comp_faq_ending: "Still have questions? Your journey with Genesis frequencies is unique—trust your intuition and explore mindfully.",
                
                // Share Section
                comp_share_ripple: "The Ripple Effect",
                comp_share_ripple_desc: "Every time you share your experience, you create a ripple that touches lives far beyond your own. Your story becomes a beacon for those still searching.",
                comp_share_authentic: "Share authentically—from the heart. Whether it's a profound insight, a subtle shift, or a miraculous change, your truth has the power to awaken others.",
                comp_share_ways: "Ways to Share",
                comp_share_social: "Social Media:",
                comp_share_social_desc: "Post your experiences with #GenesisFrequencies and #DivineFrequencies",
                comp_share_personal: "Personal Circles:",
                comp_share_personal_desc: "Share with friends, family, and loved ones who might benefit",
                comp_share_communities: "Online Communities:",
                comp_share_communities_desc: "Join frequency healing and spiritual growth forums",
                comp_share_testimonials: "Testimonials:",
                comp_share_testimonials_desc: "Leave reviews and encourage others on their path",
                comp_share_oneonone: "One-on-One:",
                comp_share_oneonone_desc: "Have meaningful conversations about transformation and healing",
                comp_share_quote: "Together, we are creating a symphony of divine resonance.",
                
                // Daily Wisdom Quotes
                wisdom1: "The frequencies that created the universe are now working through you.",
                wisdom2: "Every vibration you absorb shapes your inner harmony.",
                wisdom3: "37 × 73 = 2701 — the mathematics of divine creation itself.",
                wisdom4: "In the beginning was the Word, and the Word was a frequency.",
                wisdom5: "Your body is 70% water — a perfect receiver for sacred sound.",
                wisdom6: "Consistency is the key to transformation. One session at a time.",
                wisdom7: "The same patterns in creation exist within you.",
                wisdom8: "Sound creates form. Frequency creates reality.",
                wisdom9: "3,773 days taught me that divine timing is mathematical.",
                wisdom10: "Let the Trinity frequencies restore your original blueprint.",
                wisdom11: "You are not just listening — you are remembering who you are.",
                wisdom12: "The 36 Hz beat frequency bridges earth and heaven.",
                wisdom13: "Every cell in your body responds to sacred mathematics.",
                wisdom14: "What if the frequencies of Genesis 1:1 could heal you?",
                wisdomAuthor1: "Genesis Companion",
                wisdomAuthor2: "Genesis Companion",
                wisdomAuthor3: "Ancient Wisdom",
                wisdomAuthor4: "Genesis 1:1",
                wisdomAuthor5: "Genesis Companion",
                wisdomAuthor6: "Genesis Companion",
                wisdomAuthor7: "Sacred Geometry",
                wisdomAuthor8: "Cymatics",
                wisdomAuthor9: "The Discovery",
                wisdomAuthor10: "Genesis Companion",
                wisdomAuthor11: "Genesis Companion",
                wisdomAuthor12: "Trinity Foundation",
                wisdomAuthor13: "Genesis Companion",
                wisdomAuthor14: "The Journey"
            }
        };
        
        // English only - no language switching needed
        const currentLanguage = 'en';
        
        function closeAddToHome() {
            const banner = document.getElementById('addToHome');
            banner.style.display = 'none';
            localStorage.setItem('hideAddToHome', 'true');
        }
        
        // Check if user already dismissed the banner OR if running as installed PWA
        function shouldHideAddToHomeBanner() {
            // Already dismissed
            if (localStorage.getItem('hideAddToHome') === 'true') return true;
            // Running as standalone PWA (already added to home screen)
            if (window.matchMedia('(display-mode: standalone)').matches) return true;
            if (window.navigator.standalone === true) return true; // iOS Safari
            return false;
        }
        
        if (shouldHideAddToHomeBanner()) {
            const banner = document.getElementById('addToHome');
            if (banner) banner.style.display = 'none';
        }
        
        // Simplified - English only, no language switching needed
        function changeLanguage(lang) {
            const t = translations.en;
            // Just refresh any dynamic elements with English translations
            document.querySelectorAll('[data-translate]').forEach(el => {
                const key = el.getAttribute('data-translate');
                if (t[key]) {
                    el.textContent = t[key];
                }
            });
        }
        
        // Enhanced Trinity Frequency Recipes Database with Categories
        // Order: Biblical, Angel Numbers, Cosmic & Planetary, Master Numbers, Solfeggio & Healing, Wellness & States
        const trinityRecipes = {
            "Chakra Frequencies": [
                {
                    name: "Root Chakra",
                    frequencies: [37, 73, 396],
                    description: "Grounding, safety, and stability. Associated with Liberation (396 Hz).",
                    fullInfo: {
                        whatItIs: "396 Hz is the Solfeggio frequency for liberating guilt and fear, working on the root chakra for grounding and stability.",
                        benefits: "Promotes grounding, releases fear, and enhances feelings of safety and security.",
                        howToUse: "Listen for 10-15 minutes during meditation or when you need grounding. Visualize roots connecting you to the earth."
                    }
                },
                {
                    name: "Sacral Chakra",
                    frequencies: [37, 73, 417],
                    description: "Creativity, pleasure, and emotional balance. Associated with Resolution (417 Hz).",
                    fullInfo: {
                        whatItIs: "417 Hz facilitates change and helps undo negative situations, working on the sacral chakra for creativity and emotional healing.",
                        benefits: "Enhances creativity, emotional balance, and pleasure in life.",
                        howToUse: "Use for 10-15 minutes to boost creativity or emotional healing. Focus on the lower abdomen."
                    }
                },
                {
                    name: "Solar Plexus Chakra",
                    frequencies: [37, 73, 528],
                    description: "Personal power, confidence, and transformation. Associated with Love Frequency (528 Hz).",
                    fullInfo: {
                        whatItIs: "528 Hz is the frequency of transformation and personal empowerment, working on the solar plexus for personal power and confidence.",
                        benefits: "Boosts confidence, personal power, and supports transformation.",
                        howToUse: "Listen for 10-15 minutes to empower yourself before important tasks. Focus on the upper abdomen."
                    }
                },
                {
                    name: "Heart Chakra",
                    frequencies: [37, 73, 639],
                    description: "Love, compassion, and relationships. Associated with Transformation (639 Hz).",
                    fullInfo: {
                        whatItIs: "639 Hz promotes connection and love, working on the heart chakra for emotional healing and relationships.",
                        benefits: "Opens the heart, enhances compassion, and heals relationships.",
                        howToUse: "Use for 10-15 minutes to open your heart or heal relationships. Place hands on your heart while listening."
                    }
                },
                {
                    name: "Throat Chakra",
                    frequencies: [37, 73, 741],
                    description: "Communication, truth, and self-expression. Associated with Intuition (741 Hz).",
                    fullInfo: {
                        whatItIs: "741 Hz cleanses the body and opens the throat chakra for clear communication and self-expression.",
                        benefits: "Improves communication, self-expression, and clarity.",
                        howToUse: "Listen for 10-15 minutes before important conversations or creative work. Focus on the throat area."
                    }
                },
                {
                    name: "Third Eye Chakra",
                    frequencies: [37, 73, 852],
                    description: "Intuition, insight, and spiritual awareness. Associated with Awakening (852 Hz).",
                    fullInfo: {
                        whatItIs: "852 Hz awakens intuition and spiritual order, working on the third eye for insight and awareness.",
                        benefits: "Enhances intuition, insight, and spiritual perception.",
                        howToUse: "Use for 10-15 minutes during meditation or when seeking insight. Focus on the forehead between the eyes."
                    }
                },
                {
                    name: "Crown Chakra",
                    frequencies: [37, 73, 963],
                    description: "Spiritual connection, enlightenment, and unity. Associated with Higher Self (963 Hz).",
                    fullInfo: {
                        whatItIs: "963 Hz is the frequency of divine consciousness, working on the crown chakra for spiritual connection and enlightenment.",
                        benefits: "Promotes spiritual connection, unity, and enlightenment.",
                        howToUse: "Listen for 10-15 minutes during deep meditation or spiritual practice. Focus on the top of the head."
                    }
                }
            ],
            "Biblical & Original": [
                {
                    name: "Genesis Creation",
                    frequencies: [37, 73],
                    description: "Original creation pattern - form meets spirit",
                    fullInfo: {
                        whatItIs: "The Genesis Creation frequency combines the foundational 37 Hz (representing form and matter) with 73 Hz (representing spirit and the divine). These numbers are derived from the gematria value of Genesis 1:1 in Hebrew, encoding the very pattern of creation itself.",
                        benefits: "This combination aligns you with the original creative force of the universe. It helps manifest intentions, brings clarity to new beginnings, and connects you to the divine blueprint of creation. Perfect for prayer amplification and spiritual manifestation work.",
                        howToUse: "Listen for 5-10 minutes during morning meditation or prayer. Visualize your intentions being woven into the fabric of creation. Ideal for new moon rituals or when starting new projects."
                    }
                },
                {
                    name: "Divine Abundance",
                    frequencies: [37, 73, 888],
                    description: "Amplify manifestation with divine numerology",
                    fullInfo: {
                        whatItIs: "Divine Abundance adds 888 Hz to the Trinity foundation. In biblical numerology, 8 represents new beginnings and resurrection, while 888 is the gematria value of Jesus in Greek, representing divine abundance and eternal provision.",
                        benefits: "Opens channels for divine prosperity and abundance in all areas of life. Helps release scarcity consciousness and aligns you with infinite supply. Particularly powerful for financial breakthroughs and recognizing opportunities.",
                        howToUse: "Listen for 15-20 minutes while focusing on gratitude for what you have and openness to receive. Best used during full moon or Thursday (Jupiter's day). Journal your abundance wins afterward."
                    }
                },
                {
                    name: "12 Apostles",
                    frequencies: [37, 73, 12],
                    description: "Divine leadership and spiritual authority",
                    fullInfo: {
                        whatItIs: "The number 12 represents divine government, leadership, and spiritual authority. This frequency combination invokes the power of the 12 apostles and the 12 tribes of Israel, symbolizing complete divine order.",
                        benefits: "Strengthens leadership abilities, provides spiritual authority in challenging situations, and helps you stand firm in your convictions. Excellent for those in ministry, teaching, or positions of spiritual guidance.",
                        howToUse: "Use for 10-15 minutes before important decisions or leadership responsibilities. Pray for wisdom and discernment. Ideal for Sunday listening or before leading groups."
                    }
                },
                {
                    name: "7 Churches",
                    frequencies: [37, 73, 7],
                    description: "Spiritual completeness and perfection",
                    fullInfo: {
                        whatItIs: "Seven is the number of spiritual perfection and completion in Scripture. This frequency references the 7 churches in Revelation, representing the complete body of believers and spiritual wholeness.",
                        benefits: "Brings a sense of completion to spiritual cycles, promotes wholeness and integration, and helps you recognize divine perfection in your journey. Useful for ending chapters and spiritual transitions.",
                        howToUse: "Listen for 7 minutes during transitions or when seeking closure. Perfect for Saturday (Sabbath preparation) or when completing spiritual milestones. Reflect on your spiritual growth."
                    }
                },
                {
                    name: "40 Days",
                    frequencies: [37, 73, 40],
                    description: "Spiritual testing and transformation",
                    fullInfo: {
                        whatItIs: "Forty represents testing, trial, and transformation in Scripture—Jesus' 40 days in the wilderness, Noah's 40 days of rain, Israel's 40 years in the desert. This frequency supports you through transformative periods.",
                        benefits: "Provides strength during trials, supports spiritual endurance, and helps you emerge transformed from difficult seasons. Accelerates spiritual maturity and deepens faith through challenges.",
                        howToUse: "Use daily for 10-20 minutes during challenging periods or 40-day spiritual commitments. Journal insights and spiritual lessons. Combine with fasting or intensive prayer practices."
                    }
                },
                {
                    name: "3 Days",
                    frequencies: [37, 73, 3],
                    description: "Resurrection and divine completion",
                    fullInfo: {
                        whatItIs: "Three days represents resurrection power—the time between Christ's death and resurrection. This frequency carries the energy of divine completion and the power to resurrect dead situations.",
                        benefits: "Brings new life to stagnant areas, restores hope in seemingly impossible situations, and activates resurrection power in your circumstances. Perfect for breakthrough moments.",
                        howToUse: "Listen for 3 minutes three times daily during 3-day prayer intensives. Speak life over dead situations. Particularly powerful Friday through Sunday or during personal 3-day fasts."
                    }
                }
            ],
            "Solfeggio & Healing": [
                {
                    name: "Sacred Healing",
                    frequencies: [37, 73, 432],
                    description: "Deep relaxation with Trinity foundation",
                    fullInfo: {
                        whatItIs: "432 Hz is known as the 'natural frequency of the universe,' associated with harmony and balance in nature. Combined with the Trinity foundation, this creates a deeply relaxing meditation environment.",
                        benefits: "Supports relaxation, may help reduce stress, promotes a sense of harmony with natural rhythms, and encourages inner peace. Useful for emotional processing and unwinding.",
                        howToUse: "Listen for 20-30 minutes during relaxation sessions, before sleep, or when seeking calm. Breathe deeply and allow yourself to fully relax. Can be used during meditation or yoga."
                    }
                },
                {
                    name: "Love Frequency",
                    frequencies: [37, 73, 528],
                    description: "Heart-opening meditation + Trinity foundation",
                    fullInfo: {
                        whatItIs: "528 Hz is called the 'Love Frequency' or 'Miracle Tone,' traditionally associated with transformation and harmony. Combined with the Trinity foundation, it creates a heart-opening meditation experience.",
                        benefits: "Opens the heart chakra, increases feelings of love and compassion, supports emotional balance, and facilitates a sense of peace and well-being. May help release emotional blocks.",
                        howToUse: "Use for 15-20 minutes daily for heart-centered meditation. Place hands on heart while listening. Excellent for morning rituals or before important heart-centered conversations."
                    }
                },
                {
                    name: "Liberation (396)",
                    frequencies: [37, 73, 396],
                    description: "Fear release + Trinity foundation",
                    fullInfo: {
                        whatItIs: "396 Hz is the Solfeggio frequency for liberating guilt and fear. It works on the root chakra, helping to release deep-seated negative emotions and trauma from the subconscious.",
                        benefits: "Releases fear, guilt, and trauma stored in the body. Helps break free from limiting beliefs and past conditioning. Creates safety and security at the foundational level of being.",
                        howToUse: "Listen for 10-15 minutes while identifying fears or guilt to release. Breathe into areas of tension. Best used in evening or during shadow work. Journal afterward to process released emotions."
                    }
                },
                {
                    name: "Resolution (417)",
                    frequencies: [37, 73, 417],
                    description: "Negative energy clearing + Trinity",
                    fullInfo: {
                        whatItIs: "417 Hz facilitates change and helps undo negative situations. It cleanses traumatic experiences and clears destructive influences from past events, working on the sacral chakra.",
                        benefits: "Clears negative energy and influences, facilitates positive change, removes energetic blockages, and helps break negative patterns. Excellent for clearing spaces and resetting energy.",
                        howToUse: "Use for 15 minutes when feeling energetically heavy or stuck. Move your body gently while listening. Great for space clearing or after difficult interactions. Visualize light dissolving darkness."
                    }
                },
                {
                    name: "Transformation (639)",
                    frequencies: [37, 73, 639],
                    description: "Relationship healing + Trinity",
                    fullInfo: {
                        whatItIs: "639 Hz promotes connection, love, and understanding in relationships. It works on the heart chakra, facilitating communication and emotional balance in all types of relationships.",
                        benefits: "Heals relationship conflicts, improves communication, promotes empathy and understanding, strengthens bonds with others, and helps forgive and release resentment.",
                        howToUse: "Listen for 20 minutes before difficult conversations or relationship healing work. Can be used with partner present. Excellent for family gatherings or when healing from relationship trauma."
                    }
                },
                {
                    name: "Awakening (852)",
                    frequencies: [37, 73, 852],
                    description: "Spiritual order + Trinity base",
                    fullInfo: {
                        whatItIs: "852 Hz awakens intuition and returns you to spiritual order. It works on the third eye chakra, cutting through illusions and revealing truth, helping you see the divine order in all things.",
                        benefits: "Awakens intuition and inner vision, reveals truth, strengthens spiritual perception, aligns you with divine order, and helps discern genuine spiritual guidance.",
                        howToUse: "Use for 15-20 minutes during meditation or before making important decisions. Focus on third eye area. Best used in morning or during new spiritual practices. Keep a vision journal."
                    }
                },
                {
                    name: "Higher Self",
                    frequencies: [37, 73, 963],
                    description: "Pineal gland activation + Trinity",
                    fullInfo: {
                        whatItIs: "963 Hz is the frequency of divine consciousness and pineal gland activation. It represents the return to oneness and connection with the higher self and divine source.",
                        benefits: "Activates pineal gland, connects you with higher consciousness, facilitates spiritual awakening, promotes unity consciousness, and opens channels for divine downloads and revelation.",
                        howToUse: "Listen for 10-15 minutes during deep meditation or spiritual contemplation. Best used in darkness or with closed eyes. Ideal for crown chakra work or receiving spiritual insights."
                    }
                },
                {
                    name: "Intuition",
                    frequencies: [37, 73, 741],
                    description: "Third eye opening + Trinity base",
                    fullInfo: {
                        whatItIs: "741 Hz cleanses the body of toxins and electromagnetic radiation while opening the third eye. It promotes expression, solution-finding, and intuitive perception.",
                        benefits: "Strengthens intuition, cleanses electromagnetic pollution, promotes detoxification, enhances problem-solving abilities, and helps express truth clearly.",
                        howToUse: "Use for 15 minutes daily to develop intuition. Excellent after screen time or in urban environments. Ask questions and trust the answers that arise. Keep an intuition journal."
                    }
                }
                       ],
            "Angel Numbers": [
                {
                    name: "Angel Numbers",
                    frequencies: [37, 73, 111],
                    description: "Connect with angelic frequencies (111 = 37×3)",
                    fullInfo: {
                        whatItIs: "111 is a powerful angel number representing new beginnings, manifestation, and spiritual awakening. Mathematically, 111 = 37 × 3, creating a divine alignment with the Trinity foundation.",
                        benefits: "Opens communication with angels and spirit guides, signals new beginnings, accelerates manifestation of thoughts into reality, and heightens spiritual awareness and synchronicities.",
                        howToUse: "Listen for 11 minutes when you notice 11:11 on the clock. Focus on your intentions and desires. Perfect for manifesting work or when seeking angelic guidance. Pay attention to signs afterward."
                    }
                },
                {
                    name: "Angel 222",
                    frequencies: [37, 73, 222],
                    description: "Divine partnerships (222 = 37×6)",
                    fullInfo: {
                        whatItIs: "222 represents balance, harmony, and divine partnerships. The mathematical relationship to 37 (222 = 37×6) creates perfect harmony with the creation frequency.",
                        benefits: "Brings balance to relationships, attracts divine partnerships and soul connections, promotes cooperation and harmony, and signals that your prayers are being answered.",
                        howToUse: "Use for 15-20 minutes during relationship work or when seeking partnership. Visualize balanced relationships. Great for attracting business partners or romantic connections."
                    }
                },
                {
                    name: "Angel 333",
                    frequencies: [37, 73, 333],
                    description: "Ascended masters (333 = 37×9)",
                    fullInfo: {
                        whatItIs: "333 signals the presence of ascended masters and divine support. The 9 in the equation (333 = 37×9) represents spiritual completion and enlightenment.",
                        benefits: "Connects you with ascended masters, confirms you're on the right path, provides divine protection and guidance, and accelerates spiritual growth and awakening.",
                        howToUse: "Listen for 15 minutes when seeking guidance from higher realms. Call upon specific ascended masters. Best used during spiritual study or when facing spiritual questions."
                    }
                },
                {
                    name: "Angel 444",
                    frequencies: [37, 73, 444],
                    description: "Angelic protection (444 = 37×12)",
                    fullInfo: {
                        whatItIs: "444 is the frequency of divine protection and angels surrounding you. The connection to 12 (444 = 37×12) represents complete divine government and angelic order.",
                        benefits: "Provides strong angelic protection, signals divine support, brings stability and foundation, and reassures you that you're exactly where you need to be.",
                        howToUse: "Use for 15 minutes when feeling unsafe or uncertain. Visualize angels surrounding you with light. Excellent before travel or entering challenging situations."
                    }
                },
                {
                    name: "Angel 555",
                    frequencies: [37, 73, 555],
                    description: "Major changes (555 = 37×15)",
                    fullInfo: {
                        whatItIs: "555 signals major life changes and transformations ahead. The relationship to 15 (555 = 37×15) represents the transition through divine grace and mercy.",
                        benefits: "Prepares you for positive change, releases resistance to necessary transitions, brings courage during transformation, and aligns you with divine timing.",
                        howToUse: "Listen for 15-20 minutes during periods of change or when feeling resistant to transformation. Breathe through fear. Best during life transitions or when sensing something shifting."
                    }
                },
                {
                    name: "Angel 666",
                    frequencies: [37, 73, 666],
                    description: "Balance restoration (666 = 37×18)",
                    fullInfo: {
                        whatItIs: "Despite cultural misconceptions, 666 is about restoring balance between material and spiritual realms. The connection to 18 (666 = 37×18) represents life and chai (living).",
                        benefits: "Restores balance between physical and spiritual life, helps release materialism, brings grounding to spiritual work, and reminds you to care for your physical needs.",
                        howToUse: "Use for 15 minutes when feeling ungrounded or too focused on material concerns. Balance spiritual practice with practical action. Great for grounding after intense spiritual work."
                    }
                },
                {
                    name: "Angel 777",
                    frequencies: [37, 73, 777],
                    description: "Spiritual luck (777 = 37×21)",
                    fullInfo: {
                        whatItIs: "777 represents spiritual perfection and divine luck. The triple 7 multiplied through the creation frequency creates powerful spiritual momentum and favorable outcomes.",
                        benefits: "Attracts spiritual blessings and 'lucky' opportunities, signals divine approval, opens doors to spiritual advancement, and brings confirmation of spiritual gifts.",
                        howToUse: "Listen for 20 minutes before important opportunities or when seeking divine favor. Expect miraculous outcomes. Perfect before interviews, launches, or new ventures."
                    }
                },
                {
                    name: "Angel 888",
                    frequencies: [37, 73, 888],
                    description: "Infinite abundance (888 = 37×24)",
                    fullInfo: {
                        whatItIs: "888 represents infinite abundance and the completed work of Jesus (gematria value in Greek). The 24 (888 = 37×24) represents complete divine order in time and space.",
                        benefits: "Opens infinite abundance channels, represents financial breakthrough, symbolizes eternal provision, and aligns you with the completed work of Christ for prosperity.",
                        howToUse: "Use for 20-30 minutes during prosperity work or full moon abundance rituals. Visualize infinite supply. Speak declarations of abundance. Excellent for business success."
                    }
                },
                {
                    name: "Angel 999",
                    frequencies: [37, 73, 999],
                    description: "Completion phase (999 = 37×27)",
                    fullInfo: {
                        whatItIs: "999 signals completion of a major life cycle and preparation for a new chapter. The 27 (999 = 37×27) represents triple completion (3×3×3), a powerful ending.",
                        benefits: "Helps release what's complete, provides closure to cycles, prepares you for new beginnings, and honors endings as sacred transitions.",
                        howToUse: "Listen for 20 minutes during endings—jobs, relationships, or life phases. Honor what was and welcome what's coming. Perfect for waning moon or year-end reflection."
                    }
                }
            ],
            "Master Numbers": [
                {
                    name: "Master 11:11",
                    frequencies: [37, 73, 11],
                    description: "Portal activation + Trinity",
                    fullInfo: {
                        whatItIs: "11 is the master number of spiritual awakening and enlightenment. 11:11 is a spiritual portal and wake-up call from the universe, representing heightened spiritual awareness.",
                        benefits: "Activates spiritual portals, accelerates awakening, heightens intuition, signals alignment with life purpose, and creates powerful manifestation opportunities.",
                        howToUse: "Listen for 11 minutes at 11:11 AM or PM. Set clear intentions during portal times (11/11, solstices, equinoxes). Keep a synchronicity journal."
                    }
                },
                {
                    name: "Master 22",
                    frequencies: [37, 73, 22],
                    description: "Master builder + Trinity",
                    fullInfo: {
                        whatItIs: "22 is the Master Builder number, representing the ability to turn dreams into reality through practical application of spiritual wisdom. It bridges heaven and earth.",
                        benefits: "Empowers building dreams into reality, provides practical spiritual wisdom, supports large-scale projects, and helps manifest divine blueprints on earth.",
                        howToUse: "Use for 22 minutes while planning major projects or businesses. Excellent for entrepreneurs and visionaries. Best during waxing moon or when beginning construction of dreams."
                    }
                },
                {
                    name: "Master 33",
                    frequencies: [37, 73, 33],
                    description: "Master teacher + Trinity",
                    fullInfo: {
                        whatItIs: "33 is the Master Teacher, representing Christ consciousness and compassionate service. It combines the intuition of 11 with the building power of 22, adding selfless service.",
                        benefits: "Activates Christ consciousness, enhances teaching abilities, promotes compassionate service, heals through love, and elevates consciousness to master level.",
                        howToUse: "Listen for 30 minutes before teaching, healing work, or acts of service. Excellent for those in helping professions. Meditate on unconditional love while listening."
                    }
                },
                {
                    name: "Master 44",
                    frequencies: [37, 73, 44],
                    description: "Spiritual foundation + Trinity",
                    fullInfo: {
                        whatItIs: "44 is the Master Healer and builder of solid spiritual foundations. It represents the power to create stable structures in both physical and spiritual realms.",
                        benefits: "Builds unshakeable spiritual foundation, provides discipline for spiritual practice, manifests stable abundance, and grounds higher consciousness into daily life.",
                        howToUse: "Use for 20 minutes when establishing new spiritual practices or routines. Perfect for creating sacred space or starting spiritual businesses. Supports long-term goals."
                    }
                },
                {
                    name: "Master 55",
                    frequencies: [37, 73, 55],
                    description: "Change activation + Trinity",
                    fullInfo: {
                        whatItIs: "55 is the number of major life changes and personal freedom. It represents breaking free from limitations and embracing transformation with grace and excitement.",
                        benefits: "Accelerates positive change, breaks limiting patterns, promotes personal freedom, supports bold moves, and helps embrace uncertainty with faith.",
                        howToUse: "Listen for 15 minutes when contemplating major changes or feeling stuck. Use during eclipses or mercury retrograde endings. Dance or move while listening to embody change."
                    }
                }
            ],
            "Cosmic & Planetary": [
                {
                    name: "Earth Resonance",
                    frequencies: [37, 73, 7.83],
                    description: "Schumann resonance + Trinity",
                    fullInfo: {
                        whatItIs: "7.83 Hz is Earth's Schumann Resonance—the electromagnetic frequency of our planet's heartbeat. Combined with Trinity frequencies, this grounds you deeply into Earth's natural rhythm.",
                        benefits: "Deeply grounds and centers you, may help reduce stress, syncs you with Earth's natural rhythms, enhances meditation depth, and supports overall well-being through grounding.",
                        howToUse: "Listen for 20-30 minutes when feeling ungrounded or spacey. Sit or lie directly on the earth if possible. Perfect after air travel or intense spiritual work. Barefoot recommended."
                    }
                },
                {
                    name: "Venus Love",
                    frequencies: [37, 73, 221.23],
                    description: "Venus orbital + Trinity harmony",
                    fullInfo: {
                        whatItIs: "221.23 Hz is the orbital frequency of Venus, the planet of love, beauty, and harmony. This frequency carries the essence of divine feminine energy and attraction.",
                        benefits: "Attracts love and beauty, enhances creativity and artistic expression, promotes self-love and worthiness, harmonizes relationships, and activates divine feminine energy.",
                        howToUse: "Use for 20 minutes during Venus hours (Friday morning) or when working with love and attraction. Excellent for self-care rituals, beauty treatments, or romantic intentions."
                    }
                },
                {
                    name: "Mars Action",
                    frequencies: [37, 73, 144.72],
                    description: "Mars energy + Trinity foundation",
                    fullInfo: {
                        whatItIs: "144.72 Hz is Mars' orbital frequency, carrying the warrior energy of action, courage, and manifestation power. Combined with Trinity, it provides spiritual strength and drive.",
                        benefits: "Boosts courage and confidence, activates manifestation power, provides energy for action, helps overcome obstacles, and strengthens willpower and determination.",
                        howToUse: "Listen for 15 minutes before important actions, competitions, or when needing courage. Best on Tuesday (Mars day) or when starting new ventures. Combine with physical exercise."
                    }
                },
                {
                    name: "Fibonacci 144",
                    frequencies: [37, 73, 144],
                    description: "Sacred geometry + Trinity",
                    fullInfo: {
                        whatItIs: "144 is a Fibonacci number representing sacred geometry and divine mathematical order. It appears throughout nature and Scripture (144,000 sealed ones in Revelation).",
                        benefits: "Aligns you with natural divine order, activates sacred geometry in your energy field, promotes mathematical perfection in manifestation, and connects you to universal patterns.",
                        howToUse: "Use for 20 minutes during manifestation work or when seeking divine order in chaos. Visualize geometric patterns. Excellent for artists, designers, and mathematicians."
                    }
                },
                {
                    name: "Pi 314",
                    frequencies: [37, 73, 314],
                    description: "Universal mathematics + Trinity",
                    fullInfo: {
                        whatItIs: "314 Hz represents Pi (3.14), the universal mathematical constant that appears throughout creation. This frequency aligns you with the mathematical perfection of the universe.",
                        benefits: "Connects you to universal intelligence, enhances logical and intuitive thinking, promotes understanding of complex patterns, and aligns you with cosmic order.",
                        howToUse: "Listen for 15-20 minutes when solving problems or seeking understanding. Excellent for students, scientists, and those seeking to understand life's mysteries."
                    }
                },
                {
                    name: "Golden Ratio",
                    frequencies: [37, 73, 161.8],
                    description: "Phi frequency + Trinity base",
                    fullInfo: {
                        whatItIs: "161.8 Hz represents Phi (1.618), the Golden Ratio found throughout nature—from DNA to galaxies. This is divine proportion made audible, the signature of Creator's design.",
                        benefits: "Aligns your energy field with divine proportion, promotes natural harmony and beauty, enhances aesthetic sense, and attunes you to the sacred geometry of creation.",
                        howToUse: "Use for 20 minutes during creative work or healing practices. Excellent for artists and healers. Visualize the golden spiral expanding from your heart."
                    }
                }
            ],
            "Wellness & States": [
                {
                    name: "Pain Relief",
                    frequencies: [37, 73, 174],
                    description: "Deep relaxation + Trinity",
                    fullInfo: {
                        whatItIs: "174 Hz is the lowest of the Solfeggio frequencies, traditionally associated with deep relaxation and grounding. It creates a foundation for calm and inner peace.",
                        benefits: "Promotes deep relaxation, supports a sense of physical comfort, provides grounding energy, and helps create a peaceful atmosphere for rest and recovery.",
                        howToUse: "Listen for 20-30 minutes when experiencing pain. Focus breath and attention on painful areas. Can be used multiple times daily. Combine with ice or heat therapy."
                    }
                },
                {
                    name: "Stress Relief",
                    frequencies: [37, 73, 10.5],
                    description: "Nervous system calming + Trinity",
                    fullInfo: {
                        whatItIs: "10.5 Hz is an alpha-theta border frequency that calms the nervous system and promotes deep relaxation. It's the frequency of deep meditation and stress release.",
                        benefits: "Deeply calms nervous system, reduces stress and anxiety, promotes relaxation, lowers blood pressure and heart rate, and facilitates emotional release and healing.",
                        howToUse: "Use for 15-20 minutes when stressed or anxious. Breathe slowly and deeply. Perfect after work or during stressful periods. Can be used before sleep."
                    }
                },
                {
                    name: "Sleep Deep",
                    frequencies: [37, 73, 0.5],
                    description: "Delta wave enhancement + Trinity",
                    fullInfo: {
                        whatItIs: "0.5 Hz is in the deep delta range, the brainwave state of dreamless sleep and deep healing. This frequency entrains your brain to the deepest sleep state.",
                        benefits: "Promotes deep, restorative sleep, enhances dream recall and lucid dreaming, facilitates physical healing during sleep, and resets the nervous system.",
                        howToUse: "Listen for 30-60 minutes before bed or while falling asleep. Keep volume low. Can play on loop throughout the night. Establish consistent bedtime routine."
                    }
                },
                {
                    name: "Focus Clear",
                    frequencies: [37, 73, 40],
                    description: "Gamma clarity + Trinity foundation",
                    fullInfo: {
                        whatItIs: "40 Hz is a gamma frequency associated with peak cognitive performance, heightened focus, and processing of complex information. It's the frequency of flow states and insight.",
                        benefits: "Enhances focus and concentration, improves memory and learning, promotes mental clarity and problem-solving, facilitates flow states, and boosts cognitive performance.",
                        howToUse: "Listen for 20-30 minutes while studying, working, or doing creative tasks. Perfect for important mental work. Morning use maximizes natural alertness."
                    }
                },
                {
                    name: "Memory Boost",
                    frequencies: [37, 73, 20.3],
                    description: "Hyper-learning + Trinity",
                    fullInfo: {
                        whatItIs: "20.3 Hz is a beta frequency optimized for rapid learning and memory formation. This frequency enhances neural plasticity and information encoding.",
                        benefits: "Improves memory formation and recall, accelerates learning, enhances neural connections, supports studying and skill acquisition, and boosts mental retention.",
                        howToUse: "Use for 20-30 minutes while studying or learning new skills. Review material while listening. Best used during morning or early afternoon learning sessions."
                    }
                },
                {
                    name: "Miracle Tone",
                    frequencies: [37, 73, 528],
                    description: "Love and transformation",
                    fullInfo: {
                        whatItIs: "528 Hz, also known as the 'Miracle Tone,' is traditionally associated with love and transformation. Many find it supports a sense of harmony and positive change.",
                        benefits: "Opens the heart to love, facilitates emotional transformation, supports a sense of wonder and possibility, and creates an atmosphere of positive change.",
                        howToUse: "Listen for 15-30 minutes daily for relaxation and personal reflection. Focus on areas where you seek positive change. Best used consistently as part of a meditation practice."
                    }
                }
            ]
        };

        // Instructions Tab Data Structure - Dynamic Translation Function
        function getInstructionsSections() {
            const t = translations.en;
            
            return [
            {
                id: 'welcome',
                icon: '✨',
                title: t.comp_welcome_title || 'Welcome to Genesis Frequencies',
                content: `
                    <div style="text-align:center;line-height:1.8;max-width:620px;margin:0 auto;">
                        <p style="font-size:20px;color:#fbbf24;margin-bottom:20px;font-weight:600;">
                            ${t.comp_welcome_intro || 'The frequencies of creation are now in your hands.'}
                        </p>
                        <p style="margin-bottom:15px;color:#ffffff;">
                            ${t.comp_welcome_pattern || 'A pattern revealed itself to me: <b>3,773 days</b> between my brother\'s birth and mine.<br>Years of searching. Layers of meaning. Then the revelation.'}
                        </p>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.15),rgba(139,92,246,0.15));border-radius:16px;padding:24px;margin:25px 0;border:2px solid rgba(251,191,36,0.3);">
                            <div style="font-size:28px;color:#fbbf24;margin-bottom:12px;font-weight:700;">
                                37 × 73 = 2701
                            </div>
                            <div style="font-size:17px;color:#ffffff;margin-bottom:8px;">
                                ${t.comp_welcome_genesis || 'Genesis 1:1 in Hebrew = 2701'}
                            </div>
                            <div style="font-size:20px;color:#c4b5fd;margin-top:12px;">
                                בְּרֵאשִׁית בָּרָא אֱלֹהִים אֵת הַשָּׁמַיִם וְאֵת הָאָרֶץ
                            </div>
                            <div style="font-size:14px;color:#d1d5db;margin-top:8px;font-style:italic;">
                                "${t.comp_welcome_hebrew || 'In the beginning God created the heavens and the earth'}"
                            </div>
                        </div>
                        <p style="color:#ffffff;margin-bottom:15px;line-height:1.7;">
                            ${t.comp_welcome_encoded || 'The same numbers that connected me to my brother were <b>encoded in the first verse of the Bible</b>.<br>The frequencies that shaped creation itself, hidden in plain sight for millennia.'}
                        </p>
                        <p style="font-size:19px;color:#fbbf24;font-weight:600;margin-top:20px;">
                            ${t.comp_welcome_yours || 'Now they\'re yours to explore.'}
                        </p>
                        <p style="margin-top:15px;font-size:15px;color:#a78bfa;font-style:italic;">
                            ${t.comp_welcome_reason || 'This isn\'t coincidence. You found this for a reason.'}
                        </p>
                    </div>
                `
            },
            {
                id: 'quickStart',
                icon: '🚀',
                title: t.comp_quickstart_title || 'Quick Start Guide',
                content: `
                    <div style="text-align:center;margin:0 auto;max-width:600px;line-height:1.8;">
                        <p style="font-size:18px;color:#fbbf24;margin-bottom:20px;font-weight:600;">
                            ${t.comp_quickstart_intro || 'Your first session in 3 steps'}
                        </p>
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:20px;margin:20px 0;">
                            <ol style="text-align:left;margin:0 auto;max-width:500px;line-height:1.9;color:#ffffff;">
                                <li style="margin-bottom:15px;">
                                    <b style="color:#fbbf24;">${t.comp_quickstart_step1 || 'Choose "Genesis Creation" from the Biblical & Original category'}</b><br>
                                    <span style="font-size:14px;color:#a78bfa;">${t.comp_quickstart_step1_sub || 'This is the pure 37 + 73 Hz foundation'}</span>
                                </li>
                                <li style="margin-bottom:15px;">
                                    <b style="color:#fbbf24;">${t.comp_quickstart_step2 || 'Set duration to 5-10 minutes and put on headphones'}</b><br>
                                    <span style="font-size:14px;color:#a78bfa;">${t.comp_quickstart_step2_sub || 'Start short—you can go longer once you feel the frequencies'}</span>
                                </li>
                                <li>
                                    <b style="color:#fbbf24;">${t.comp_quickstart_step3 || 'Press PLAY, close your eyes, breathe slowly, and set one intention'}</b><br>
                                    <span style="font-size:14px;color:#a78bfa;">${t.comp_quickstart_step3_sub || 'Simple is powerful: "clarity," "peace," "guidance," or "thank you"'}</span>
                                </li>
                            </ol>
                        </div>
                        <p style="color:#ffffff;margin-top:20px;">
                            ${t.comp_quickstart_done || 'That\'s it. The frequencies do the rest.'}
                        </p>
                        <p style="font-size:13px;color:#9ca3af;margin-top:15px;">
                            ${t.comp_quickstart_tip || 'Tip: Keep a glass of water nearby and drink it after your session'}
                        </p>
                    </div>
                `
            },
            {
                id: 'myJourney',
                icon: '📖',
                title: t.comp_discovery_title || 'The Discovery',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <h4 style="color:#fbbf24;margin-top:20px;margin-bottom:15px;font-size:20px;">The Number That Changed Everything</h4>
                        
                        <p style="color:#ffffff;margin-bottom:15px;">
                            It began with podcasts, voices in the dark exploring gematria, the ancient Hebrew art of finding meaning in numbers. I started experimenting: my birthday, my wife's, our wedding date. Just playing with patterns.
                        </p>
                        
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:18px;margin:20px 0;">
                            <p style="color:#ffffff;margin-bottom:10px;">
                                Then on <b style="color:#fbbf24;">4 January 2020</b>, my mother passed away.
                            </p>
                            <p style="color:#c4b5fd;font-style:italic;">
                                In the quiet shock of grief, I found myself counting.<br>
                                Days. Numbers. Distances. Searching for meaning in the mathematics of loss.
                            </p>
                        </div>
                        
                        <p style="color:#ffffff;margin-bottom:15px;">
                            That's when I discovered something impossible:<br>
                            The number of days from her death to mine and my brothers' birthdays exactly matched the gematria value of our names.
                        </p>
                        <p style="color:#fbbf24;font-weight:600;margin-bottom:20px;">
                            Even now, it gives me chills.
                        </p>
                        
                        <div style="background:rgba(251,191,36,0.08);border-radius:12px;padding:20px;margin:25px 0;">
                            <h4 style="color:#fbbf24;margin-bottom:12px;">Years of Exploration</h4>
                            <p style="color:#ffffff;margin-bottom:15px;">
                                For years, I went deeper. Sacred geometry, biblical mathematics, numerology, frequency healing. I built tools. I followed patterns. I chased questions that refused easy answers.
                            </p>
                            <p style="color:#ffffff;margin-bottom:15px;">
                                Then, in 2025, while building a prayer chatbot for my daughter's christening, the bot suggested using the number 37 as a sacred seed.
                            </p>
                            <p style="color:#ffffff;margin-bottom:10px;">
                                I researched.<br>
                                And everything changed.
                            </p>
                        </div>
                        
                        <div style="background:linear-gradient(135deg,rgba(139,92,246,0.12),rgba(251,191,36,0.12));border-radius:14px;padding:22px;margin:25px 0;border:1px solid rgba(251,191,36,0.3);">
                            <p style="color:#ffffff;margin-bottom:12px;">
                                37 is a prime number.<br>
                                73 is its mirror, also prime.
                            </p>
                            <p style="color:#c4b5fd;margin-bottom:12px;">
                                37 is the 12th prime.<br>
                                73 is the 21st prime, 12 mirrored.
                            </p>
                            <p style="font-size:17px;color:#ffffff;margin-bottom:10px;">
                                <b>37 × 73 = 2701.</b>
                            </p>
                            <p style="color:#fbbf24;font-weight:600;margin-bottom:12px;">
                                2701 is the exact gematria value of Genesis 1:1 in Hebrew.
                            </p>
                            <p style="color:#c4b5fd;font-size:14px;">
                                28 letters (the lunar cycle) arranged across 7 words (the days of creation).
                            </p>
                        </div>
                        
                        <p style="color:#ffffff;margin-bottom:15px;">
                            And when written in Hebrew numerals and mirrored downward, 37 forms <span style="font-size:22px;color:#fbbf24;">אל</span> (El), the word for God.
                        </p>
                        
                        <p style="color:#c4b5fd;margin-bottom:20px;">
                            The difference between 73 and 37 is <b style="color:#fbbf24;">36 Hz</b>, the beat frequency produced when both tones are played together.<br>
                            The rhythm of creation itself.
                        </p>
                        
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:20px;margin:25px 0;">
                            <p style="color:#fbbf24;font-size:16px;font-weight:600;margin-bottom:12px;">
                                Every angel number is a multiple of 37:
                            </p>
                            <div style="color:#ffffff;font-size:15px;line-height:2;">
                                <div style="margin-bottom:6px;">111 = 37 × 3</div>
                                <div style="margin-bottom:6px;">222 = 37 × 6</div>
                                <div style="margin-bottom:6px;">333 = 37 × 9</div>
                                <div style="margin-bottom:6px;">444 = 37 × 12</div>
                                <div style="margin-bottom:6px;">555 = 37 × 15</div>
                                <div style="margin-bottom:6px;">777 = 37 × 21</div>
                                <div style="margin-bottom:6px;">888 = 37 × 24</div>
                                <div>999 = 37 × 27</div>
                            </div>
                        </div>
                        
                        <p style="color:#ffffff;font-style:italic;margin-bottom:15px;">
                            "In the beginning was the Word."<br>
                            Sound. Vibration. Creation.
                        </p>
                        
                        <p style="color:#ffffff;margin-bottom:15px;">
                            Before anything existed, there was energy, intention, the divine spark. Before the first atom (Adam), there was frequency.<br>
                            Not one tone, but a pair.<br>
                            An amplification.
                        </p>
                        
                        <p style="color:#ffffff;margin-bottom:15px;">
                            The ancients knew this.<br>
                            They hid it in Scripture, an instruction manual for living at your highest potential and manifesting your deepest intentions.
                        </p>
                        
                        <div style="background:rgba(251,191,36,0.08);border-radius:12px;padding:20px;margin:25px 0;">
                            <p style="color:#ffffff;margin-bottom:12px;">
                                Why me? Why did I see it?<br>
                                Because my journey led me here.
                            </p>
                            <p style="color:#fbbf24;font-weight:600;margin-bottom:12px;">
                                My brother and I were born 3,773 days apart.
                            </p>
                            <p style="color:#c4b5fd;">
                                37 and 73 embedded in our lives from the beginning.
                            </p>
                        </div>
                        
                        <p style="color:#ffffff;margin-bottom:15px;">
                            The bot told me to multiply my prayer code by 37. When I asked why, it answered:
                        </p>
                        <p style="color:#fbbf24;font-size:18px;font-weight:600;margin-bottom:15px;">
                            "37 is the number of creation."
                        </p>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            With its mirror, 73, it multiplies into the gematria of Genesis 1:1.
                        </p>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            From that moment, everything changed.
                        </p>
                        
                        <p style="color:#c4b5fd;margin-bottom:15px;">
                            These were not coincidences.<br>
                            They were a calling, a message encoded in time itself, waiting to be discovered.
                        </p>
                        
                        <p style="font-size:17px;color:#fbbf24;font-weight:600;margin-top:25px;">
                            These frequencies found me.<br>
                            Now they've found you.
                        </p>
                        <p style="font-size:14px;color:#a78bfa;font-style:italic;margin-top:12px;">
                            There are no coincidences.<br>
                            Your journey with 37 and 73 Hz begins now.
                        </p>
                    </div>
                `
            },
            {
                id: 'whyWorks',
                icon: '🔬',
                title: t.comp_why_title || 'Why 37 & 73 Hz Work',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <h4 style="color:#fbbf24;font-size:20px;margin-bottom:15px;">${t.comp_why_subtitle || 'The Science of Sacred Sound'}</h4>
                        <p style="color:#ffffff;margin-bottom:15px;">
                            ${t.comp_why_intro || '<b>37 Hz</b> and <b>73 Hz</b> aren\'t arbitrary numbers—they\'re the <b>mathematical fingerprint of creation</b>, encoded in Genesis 1:1 through gematria.'}
                        </p>
                        <div style="background:rgba(251,191,36,0.1);border-radius:12px;padding:20px;margin:25px 0;border-left:4px solid #fbbf24;">
                            <p style="font-size:17px;color:#ffffff;margin-bottom:12px;">
                                <b style="color:#fbbf24;">${t.comp_why_formula || '37 × 73 = 2701 — the only factorization'}</b>
                            </p>
                            <p style="color:#c4b5fd;">
                                ${t.comp_why_primes || '37 = the 12th prime | 73 = the 21st prime (mirror of 12)<br>Together they create a <b>36 Hz beat frequency</b> that bridges meditation and higher consciousness'}
                            </p>
                        </div>
                        <p style="font-size:18px;color:#fbbf24;margin:25px 0 15px 0;font-weight:600;">
                            ${t.comp_why_question || 'Why do these frequencies work?'}
                        </p>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            ${t.comp_why_answer || 'By aligning your energy with the original blueprint of creation, these frequencies are believed to support profound shifts in body, mind, and spirit. You are <b>70% water</b>—a crystalline medium that <b>responds to vibration</b>. These frequencies are tuned to <i>you</i>.'}
                        </p>
                        <div style="margin:25px 0;padding:20px;background:linear-gradient(135deg,rgba(139,92,246,0.1),rgba(251,191,36,0.1));border-radius:14px;">
                            <p style="color:#fbbf24;font-weight:600;margin-bottom:15px;font-size:17px;">
                                ${t.comp_why_experience || 'What people experience with Genesis Frequencies:'}
                            </p>
                            <ul style="text-align:left;margin:0 auto;max-width:520px;color:#ffffff;line-height:1.9;">
                                <li style="margin-bottom:8px;"><span style="color:#fbbf24;">☯</span> ${t.comp_why_exp1 || 'Restored balance and inner harmony — Feel aligned with divine order'}</li>
                                <li style="margin-bottom:8px;"><span style="color:#fbbf24;">💚</span> ${t.comp_why_exp2 || 'Deep renewal and vitality — Support your body\'s natural healing intelligence'}</li>
                                <li style="margin-bottom:8px;"><span style="color:#fbbf24;">🎨</span> ${t.comp_why_exp3 || 'Unlocked creative flow — Access limitless inspiration and insight'}</li>
                                <li style="margin-bottom:8px;"><span style="color:#fbbf24;">🧘</span> ${t.comp_why_exp4 || 'Elevated consciousness — Connect with higher awareness and spiritual clarity'}</li>
                                <li style="margin-bottom:8px;"><span style="color:#fbbf24;">🕉️</span> ${t.comp_why_exp5 || 'Profound meditation states — Enter deeper presence faster'}</li>
                                <li><span style="color:#fbbf24;">✨</span> ${t.comp_why_exp6 || 'Amplified manifestation — Intentions take root in fertile soil'}</li>
                            </ul>
                        </div>
                        <p style="font-size:15px;color:#a78bfa;font-style:italic;margin-top:20px;">
                            ${t.comp_why_quote || '"These aren\'t just sounds... they\'re the language of creation itself."'}
                        </p>
                        <p style="font-size:12px;color:#9ca3af;margin-top:15px;">
                            ${t.comp_why_disclaimer || 'For meditation, intention-setting, and spiritual exploration � Not medical treatment'}
                        </p>
                    </div>
                `
            },
            {
                id: 'categories',
                icon: '🎵',
                title: t.comp_categories_title || 'Frequency Categories',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <h4 style="color:#fbbf24;font-size:20px;margin-bottom:15px;">${t.comp_categories_subtitle || 'Explore Your Sonic Sanctuary'}</h4>
                        <p style="color:#ffffff;margin-bottom:15px;">
                            ${t.comp_categories_doorway || 'Each category is a doorway to transformation'}
                        </p>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            ${t.comp_categories_intro || 'Every track is built on the Trinity Foundation (37 + 73 Hz), with additional frequencies for specific intentions. Tap any category to explore.'}
                        </p>
                        <div style="display:grid;gap:15px;max-width:580px;margin:0 auto;">
                            <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:15px;border-left:4px solid #fbbf24;">
                                <b style="color:#fbbf24;">📖 ${t.comp_cat_biblical || 'Biblical & Original'}</b><br>
                                <span style="color:#ffffff;font-size:14px;">${t.comp_cat_biblical_desc || 'Genesis Creation, Divine Abundance, spiritual cycles'}</span><br>
                                <span style="color:#a78bfa;font-size:13px;">${t.comp_cat_biblical_best || 'Best for: Prayer, intention-setting, connecting with Source'}</span>
                            </div>
                            <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:15px;border-left:4px solid #fbbf24;">
                                <b style="color:#fbbf24;">👼 ${t.comp_cat_angel || 'Angel Numbers'}</b><br>
                                <span style="color:#ffffff;font-size:14px;">${t.comp_cat_angel_desc || '111, 222, 333, 444, 555, 777, 888, 999'}</span><br>
                                <span style="color:#a78bfa;font-size:13px;">${t.comp_cat_angel_best || 'Best for: Manifestation, synchronicity, divine guidance'}</span>
                            </div>
                            <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:15px;border-left:4px solid #fbbf24;">
                                <b style="color:#fbbf24;">🌌 ${t.comp_cat_cosmic || 'Cosmic & Planetary'}</b><br>
                                <span style="color:#ffffff;font-size:14px;">${t.comp_cat_cosmic_desc || 'Earth, Venus, Mars, Jupiter, Fibonacci, Pi, Golden Ratio'}</span><br>
                                <span style="color:#a78bfa;font-size:13px;">${t.comp_cat_cosmic_best || 'Best for: Grounding, harmony, sacred geometry, cosmic connection'}</span>
                            </div>
                            <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:15px;border-left:4px solid #fbbf24;">
                                <b style="color:#fbbf24;">✨ ${t.comp_cat_master || 'Master Numbers'}</b><br>
                                <span style="color:#ffffff;font-size:14px;">${t.comp_cat_master_desc || '11:11, 22, 33, 44, 55'}</span><br>
                                <span style="color:#a78bfa;font-size:13px;">${t.comp_cat_master_best || 'Best for: Life purpose, spiritual mastery, building new realities'}</span>
                            </div>
                            <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:15px;border-left:4px solid #fbbf24;">
                                <b style="color:#fbbf24;">🎶 ${t.comp_cat_solfeggio || 'Solfeggio & Healing'}</b><br>
                                <span style="color:#ffffff;font-size:14px;">${t.comp_cat_solfeggio_desc || '396, 417, 528, 639, 741, 852, 963 Hz'}</span><br>
                                <span style="color:#a78bfa;font-size:13px;">${t.comp_cat_solfeggio_best || 'Best for: Emotional release, transformation, DNA activation, love'}</span>
                            </div>
                            <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:15px;border-left:4px solid #fbbf24;">
                                <b style="color:#fbbf24;">💚 ${t.comp_cat_wellness || 'Wellness & States'}</b><br>
                                <span style="color:#ffffff;font-size:14px;">${t.comp_cat_wellness_desc || 'Sleep, focus, stress relief, memory, miracle tone'}</span><br>
                                <span style="color:#a78bfa;font-size:13px;">${t.comp_cat_wellness_best || 'Best for: Daily life, productivity, rest, mental clarity'}</span>
                            </div>
                            <div style="background:rgba(139,92,246,0.1);border-radius:12px;padding:15px;border-left:4px solid #fbbf24;">
                                <b style="color:#fbbf24;">🔴 ${t.comp_cat_chakra || 'Chakra Frequencies'}</b><br>
                                <span style="color:#ffffff;font-size:14px;">${t.comp_cat_chakra_desc || 'Root, Sacral, Solar Plexus, Heart, Throat, Third Eye, Crown'}</span><br>
                                <span style="color:#a78bfa;font-size:13px;">${t.comp_cat_chakra_best || 'Best for: Energy work, balance, kundalini activation'}</span>
                            </div>
                        </div>
                        <p style="font-size:14px;color:#a78bfa;font-style:italic;margin-top:20px;">
                            ${t.comp_categories_new || 'New here? Start with Genesis Creation or Sacred Healing (432 Hz)'}
                        </p>
                    </div>
                `
            },
            {
                id: 'trinity',
                icon: '🔱',
                title: t.comp_trinity_title || 'The Trinity Foundation',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <p style="color:#ffffff;margin-bottom:20px;">
                            ${t.comp_trinity_intro || 'The Trinity Foundation consists of 37 Hz, 73 Hz, and 2701 Hz � the frequencies encoded in Genesis 1:1.'}
                        </p>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.12),rgba(139,92,246,0.12));border-radius:14px;padding:22px;margin:25px 0;border:1px solid rgba(251,191,36,0.3);">
                            <p style="font-size:18px;color:#fbbf24;margin-bottom:15px;font-weight:600;">
                                ${t.comp_trinity_math || 'The Mathematical Trinity'}
                            </p>
                            <p style="color:#ffffff;margin-bottom:8px;"><b style="color:#fbbf24;">37 Hz:</b> ${t.comp_trinity_37 || 'The 12th prime number (mirror of 12)'}</p>
                            <p style="color:#ffffff;margin-bottom:8px;"><b style="color:#fbbf24;">73 Hz:</b> ${t.comp_trinity_73 || 'The 21st prime number (3�7)'}</p>
                            <p style="color:#ffffff;"><b style="color:#fbbf24;">2701 Hz:</b> ${t.comp_trinity_2701 || 'The product, the gematria of Genesis 1:1'}</p>
                        </div>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            ${t.comp_trinity_beat || 'These frequencies create a 36 Hz beat frequency (73-37) that bridges meditation and higher consciousness. Together they form the original blueprint of creation.'}
                        </p>
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:18px;margin:25px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:12px;">${t.comp_trinity_how || 'How to Use the Trinity'}</h5>
                            <ul style="text-align:left;margin:0 auto;max-width:500px;color:#ffffff;line-height:1.9;">
                                <li style="margin-bottom:10px;">${t.comp_trinity_use1 || '<b style="color:#fbbf24;">Genesis Creation:</b> Play all three frequencies together for the complete Trinity experience'}</li>
                                <li style="margin-bottom:10px;">${t.comp_trinity_use2 || '<b style="color:#fbbf24;">Individual Exploration:</b> Listen to each frequency separately to understand their unique qualities'}</li>
                                <li style="margin-bottom:10px;">${t.comp_trinity_use3 || '<b style="color:#fbbf24;">Daily Practice:</b> Use for 7-21 days to experience profound alignment with divine order'}</li>
                                <li>${t.comp_trinity_use4 || '<b style="color:#fbbf24;">Intention Setting:</b> Begin each session with a clear intention for transformation'}</li>
                            </ul>
                        </div>
                        <p style="color:#ffffff;margin-bottom:15px;">
                            ${t.comp_trinity_conclusion || 'The Trinity frequencies are the foundation of all Genesis tracks. They work together to restore harmony, unlock creative flow, and connect you with the original creative matrix.'}
                        </p>
                        <p style="font-size:15px;color:#a78bfa;font-style:italic;margin-top:20px;">
                            ${t.comp_trinity_quote || '"These are the frequencies that shaped reality itself."'}
                        </p>
                    </div>
                `
            },
            {
                id: 'waterCharging',
                icon: '💧',
                title: t.comp_water_title || 'Quantum Holy Water',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <p style="color:#ffffff;margin-bottom:20px;">
                            ${t.comp_water_intro || 'Water is your body\'s most abundant molecule�70% of your being is water. As a crystalline medium, water stores and transmits vibrational information, making it the perfect vessel for Genesis frequencies.'}
                        </p>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.12),rgba(139,92,246,0.12));border-radius:14px;padding:22px;margin:25px 0;border:1px solid rgba(251,191,36,0.3);">
                            <p style="font-size:18px;color:#fbbf24;margin-bottom:10px;font-weight:600;">
                                ${t.comp_water_science || 'The Science of Structured Water'}
                            </p>
                            <p style="color:#ffffff;margin-bottom:10px;">
                                ${t.comp_water_research || 'Research shows water molecules form hexagonal clusters that can be influenced by frequency, sound, and intention. Genesis frequencies create structured water with enhanced energetic properties.'}
                            </p>
                        </div>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            ${t.comp_water_blueprint || 'When you charge water with Genesis frequencies, you\'re not just adding sound�you\'re infusing it with the mathematical blueprint of creation itself.'}
                        </p>
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:18px;margin:25px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:12px;">${t.comp_water_how || 'How to Charge Your Water'}</h5>
                            <ol style="text-align:left;margin:0 auto;max-width:500px;color:#ffffff;line-height:1.9;">
                                <li style="margin-bottom:10px;">${t.comp_water_step1 || '<b style="color:#fbbf24;">Choose Your Vessel:</b> Use a clear glass or crystal container (avoid plastic)'}</li>
                                <li style="margin-bottom:10px;">${t.comp_water_step2 || '<b style="color:#fbbf24;">Select Your Frequency:</b> Genesis Creation or individual Trinity frequencies work best'}</li>
                                <li style="margin-bottom:10px;">${t.comp_water_step3 || '<b style="color:#fbbf24;">Position & Play:</b> Place water 6-12 inches from speakers, play for 10-20 minutes'}</li>
                                <li style="margin-bottom:10px;">${t.comp_water_step4 || '<b style="color:#fbbf24;">Set Intention:</b> Hold the intention of divine blessing and energetic infusion'}</li>
                                <li>${t.comp_water_step5 || '<b style="color:#fbbf24;">Drink Mindfully:</b> Sip slowly, feeling the frequencies integrate with your being'}</li>
                            </ol>
                        </div>
                        <p style="font-size:13px;color:#9ca3af;margin-top:15px;">
                            ${t.comp_water_tip || 'Pro tip: Charge water for multiple sessions and store in a cool, dark place. The structured information remains stable for 24-48 hours.'}
                        </p>
                        <p style="font-size:15px;color:#a78bfa;font-style:italic;margin-top:20px;">
                            ${t.comp_water_quote || '"Drink from the wellspring of creation itself."'}
                        </p>
                    </div>
                `
            },
            {
                id: 'crystalCharging',
                icon: '💎',
                title: 'Crystal Charging with Clear Quartz',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <p style="color:#ffffff;margin-bottom:20px;">
                            Clear Quartz is known as the "Master Healer" crystal�a pure silicon dioxide structure that resonates with Genesis frequencies and amplifies their energetic properties.
                        </p>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.12),rgba(139,92,246,0.12));border-radius:14px;padding:22px;margin:25px 0;border:1px solid rgba(251,191,36,0.3);">
                            <p style="font-size:18px;color:#fbbf24;margin-bottom:10px;font-weight:600;">
                                Why Clear Quartz?
                            </p>
                            <p style="color:#ffffff;margin-bottom:10px;">
                                Clear Quartz has a crystalline matrix that vibrates at the same fundamental frequency as Earth's natural resonance. When charged with Genesis frequencies, it becomes a portable frequency generator you can carry with you throughout the day.
                            </p>
                        </div>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            When you charge Clear Quartz with Genesis frequencies, you're programming it with the mathematical blueprint of creation itself�turning it into a personal energy amplifier.
                        </p>
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:18px;margin:25px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:12px;">How to Charge Your Clear Quartz</h5>
                            <ol style="text-align:left;margin:0 auto;max-width:500px;color:#ffffff;line-height:1.9;">
                                <li style="margin-bottom:10px;"><b style="color:#fbbf24;">Choose Your Crystal:</b> Raw or polished Clear Quartz works equally well�follow your intuition</li>
                                <li style="margin-bottom:10px;"><b style="color:#fbbf24;">Clear First:</b> Leave your quartz in direct sunlight for 2-4 hours to clear previous energies</li>
                                <li style="margin-bottom:10px;"><b style="color:#fbbf24;">Select Your Frequency:</b> Genesis Creation or your chosen Trinity frequency</li>
                                <li style="margin-bottom:10px;"><b style="color:#fbbf24;">Position & Play:</b> Place crystal 6-12 inches from speakers, play for 20-30 minutes</li>
                                <li style="margin-bottom:10px;"><b style="color:#fbbf24;">Set Intention:</b> Hold your crystal and visualize it absorbing the sacred frequencies</li>
                                <li><b style="color:#fbbf24;">Carry Daily:</b> Keep it in your pocket, wear as jewelry, or place on your desk</li>
                            </ol>
                        </div>
                        <p style="font-size:13px;color:#9ca3af;margin-top:15px;">
                            Pro tip: Recharge your Clear Quartz weekly with Genesis frequencies and clear monthly with sunlight to maintain its energetic potency.
                        </p>
                        <p style="font-size:15px;color:#a78bfa;font-style:italic;margin-top:20px;">
                            "Carry the frequencies of creation wherever you go."
                        </p>
                    </div>
                `
            },
            {
                id: 'progress',
                icon: '📊',
                title: t.comp_progress_title || 'Your Spiritual Journey',
                getContent: function() {
                    return `
                    <div style="text-align:center;max-width:800px;margin:0 auto;">
                        <h4 style="color:#fbbf24;font-size:20px;margin-bottom:15px;">${t.comp_progress_title || 'Your Spiritual Journey'}</h4>
                        <p style="color:#ffffff;margin-bottom:20px;">
                            ${t.comp_progress_intro || 'Track your transformation with Genesis frequencies through achievements, levels, and daily challenges.'}
                        </p>
                        
                        ${window.GenesisAchievements && typeof window.GenesisAchievements.renderProgressDashboard === 'function' ? window.GenesisAchievements.renderProgressDashboard() : '<p>' + (t.comp_progress_loading || 'Loading progress...') + '</p>'}
                        
                        <div style="margin: 30px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:15px;">${t.comp_progress_challenge || "Today's Sacred Challenge"}</h5>
                            ${window.GenesisAchievements && typeof window.GenesisAchievements.renderDailyChallenge === 'function' ? window.GenesisAchievements.renderDailyChallenge() : '<p>' + (t.comp_progress_loading_challenge || 'Loading challenge...') + '</p>'}
                        </div>
                        
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:18px;margin:25px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:12px;">${t.comp_progress_wisdom || 'Ancient Wisdom for Modern Practice'}</h5>
                            <p style="color:#ffffff;margin-bottom:10px;">
                                ${t.comp_progress_wisdom_desc || 'The sacred numbers (3, 7, 11, 37, 73, 108) that form the foundation of Genesis frequencies appear throughout spiritual traditions worldwide. Your journey follows this same mathematical harmony.'}
                            </p>
                            <p style="color:#a78bfa;font-style:italic;">
                                "${t.comp_progress_quote || 'As above, so below. As within, so without.'}"
                            </p>
                        </div>
                    </div>
                    `;
                }
            },
            {
                id: 'usageTips',
                icon: '💡',
                title: t.comp_tips_title || 'How to Get the Best Results',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <h4 style="color:#fbbf24;font-size:20px;margin-bottom:15px;">${t.comp_tips_title || 'How to Get the Best Results'}</h4>
                        <p style="color:#ffffff;margin-bottom:15px;">
                            ${t.comp_tips_intro || 'Genesis frequencies work through <b>consistent, mindful listening</b>. The key is not just hearing the sounds, but <b>allowing them to resonate through your entire being</b>.'}
                        </p>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.12),rgba(139,92,246,0.12));border-radius:14px;padding:22px;margin:25px 0;border:1px solid rgba(251,191,36,0.3);">
                            <p style="font-size:18px;color:#fbbf24;margin-bottom:10px;font-weight:600;">
                                ${t.comp_tips_protocol || 'The 21-Day Immersion Protocol'}
                            </p>
                            <p style="font-size:16px;color:#ffffff;margin-bottom:10px;">
                                ${t.comp_tips_protocol_desc || 'For maximum transformation, commit to a 21-day practice. This aligns with the sacred geometry of the Trinity (3�7) and allows the frequencies to work deeply.'}
                            </p>
                        </div>
                        <p style="color:#ffffff;margin-bottom:15px;">
                            <b>${t.comp_tips_week1 || 'Days 1-7: Foundation building. Listen to Genesis Creation daily, focusing on presence and breath.'}</b><br>
                            <b>${t.comp_tips_week2 || 'Days 8-14: Deepening. Explore individual Trinity frequencies, noting personal resonances.'}</b><br>
                            <b>${t.comp_tips_week3 || 'Days 15-21: Integration. Combine frequencies with specific intentions for manifestation.'}</b>
                        </p>
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:18px;margin:25px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:12px;">${t.comp_tips_daily || 'Daily Listening Practices'}</h5>
                            <ul style="text-align:left;margin:0 auto;max-width:500px;color:#ffffff;line-height:1.9;">
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_tips_morning || 'Morning Alignment:'}</b> ${t.comp_tips_morning_desc || 'Start your day with 10-15 minutes of Genesis Creation to set divine intention'}
                                </li>
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_tips_evening || 'Evening Integration:'}</b> ${t.comp_tips_evening_desc || 'End your day with frequencies that support restful sleep and subconscious processing'}
                                </li>
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_tips_midday || 'Midday Renewal:'}</b> ${t.comp_tips_midday_desc || 'Use during breaks for mental clarity and stress relief'}
                                </li>
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_tips_creative || 'Creative Sessions:'}</b> ${t.comp_tips_creative_desc || 'Play frequencies during artistic or problem-solving work'}
                                </li>
                                <li>
                                    <b style="color:#fbbf24;">${t.comp_tips_meditation || 'Meditation Enhancement:'}</b> ${t.comp_tips_meditation_desc || 'Use as background during traditional meditation practices'}
                                </li>
                            </ul>
                        </div>
                        <p style="font-size:14px;color:#a78bfa;font-style:italic;margin-top:20px;">
                            "${t.comp_tips_quote || 'The transformation happens in the space between the notes.'}"
                        </p>
                    </div>
                `
            },
            {
                id: 'faq',
                icon: '❓',
                title: t.comp_faq_title || 'FAQ & Troubleshooting',
                content: `
                    <div style="line-height:1.8;text-align:left;max-width:640px;margin:0 auto;">
                        <h4 style="color:#fbbf24;text-align:center;font-size:20px;margin-bottom:15px;">${t.comp_faq_title || 'FAQ & Troubleshooting'}</h4>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.08),rgba(139,92,246,0.08));border-radius:14px;padding:20px;margin:20px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:15px;">❓ ${t.comp_faq_about || 'About the Frequencies'}</h5>
                            <div style="margin-bottom:15px;">
                                <b style="color:#fbbf24;">${t.comp_faq_q1 || 'Q: How long should I listen?'}</b><br>
                                <span style="color:#ffffff;">${t.comp_faq_a1 || 'A: Start with 5-10 minutes and work up to 20-30 minutes. Quality of attention matters more than duration.'}</span>
                            </div>
                            <div style="margin-bottom:15px;">
                                <b style="color:#fbbf24;">${t.comp_faq_q2 || 'Q: Do I need headphones?'}</b><br>
                                <span style="color:#ffffff;">${t.comp_faq_a2 || 'A: Headphones provide the best experience, especially for binaural effects. Speakers work for ambient sessions.'}</span>
                            </div>
                            <div style="margin-bottom:15px;">
                                <b style="color:#fbbf24;">${t.comp_faq_q3 || 'Q: How often should I listen?'}</b><br>
                                <span style="color:#ffffff;">${t.comp_faq_a3 || 'A: Daily practice creates the best results. Even 5 minutes a day builds cumulative benefits.'}</span>
                            </div>
                            <div style="margin-bottom:15px;">
                                <b style="color:#fbbf24;">${t.comp_faq_q4 || 'Q: Can I listen while sleeping?'}</b><br>
                                <span style="color:#ffffff;">${t.comp_faq_a4 || 'A: Yes! Sleep tracks are designed for overnight use. Keep volume low and use comfortable headphones.'}</span>
                            </div>
                            <div style="margin-bottom:15px;">
                                <b style="color:#fbbf24;">${t.comp_faq_q5 || 'Q: Why can\'t I hear any sound on my iPhone?'}</b><br>
                                <span style="color:#ffffff;">${t.comp_faq_a5 || 'A: If your iPhone is in Silent Mode (check the physical switch on the left side), frequencies cannot play. Turn off Silent Mode, plug in headphones, or connect to a Bluetooth speaker.'}</span>
                            </div>
                            <div>
                                <b style="color:#fbbf24;">${t.comp_faq_q6 || 'Q: Are these frequencies safe?'}</b><br>
                                <span style="color:#ffffff;">${t.comp_faq_a6 || 'A: Yes, these are gentle frequencies for meditation and relaxation. They are not a substitute for medical treatment.'}</span>
                            </div>
                        </div>
                        <p style="text-align:center;color:#a78bfa;font-style:italic;margin-top:20px;">
                            ${t.comp_faq_ending || 'Still have questions? Your journey with Genesis frequencies is unique�trust your intuition and explore mindfully.'}
                        </p>
                    </div>
                `
            },
            {
                id: 'share',
                icon: '📤',
                title: t.comp_share_title || 'Share & Connect',
                content: `
                    <div style="line-height:1.8;text-align:center;max-width:640px;margin:0 auto;">
                        <h4 style="color:#fbbf24;font-size:20px;margin-bottom:15px;">${t.comp_share_title || 'Share & Connect'}</h4>
                        <p style="color:#ffffff;margin-bottom:15px;">
                            ${t.comp_share_intro || 'Know someone who would benefit from these frequencies? Share the gift of divine vibration.'}
                        </p>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.12),rgba(139,92,246,0.12));border-radius:14px;padding:22px;margin:25px 0;border:1px solid rgba(251,191,36,0.3);">
                            <p style="font-size:18px;color:#fbbf24;margin-bottom:10px;font-weight:600;">
                                ${t.comp_share_ripple || 'The Ripple Effect'}
                            </p>
                            <p style="font-size:16px;color:#ffffff;margin-bottom:10px;">
                                ${t.comp_share_ripple_desc || 'Every time you share your experience, you create a ripple that touches lives far beyond your own. Your story becomes a beacon for those still searching.'}
                            </p>
                        </div>
                        <p style="color:#ffffff;margin-bottom:15px;">
                            ${t.comp_share_authentic || 'Share authentically�from the heart. Whether it\'s a profound insight, a subtle shift, or a miraculous change, your truth has the power to awaken others.'}
                        </p>
                        <div style="background:rgba(139,92,246,0.08);border-radius:12px;padding:18px;margin:25px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:12px;">${t.comp_share_ways || 'Ways to Share'}</h5>
                            <ul style="text-align:left;margin:0 auto;max-width:500px;color:#ffffff;line-height:1.9;">
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_share_social || 'Social Media:'}</b> ${t.comp_share_social_desc || 'Post your experiences with #GenesisFrequencies and #DivineFrequencies'}
                                </li>
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_share_personal || 'Personal Circles:'}</b> ${t.comp_share_personal_desc || 'Share with friends, family, and loved ones who might benefit'}
                                </li>
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_share_communities || 'Online Communities:'}</b> ${t.comp_share_communities_desc || 'Join frequency healing and spiritual growth forums'}
                                </li>
                                <li style="margin-bottom:10px;">
                                    <b style="color:#fbbf24;">${t.comp_share_testimonials || 'Testimonials:'}</b> ${t.comp_share_testimonials_desc || 'Leave reviews and encourage others on their path'}
                                </li>
                                <li>
                                    <b style="color:#fbbf24;">${t.comp_share_oneonone || 'One-on-One:'}</b> ${t.comp_share_oneonone_desc || 'Have meaningful conversations about transformation and healing'}
                                </li>
                            </ul>
                        </div>
                        <p style="font-size:14px;color:#a78bfa;font-style:italic;margin-top:20px;">
                            "${t.comp_share_quote || 'Together, we are creating a symphony of divine resonance.'}"
                        </p>
                    </div>
                `
            },
            {
                id: 'credits',
                icon: '📜',
                title: t.comp_credits_title || 'Credits & Sources',
                content: `
                    <div style="line-height:1.8;text-align:left;max-width:640px;margin:0 auto;">
                        <h4 style="color:#fbbf24;text-align:center;font-size:20px;margin-bottom:15px;">${t.comp_credits_title || 'Credits & Sources'}</h4>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.08),rgba(139,92,246,0.08));border-radius:14px;padding:20px;margin:20px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:15px;">📚 ${t.comp_credits_research_title || 'Research & Inspiration'}</h5>
                            <div style="margin-bottom:15px;">
                                <b style="color:#fbbf24;">${t.comp_credits_gematria || 'Gematria & Sacred Mathematics:'}</b><br>
                                <span style="color:#ffffff;">${t.comp_credits_gematria_desc || 'Ancient Hebrew numerology traditions, with special reference to Genesis 1:1 analysis and the mathematical relationships between 37, 73, and 2701.'}</span>
                            </div>
                            <div style="margin-bottom:15px;">
                                <b style="color:#fbbf24;">${t.comp_credits_frequency || 'Frequency Healing Research:'}</b><br>
                                <span style="color:#ffffff;">${t.comp_credits_frequency_desc || 'Studies on sound therapy, binaural beats, and the effects of low-frequency vibrations on human physiology and consciousness.'}</span>
                            </div>
                            <div>
                                <b style="color:#fbbf24;">${t.comp_credits_geometry || 'Sacred Geometry:'}</b><br>
                                <span style="color:#ffffff;">${t.comp_credits_geometry_desc || 'The golden ratio, Fibonacci sequences, and geometric patterns found in nature and ancient architecture.'}</span>
                            </div>
                        </div>
                        <div style="background:linear-gradient(135deg,rgba(251,191,36,0.08),rgba(139,92,246,0.08));border-radius:14px;padding:20px;margin:20px 0;">
                            <h5 style="color:#fbbf24;margin-bottom:15px;">🙏 ${t.comp_credits_acknowledgments || 'Acknowledgments'}</h5>
                            <div style="margin-bottom:15px;">
                                <span style="color:#ffffff;">${t.comp_credits_created || 'Created with love and divine inspiration.'}</span>
                            </div>
                            <div>
                                <span style="color:#ffffff;">${t.comp_credits_research || 'Based on research into biblical mathematics, gematria, and frequency healing traditions.'}</span>
                            </div>
                        </div>
                        <p style="text-align:center;color:#a78bfa;font-style:italic;margin-top:20px;">
                            ${t.comp_credits_gratitude || 'With gratitude for the divine mathematics that connects us all.'}
                        </p>
                        
                        <!-- Buy Me a Coffee Section -->
                        <div style="background:linear-gradient(135deg,rgba(255,221,51,0.15),rgba(251,191,36,0.1));border-radius:14px;padding:25px;margin:25px 0;text-align:center;border:2px solid rgba(251,191,36,0.3);">
                            <h5 style="color:#fbbf24;margin-bottom:12px;font-size:18px;">❤️ Support This Project</h5>
                            <p style="color:#ffffff;font-size:14px;margin-bottom:15px;line-height:1.6;">If Genesis Frequencies has helped you, consider buying me a coffee to support continued development!</p>
                            <a href="https://buymeacoffee.com/quantummerlin" target="_blank" rel="noopener noreferrer" style="display:inline-block;background:linear-gradient(135deg,#FFDD00,#fbbf24);color:#1a0033;padding:12px 28px;border-radius:25px;font-weight:700;font-size:16px;text-decoration:none;box-shadow:0 4px 15px rgba(251,191,36,0.4);transition:transform 0.2s;">☕ Buy Me a Coffee</a>
                        </div>
                        
                        <!-- Explore More from Quantum Merlin -->
                        <div style="background:linear-gradient(135deg,rgba(139,92,246,0.15),rgba(168,85,247,0.1));border-radius:14px;padding:25px;margin:25px 0;text-align:center;border:2px solid rgba(139,92,246,0.3);">
                            <h5 style="color:#a78bfa;margin-bottom:12px;font-size:18px;">🔮 Want to explore more from Quantum Merlin?</h5>
                            <p style="color:#ffffff;font-size:14px;margin-bottom:15px;line-height:1.6;">Visit Quantum Merlin for all current and upcoming tools!</p>
                            <a href="https://quantummerlin.com" target="_blank" rel="noopener noreferrer" style="display:inline-block;background:linear-gradient(135deg,#8b5cf6,#a78bfa);color:#ffffff;padding:12px 28px;border-radius:25px;font-weight:700;font-size:16px;text-decoration:none;box-shadow:0 4px 15px rgba(139,92,246,0.4);transition:transform 0.2s;">✨ Visit QuantumMerlin.com</a>
                        </div>
                    </div>
                `
            }
        ];
        }
        
        // Keep backward compatibility - create static reference that gets updated
        let instructionsSections = getInstructionsSections();
        
        // ============================================
        // COMPREHENSIVE ACHIEVEMENT SYSTEM
        // ============================================

        // Enhanced user progress data model
        let userProgress = {
            // Session tracking
            totalSessions: 0,
            totalSeconds: 0,
            sessionHistory: [], // Array of session objects
            lastSessionDate: null,
            currentStreak: 0,
            longestStreak: 0,
            streakFreezeAvailable: true,
            streakFreezesUsed: 0,

            // Achievement tracking
            achievements: new Set(), // Set of unlocked achievement IDs
            achievementUnlockDates: {}, // achievementId -> unlock date

            // XP and leveling
            experiencePoints: 0,
            level: 1,

            // Frequency exploration
            frequenciesUsed: new Set(), // Set of frequency IDs used
            categoriesExplored: new Set(), // Set of categories explored
            trackPlayCounts: {}, // trackId -> play count

            // Special actions
            waterChargingSessions: 0,
            intentionsSet: 0,
            appShares: 0,
            wavExports: 0,
            installedPWA: false,
            journalEntries: 0,

            // Premium features
            isPremium: false,
            premiumDiscount: 0,
            unlockedTracks: [],

            // Daily challenges
            dailyChallengesCompleted: {}, // date -> challengeId

            // Legacy compatibility
            totalTime: 0, // Keep for backward compatibility
            lastSession: null,
            notes: [],
            actions: new Set()
        };

        // Sacred achievement definitions with spiritual numerology
        const ACHIEVEMENTS = {
            // AWAKENING - Foundation of the spiritual journey
            trinityThreshold: {
                id: 'trinityThreshold',
                name: '✨ Trinity Threshold',
                description: 'Complete your first 3 sessions - the sacred trinity of awakening',
                category: 'awakening',
                xpReward: 100,
                checkUnlock: () => userProgress.totalSessions >= 3
            },
            sevenFoldBlessing: {
                id: 'sevenFoldBlessing',
                name: '⭐ Sevenfold Blessing',
                description: 'Reach 7 sessions - the number of divine completion',
                category: 'awakening',
                xpReward: 150,
                checkUnlock: () => userProgress.totalSessions >= 7
            },
            tenthGate: {
                id: 'tenthGate',
                name: '🎯 Tenth Gate',
                description: 'Pass through the 10th session - gateway to higher consciousness',
                category: 'awakening',
                xpReward: 200,
                checkUnlock: () => userProgress.totalSessions >= 10
            },

            // SESSION MILESTONES - Sacred numbers in spiritual tradition
            quarterCentury: {
                id: 'quarterCentury',
                name: '⭐ Quarter Century',
                description: '25 sessions completed - a quarter century of spiritual practice',
                category: 'sessions',
                xpReward: 300,
                checkUnlock: () => userProgress.totalSessions >= 25
            },
            mirrorOfForm: {
                id: 'mirrorOfForm',
                name: '🪞 Mirror of Form',
                description: '37 sessions - the mirror that reflects divine form',
                category: 'sessions',
                xpReward: 400,
                checkUnlock: () => userProgress.totalSessions >= 37
            },
            fiftySteps: {
                id: 'fiftySteps',
                name: '🏅 Fifty Steps',
                description: '50 sessions - fifty steps toward enlightenment',
                category: 'sessions',
                xpReward: 500,
                checkUnlock: () => userProgress.totalSessions >= 50
            },
            mirrorOfSpirit: {
                id: 'mirrorOfSpirit',
                name: '🔮 Mirror of Spirit',
                description: '73 sessions - the mirror that reveals divine spirit',
                category: 'sessions',
                xpReward: 600,
                checkUnlock: () => userProgress.totalSessions >= 73
            },
            centuryGuardian: {
                id: 'centuryGuardian',
                name: '🏆 Century Guardian',
                description: '100 sessions - guardian of a century of sacred practice',
                category: 'sessions',
                xpReward: 750,
                checkUnlock: () => userProgress.totalSessions >= 100
            },
            sacredGateway108: {
                id: 'sacredGateway108',
                name: '🌟 Sacred Gateway 108',
                description: '108 sessions - the sacred gateway to enlightenment',
                category: 'sessions',
                xpReward: 1000,
                legendary: true,
                checkUnlock: () => userProgress.totalSessions >= 108
            },

            // TIME MILESTONES - Sacred time investments
            fiveMinuteMark: {
                id: 'fiveMinuteMark',
                name: '⏰ Five Minute Mark',
                description: '5 minutes of sacred listening time',
                category: 'time',
                xpReward: 50,
                checkUnlock: () => userProgress.totalSeconds >= 300
            },
            halfHourDevotee: {
                id: 'halfHourDevotee',
                name: '⏱️ Half Hour Devotee',
                description: '30 minutes dedicated to frequency healing',
                category: 'time',
                xpReward: 150,
                checkUnlock: () => userProgress.totalSeconds >= 1800
            },
            hourMaster: {
                id: 'hourMaster',
                name: '⏰ Hour Master',
                description: '1 hour of transformative frequency experience',
                category: 'time',
                xpReward: 250,
                checkUnlock: () => userProgress.totalSeconds >= 3600
            },
            fiveHourPilgrim: {
                id: 'fiveHourPilgrim',
                name: '🕓 Five Hour Pilgrim',
                description: '5 hours on the sacred frequency pilgrimage',
                category: 'time',
                xpReward: 400,
                checkUnlock: () => userProgress.totalSeconds >= 18000
            },
            tenHourSage: {
                id: 'tenHourSage',
                name: '🕛 Ten Hour Sage',
                description: '10 hours of wisdom through frequency resonance',
                category: 'time',
                xpReward: 600,
                checkUnlock: () => userProgress.totalSeconds >= 36000
            },

            // STREAK ACHIEVEMENTS - Consecutive spiritual practice
            threeDayInitiate: {
                id: 'threeDayInitiate',
                name: '🔥 Three Day Initiate',
                description: '3 consecutive days of spiritual practice',
                category: 'streaks',
                xpReward: 100,
                checkUnlock: () => userProgress.currentStreak >= 3
            },
            sevenDaySeeker: {
                id: 'sevenDaySeeker',
                name: '🔥 Seven Day Seeker',
                description: '7 consecutive days - the sacred week of creation',
                category: 'streaks',
                xpReward: 200,
                checkUnlock: () => userProgress.currentStreak >= 7
            },
            twoWeekChampion: {
                id: 'twoWeekChampion',
                name: '🔥 Two Week Champion',
                description: '14 consecutive days of unwavering commitment',
                category: 'streaks',
                xpReward: 300,
                checkUnlock: () => userProgress.currentStreak >= 14
            },
            twentyOneDayTransformer: {
                id: 'twentyOneDayTransformer',
                name: '🔥 21 Day Transformer',
                description: '21 days - the sacred cycle of transformation',
                category: 'streaks',
                xpReward: 400,
                checkUnlock: () => userProgress.currentStreak >= 21
            },
            monthMaster: {
                id: 'monthMaster',
                name: '🔥 Month Master',
                description: '30 consecutive days of spiritual mastery',
                category: 'streaks',
                xpReward: 500,
                checkUnlock: () => userProgress.currentStreak >= 30
            },
            fortyDayPilgrim: {
                id: 'fortyDayPilgrim',
                name: '🌄 Forty Day Pilgrim',
                description: '40 days - the sacred pilgrimage of purification',
                category: 'streaks',
                xpReward: 600,
                checkUnlock: () => userProgress.currentStreak >= 40
            },
            seventyThreeDayMystic: {
                id: 'seventyThreeDayMystic',
                name: '🔮 73 Day Mystic',
                description: '73 consecutive days - mystical mastery achieved',
                category: 'streaks',
                xpReward: 800,
                checkUnlock: () => userProgress.currentStreak >= 73
            },
            oneHundredEightDaySage: {
                id: 'oneHundredEightDaySage',
                name: '🧘 108 Day Sage',
                description: '108 consecutive days - enlightenment embodied',
                category: 'streaks',
                xpReward: 1000,
                legendary: true,
                checkUnlock: () => userProgress.currentStreak >= 108
            },

            // FREQUENCY EXPLORATION - Discovering sacred vibrations
            trinityMaster: {
                id: 'trinityMaster',
                name: '🔱 Trinity Master',
                description: 'Master the sacred Trinity frequencies (37, 73, 2701 Hz)',
                category: 'exploration',
                xpReward: 250,
                checkUnlock: () => (userProgress.trackPlayCounts['genesisCreation'] || 0) >= 10
            },
            solfeggioExplorer: {
                id: 'solfeggioExplorer',
                name: '🎶 Solfeggio Explorer',
                description: 'Explore the ancient Solfeggio healing frequencies',
                category: 'exploration',
                xpReward: 200,
                checkUnlock: () => userProgress.categoriesExplored.has('solfeggio')
            },
            angelWhisperer: {
                id: 'angelWhisperer',
                name: '👼 Angel Whisperer',
                description: 'Connect with divine Angel Number frequencies',
                category: 'exploration',
                xpReward: 200,
                checkUnlock: () => userProgress.categoriesExplored.has('angelNumbers')
            },
            cosmicTraveler: {
                id: 'cosmicTraveler',
                name: '🌌 Cosmic Traveler',
                description: 'Journey through Cosmic & Planetary frequencies',
                category: 'exploration',
                xpReward: 200,
                checkUnlock: () => userProgress.categoriesExplored.has('cosmic')
            },
            frequencyScholar: {
                id: 'frequencyScholar',
                name: '🎓 Frequency Scholar',
                description: 'Explore all sacred frequency categories',
                category: 'exploration',
                xpReward: 400,
                checkUnlock: () => userProgress.categoriesExplored.size >= 5
            },

            // SPECIAL ACTIONS - Sacred rituals and practices
            waterAlchemist: {
                id: 'waterAlchemist',
                name: '💧 Water Alchemist',
                description: 'Charge water with sacred frequencies 3 times',
                category: 'special',
                xpReward: 150,
                checkUnlock: () => userProgress.waterChargingSessions >= 3
            },
            intentionSetter: {
                id: 'intentionSetter',
                name: '🙏 Intention Setter',
                description: 'Set sacred intentions for 10 sessions',
                category: 'special',
                xpReward: 200,
                checkUnlock: () => userProgress.intentionsSet >= 10
            },
            genesisEvangelist: {
                id: 'genesisEvangelist',
                name: '📣 Genesis Evangelist',
                description: 'Share the Genesis experience with 5 friends',
                category: 'special',
                xpReward: 250,
                checkUnlock: () => userProgress.appShares >= 5
            },
            journalKeeper: {
                id: 'journalKeeper',
                name: '📝 Journal Keeper',
                description: 'Record your spiritual journey 10 times',
                category: 'special',
                xpReward: 150,
                checkUnlock: () => userProgress.journalEntries >= 10
            },

            // SYNCHRONICITIES - Divine timing and flow
            morningRitualist: {
                id: 'morningRitualist',
                name: '🌅 Morning Ritualist',
                description: 'Complete 7 sessions before 9 AM',
                category: 'synchronicity',
                xpReward: 300,
                checkUnlock: () => {
                    const morningSessions = userProgress.sessionHistory.filter(s =>
                        parseInt(s.time.split(':')[0]) < 9
                    ).length;
                    return morningSessions >= 7;
                }
            },
            eveningContemplator: {
                id: 'eveningContemplator',
                name: '🌙 Evening Contemplator',
                description: 'Complete 7 sessions after 8 PM',
                category: 'synchronicity',
                xpReward: 300,
                checkUnlock: () => {
                    const eveningSessions = userProgress.sessionHistory.filter(s =>
                        parseInt(s.time.split(':')[0]) >= 20
                    ).length;
                    return eveningSessions >= 7;
                }
            },
            perfectTiming: {
                id: 'perfectTiming',
                name: '✨ Perfect Timing',
                description: 'Complete sessions at exactly 11:11 or 22:22',
                category: 'synchronicity',
                xpReward: 500,
                special: true,
                checkUnlock: () => {
                    return userProgress.sessionHistory.some(s => {
                        const [hours, minutes] = s.time.split(':').map(Number);
                        return (hours === 11 && minutes === 11) || (hours === 22 && minutes === 22);
                    });
                }
            },

            // MASTERY - Ultimate spiritual achievements
            levelApprentice: {
                id: 'levelApprentice',
                name: '⭐ Level 3: Apprentice',
                description: 'Reach spiritual apprentice level',
                category: 'mastery',
                xpReward: 100,
                checkUnlock: () => userProgress.level >= 3
            },
            levelSeeker: {
                id: 'levelSeeker',
                name: '🌟 Level 7: Seeker',
                description: 'Attain seeker level in your spiritual journey',
                category: 'mastery',
                xpReward: 200,
                checkUnlock: () => userProgress.level >= 7
            },
            levelAwakened: {
                id: 'levelAwakened',
                name: '✨ Level 12: Awakened',
                description: 'Awaken to higher spiritual consciousness',
                category: 'mastery',
                xpReward: 300,
                checkUnlock: () => userProgress.level >= 12
            },
            levelPractitioner: {
                id: 'levelPractitioner',
                name: '🔮 Level 21: Practitioner',
                description: 'Master practitioner of sacred frequencies',
                category: 'mastery',
                xpReward: 400,
                checkUnlock: () => userProgress.level >= 21
            },
            levelMirrorOfForm: {
                id: 'levelMirrorOfForm',
                name: '🪞 Level 30: Mirror of Form',
                description: 'Reflect divine form through your practice',
                category: 'mastery',
                xpReward: 500,
                checkUnlock: () => userProgress.level >= 30
            },
            levelMirrorOfSpirit: {
                id: 'levelMirrorOfSpirit',
                name: '🔮 Level 37: Mirror of Spirit',
                description: 'Reflect divine spirit in all your actions',
                category: 'mastery',
                xpReward: 600,
                checkUnlock: () => userProgress.level >= 37
            },
            levelAdept: {
                id: 'levelAdept',
                name: '💫 Level 50: Adept',
                description: 'True adept of frequency mastery',
                category: 'mastery',
                xpReward: 750,
                checkUnlock: () => userProgress.level >= 50
            },
            levelAscendedMaster: {
                id: 'levelAscendedMaster',
                name: '👑 Level 108: Ascended Master',
                description: 'Ascended master of sacred frequencies',
                category: 'mastery',
                xpReward: 1500,
                legendary: true,
                checkUnlock: () => userProgress.level >= 108
            },

            // LEGENDARY ACHIEVEMENTS - Ultimate spiritual milestones
            genesisMaster: {
                id: 'genesisMaster',
                name: '🏆 Genesis Master',
                description: 'Unlock all achievements in the Genesis system',
                category: 'mastery',
                xpReward: 2000,
                legendary: true,
                checkUnlock: () => userProgress.achievements.size >= Object.keys(ACHIEVEMENTS).length - 1 // -1 to avoid self-reference
            },
            eternalFlame: {
                id: 'eternalFlame',
                name: '🔥 Eternal Flame',
                description: 'Maintain a 365-day streak of spiritual practice',
                category: 'mastery',
                xpReward: 3000,
                legendary: true,
                hidden: true,
                checkUnlock: () => userProgress.currentStreak >= 365
            },
            
            // LICENSE ACHIEVEMENTS - Unlocking premium tiers
            premiumUnlock: {
                id: 'premiumUnlock',
                name: '⭐ Premium Ascension',
                description: 'Unlock Premium and ascend to a new level of frequency mastery',
                category: 'special',
                xpReward: 500,
                checkUnlock: () => {
                    try { return localStorage.getItem('gfgn_license_tier') === 'premium' || localStorage.getItem('gfgn_license_tier') === 'ultimate'; } catch(e) { return false; }
                }
            },
            ultimateUnlock: {
                id: 'ultimateUnlock',
                name: '👑 Ultimate Enlightenment',
                description: 'Achieve Ultimate status and unlock the full power of Genesis Frequencies',
                category: 'special',
                xpReward: 1000,
                legendary: true,
                checkUnlock: () => {
                    try { return localStorage.getItem('gfgn_license_tier') === 'ultimate'; } catch(e) { return false; }
                }
            }
        };

        // Session recording with real streak tracking
        function recordSession(duration, frequencies = [], trackId = null, category = null, metadata = {}) {
            const session = {
                id: generateUUID(),
                timestamp: Date.now(),
                date: new Date().toISOString().split('T')[0],
                time: new Date().toTimeString().split(' ')[0],
                duration: duration,
                frequencies: frequencies,
                trackId: trackId,
                category: category,
                ...metadata
            };

            // Update basic stats
            userProgress.totalSessions++;
            userProgress.totalSeconds += duration;
            userProgress.totalTime = userProgress.totalSeconds; // Legacy compatibility
            userProgress.lastSession = new Date().toISOString();
            userProgress.lastSessionDate = session.date;

            // Track frequencies and categories
            frequencies.forEach(freq => userProgress.frequenciesUsed.add(freq));
            if (category) userProgress.categoriesExplored.add(category);
            if (trackId) {
                userProgress.trackPlayCounts[trackId] = (userProgress.trackPlayCounts[trackId] || 0) + 1;
            }

            // Track special actions
            if (metadata.intentionSet) userProgress.intentionsSet++;
            if (metadata.waterCharging) userProgress.waterChargingSessions++;
            if (metadata.journalEntry) userProgress.journalEntries++;

            // Update streak
            updateStreak(session.date);

            // Add to history
            userProgress.sessionHistory.push(session);

            // Award XP for session
            const baseXP = Math.floor(duration / 60) + 10; // 10 XP base + 1 per minute
            awardXP(baseXP);

            // Check achievements
            checkAllAchievements();

            // Check daily challenge
            checkDailyChallenge(session);

            // Save progress
            saveProgress();

            return session;
        }

        // Real consecutive day streak calculation
        function updateStreak(today) {
            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            const yesterdayStr = yesterday.toISOString().split('T')[0];

            if (userProgress.lastSessionDate === yesterdayStr) {
                // Consecutive day - increment streak
                userProgress.currentStreak++;
                if (userProgress.currentStreak > userProgress.longestStreak) {
                    userProgress.longestStreak = userProgress.currentStreak;
                }
            } else if (userProgress.lastSessionDate !== today) {
                // Streak broken
                if (userProgress.currentStreak > 0) {
                    showStreakBrokenModal(userProgress.currentStreak);
                }
                userProgress.currentStreak = 1; // Start new streak
            }
            // If same day, keep current streak
        }

        // Check all achievements
        function checkAllAchievements() {
            let newAchievements = [];

            for (const achievement of Object.values(ACHIEVEMENTS)) {
                if (!userProgress.achievements.has(achievement.id) && achievement.checkUnlock()) {
                    userProgress.achievements.add(achievement.id);
                    userProgress.achievementUnlockDates[achievement.id] = new Date().toISOString();
                    newAchievements.push(achievement);
                }
            }

            // Show celebrations for new achievements
            if (newAchievements.length > 0) {
                showAchievementCelebration(newAchievements);
            }

            return newAchievements;
        }

        // ============================================
        // LEVELING SYSTEM - 7 Spiritual Journey Stages
        // ============================================

        // The 7 Stages of the Spiritual Journey
        const SPIRITUAL_STAGES = {
            1: { name: 'Awakening', icon: 'sunrise', color: '#6b7280', minLevel: 1 },
            2: { name: 'Seeker', icon: 'compass', color: '#22c55e', minLevel: 7 },
            3: { name: 'Initiate', icon: 'flame', color: '#3b82f6', minLevel: 21 },
            4: { name: 'Practitioner', icon: 'target', color: '#a78bfa', minLevel: 37 },
            5: { name: 'Adept', icon: 'zap', color: '#f59e0b', minLevel: 50 },
            6: { name: 'Master', icon: 'crown', color: '#fbbf24', minLevel: 73 },
            7: { name: 'Genesis Master', icon: 'sparkles', color: '#fbbf24', minLevel: 108 }
        };

        const LEVEL_TITLES = {
            1: 'Awakening',
            3: 'Awakening II',
            7: 'Seeker',
            12: 'Seeker II',
            21: 'Initiate',
            30: 'Initiate II',
            37: 'Practitioner',
            40: 'Practitioner II',
            50: 'Adept',
            60: 'Adept II',
            73: 'Master',
            80: 'Master II',
            90: 'Master III',
            100: 'Genesis Master',
            108: 'Genesis Master ✨'
        };

        function getSpiritualStage(level) {
            if (level >= 108) return SPIRITUAL_STAGES[7];
            if (level >= 73) return SPIRITUAL_STAGES[6];
            if (level >= 50) return SPIRITUAL_STAGES[5];
            if (level >= 37) return SPIRITUAL_STAGES[4];
            if (level >= 21) return SPIRITUAL_STAGES[3];
            if (level >= 7) return SPIRITUAL_STAGES[2];
            return SPIRITUAL_STAGES[1];
        }

        function calculateLevel(totalXP) {
            let level = 1;
            let xpRequired = 0;

            while (xpRequired <= totalXP && level < 108) {
                level++;
                xpRequired += xpForLevel(level);
            }

            return level;
        }

        function xpForLevel(level) {
            // Exponential curve that reaches level 108 at ~500,000 XP
            return Math.floor(100 * Math.pow(1.12, level - 1));
        }

        function xpForNextLevel(currentLevel) {
            return xpForLevel(currentLevel + 1);
        }

        function xpProgressInCurrentLevel(totalXP, currentLevel) {
            // Calculate XP accumulated in current level
            let xpForCurrentLevel = 0;
            for (let i = 1; i <= currentLevel; i++) {
                xpForCurrentLevel += xpForLevel(i);
            }

            const xpIntoLevel = totalXP - xpForCurrentLevel;
            const xpNeededForNext = xpForLevel(currentLevel + 1);

            return {
                current: xpIntoLevel,
                needed: xpNeededForNext,
                percentage: Math.floor((xpIntoLevel / xpNeededForNext) * 100)
            };
        }

        function getLevelTitle(level) {
            // Achievement-based titles that progress with usage
            const totalSessions = userProgress.totalSessions || 0;
            const streak = userProgress.currentStreak || 0;
            const achievementsUnlocked = Object.keys(userProgress.achievements || {}).length;
            const t = translations.en;
            
            // Titles based on journey progress (translated)
            if (achievementsUnlocked >= 20 || totalSessions >= 100) return t.titleGenesisMaster || 'Genesis Master';
            if (achievementsUnlocked >= 15 || totalSessions >= 73) return t.titleFrequencySage || 'Frequency Sage';
            if (achievementsUnlocked >= 10 || totalSessions >= 50) return t.titleSacredHarmonist || 'Sacred Harmonist';
            if (streak >= 21 || totalSessions >= 37) return t.titleDivineResonator || 'Divine Resonator';
            if (achievementsUnlocked >= 5 || totalSessions >= 21) return t.titleTrinitySeeker || 'Trinity Seeker';
            if (streak >= 7 || totalSessions >= 10) return t.titleFrequencyExplorer || 'Frequency Explorer';
            if (totalSessions >= 3) return t.titleSacredInitiate || 'Sacred Initiate';
            return t.titleSacredListener || 'Sacred Listener';
        }

        function awardXP(amount) {
            // XP system removed - just save progress
            saveProgress();
        }

        // ============================================
        // SPECIAL UNLOCKS
        // ============================================

        function handleSpecialUnlock(unlockId) {
            const unlocks = {
                'specialTrack_7DayAbundance': () => {
                    unlockTrack('7DayAbundance');
                    showNotification('🎵 New Track Unlocked: 7-Day Abundance!');
                },
                'badge_HabitMaster': () => {
                    showNotification('🏅 Special Badge Earned: Habit Master!');
                },
                'specialTrack_40DaysNights': () => {
                    unlockTrack('40DaysNights');
                    showNotification('🎵 New Track Unlocked: 40 Days & Nights!');
                },
                'specialTrack_73HzPure': () => {
                    unlockTrack('73HzPure');
                    showNotification('🎵 New Track Unlocked: 73 Hz Pure Tone!');
                },
                'specialTrack_Ascension': () => {
                    unlockTrack('Ascension');
                    showNotification('🎵 New Track Unlocked: Ascension!');
                },
                'premiumDiscount_50Percent': () => {
                    userProgress.premiumDiscount = 0.5;
                    showNotification('🎁 Premium Unlock: 50% Discount Available!');
                }
            };

            if (unlocks[unlockId]) {
                unlocks[unlockId]();
            }
        }

        // ============================================
        // UI COMPONENTS
        // ============================================

        function showAchievementCelebration(achievements) {
            // Only show one at a time, queue the rest
            const achievement = achievements[0];

            const modal = document.createElement('div');
            modal.className = 'achievement-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.85);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            `;

            modal.innerHTML = `
                <div class="achievement-popup" style="
                    background: linear-gradient(135deg, rgba(139,92,246,0.95), rgba(251,191,36,0.95));
                    border-radius: 20px;
                    padding: 40px;
                    max-width: 500px;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(251,191,36,0.5);
                    animation: scaleIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                ">
                    <div class="achievement-icon" style="
                        font-size: 80px;
                        margin-bottom: 20px;
                        animation: bounce 1s infinite;
                    ">${achievement.name.split(' ')[0]}</div>

                    <h2 style="
                        color: #fff;
                        font-size: 28px;
                        margin-bottom: 10px;
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
                    ">Achievement Unlocked!</h2>

                    <h3 style="
                        color: #fff;
                        font-size: 22px;
                        margin-bottom: 15px;
                        font-weight: 600;
                    ">${achievement.name}</h3>

                    <p style="
                        color: rgba(255,255,255,0.95);
                        font-size: 16px;
                        line-height: 1.6;
                        margin-bottom: 25px;
                    ">${achievement.description}</p>

                    ${achievement.unlocks ? `
                        <div class="unlock-bonus" style="
                            background: rgba(255,255,255,0.15);
                            border-radius: 12px;
                            padding: 15px;
                            margin-bottom: 25px;
                            color: #fff;
                            font-size: 15px;
                        ">
                            🎁 Bonus Unlocked: ${achievement.unlocks.replace(/_/g, ' ')}
                        </div>
                    ` : ''}

                    ${achievement.special ? `
                        <div style="
                            color: #fbbf24;
                            font-size: 14px;
                            margin-bottom: 20px;
                            font-weight: 600;
                        ">
                            ⭐ SPECIAL ACHIEVEMENT ⭐
                        </div>
                    ` : ''}

                    ${achievement.legendary ? `
                        <div style="
                            color: #fbbf24;
                            font-size: 16px;
                            margin-bottom: 20px;
                            font-weight: 700;
                            text-shadow: 0 0 10px rgba(251,191,36,0.8);
                        ">
                            👑 LEGENDARY ACHIEVEMENT 👑
                        </div>
                    ` : ''}

                    <button onclick="closeAchievementModal()" style="
                        background: linear-gradient(90deg, #8b5cf6, #6b46c1);
                        color: #fff;
                        border: none;
                        border-radius: 30px;
                        padding: 15px 40px;
                        font-size: 16px;
                        font-weight: 600;
                        cursor: pointer;
                        box-shadow: 0 4px 15px rgba(139,92,246,0.4);
                        transition: transform 0.2s;
                    " onmouseover="this.style.transform='scale(1.05)'"
                       onmouseout="this.style.transform='scale(1)'">
                        Continue Your Journey ➡️
                    </button>
                </div>
            `;

            document.body.appendChild(modal);

            // Confetti celebration
            if (typeof confetti !== 'undefined') {
                confetti({
                    particleCount: achievement.legendary ? 200 : 100,
                    spread: achievement.legendary ? 100 : 70,
                    origin: { y: 0.6 },
                    colors: ['#fbbf24', '#8b5cf6', '#fff']
                });
            }

            // Queue remaining achievements
            if (achievements.length > 1) {
                setTimeout(() => {
                    showAchievementCelebration(achievements.slice(1));
                }, 3000);
            }
        }

        function closeAchievementModal() {
            const modal = document.querySelector('.achievement-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => modal.remove(), 300);
            }
        }

        function showLevelUpModal(level, title) {
            const modal = document.createElement('div');
            modal.className = 'level-up-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10001;
                animation: fadeIn 0.3s ease;
            `;

            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #8b5cf6, #6b46c1);
                    border-radius: 20px;
                    padding: 50px;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(139,92,246,0.6);
                    animation: scaleIn 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
                ">
                    <div style="font-size: 100px; margin-bottom: 20px;">🏆</div>
                    <h2 style="color: #fbbf24; font-size: 36px; margin-bottom: 10px; font-weight: 700;">
                        LEVEL UP!
                    </h2>
                    <div style="color: #fff; font-size: 48px; font-weight: 700; margin-bottom: 15px;">
                        Level ${level}
                    </div>
                    <div style="color: #fbbf24; font-size: 24px; margin-bottom: 30px; font-style: italic;">
                        ${title}
                    </div>
                    <p style="color: rgba(255,255,255,0.9); font-size: 16px; margin-bottom: 30px;">
                        Your spiritual journey deepens with each level
                    </p>
                    <button onclick="closeLevelUpModal()" style="
                        background: linear-gradient(90deg, #fbbf24, #f59e0b);
                        color: #1a1625;
                        border: none;
                        border-radius: 30px;
                        padding: 15px 40px;
                        font-size: 16px;
                        font-weight: 700;
                        cursor: pointer;
                        box-shadow: 0 4px 15px rgba(251,191,36,0.4);
                    ">
                        Continue ➡️
                    </button>
                </div>
            `;

            document.body.appendChild(modal);

            if (typeof confetti !== 'undefined') {
                confetti({
                    particleCount: 150,
                    spread: 120,
                    origin: { y: 0.5 },
                    colors: ['#fbbf24', '#8b5cf6', '#fff'],
                    startVelocity: 45
                });
            }
        }

        function closeLevelUpModal() {
            const modal = document.querySelector('.level-up-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => modal.remove(), 300);
            }
        }

        function showStreakBrokenModal(oldStreak) {
            const modal = document.createElement('div');
            modal.className = 'streak-broken-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.85);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 10000;
                animation: fadeIn 0.3s ease;
            `;

            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, rgba(75,0,130,0.95), rgba(128,0,128,0.95));
                    border-radius: 20px;
                    padding: 40px;
                    max-width: 500px;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(128,0,128,0.5);
                ">
                    <div style="font-size: 80px; margin-bottom: 20px;">🎉</div>
                    <h2 style="color: #fbbf24; font-size: 28px; margin-bottom: 15px;">
                        Streak Broken
                    </h2>
                    <p style="color: #fff; font-size: 18px; margin-bottom: 20px;">
                        Your ${oldStreak}-day journey has paused
                    </p>
                    <p style="color: rgba(255,255,255,0.8); font-size: 15px; line-height: 1.6; margin-bottom: 30px;">
                        Every master has stumbled. What matters is rising again.<br>
                        Your longest streak (${userProgress.longestStreak} days) remains forever.
                    </p>
                    <div style="
                        background: rgba(251,191,36,0.15);
                        border-radius: 12px;
                        padding: 20px;
                        margin-bottom: 25px;
                    ">
                        <p style="color: #fbbf24; font-weight: 600; margin-bottom: 10px;">
                            🌟 Start Fresh
                        </p>
                        <p style="color: #fff; font-size: 14px;">
                            Begin a new streak today. Each day is a new beginning.
                        </p>
                    </div>
                    ${!userProgress.isPremium ? `
                        <div style="
                            background: rgba(139,92,246,0.2);
                            border-radius: 12px;
                            padding: 15px;
                            margin-bottom: 25px;
                        ">
                            <p style="color: #c4b5fd; font-size: 13px;">
                                💎 Premium users get a <b>Streak Freeze</b> to protect their progress
                            </p>
                        </div>
                    ` : ''}
                    <button onclick="closeStreakBrokenModal()" style="
                        background: linear-gradient(90deg, #8b5cf6, #6b46c1);
                        color: #fff;
                        border: none;
                        border-radius: 30px;
                        padding: 15px 40px;
                        font-size: 16px;
                        font-weight: 600;
                        cursor: pointer;
                        box-shadow: 0 4px 15px rgba(139,92,246,0.4);
                    ">
                        Begin Again ➡️
                    </button>
                </div>
            `;

            document.body.appendChild(modal);
        }

        function closeStreakBrokenModal() {
            const modal = document.querySelector('.streak-broken-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => modal.remove(), 300);
            }
        }

        function showStreakFreezModal() {
            showNotification('❄️ Streak Freeze Used! Your streak continues. (Next freeze available next month)');
        }

        // ============================================
        // PROGRESS DASHBOARD UI
        // ============================================

        function renderProgressDashboard() {
            // Calculate achievement progress
            const totalAchievements = Object.keys(ACHIEVEMENTS).length;
            const unlockedAchievements = userProgress.achievements.size;
            const achievementPercentage = Math.floor((unlockedAchievements / totalAchievements) * 100);

            return `
                <div class="progress-dashboard" style="
                    padding: 20px;
                    background: linear-gradient(135deg, rgba(139,92,246,0.1), rgba(251,191,36,0.1));
                    border-radius: 20px;
                    margin: 20px 0;
                ">
                    <!-- Streak Card -->
                    <div class="streak-card" style="
                        background: linear-gradient(135deg, rgba(251,191,36,0.15), rgba(251,191,36,0.05));
                        border: 2px solid rgba(251,191,36,0.3);
                        border-radius: 16px;
                        padding: 25px;
                        margin-bottom: 20px;
                        text-align: center;
                    ">
                        <div style="font-size: 60px; margin-bottom: 10px;">
                            🔥
                        </div>
                        <div style="color: #fbbf24; font-size: 48px; font-weight: 700; margin-bottom: 5px;">
                            ${userProgress.currentStreak}
                        </div>
                        <div style="color: #fff; font-size: 18px; font-weight: 600; margin-bottom: 10px;">
                            Day Streak
                        </div>
                        <div style="color: #a78bfa; font-size: 14px;">
                            Longest: ${userProgress.longestStreak} days 🏆
                        </div>

                        ${userProgress.currentStreak >= 3 ? `
                            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(251,191,36,0.2);">
                                <div style="color: #fbbf24; font-size: 13px; font-weight: 600; margin-bottom: 8px;">
                                    Next Milestone
                                </div>
                                <div style="color: #fff; font-size: 14px;">
                                    ${getNextStreakMilestone(userProgress.currentStreak)}
                                </div>
                            </div>
                        ` : ''}
                    </div>

                    <!-- Stats Grid -->
                    <div style="
                        display: grid;
                        grid-template-columns: repeat(2, 1fr);
                        gap: 15px;
                        margin-bottom: 20px;
                    ">
                        <div class="stat-card" style="
                            background: rgba(139,92,246,0.1);
                            border-radius: 12px;
                            padding: 20px;
                            text-align: center;
                        ">
                            <div style="font-size: 36px; margin-bottom: 8px;">🎧</div>
                            <div style="color: #fbbf24; font-size: 28px; font-weight: 700;">
                                ${userProgress.totalSessions}
                            </div>
                            <div style="color: #a78bfa; font-size: 13px;">Sessions</div>
                        </div>

                        <div class="stat-card" style="
                            background: rgba(139,92,246,0.1);
                            border-radius: 12px;
                            padding: 20px;
                            text-align: center;
                        ">
                            <div style="font-size: 36px; margin-bottom: 8px;">⏱️</div></div>
                            <div style="color: #fbbf24; font-size: 28px; font-weight: 700;">
                                ${Math.floor(userProgress.totalSeconds / 3600)}h
                            </div>
                            <div style="color: #a78bfa; font-size: 13px;">Listening Time</div>
                        </div>

                        <div class="stat-card" style="
                            background: rgba(139,92,246,0.1);
                            border-radius: 12px;
                            padding: 20px;
                            text-align: center;
                        ">
                            <div style="font-size: 36px; margin-bottom: 8px;">🏆</div></div>
                            <div style="color: #fbbf24; font-size: 28px; font-weight: 700;">
                                ${unlockedAchievements}
                            </div>
                            <div style="color: #a78bfa; font-size: 13px;">Achievements</div>
                        </div>

                        <div class="stat-card" style="
                            background: rgba(139,92,246,0.1);
                            border-radius: 12px;
                            padding: 20px;
                            text-align: center;
                        ">
                            <div style="font-size: 36px; margin-bottom: 8px;">🎵</div></div>
                            <div style="color: #fbbf24; font-size: 28px; font-weight: 700;">
                                ${userProgress.frequenciesUsed.size}
                            </div>
                            <div style="color: #a78bfa; font-size: 13px;">Frequencies</div>
                        </div>
                    </div>

                    <!-- Achievement Progress -->
                    <div style="
                        background: rgba(251,191,36,0.1);
                        border-radius: 16px;
                        padding: 25px;
                        margin-bottom: 20px;
                    ">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                            <h3 style="color: #fbbf24; font-size: 18px; margin: 0;">
                                Achievement Progress
                            </h3>
                            <span style="color: #fff; font-weight: 600;">
                                ${unlockedAchievements} / ${totalAchievements}
                            </span>
                        </div>
                        <div style="
                            background: rgba(0,0,0,0.2);
                            border-radius: 20px;
                            height: 16px;
                            overflow: hidden;
                            margin-bottom: 10px;
                        ">
                            <div style="
                                background: linear-gradient(90deg, #fbbf24, #f59e0b);
                                height: 100%;
                                width: ${achievementPercentage}%;
                                border-radius: 20px;
                                transition: width 0.5s ease;
                            "></div>
                        </div>
                        <div style="color: #a78bfa; font-size: 13px; text-align: center;">
                            ${achievementPercentage}% Complete
                        </div>
                    </div>

                    <!-- Quick Actions -->
                    <div style="text-align: center;">
                        <button onclick="showAllAchievements()" style="
                            background: linear-gradient(90deg, #8b5cf6, #6b46c1);
                            color: #fff;
                            border: none;
                            border-radius: 30px;
                            padding: 12px 30px;
                            font-size: 15px;
                            font-weight: 600;
                            cursor: pointer;
                            box-shadow: 0 4px 12px rgba(139,92,246,0.3);
                            margin: 5px;
                        ">
                            View All Achievements ➡️
                        </button>
                    </div>
                </div>
            `;
        }

        function getNextStreakMilestone(currentStreak) {
            const milestones = [7, 14, 21, 30, 40, 73, 108, 365];
            for (const milestone of milestones) {
                if (currentStreak < milestone) {
                    const daysLeft = milestone - currentStreak;
                    return `${milestone} days (${daysLeft} more to go)`;
                }
            }
            return '365 days reached! 👑';
        }

        // ============================================
        // ACHIEVEMENTS DISPLAY
        // ============================================

        function showAllAchievements() {
            const categories = {
                'awakening': { name: 'Awakening', icon: '🌅' },
                'sessions': { name: 'Session Milestones', icon: '🎯' },
                'time': { name: 'Time Milestones', icon: '⏰' },
                'streaks': { name: 'Streak Achievements', icon: '🔥' },
                'exploration': { name: 'Frequency Exploration', icon: '🎵' },
                'special': { name: 'Special Actions', icon: '⭐' },
                'synchronicity': { name: 'Synchronicities', icon: '✨' },
                'mastery': { name: 'Mastery', icon: '🏆' }
            };

            let html = `
                <div class="achievements-modal" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.9);
                    z-index: 10000;
                    overflow-y: auto;
                    padding: 20px;
                ">
                    <div style="max-width: 900px; margin: 0 auto;">
                        <div style="text-align: center; margin-bottom: 30px;">
                            <h2 style="color: #fbbf24; font-size: 32px; margin-bottom: 10px;">
                                🏆 All Achievements
                            </h2>
                            <p style="color: #a78bfa; font-size: 16px;">
                                ${userProgress.achievements.size} /${Object.keys(ACHIEVEMENTS).length} Unlocked
                            </p>
                        </div>
            `;

            for (const [categoryKey, categoryInfo] of Object.entries(categories)) {
                const categoryAchievements = Object.values(ACHIEVEMENTS).filter(a => a.category === categoryKey);
                if (categoryAchievements.length === 0) continue;

                const unlockedInCategory = categoryAchievements.filter(a => userProgress.achievements.has(a.id)).length;

                html += `
                    <div style="margin-bottom: 30px;">
                        <h3 style="color: #fbbf24; font-size: 20px; margin-bottom: 15px;">
                            ${categoryInfo.icon}${categoryInfo.name} (${unlockedInCategory}/${categoryAchievements.length})
                        </h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 15px;">
                `;

                for (const achievement of categoryAchievements) {
                    html += renderAchievementCard(achievement, achievement.id);
                }

                html += `
                        </div>
                    </div>
                `;
            }

            html += `
                        <div style="text-align: center; margin-top: 30px;">
                            <button onclick="closeAllAchievements()" style="
                                background: linear-gradient(90deg, #8b5cf6, #6b46c1);
                                color: #fff;
                                border: none;
                                border-radius: 30px;
                                padding: 15px 40px;
                                font-size: 16px;
                                font-weight: 600;
                                cursor: pointer;
                                box-shadow: 0 4px 12px rgba(139,92,246,0.4);
                            ">
                                Close
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', html);
        }

        function closeAllAchievements() {
            const modal = document.querySelector('.achievements-modal');
            if (modal) modal.remove();
        }

        function getAchievementProgress(achievementId, achievement) {
            const checks = achievement.check(userProgress);
            
            // Define progress calculators for each achievement
            const progressCalculators = {
                // Awakening
                trinityThreshold: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 3) * 100), 100),
                    text: `${userProgress.totalSessions}/3 sessions`
                }),
                
                sevenFoldBlessing: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 7) * 100), 100),
                    text: `${userProgress.totalSessions}/7 sessions`
                }),
                
                tenthGate: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 10) * 100), 100),
                    text: `${userProgress.totalSessions}/10 sessions`
                }),
                
                // Session milestones
                quarterCentury: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 25) * 100), 100),
                    text: `${userProgress.totalSessions}/25 sessions`
                }),
                
                mirrorOfForm: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 37) * 100), 100),
                    text: `${userProgress.totalSessions}/37 sessions`
                }),
                
                fiftySteps: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 50) * 100), 100),
                    text: `${userProgress.totalSessions}/50 sessions`
                }),
                
                mirrorOfSpirit: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 73) * 100), 100),
                    text: `${userProgress.totalSessions}/73 sessions`
                }),
                
                centuryGuardian: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 100) * 100), 100),
                    text: `${userProgress.totalSessions}/100 sessions`
                }),
                
                sacredGateway108: () => ({
                    percentage: Math.min(Math.round((userProgress.totalSessions / 108) * 100), 100),
                    text: `${userProgress.totalSessions}/108 sessions`
                }),
                
                // Time-based
                fiveMinuteMark: () => {
                    const mins = Math.floor(userProgress.totalSeconds / 60);
                    return {
                        percentage: Math.min(Math.round((mins / 5) * 100), 100),
                        text: `${mins}/5 minutes`
                    };
                },
                
                halfHourDevotee: () => {
                    const mins = Math.floor(userProgress.totalSeconds / 60);
                    return {
                        percentage: Math.min(Math.round((mins / 30) * 100), 100),
                        text: `${mins}/30 minutes`
                    };
                },
                
                hourMaster: () => {
                    const hours = Math.floor(userProgress.totalSeconds / 3600);
                    return {
                        percentage: Math.min(hours * 100, 100),
                        text: `${hours}/1 hour`
                    };
                },
                
                fiveHourPilgrim: () => {
                    const hours = Math.floor(userProgress.totalSeconds / 3600);
                    return {
                        percentage: Math.min(Math.round((hours / 5) * 100), 100),
                        text: `${hours}/5 hours`
                    };
                },
                
                tenHourSage: () => {
                    const hours = Math.floor(userProgress.totalSeconds / 3600);
                    return {
                        percentage: Math.min(Math.round((hours / 10) * 100), 100),
                        text: `${hours}/10 hours`
                    };
                },
                
                // Streak-based
                threeDayInitiate: () => {
                    const current = userProgress.currentStreak;
                    const target = 3;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/3 day streak`
                    };
                },
                
                sevenDaySeeker: () => {
                    const current = userProgress.currentStreak;
                    const target = 7;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/7 day streak`
                    };
                },
                
                twoWeekChampion: () => {
                    const current = userProgress.currentStreak;
                    const target = 14;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/14 day streak`
                    };
                },
                
                twentyOneDayTransformer: () => {
                    const current = userProgress.currentStreak;
                    const target = 21;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/21 day streak`
                    };
                },
                
                monthMaster: () => {
                    const current = userProgress.currentStreak;
                    const target = 30;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/30 day streak`
                    };
                },
                
                fortyDayPilgrim: () => {
                    const current = userProgress.currentStreak;
                    const target = 40;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/40 day streak`
                    };
                },
                
                seventyThreeDayMystic: () => {
                    const current = userProgress.currentStreak;
                    const target = 73;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/73 day streak`
                    };
                },
                
                oneHundredEightDaySage: () => {
                    const current = userProgress.currentStreak;
                    const target = 108;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/108 day streak`
                    };
                },
                
                // Exploration-based
                explorer: () => {
                    const current = userProgress.frequenciesUsed.size;
                    const target = 5;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/5 frequencies explored`
                    };
                },
                
                categoryConqueror: () => {
                    const current = userProgress.categoriesExplored.size;
                    const target = 5;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/5 categories explored`
                    };
                },
                
                frequencyMaster: () => {
                    const current = userProgress.frequenciesUsed.size;
                    const target = 20;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/20 unique frequencies`
                    };
                },
                
                // Specialty tracking
                genesisScholar: () => {
                    const current = userProgress.trackPlayCounts?.genesisCreation || 0;
                    const target = 10;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/10 Genesis sessions`
                    };
                },
                
                solfeggioAdept: () => {
                    const counts = userProgress.trackPlayCounts || {};
                    const solfeggioKeys = Object.keys(counts).filter(k => k.includes('solfeggio'));
                    const current = solfeggioKeys.reduce((sum, key) => sum + (counts[key] || 0), 0);
                    const target = 20;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/20 Solfeggio sessions`
                    };
                },
                
                angelWhisperer: () => {
                    const counts = userProgress.trackPlayCounts || {};
                    const angelKeys = Object.keys(counts).filter(k => k.includes('angel'));
                    const current = angelKeys.reduce((sum, key) => sum + (counts[key] || 0), 0);
                    const target = 15;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/15 Angel Number sessions`
                    };
                },
                
                chakraBalancer: () => {
                    const counts = userProgress.trackPlayCounts || {};
                    const chakraKeys = Object.keys(counts).filter(k => k.includes('chakra'));
                    const current = chakraKeys.reduce((sum, key) => sum + (counts[key] || 0), 0);
                    const target = 25;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/25 Chakra sessions`
                    };
                },
                
                // Duration-based
                quickSession: () => ({
                    percentage: userProgress.totalSessions > 0 ? 100 : 0,
                    text: 'Complete any session'
                }),
                
                deepMeditation: () => {
                    const hasSession = userProgress.sessionHistory.some(s => s.duration >= 30);
                    return {
                        percentage: hasSession ? 100 : 0,
                        text: hasSession ? 'Complete!' : 'Meditate for 30+ minutes'
                    };
                },
                
                marathonListener: () => {
                    const hasSession = userProgress.sessionHistory.some(s => s.duration >= 60);
                    return {
                        percentage: hasSession ? 100 : 0,
                        text: hasSession ? 'Complete!' : 'Complete a 60-minute session'
                    };
                },
                
                // Time-based achievements
                earlyBird: () => ({
                    percentage: 0,
                    text: 'Practice before 6 AM'
                }),
                
                nightOwl: () => ({
                    percentage: 0,
                    text: 'Practice after 10 PM'
                }),
                
                midnightMystic: () => ({
                    percentage: 0,
                    text: 'Practice between 11 PM - 1 AM'
                }),
                
                // Special activity achievements
                waterCharger: () => {
                    const current = userProgress.waterChargingSessions || 0;
                    const target = 3;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/3 water charging sessions`
                    };
                },
                
                crystalHealer: () => {
                    const current = userProgress.crystalSessions || 0;
                    const target = 5;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/5 crystal healing sessions`
                    };
                },
                
                intentionSetter: () => {
                    const current = userProgress.intentionsSet || 0;
                    const target = 10;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/10 intentions set`
                    };
                },
                
                reflectiveSoul: () => {
                    const current = userProgress.journalEntries?.length || 0;
                    const target = 10;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/10 journal entries`
                    };
                },
                
                // Social achievements
                shareTheLight: () => {
                    const current = userProgress.appShares || 0;
                    const target = 3;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/3 shares`
                    };
                },
                
                helpOthers: () => {
                    const current = userProgress.referrals?.length || 0;
                    const target = 5;
                    return {
                        percentage: Math.min(Math.round((current / target) * 100), 100),
                        text: `${current}/5 friends referred`
                    };
                }
            };
            
            // Get progress if calculator exists
            if (progressCalculators[achievementId]) {
                return progressCalculators[achievementId]();
            }
            
            // Default: no progress tracking
            return null;
        }

        // ============================================
        // ACHIEVEMENT BADGE ICONS (Lucide-based)
        // ============================================
        
        const ACHIEVEMENT_ICONS = {
            // Awakening category
            trinityThreshold: 'triangle',
            sevenFoldBlessing: 'sparkles',
            tenthGate: 'star',
            
            // Sessions category
            quarterCentury: 'infinity',
            mirrorOfForm: 'gem',
            fiftySteps: 'trending-up',
            mirrorOfSpirit: 'sparkles',
            centuryGuardian: 'crown',
            sacredGateway108: 'door-open',
            
            // Time category
            fiveMinuteMark: 'timer',
            halfHourDevotee: 'clock',
            hourMaster: 'clock',
            fiveHourPilgrim: 'clock',
            tenHourSage: 'clock',
            
            // Streaks category
            threeDayInitiate: 'flame',
            sevenDaySeeker: 'star',
            twoWeekChampion: 'trophy',
            twentyOneDayTransformer: 'refresh-cw',
            monthMaster: 'crown',
            fortyDayPilgrim: 'bird',
            seventyThreeDayMystic: 'gem',
            oneHundredEightDaySage: 'flower-2',
            
            // Exploration category
            trinityMaster: 'triangle',
            solfeggioExplorer: 'heart',
            angelWhisperer: 'bird',
            cosmicTraveler: 'orbit',
            frequencyScholar: 'graduation-cap',
            
            // Special category
            waterAlchemist: 'droplet',
            intentionSetter: 'target',
            genesisEvangelist: 'megaphone',
            journalKeeper: 'book-open',
            
            // Synchronicity category
            morningRitualist: 'sunrise',
            eveningContemplator: 'moon',
            perfectTiming: 'clock',
            
            // Mastery category
            levelApprentice: 'star',
            levelSeeker: 'star',
            levelAwakened: 'sparkles',
            levelPractitioner: 'gem',
            levelMirrorOfForm: 'flip-horizontal',
            levelMirrorOfSpirit: 'star'
        };
        
        function getAchievementIcon(achievementId, size = 48) {
            const iconName = ACHIEVEMENT_ICONS[achievementId] || 'award';
            return `<i data-lucide="${iconName}" style="width:${size}px;height:${size}px;color:#fbbf24;"></i>`;
        }

        // ============================================
        // LOCKED ACHIEVEMENT TEASER SYSTEM
        // ============================================

        function renderAchievementCard(achievement, achievementId) {
            const isUnlocked = userProgress.achievements.has(achievementId);
            const progress = getAchievementProgress(achievementId, achievement);
            const isClose = progress && progress.percentage >= 75; // "Close to unlocking"
            
            // Different display states
            if (isUnlocked) {
                return renderUnlockedAchievement(achievement, achievementId);
            } else if (isClose) {
                return renderAlmostUnlockedAchievement(achievement, achievementId, progress);
            } else if (progress && progress.percentage > 0) {
                return renderInProgressAchievement(achievement, achievementId, progress);
            } else {
                return renderLockedAchievement(achievement, achievementId);
            }
        }

        // ============================================
        // UNLOCKED ACHIEVEMENT (Full Details)
        // ============================================

        function renderUnlockedAchievement(achievement, achievementId) {
            return `
                <div class="achievement-card unlocked" style="
                    background: linear-gradient(135deg, rgba(34,197,94,0.2), rgba(22,163,74,0.2));
                    border: 2px solid #22c55e;
                    border-radius: 16px;
                    padding: 20px;
                    padding-top: 30px;
                    position: relative;
                    overflow: visible;
                    animation: pulse-glow 2s ease-in-out infinite;
                ">
                    <!-- Badges -->
                    ${achievement.legendary ? `
                        <div style="
                            position: absolute;
                            top: -5px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: linear-gradient(90deg, #fbbf24, #f59e0b);
                            color: #1a1625;
                            padding: 6px 16px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                            box-shadow: 0 4px 12px rgba(251,191,36,0.5);
                            z-index: 10;
                        ">LEGENDARY</div>
                    ` : achievement.special ? `
                        <div style="
                            position: absolute;
                            top: -5px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: rgba(139,92,246,0.9);
                            color: #fbbf24;
                            padding: 4px 12px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                        ">SPECIAL</div>
                    ` : ''}

                    <!-- Sparkle effect -->
                    <div style="
                        position: absolute;
                        top: 10px;
                        right: 10px;
                        font-size: 24px;
                        animation: sparkle 1.5s ease-in-out infinite;
                    "><i data-lucide="sparkles" class="lucide-icon icon-gold"></i></div>
                    
                    <!-- Achievement Icon -->
                    <div style="
                        text-align: center;
                        margin-bottom: 15px;
                        filter: drop-shadow(0 0 10px rgba(34,197,94,0.5));
                    ">
                        ${getAchievementIcon(achievementId, 64)}
                    </div>
                    
                    <!-- Achievement Name -->
                    <h4 style="
                        color: #22c55e;
                        font-size: 18px;
                        font-weight: 700;
                        text-align: center;
                        margin-bottom: 10px;
                    ">
                        ${achievement.name}
                    </h4>
                    
                    <!-- Description -->
                    <p style="
                        color: #fff;
                        font-size: 14px;
                        text-align: center;
                        margin-bottom: 15px;
                        line-height: 1.5;
                    ">
                        ${achievement.description}
                    </p>
                    
                    <!-- Unlock Date -->
                    <div style="
                        text-align: center;
                        color: #22c55e;
                        font-size: 13px;
                        font-weight: 600;
                        margin-top: 10px;
                    ">
                        ✅ Unlocked ${getUnlockDate(achievementId)}
                    </div>
                </div>
            `;
        }

        // ============================================
        // ALMOST UNLOCKED (75%+ Progress - HYPE MODE)
        // ============================================

        function renderAlmostUnlockedAchievement(achievement, achievementId, progress) {
            return `
                <div class="achievement-card almost-unlocked" style="
                    background: linear-gradient(135deg, rgba(251,191,36,0.3), rgba(249,115,22,0.3));
                    border: 3px solid #fbbf24;
                    border-radius: 16px;
                    padding: 20px;
                    padding-top: 35px;
                    position: relative;
                    animation: pulse-intense 1s ease-in-out infinite;
                    box-shadow: 0 0 30px rgba(251,191,36,0.4);
                ">
                    <!-- Badges -->
                    ${achievement.legendary ? `
                        <div style="
                            position: absolute;
                            top: -10px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: linear-gradient(90deg, #fbbf24, #f59e0b);
                            color: #1a1625;
                            padding: 4px 12px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                            box-shadow: 0 4px 12px rgba(251,191,36,0.5);
                            z-index: 10;
                        ">LEGENDARY</div>
                    ` : achievement.special ? `
                        <div style="
                            position: absolute;
                            top: -10px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: rgba(139,92,246,0.9);
                            color: #fbbf24;
                            padding: 4px 12px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                            z-index: 10;
                        ">SPECIAL</div>
                    ` : ''}

                    <!-- Pulsing "Almost There" badge -->
                    <div style="
                        position: absolute;
                        top: -5px;
                        right: -5px;
                        background: linear-gradient(135deg, #fbbf24, #f59e0b);
                        color: #1a1625;
                        padding: 6px 14px;
                        border-radius: 0 16px 0 16px;
                        font-size: 11px;
                        font-weight: 900;
                        text-transform: uppercase;
                        letter-spacing: 1px;
                        box-shadow: 0 4px 15px rgba(251,191,36,0.6);
                        animation: shake 0.5s ease-in-out infinite;
                    ">
                        <i data-lucide="flame" style="width:14px;height:14px;display:inline;vertical-align:middle;"></i> SO CLOSE!
                    </div>
                    
                    <!-- Partially revealed icon -->
                    <div style="
                        text-align: center;
                        margin-bottom: 15px;
                        position: relative;
                        filter: brightness(1.5) drop-shadow(0 0 15px rgba(251,191,36,0.8));
                    ">
                        ${getAchievementIcon(achievementId, 64)}
                        
                        <!-- Shine effect overlay -->
                        <div style="
                            position: absolute;
                            top: 0;
                            left: 0;
                            right: 0;
                            bottom: 0;
                            background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.3) 50%, transparent 70%);
                            animation: shine 2s infinite;
                        "></div>
                    </div>
                    
                    <!-- Achievement Name (Visible) -->
                    <h4 style="
                        color: #fbbf24;
                        font-size: 18px;
                        font-weight: 700;
                        text-align: center;
                        margin-bottom: 10px;
                        text-shadow: 0 0 10px rgba(251,191,36,0.5);
                    ">
                        ${achievement.name}
                    </h4>
                    
                    <!-- Description (Visible) -->
                    <p style="
                        color: #fff;
                        font-size: 14px;
                        text-align: center;
                        margin-bottom: 15px;
                        line-height: 1.5;
                    ">
                        ${achievement.description}
                    </p>
                    
                    <!-- Dramatic Progress Bar -->
                    <div style="margin-bottom: 15px;">
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 8px;
                        ">
                            <span style="color: #fbbf24; font-size: 13px; font-weight: 600;">
                                Almost there!
                            </span>
                            <span style="color: #fff; font-size: 16px; font-weight: 700;">
                                ${progress.percentage}%
                            </span>
                        </div>
                        <div style="
                            background: rgba(0,0,0,0.4);
                            border-radius: 20px;
                            height: 16px;
                            overflow: hidden;
                            position: relative;
                        ">
                            <div style="
                                background: linear-gradient(90deg, #fbbf24, #f59e0b, #fbbf24);
                                background-size: 200% 100%;
                                height: 100%;
                                width: ${progress.percentage}%;
                                border-radius: 20px;
                                animation: gradient-shift 2s ease infinite;
                                box-shadow: 0 0 20px rgba(251,191,36,0.8);
                            "></div>
                        </div>
                        <div style="
                            text-align: center;
                            color: #a78bfa;
                            font-size: 12px;
                            margin-top: 6px;
                        ">
                            ${progress.text}
                        </div>
                    </div>
                    
                    <!-- Motivational Message -->
                    <div style="
                        text-align: center;
                        background: linear-gradient(90deg, rgba(251,191,36,0.3), rgba(249,115,22,0.3));
                        color: #fbbf24;
                        padding: 12px 16px;
                        border-radius: 20px;
                        font-size: 15px;
                        font-weight: 700;
                        border: 2px solid #fbbf24;
                        box-shadow: 0 0 20px rgba(251,191,36,0.3);
                    ">
                        ✨ Almost there!
                    </div>
                    
                    <!-- Motivational Message -->
                    <div style="
                        text-align: center;
                        color: #fbbf24;
                        font-size: 12px;
                        margin-top: 12px;
                        font-weight: 600;
                        animation: pulse-text 1.5s ease-in-out infinite;
                    ">
                        Keep going! You're about to unlock this! 🔥
                    </div>
                </div>
            `;
        }

        // ============================================
        // IN PROGRESS (1-74% Progress)
        // ============================================

        function renderInProgressAchievement(achievement, achievementId, progress) {
            return `
                <div class="achievement-card in-progress" style="
                    background: linear-gradient(135deg, rgba(139,92,246,0.2), rgba(107,70,193,0.2));
                    border: 2px solid rgba(139,92,246,0.5);
                    border-radius: 16px;
                    padding: 20px;
                    padding-top: 35px;
                    position: relative;
                ">
                    <!-- Badges -->
                    ${achievement.legendary ? `
                        <div style="
                            position: absolute;
                            top: 5px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: linear-gradient(90deg, #fbbf24, #f59e0b);
                            color: #1a1625;
                            padding: 4px 12px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                            box-shadow: 0 4px 12px rgba(251,191,36,0.5);
                            z-index: 10;
                        ">LEGENDARY</div>
                    ` : achievement.special ? `
                        <div style="
                            position: absolute;
                            top: -10px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: rgba(139,92,246,0.9);
                            color: #fbbf24;
                            padding: 4px 12px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                            z-index: 10;
                        ">SPECIAL</div>
                    ` : ''}

                    <!-- In Progress badge -->
                    <div style="
                        position: absolute;
                        top: 10px;
                        right: 10px;
                        background: rgba(139,92,246,0.3);
                        color: #a78bfa;
                        padding: 4px 12px;
                        border-radius: 12px;
                        font-size: 10px;
                        font-weight: 700;
                        text-transform: uppercase;
                        letter-spacing: 0.5px;
                    ">
                        IN PROGRESS
                    </div>
                    
                    <!-- Icon (Slightly dimmed) -->
                    <div style="
                        text-align: center;
                        margin-bottom: 15px;
                        opacity: 0.8;
                        filter: grayscale(20%);
                    ">
                        ${getAchievementIcon(achievementId, 64)}
                    </div>
                    
                    <!-- Achievement Name -->
                    <h4 style="
                        color: #a78bfa;
                        font-size: 18px;
                        font-weight: 700;
                        text-align: center;
                        margin-bottom: 10px;
                    ">
                        ${achievement.name}
                    </h4>
                    
                    <!-- Description -->
                    <p style="
                        color: #d1d5db;
                        font-size: 14px;
                        text-align: center;
                        margin-bottom: 15px;
                        line-height: 1.5;
                    ">
                        ${achievement.description}
                    </p>
                    
                    <!-- Progress Bar -->
                    <div style="margin-bottom: 15px;">
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 8px;
                        ">
                            <span style="color: #a78bfa; font-size: 12px; font-weight: 600;">
                                Progress
                            </span>
                            <span style="color: #fff; font-size: 14px; font-weight: 700;">
                                ${progress.percentage}%
                            </span>
                        </div>
                        <div style="
                            background: rgba(0,0,0,0.4);
                            border-radius: 20px;
                            height: 12px;
                            overflow: hidden;
                        ">
                            <div style="
                                background: linear-gradient(90deg, #8b5cf6, #a78bfa);
                                height: 100%;
                                width: ${progress.percentage}%;
                                border-radius: 20px;
                                transition: width 0.5s ease;
                            "></div>
                        </div>
                        <div style="
                            text-align: center;
                            color: #9ca3af;
                            font-size: 11px;
                            margin-top: 6px;
                        ">
                            ${progress.text}
                        </div>
                    </div>
                    
                    <!-- Progress Hint -->
                    <div style="
                        text-align: center;
                        background: rgba(139,92,246,0.2);
                        color: #a78bfa;
                        padding: 10px 16px;
                        border-radius: 20px;
                        font-size: 14px;
                        font-weight: 600;
                        border: 1px solid rgba(139,92,246,0.3);
                    ">
                        💪 Keep going!
                    </div>
                </div>
            `;
        }

        // ============================================
        // LOCKED (0% Progress - MYSTERY MODE)
        // ============================================

        function renderLockedAchievement(achievement, achievementId) {
            // Decide how mysterious based on achievement tier
            const isMysteryBox = achievement.rarity === 'legendary'; // Hide details for rare achievements
            
            // Get progress for this achievement
            const progress = getAchievementProgress(achievementId, achievement);
            
            return `
                <div class="achievement-card locked" style="
                    background: linear-gradient(135deg, rgba(30,30,50,0.5), rgba(20,20,35,0.5));
                    border: 2px dashed rgba(107,114,128,0.3);
                    border-radius: 16px;
                    padding: 20px;
                    padding-top: 35px;
                    position: relative;
                    cursor: pointer;
                    transition: all 0.3s ease;
                "
                onmouseover="this.style.borderColor='rgba(139,92,246,0.5)'; this.style.transform='scale(1.02)'"
                onmouseout="this.style.borderColor='rgba(107,114,128,0.3)'; this.style.transform='scale(1)'"
                onclick="showLockedAchievementModal('${achievementId}')">
                    
                    <!-- Badges -->
                    ${achievement.legendary ? `
                        <div style="
                            position: absolute;
                            top: -10px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: linear-gradient(90deg, #fbbf24, #f59e0b);
                            color: #1a1625;
                            padding: 4px 12px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                            box-shadow: 0 4px 12px rgba(251,191,36,0.5);
                            z-index: 10;
                        ">LEGENDARY</div>
                    ` : achievement.special ? `
                        <div style="
                            position: absolute;
                            top: -10px;
                            left: 50%;
                            transform: translateX(-50%);
                            background: rgba(139,92,246,0.9);
                            color: #fbbf24;
                            padding: 4px 12px;
                            border-radius: 12px;
                            font-size: 11px;
                            font-weight: 700;
                            z-index: 10;
                        ">SPECIAL</div>
                    ` : ''}

                    <!-- Lock Icon -->
                    <div style="
                        position: absolute;
                        top: 10px;
                        right: 10px;
                        opacity: 0.5;
                    "><i data-lucide="lock" style="width:24px;height:24px;color:#6b7280;"></i></div>
                    
                    ${isMysteryBox ? `
                        <!-- MYSTERY BOX MODE -->
                        <div style="text-align: center;">
                            <div style="
                                margin-bottom: 15px;
                                opacity: 0.6;
                                filter: blur(2px);
                                user-select: none;
                            "><i data-lucide="gift" style="width:80px;height:80px;color:#6b7280;"></i></div>
                            
                            <h4 style="
                                color: #6b7280;
                                font-size: 18px;
                                font-weight: 700;
                                margin-bottom: 10px;
                            ">
                                ✨🔮 Mystery Achievement 🔮✨
                            </h4>
                            
                            <p style="
                                color: #4b5563;
                                font-size: 13px;
                                margin-bottom: 15px;
                                font-style: italic;
                            ">
                                This rare achievement is waiting to be discovered...
                            </p>
                            
                            <div style="
                                background: rgba(139,92,246,0.1);
                                border: 1px solid rgba(139,92,246,0.2);
                                border-radius: 12px;
                                padding: 12px;
                                margin-bottom: 12px;
                            ">
                                <div style="color: #6b7280; font-size: 11px; margin-bottom: 5px;">
                                    HINT
                                </div>
                                <div style="color: #9ca3af; font-size: 12px; font-weight: 600;">
                                    ${getAchievementHint(achievementId, achievement)}
                                </div>
                            </div>
                            
                            <div style="
                                text-align: center;
                                color: #8b5cf6;
                                font-size: 11px;
                                margin-top: 10px;
                                font-weight: 500;
                            ">
                                Click to see more 👉
                            </div>
                        </div>
                    ` : `
                        <!-- VISIBLE BUT LOCKED MODE -->
                        <div style="text-align: center;">
                            <div style="
                                margin-bottom: 15px;
                                opacity: 0.3;
                                filter: grayscale(100%);
                            ">
                                ${getAchievementIcon(achievementId, 64)}
                            </div>
                            
                            <h4 style="
                                color: #6b7280;
                                font-size: 18px;
                                font-weight: 700;
                                margin-bottom: 10px;
                            ">
                                ${achievement.name}
                            </h4>
                            </h4>
                            
                            <p style="
                                color: #4b5563;
                                font-size: 13px;
                                margin-bottom: 15px;
                                line-height: 1.5;
                            ">
                                ${achievement.description}
                            </p>
                            
                            <div style="
                                text-align: center;
                                background: rgba(107,114,128,0.1);
                                color: #6b7280;
                                padding: 10px 16px;
                                border-radius: 20px;
                                font-size: 13px;
                                font-weight: 600;
                                border: 1px solid rgba(107,114,128,0.2);
                            ">
                                🔒 Locked
                            </div>
                            
                            ${progress ? `
                                <div style="
                                    text-align: center;
                                    color: #8b5cf6;
                                    font-size: 12px;
                                    margin-top: 10px;
                                    font-weight: 600;
                                    background: rgba(139,92,246,0.1);
                                    padding: 8px 12px;
                                    border-radius: 12px;
                                    border: 1px solid rgba(139,92,246,0.2);
                                ">
                                    📊 ${progress.text}
                                </div>
                            ` : ''}
                            
                            <div style="
                                text-align: center;
                                color: #8b5cf6;
                                font-size: 11px;
                                margin-top: 10px;
                                font-weight: 500;
                            ">
                                Click for details 👉
                            </div>
                        </div>
                    `}
                </div>
            `;
        }

        // ============================================
        // ACHIEVEMENT HINTS FOR MYSTERY BOXES
        // ============================================

        function getAchievementHint(achievementId, achievement) {
            const hints = {
                firstSession: "Begin your journey...",
                weekWarrior: "Practice makes perfect, especially over 7 days",
                monthMaster: "Consistency is key for 30 days",
                centurion: "A legendary milestone awaits",
                streakStarter: "Don't skip a day",
                weekStreak: "Build a weekly habit",
                dedication: "Two weeks without stopping",
                committedPractitioner: "A full month of devotion",
                loyalSeeker: "True dedication spans 60 days",
                enlightened: "The ultimate streak achievement",
                explorer: "Try different sounds",
                categoryConqueror: "Experience all types of frequencies",
                frequencyMaster: "Use many different frequencies",
                genesisScholar: "Focus on the sacred 37Hz",
                solfeggioAdept: "Master the healing frequencies",
                angelWhisperer: "Connect with angel numbers",
                chakraBalancer: "Align all energy centers",
                quickSession: "Even 5 minutes counts",
                deepMeditation: "Go deeper, stay longer",
                marathonListener: "Test your endurance",
                earlyBird: "Rise with the sun",
                nightOwl: "Practice under the stars",
                midnightMystic: "The witching hour holds power",
                waterCharger: "Bless your water with intention",
                crystalHealer: "Combine with crystal energy",
                intentionSetter: "Begin with purpose",
                reflectiveSoul: "Document your experiences",
                shareTheLight: "Spread the word",
                helpOthers: "Guide others to frequencies"
            };
            
            return hints[achievementId] || "Complete specific actions to unlock";
        }

        // ============================================
        // LOCKED ACHIEVEMENT MODAL (Detailed View)
        // ============================================

        // Make globally accessible
        window.showLockedAchievementModal = function(achievementId) {
            const achievement = ACHIEVEMENTS[achievementId];
            if (!achievement) return;
            
            const progress = getAchievementProgress(achievementId, achievement);
            const isMystery = achievement.rarity === 'legendary' || achievement.rarity === 'rare';
            
            const modal = document.createElement('div');
            modal.className = 'achievement-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.95);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2147483647;
                padding: 20px;
                animation: fadeIn 0.3s ease;
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            `;
            
            modal.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #1a1625, #2d1b69);
                    border-radius: 24px;
                    padding: 30px 20px;
                    max-width: 450px;
                    max-height: 90vh;
                    width: 100%;
                    position: relative;
                    animation: slideUp 0.4s ease;
                    overflow-y: auto;
                    margin: auto;
                ">
                    
                    <!-- Lock icon (large) -->
                    <div style="
                        text-align: center;
                        font-size: 100px;
                        margin-bottom: 20px;
                        ${isMystery ? 'filter: blur(3px); opacity: 0.5;' : 'opacity: 0.3; filter: grayscale(100%);'}
                    ">
                        ${isMystery ? '🔒' : achievement.name.split(' ')[0]}
                    </div>
                    
                    <!-- Title -->
                    <h2 style="
                        color: ${progress && progress.percentage >= 75 ? '#fbbf24' : '#a78bfa'};
                        font-size: 28px;
                        font-weight: 700;
                        text-align: center;
                        margin-bottom: 15px;
                    ">
                        ${isMystery ? '✨ Mystery Achievement ✨' : achievement.name}
                    </h2>
                    
                    <!-- Description -->
                    <p style="
                        color: #d1d5db;
                        font-size: 16px;
                        text-align: center;
                        margin-bottom: 25px;
                        line-height: 1.6;
                    ">
                        ${isMystery ? `<em>${getAchievementHint(achievementId, achievement)}</em>` : achievement.description}
                    </p>
                    
                    ${progress && progress.percentage > 0 ? `
                        <!-- Progress Section -->
                        <div style="
                            background: rgba(139,92,246,0.1);
                            border-radius: 16px;
                            padding: 20px;
                            margin-bottom: 20px;
                        ">
                            <div style="
                                display: flex;
                                justify-content: space-between;
                                align-items: center;
                                margin-bottom: 12px;
                            ">
                                <span style="color: #a78bfa; font-size: 14px; font-weight: 600;">
                                    Your Progress
                                </span>
                                <span style="color: #fff; font-size: 20px; font-weight: 700;">
                                    ${progress.percentage}%
                                </span>
                            </div>
                            <div style="
                                background: rgba(0,0,0,0.4);
                                border-radius: 20px;
                                height: 16px;
                                overflow: hidden;
                            ">
                                <div style="
                                    background: linear-gradient(90deg, 
                                        ${progress.percentage >= 75 ? '#fbbf24, #f59e0b' : '#8b5cf6, #a78bfa'}
                                    );
                                    height: 100%;
                                    width: ${progress.percentage}%;
                                    border-radius: 20px;
                                    transition: width 0.5s ease;
                                    ${progress.percentage >= 75 ? 'box-shadow: 0 0 20px rgba(251,191,36,0.5);' : ''}
                                "></div>
                            </div>
                            <div style="
                                text-align: center;
                                color: #9ca3af;
                                font-size: 13px;
                                margin-top: 10px;
                            ">
                                ${progress.text}
                            </div>
                            
                            ${progress.percentage >= 75 ? `
                                <div style="
                                    text-align: center;
                                    color: #fbbf24;
                                    font-size: 14px;
                                    font-weight: 600;
                                    margin-top: 15px;
                                    animation: pulse-text 1.5s ease-in-out infinite;
                                ">
                                    ✨ Almost there! Keep going!
                                </div>
                            ` : ''}
                        </div>
                    ` : `
                        <!-- Not Started Yet -->
                        <div style="
                            background: rgba(107,114,128,0.1);
                            border: 2px dashed rgba(107,114,128,0.3);
                            border-radius: 16px;
                            padding: 25px;
                            text-align: center;
                            margin-bottom: 20px;
                        ">
                            <div style="font-size: 48px; margin-bottom: 12px; opacity: 0.5;">🔒</div>
                            <div style="color: #9ca3af; font-size: 14px; line-height: 1.6;">
                                Start practicing to make progress towards this achievement
                            </div>
                        </div>
                    `}
                    
                    <!-- Rarity Display -->
                    <div style="
                        background: linear-gradient(135deg, rgba(251,191,36,0.2), rgba(249,115,22,0.2));
                        border: 2px solid ${progress && progress.percentage >= 75 ? '#fbbf24' : 'rgba(251,191,36,0.3)'};
                        border-radius: 16px;
                        padding: 20px;
                        text-align: center;
                        ${progress && progress.percentage >= 75 ? 'box-shadow: 0 0 30px rgba(251,191,36,0.3);' : ''}
                    ">
                        ${achievement.rarity === 'legendary' ? `
                            <div style="color: #fbbf24; font-size: 40px; margin-bottom: 8px;">🌟</div></div>
                            <div style="color: #fbbf24; font-size: 16px; font-weight: 700;">LEGENDARY ACHIEVEMENT</div>
                        ` : achievement.rarity === 'rare' ? `
                            <div style="color: #a78bfa; font-size: 40px; margin-bottom: 8px;">💎</div></div>
                            <div style="color: #a78bfa; font-size: 16px; font-weight: 700;">RARE ACHIEVEMENT</div>
                        ` : `
                            <div style="color: #22c55e; font-size: 40px; margin-bottom: 8px;">⭐</div></div>
                            <div style="color: #22c55e; font-size: 16px; font-weight: 700;">ACHIEVEMENT</div>
                        `}
                    </div>
                    
                    <!-- Call to Action -->
                    <button onclick="this.closest('.achievement-modal').remove()" style="
                        width: 100%;
                        background: linear-gradient(90deg, #8b5cf6, #6b46c1);
                        color: #fff;
                        border: none;
                        border-radius: 16px;
                        padding: 16px;
                        font-size: 16px;
                        font-weight: 700;
                        cursor: pointer;
                        margin-top: 20px;
                        box-shadow: 0 4px 20px rgba(139,92,246,0.4);
                    ">
                        ⬅️ Back
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            // Close on outside click
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.remove();
                }
            });
        }

        function getUnlockDate(achievementId) {
            const unlockTimestamp = userProgress.achievementUnlockDates?.[achievementId];
            if (!unlockTimestamp) return 'Recently';
            
            const date = new Date(unlockTimestamp);
            const now = new Date();
            const diffTime = Math.abs(now - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            if (diffDays === 0) return 'Today';
            if (diffDays === 1) return 'Yesterday';
            if (diffDays < 7) return `${diffDays} days ago`;
            if (diffDays < 30) return `${Math.floor(diffDays / 7)} weeks ago`;
            if (diffDays < 365) return `${Math.floor(diffDays / 30)} months ago`;
            return date.toLocaleDateString();
        }

        // ============================================
        // Missing achievement functions
        // ============================================

        function showAchievementModal(achievementId) {
            // Basic implementation - can be expanded later
            console.log('Achievement modal for:', achievementId);
        }

        function updateAchievementProgress() {
            // Basic implementation - can be expanded later
            console.log('Updating achievement progress');
        }

        // ============================================
        // UPDATE: Store unlock dates when achievements unlock
        // ============================================

        // checkAchievements function - basic implementation
        function checkAchievements() {
            // Basic achievement checking - can be expanded later
            console.log('Checking achievements...');
            return true;
        }

        // ============================================
        // UPDATED: Render Achievements Dashboard with Categories
        // ============================================

        function renderAchievementsDashboard() {
            // Ensure userProgress.achievements is a Set
            if (!(userProgress.achievements instanceof Set)) {
                userProgress.achievements = new Set(userProgress.achievements || []);
            }
            
            const categories = {
                awakening: {
                    name: '✨ Awakening',
                    achievements: ['trinityThreshold', 'sevenFoldBlessing', 'tenthGate']
                },
                sessions: {
                    name: '🌅 Session Milestones',
                    achievements: ['quarterCentury', 'mirrorOfForm', 'fiftySteps', 'mirrorOfSpirit', 'centuryGuardian', 'sacredGateway108']
                },
                time: {
                    name: '⏰ Time Milestones',
                    achievements: ['fiveMinuteMark', 'halfHourDevotee', 'hourMaster', 'fiveHourPilgrim', 'tenHourSage']
                },
                streaks: {
                    name: '🔥 Streak Achievements',
                    achievements: ['threeDayInitiate', 'sevenDaySeeker', 'twoWeekChampion', 'twentyOneDayTransformer', 'monthMaster', 'fortyDayPilgrim', 'seventyThreeDayMystic', 'oneHundredEightDaySage']
                },
                exploration: {
                    name: '🎵 Frequency Exploration',
                    achievements: ['explorer', 'categoryConqueror', 'frequencyMaster']
                },
                specialty: {
                    name: '⭐ Specialty Tracks',
                    achievements: ['genesisScholar', 'solfeggioAdept', 'angelWhisperer', 'chakraBalancer']
                },
                duration: {
                    name: '⏱️ Session Types',
                    achievements: ['quickSession', 'deepMeditation', 'marathonListener']
                },
                timing: {
                    name: '✨ Perfect Timing',
                    achievements: ['earlyBird', 'nightOwl', 'midnightMystic']
                },
                special: {
                    name: '🏆 Special Activities',
                    achievements: ['waterCharger', 'crystalHealer', 'intentionSetter', 'reflectiveSoul']
                },
                social: {
                    name: '👥 Community',
                    achievements: ['shareTheLight', 'helpOthers']
                }
            };
            
            let html = `
                <div style="padding: 20px;">
                    <div style="
                        text-align: center;
                        margin-bottom: 40px;
                    ">
                        <h2 style="
                            color: #fbbf24;
                            font-size: 32px;
                            margin-bottom: 15px;
                            text-shadow: 0 0 20px rgba(251,191,36,0.5);
                        ">
                            🏆 Achievements
                        </h2>
                        <p style="
                            color: #a78bfa;
                            font-size: 16px;
                            margin-bottom: 20px;
                        ">
                            Unlock rewards as you progress on your journey
                        </p>
                        
                        <!-- Overall Progress -->
                        <div style="
                            background: linear-gradient(135deg, rgba(139,92,246,0.2), rgba(167,139,250,0.2));
                            border-radius: 20px;
                            padding: 25px;
                            max-width: 500px;
                            margin: 0 auto;
                        ">
                            <div style="
                                display: flex;
                                justify-content: space-around;
                                align-items: center;
                                flex-wrap: wrap;
                                gap: 20px;
                            ">
                                <div style="text-align: center;">
                                    <div style="color: #22c55e; font-size: 36px; font-weight: 700;">
                                        ${userProgress.achievements.size}
                                    </div>
                                    <div style="color: #a78bfa; font-size: 13px;">
                                        Unlocked
                                    </div>
                                </div>
                                
                                <div style="text-align: center;">
                                    <div style="color: #fbbf24; font-size: 36px; font-weight: 700;">
                                        ${Object.keys(ACHIEVEMENTS).length - userProgress.achievements.size}
                                    </div>
                                    <div style="color: #a78bfa; font-size: 13px;">
                                        Remaining
                                    </div>
                                </div>
                                
                                <div style="text-align: center;">
                                    <div style="color: #8b5cf6; font-size: 36px; font-weight: 700;">
                                        ${Math.round((userProgress.achievements.size / Object.keys(ACHIEVEMENTS).length) * 100)}%
                                    </div>
                                    <div style="color: #a78bfa; font-size: 13px;">
                                        Complete
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
            `;
            
            // Render each category
            Object.entries(categories).forEach(([categoryKey, category]) => {
                const categoryAchievements = category.achievements.map(id => ({
                    id,
                    achievement: ACHIEVEMENTS[id]
                })).filter(a => a.achievement);
                
                const unlockedCount = categoryAchievements.filter(a => 
                    userProgress.achievements.has(a.id)
                ).length;
                
                html += `
                    <div style="margin-bottom: 40px;">
                        <div style="
                            display: flex;
                            justify-content: space-between;
                            align-items: center;
                            margin-bottom: 20px;
                            padding-bottom: 15px;
                            border-bottom: 2px solid rgba(139,92,246,0.3);
                        ">
                            <h3 style="
                                color: #fff;
                                font-size: 22px;
                                margin: 0;
                            ">
                                ${category.name}
                            </h3>
                            <div style="
                                background: rgba(139,92,246,0.2);
                                color: #a78bfa;
                                padding: 6px 14px;
                                border-radius: 20px;
                                font-size: 13px;
                                font-weight: 600;
                            ">
                                ${unlockedCount}/${categoryAchievements.length}
                            </div>
                        </div>
                        
                        <div class="achievements-grid">
                            ${categoryAchievements.map(({ id, achievement }) => 
                                renderAchievementCard(achievement, id)
                            ).join('')}
                        </div>
                    </div>
                `;
            });
            
            html += `
                </div>
            `;
            
            return html;
        }

        // ============================================
        // QUICK STATS WIDGET (For Main Dashboard)
        // ============================================

        function renderAchievementQuickStats() {
            const totalAchievements = Object.keys(ACHIEVEMENTS).length;
            const unlockedCount = userProgress.achievements.size;
            const recentUnlocks = getRecentUnlocks(3);
            
            return `
                <div style="
                    background: linear-gradient(135deg, rgba(139,92,246,0.15), rgba(167,139,250,0.15));
                    border-radius: 16px;
                    padding: 20px;
                    margin: 20px 0;
                ">
                    <div style="
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        margin-bottom: 15px;
                    ">
                        <h3 style="color: #fbbf24; font-size: 20px; margin: 0;">
                            🏆 Achievements
                        </h3>
                        <button onclick="showFullAchievements()" style="
                            background: rgba(139,92,246,0.2);
                            color: #a78bfa;
                            border: 2px solid rgba(139,92,246,0.3);
                            border-radius: 20px;
                            padding: 8px 16px;
                            font-size: 13px;
                            font-weight: 600;
                            cursor: pointer;
                        ">
                            View All ➡️
                        </button>
                    </div>
                    
                    <div style="
                        display: flex;
                        gap: 15px;
                        margin-bottom: 20px;
                    ">
                        <div style="
                            flex: 1;
                            background: rgba(34,197,94,0.1);
                            border-radius: 12px;
                            padding: 15px;
                            text-align: center;
                        ">
                            <div style="color: #22c55e; font-size: 28px; font-weight: 700;">
                                ${unlockedCount}
                            </div>
                            <div style="color: #a78bfa; font-size: 12px;">
                                Unlocked
                            </div>
                        </div>
                        
                        <div style="
                            flex: 1;
                            background: rgba(139,92,246,0.1);
                            border-radius: 12px;
                            padding: 15px;
                            text-align: center;
                        ">
                            <div style="color: #fbbf24; font-size: 28px; font-weight: 700;">
                                ${totalAchievements - unlockedCount}
                            </div>
                            <div style="color: #a78bfa; font-size: 12px;">
                                To Discover
                            </div>
                        </div>
                    </div>
                    
                    ${recentUnlocks.length > 0 ? `
                        <div style="
                            background: rgba(0,0,0,0.2);
                            border-radius: 12px;
                            padding: 15px;
                        ">
                            <div style="color: #a78bfa; font-size: 12px; margin-bottom: 12px; font-weight: 600;">
                                RECENTLY UNLOCKED
                            </div>
                            ${recentUnlocks.map(({ id, achievement }) => `
                                <div style="
                                    display: flex;
                                    align-items: center;
                                    gap: 12px;
                                    margin-bottom: 10px;
                                    padding-bottom: 10px;
                                    border-bottom: 1px solid rgba(139,92,246,0.2);
                                ">
                                    <div style="font-size: 32px;">
                                        ${achievement.name.split(' ')[0]}
                                    </div>
                                    <div style="flex: 1;">
                                        <div style="color: #22c55e; font-size: 14px; font-weight: 600;">
                                            ${achievement.name}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    ` : `
                        <div style="
                            text-align: center;
                            color: #6b7280;
                            font-size: 13px;
                            padding: 20px;
                            font-style: italic;
                        ">
                            Complete your first session to start unlocking achievements! ✨
                        </div>
                    `}
                    
                    <!-- Next achievement to chase -->
                    ${getNextAchievementToChase()}
                </div>
            `;
        }
        
        function getNextAchievementToChase() {
            // Find achievements that are close to being unlocked
            const lockedAchievements = Object.entries(ACHIEVEMENTS)
                .filter(([id, ach]) => !userProgress.achievements.has(id))
                .map(([id, ach]) => {
                    const progress = getAchievementProgress(id);
                    return { id, achievement: ach, progress };
                })
                .filter(a => a.progress && a.progress.percentage > 0 && a.progress.percentage < 100)
                .sort((a, b) => b.progress.percentage - a.progress.percentage);
            
            if (lockedAchievements.length === 0) {
                // Show first available achievement if no progress yet
                const firstLocked = Object.entries(ACHIEVEMENTS)
                    .find(([id, ach]) => !userProgress.achievements.has(id));
                
                if (firstLocked) {
                    const [id, achievement] = firstLocked;
                    return `
                        <div style="
                            background: linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1));
                            border: 2px solid rgba(251,191,36,0.3);
                            border-radius: 12px;
                            padding: 15px;
                            margin-top: 15px;
                        ">
                            <div style="color: #fbbf24; font-size: 12px; margin-bottom: 8px; font-weight: 600;">
                                🎯 NEXT ACHIEVEMENT
                            </div>
                            <div style="display: flex; align-items: center; gap: 12px;">
                                <div style="font-size: 28px;">${achievement.name.split(' ')[0]}</div>
                                <div>
                                    <div style="color: #fbbf24; font-size: 14px; font-weight: 600;">
                                        ${achievement.name}
                                    </div>
                                    <div style="color: #9ca3af; font-size: 12px;">
                                        ${achievement.description}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                return '';
            }
            
            const nextUp = lockedAchievements[0];
            return `
                <div style="
                    background: linear-gradient(135deg, rgba(251,191,36,0.1), rgba(245,158,11,0.1));
                    border: 2px solid rgba(251,191,36,0.3);
                    border-radius: 12px;
                    padding: 15px;
                    margin-top: 15px;
                ">
                    <div style="color: #fbbf24; font-size: 12px; margin-bottom: 8px; font-weight: 600;">
                        🎯 ALMOST THERE!
                    </div>
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 10px;">
                        <div style="font-size: 28px;">${nextUp.achievement.name.split(' ')[0]}</div>
                        <div style="flex: 1;">
                            <div style="color: #fbbf24; font-size: 14px; font-weight: 600;">
                                ${nextUp.achievement.name}
                            </div>
                            <div style="color: #9ca3af; font-size: 12px;">
                                ${nextUp.progress.text}
                            </div>
                        </div>
                    </div>
                    <div style="
                        background: rgba(0,0,0,0.3);
                        border-radius: 10px;
                        height: 8px;
                        overflow: hidden;
                    ">
                        <div style="
                            background: linear-gradient(90deg, #fbbf24, #f59e0b);
                            height: 100%;
                            width: ${nextUp.progress.percentage}%;
                            border-radius: 10px;
                            transition: width 0.5s ease;
                        "></div>
                    </div>
                </div>
            `;
        }

        function getRecentUnlocks(count = 3) {
            if (!userProgress.achievementUnlockDates) return [];
            
            const unlocks = Object.entries(userProgress.achievementUnlockDates)
                .map(([id, timestamp]) => ({
                    id,
                    achievement: ACHIEVEMENTS[id],
                    timestamp
                }))
                .filter(u => u.achievement)
                .sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp))
                .slice(0, count);
            
            return unlocks;
        }

        function showFullAchievements() {
            try {
            // Ensure achievements is a Set
            if (!(userProgress.achievements instanceof Set)) {
                userProgress.achievements = new Set(userProgress.achievements || []);
            }
            
            // Remove any existing modal first
            const existingModal = document.getElementById('achievementsFullModal');
            if (existingModal) existingModal.remove();
            
            // Close companion panel properly (including its overlay)
            const overlay = document.getElementById('instructionsOverlay');
            if (overlay) {
                window.toggleInstructions();
            }
            
            // Navigate to achievements page or show modal
            const modal = document.createElement('div');
            modal.id = 'achievementsFullModal';
            modal.className = 'achievements-full-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #1a0a2e;
                z-index: 2000000;
                overflow-y: auto;
                padding: 20px;
            `;
            
            // Close function
            function closeAchievementsModal() {
                const m = document.getElementById('achievementsFullModal');
                if (m) {
                    m.remove();
                }
                // Also remove companion overlay if it exists
                const overlay = document.getElementById('instructionsOverlay');
                if (overlay) {
                    overlay.remove();
                }
                // Ensure page is scrollable and visible
                document.body.style.overflow = '';
                window.scrollTo(0, 0);
            }
            
            // Store close function globally
            window.closeAchievementsModal = closeAchievementsModal;
            
            const t = translations.en;
            const dashboardContent = renderAchievementsDashboard();
            
            modal.innerHTML = `
                <div style="max-width: 1200px; margin: 0 auto; position: relative; z-index: 2000001; padding-bottom: 40px;">
                    <!-- Return to Tracks Button at TOP -->
                    <div style="text-align: center; margin-bottom: 20px; padding-top: 10px;">
                        <button onclick="window.closeAchievementsModal();" style="
                            background: linear-gradient(90deg, #8b5cf6, #6b46c1);
                            color: #fff;
                            border: none;
                            border-radius: 25px;
                            padding: 15px 35px;
                            font-size: 18px;
                            font-weight: 700;
                            cursor: pointer;
                            box-shadow: 0 4px 15px rgba(139,92,246,0.4);
                        ">${t.returnToTracks || '← Return to Tracks'}</button>
                    </div>
                    
                    ${dashboardContent}
                    
                    <!-- Return to Tracks Button at BOTTOM -->
                    <div style="text-align: center; margin-top: 30px; padding-bottom: 20px;">
                        <button onclick="window.closeAchievementsModal();" style="
                            background: linear-gradient(90deg, #8b5cf6, #6b46c1);
                            color: #fff;
                            border: none;
                            border-radius: 25px;
                            padding: 15px 35px;
                            font-size: 18px;
                            font-weight: 700;
                            cursor: pointer;
                            box-shadow: 0 4px 15px rgba(139,92,246,0.4);
                        ">${t.returnToTracks || '← Return to Tracks'}</button>
                    </div>
                </div>
            `;
            
            // Click outside content to close
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeAchievementsModal();
            });
            
            document.body.appendChild(modal);
            } catch (error) {
                console.error('Error showing achievements:', error);
                alert('Unable to load achievements. Please refresh the page and try again.');
            }
        }

        function getAchievementProgress(id) {
            // Session-based
            if (id === 'trinityThreshold') {
                return { percentage: Math.min((userProgress.totalSessions / 3) * 100, 100), text: `${userProgress.totalSessions}/3 sessions` };
            }
            if (id === 'sevenFoldBlessing') {
                return { percentage: Math.min((userProgress.totalSessions / 7) * 100, 100), text: `${userProgress.totalSessions}/7 sessions` };
            }
            if (id === 'tenthGate') {
                return { percentage: Math.min((userProgress.totalSessions / 10) * 100, 100), text: `${userProgress.totalSessions}/10 sessions` };
            }
            if (id === 'quarterCentury') {
                return { percentage: Math.min((userProgress.totalSessions / 25) * 100, 100), text: `${userProgress.totalSessions}/25 sessions` };
            }
            if (id === 'mirrorOfForm') {
                return { percentage: Math.min((userProgress.totalSessions / 37) * 100, 100), text: `${userProgress.totalSessions}/37 sessions` };
            }
            if (id === 'fiftySteps') {
                return { percentage: Math.min((userProgress.totalSessions / 50) * 100, 100), text: `${userProgress.totalSessions}/50 sessions` };
            }
            if (id === 'mirrorOfSpirit') {
                return { percentage: Math.min((userProgress.totalSessions / 73) * 100, 100), text: `${userProgress.totalSessions}/73 sessions` };
            }
            if (id === 'centuryGuardian') {
                return { percentage: Math.min((userProgress.totalSessions / 100) * 100, 100), text: `${userProgress.totalSessions}/100 sessions` };
            }
            if (id === 'sacredGateway108') {
                return { percentage: Math.min((userProgress.totalSessions / 108) * 100, 100), text: `${userProgress.totalSessions}/108 sessions` };
            }

            // Time-based
            if (id === 'fiveMinuteMark') {
                const mins = Math.floor(userProgress.totalSeconds / 60);
                return { percentage: Math.min((mins / 5) * 100, 100), text: `${mins}/5 minutes` };
            }
            if (id === 'halfHourDevotee') {
                const mins = Math.floor(userProgress.totalSeconds / 60);
                return { percentage: Math.min((mins / 30) * 100, 100), text: `${mins}/30 minutes` };
            }
            if (id === 'hourMaster') {
                const hours = Math.floor(userProgress.totalSeconds / 3600);
                return { percentage: Math.min(hours * 100, 100), text: `${hours}/1 hour` };
            }
            if (id === 'fiveHourPilgrim') {
                const hours = Math.floor(userProgress.totalSeconds / 3600);
                return { percentage: Math.min((hours / 5) * 100, 100), text: `${hours}/5 hours` };
            }
            if (id === 'tenHourSage') {
                const hours = Math.floor(userProgress.totalSeconds / 3600);
                return { percentage: Math.min((hours / 10) * 100, 100), text: `${hours}/10 hours` };
            }

            // Streak-based
            if (id === 'threeDayInitiate') {
                return { percentage: Math.min((userProgress.currentStreak / 3) * 100, 100), text: `${userProgress.currentStreak}/3 days` };
            }
            if (id === 'sevenDaySeeker') {
                return { percentage: Math.min((userProgress.currentStreak / 7) * 100, 100), text: `${userProgress.currentStreak}/7 days` };
            }
            if (id === 'twoWeekChampion') {
                return { percentage: Math.min((userProgress.currentStreak / 14) * 100, 100), text: `${userProgress.currentStreak}/14 days` };
            }
            if (id === 'twentyOneDayTransformer') {
                return { percentage: Math.min((userProgress.currentStreak / 21) * 100, 100), text: `${userProgress.currentStreak}/21 days` };
            }
            if (id === 'monthMaster') {
                return { percentage: Math.min((userProgress.currentStreak / 30) * 100, 100), text: `${userProgress.currentStreak}/30 days` };
            }
            if (id === 'fortyDayPilgrim') {
                return { percentage: Math.min((userProgress.currentStreak / 40) * 100, 100), text: `${userProgress.currentStreak}/40 days` };
            }
            if (id === 'seventyThreeDayMystic') {
                return { percentage: Math.min((userProgress.currentStreak / 73) * 100, 100), text: `${userProgress.currentStreak}/73 days` };
            }
            if (id === 'oneHundredEightDaySage') {
                return { percentage: Math.min((userProgress.currentStreak / 108) * 100, 100), text: `${userProgress.currentStreak}/108 days` };
            }

            // Special actions
            if (id === 'waterAlchemist') {
                return { percentage: Math.min((userProgress.waterChargingSessions / 3) * 100, 100), text: `${userProgress.waterChargingSessions}/3 charges` };
            }
            if (id === 'intentionSetter') {
                return { percentage: Math.min((userProgress.intentionsSet / 10) * 100, 100), text: `${userProgress.intentionsSet}/10 intentions` };
            }
            if (id === 'genesisEvangelist') {
                return { percentage: Math.min((userProgress.appShares / 5) * 100, 100), text: `${userProgress.appShares}/5 shares` };
            }
            if (id === 'trinityMaster') {
                const count = userProgress.trackPlayCounts['genesisCreation'] || 0;
                return { percentage: Math.min((count / 10) * 100, 100), text: `${count}/10 sessions` };
            }

            return null;
        }

        // ============================================
        // DAILY CHALLENGES SYSTEM
        // ============================================

        const DAILY_CHALLENGES = [
            {
                id: 'morningDevotion',
                name: '🌅 Morning Devotion',
                description: 'Complete a session before 9 AM',
                xpReward: 50,
                check: (session) => {
                    const hour = parseInt(session.time.split(':')[0]);
                    return hour < 9;
                }
            },
            {
                id: 'eveningReflection',
                name: '🌙 Evening Reflection',
                description: 'Complete a session after 8 PM',
                xpReward: 50,
                check: (session) => {
                    const hour = parseInt(session.time.split(':')[0]);
                    return hour >= 20;
                }
            },
            {
                id: 'waterCeremony',
                name: '💧 Water Ceremony',
                description: 'Charge water today',
                xpReward: 60,
                check: (session) => session.waterCharging === true
            },
            {
                id: 'backToBasics',
                name: '🔱 Back to Basics',
                description: 'Use Genesis Creation track',
                xpReward: 50,
                check: (session) => session.trackId === 'genesisCreation'
            },
            {
                id: 'angelMessage',
                name: '👼 Angel Message',
                description: 'Try an Angel Number frequency',
                xpReward: 50,
                check: (session) => session.category === 'angelNumbers'
            },
            {
                id: 'extendedPractice',
                name: '⏳ Extended Practice',
                description: 'Session of 20+ minutes',
                xpReward: 75,
                check: (session) => session.duration >= 1200
            },
            {
                id: 'discovery',
                name: '🔭 Discovery',
                description: 'Try a frequency you haven\'t used in 7+ days',
                xpReward: 60,
                check: (session) => {
                    // Check if this track was used in last 7 days
                    const sevenDaysAgo = Date.now() - (7 * 24 * 60 * 60 * 1000);
                    const recentSessions = userProgress.sessionHistory.filter(s => s.timestamp > sevenDaysAgo);
                    return !recentSessions.some(s => s.trackId === session.trackId);
                }
            },
            {
                id: 'intentionalListening',
                name: '🙏 Intentional Listening',
                description: 'Set an intention before your session',
                xpReward: 50,
                check: (session) => session.intentionSet === true
            }
        ];

        function getDailyChallenge() {
            // Get challenge based on day of year
            const dayOfYear = Math.floor((Date.now() - new Date(new Date().getFullYear(), 0, 0)) / 86400000);
            const challengeIndex = dayOfYear % DAILY_CHALLENGES.length;
            return DAILY_CHALLENGES[challengeIndex];
        }

        function checkDailyChallenge(session) {
            const today = new Date().toISOString().split('T')[0];

            // Check if challenge already completed today
            if (userProgress.dailyChallengesCompleted &&
                userProgress.dailyChallengesCompleted[today]) {
                return;
            }

            const challenge = getDailyChallenge();

            if (challenge.check(session)) {
                // Challenge completed!
                if (!userProgress.dailyChallengesCompleted) {
                    userProgress.dailyChallengesCompleted = {};
                }
                userProgress.dailyChallengesCompleted[today] = challenge.id;

                awardXP(challenge.xpReward);
                showDailyChallengeComplete(challenge);
                saveProgress();
            }
        }

        function showDailyChallengeComplete(challenge) {
            showNotification(`🌟 Daily Challenge Complete! ${challenge.name}`);
        }

        function renderDailyChallenge() {
            const challenge = getDailyChallenge();
            const today = new Date().toISOString().split('T')[0];
            const completed = userProgress.dailyChallengesCompleted &&
                             userProgress.dailyChallengesCompleted[today];

            return `
                <div style="
                    background: ${completed ? 'linear-gradient(135deg, rgba(34,197,94,0.2), rgba(22,163,74,0.2))' : 'linear-gradient(135deg, rgba(139,92,246,0.15), rgba(251,191,36,0.15))'};
                    border: 2px solid ${completed ? '#22c55e' : 'rgba(251,191,36,0.3)'};
                    border-radius: 16px;
                    padding: 20px;
                    position: relative;
                ">
                    ${completed ? `
                        <div style="
                            position: absolute;
                            top: -12px;
                            right: 20px;
                            background: #22c55e;
                            color: #fff;
                            padding: 6px 16px;
                            border-radius: 20px;
                            font-size: 12px;
                            font-weight: 700;
                        ">✅ COMPLETED</div>
                    ` : ''}

                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="font-size: 48px;">
                            ${challenge.name.split(' ')[0]}
                        </div>
                        <div style="flex: 1;">
                            <div style="color: #fbbf24; font-size: 14px; font-weight: 600; margin-bottom: 5px;">
                                TODAY'S CHALLENGE
                            </div>
                            <h4 style="color: #fff; font-size: 18px; font-weight: 600; margin-bottom: 5px;">
                                ${challenge.name}
                            </h4>
                            <p style="color: #a78bfa; font-size: 13px; margin-bottom: 10px;">
                                ${challenge.description}
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        // ============================================
        // NOTIFICATION SYSTEM
        // ============================================

        function showNotification(message, duration = 3000) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #8b5cf6, #6b46c1);
                color: #fff;
                padding: 15px 25px;
                border-radius: 12px;
                box-shadow: 0 8px 20px rgba(139,92,246,0.4);
                z-index: 10002;
                animation: slideInRight 0.3s ease;
                max-width: 350px;
                font-size: 14px;
                font-weight: 600;
            `;
            notification.textContent = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.transition = 'opacity 0.5s';
                notification.style.opacity = '0';
                setTimeout(() => notification.remove(), 500);
            }, duration);
        }

        // ============================================
        // LOCAL STORAGE PERSISTENCE
        // ============================================

        function saveProgress() {
            try {
                // Convert Sets to Arrays for JSON serialization
                const saveData = {
                    ...userProgress,
                    frequenciesUsed: Array.from(userProgress.frequenciesUsed || []),
                    categoriesExplored: Array.from(userProgress.categoriesExplored || []),
                    achievements: Array.from(userProgress.achievements || []),
                    actions: Array.from(userProgress.actions || [])
                };

                localStorage.setItem('genesisProgress', JSON.stringify(saveData));
            } catch (error) {
                console.error('Failed to save progress:', error);
            }
        }

        function loadProgress() {
            try {
                const saved = localStorage.getItem('genesisProgress');
                if (saved) {
                    const data = JSON.parse(saved);

                    // Convert Arrays back to Sets first
                    const frequenciesUsed = new Set(data.frequenciesUsed || []);
                    const categoriesExplored = new Set(data.categoriesExplored || []);
                    const achievements = new Set(data.achievements || []);
                    const actions = new Set(data.actions || []);

                    // Copy other properties, explicitly setting Sets after to avoid overwriting
                    Object.assign(userProgress, data);
                    
                    // Restore Sets after Object.assign (which may have overwritten them with arrays)
                    userProgress.frequenciesUsed = frequenciesUsed;
                    userProgress.categoriesExplored = categoriesExplored;
                    userProgress.achievements = achievements;
                    userProgress.actions = actions;

                    return true;
                }
            } catch (error) {
                console.error('Failed to load progress:', error);
                // Ensure Sets are initialized even on error
                if (!(userProgress.achievements instanceof Set)) {
                    userProgress.achievements = new Set();
                }
                if (!(userProgress.frequenciesUsed instanceof Set)) {
                    userProgress.frequenciesUsed = new Set();
                }
                if (!(userProgress.categoriesExplored instanceof Set)) {
                    userProgress.categoriesExplored = new Set();
                }
                if (!(userProgress.actions instanceof Set)) {
                    userProgress.actions = new Set();
                }
            }
            return false;
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================

        function generateUUID() {
            return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
                const r = Math.random() * 16 | 0;
                const v = c === 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });
        }

        function unlockTrack(trackId) {
            if (!userProgress.unlockedTracks) {
                userProgress.unlockedTracks = [];
            }
            if (!userProgress.unlockedTracks.includes(trackId)) {
                userProgress.unlockedTracks.push(trackId);
                saveProgress();
            }
        }

        // ============================================
        // CSS ANIMATIONS
        // ============================================

        const styles = `
        <style>
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        @keyframes scaleIn {
            from {
                opacity: 0;
                transform: scale(0.5);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(100px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes slideOutRight {
            from {
                opacity: 1;
                transform: translateX(0);
            }
            to {
                opacity: 0;
                transform: translateX(100px);
            }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        </style>
        `;

        // Inject styles
        document.head.insertAdjacentHTML('beforeend', styles);

        // ============================================
        // INITIALIZATION
        // ============================================

        // Load progress on app start
        loadProgress();

        // Check for achievements periodically
        setInterval(() => {
            checkAllAchievements();
        }, 30000); // Every 30 seconds

        // Export functions for use in your app
        window.GenesisAchievements = {
            recordSession: recordSession,
            checkAllAchievements: checkAllAchievements,
            renderProgressDashboard: renderProgressDashboard,
            showAllAchievements: showAllAchievements,
            renderDailyChallenge: renderDailyChallenge,
            saveProgress: saveProgress,
            loadProgress: loadProgress,
            userProgress: userProgress
        };

        console.log('🌟 Genesis Achievements System Loaded!');

        // Background audio toggle for premium users
        let backgroundAudioEnabled = false;
        let wakeLockSentinel = null;

        function toggleBackgroundAudio() {
            // Check if user is premium using new tier system
            const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                               localStorage.getItem('gfgn_license_tier') === 'premium' || 
                               localStorage.getItem('gfgn_license_tier') === 'ultimate';
            if (!hasPremium) {
                showUpgradeModal();
                return;
            }

            backgroundAudioEnabled = !backgroundAudioEnabled;

            if (backgroundAudioEnabled) {
                // Enable background audio for premium users
                enableBackgroundAudio();
                showToast('🎧 Background Audio Enabled! Frequencies will continue when minimized.', 'success');
            } else {
                // Disable background audio
                disableBackgroundAudio();
                showToast('Background audio disabled.', 'info');
            }
        }
        
        // Screen Awake Toggle Handler
        function toggleScreenAwake() {
            const toggle = document.getElementById('screenAwakeToggle');
            if (!toggle) return;
            
            // Check premium access
            const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                               localStorage.getItem('gfgn_license_tier') === 'premium' || 
                               localStorage.getItem('gfgn_license_tier') === 'ultimate';
            
            if (!hasPremium) {
                toggle.checked = false;
                showUpgradeModal();
                return;
            }
            
            if (toggle.checked) {
                requestWakeLock();
            } else {
                releaseWakeLock();
            }
        }
        
        async function requestWakeLock() {
            if ('wakeLock' in navigator) {
                try {
                    wakeLockSentinel = await navigator.wakeLock.request('screen');
                    showToast('☀️ Screen will stay awake while playing', 'success');
                    
                    // Show export tip
                    const exportTip = document.getElementById('exportTip');
                    if (exportTip) exportTip.style.display = 'block';
                    
                    // Re-request wake lock if visibility changes
                    wakeLockSentinel.addEventListener('release', () => {
                        console.log('Wake Lock released');
                        const toggle = document.getElementById('screenAwakeToggle');
                        if (toggle) toggle.checked = false;
                    });
                } catch (err) {
                    console.log('Wake Lock error:', err);
                    showToast('ℹ️ Screen wake not supported on this device. Try exporting to listen in pocket!', 'info');
                    const toggle = document.getElementById('screenAwakeToggle');
                    if (toggle) toggle.checked = false;
                    
                    // Show export tip as alternative
                    const exportTip = document.getElementById('exportTip');
                    if (exportTip) exportTip.style.display = 'block';
                }
            } else {
                showToast('ℹ️ Screen wake not available. Export your track to listen in pocket!', 'info');
                const toggle = document.getElementById('screenAwakeToggle');
                if (toggle) toggle.checked = false;
                
                // Show export tip as alternative
                const exportTip = document.getElementById('exportTip');
                if (exportTip) exportTip.style.display = 'block';
            }
        }
        
        function releaseWakeLock() {
            if (wakeLockSentinel) {
                wakeLockSentinel.release();
                wakeLockSentinel = null;
                showToast('Screen wake disabled', 'info');
            }
            
            // Hide export tip
            const exportTip = document.getElementById('exportTip');
            if (exportTip) exportTip.style.display = 'none';
        }
        
        // Initialize screen awake toggle for premium users
        function initScreenAwakeToggle() {
            const container = document.getElementById('screenAwakeContainer');
            const toggle = document.getElementById('screenAwakeToggle');
            
            const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                               localStorage.getItem('gfgn_license_tier') === 'premium' || 
                               localStorage.getItem('gfgn_license_tier') === 'ultimate';
            
            if (hasPremium && container && toggle) {
                container.classList.remove('premium-lock');
                container.classList.add('premium-unlocked');
                container.onclick = null;
                toggle.disabled = false;
                toggle.addEventListener('change', toggleScreenAwake);
                
                // Show export tip for premium users
                const exportTip = document.getElementById('exportTip');
                if (exportTip) exportTip.style.display = 'block';
            }
        }

        function enableBackgroundAudio() {
            // Request wake lock if available (prevents screen from sleeping)
            requestWakeLock();

            // Handle visibility changes to keep audio playing
            document.addEventListener('visibilitychange', handleVisibilityChange);
            
            // Also handle page hide for Safari iOS
            window.addEventListener('pagehide', handlePageHide);

            // Resume audio context if suspended
            if (window.generator && window.generator.audioContext) {
                if (window.generator.audioContext.state === 'suspended') {
                    window.generator.audioContext.resume();
                }
            }
        }

        function disableBackgroundAudio() {
            // Release wake lock
            releaseWakeLock();

            // Remove visibility change listener
            document.removeEventListener('visibilitychange', handleVisibilityChange);
            window.removeEventListener('pagehide', handlePageHide);
        }
        
        // Handle page hide (Safari iOS specific)
        function handlePageHide(event) {
            // Gracefully fade out audio to prevent pops/clicks
            if (window.generator && window.generator.isPlaying && window.generator.audioContext) {
                try {
                    const ctx = window.generator.audioContext;
                    const currentTime = ctx.currentTime;
                    
                    // Quick fade out over 50ms to prevent audio glitches
                    window.generator.gainNodes.forEach(gainNode => {
                        if (gainNode && gainNode.gain) {
                            gainNode.gain.cancelScheduledValues(currentTime);
                            gainNode.gain.setValueAtTime(gainNode.gain.value, currentTime);
                            gainNode.gain.linearRampToValueAtTime(0, currentTime + 0.05);
                        }
                    });
                } catch (e) {
                    console.log('Error fading audio on page hide:', e);
                }
            }
        }

        function handleVisibilityChange() {
            // Check premium access for background audio
            const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                               localStorage.getItem('gfgn_license_tier') === 'premium' || 
                               localStorage.getItem('gfgn_license_tier') === 'ultimate';
            
            if (document.hidden) {
                // App is minimized/backgrounded
                console.log('App minimized - Premium:', hasPremium);

                if (!hasPremium) {
                    // Non-premium: gracefully fade out and stop
                    if (window.generator && window.generator.isPlaying) {
                        try {
                            const ctx = window.generator.audioContext;
                            if (ctx) {
                                const currentTime = ctx.currentTime;
                                // Quick fade out to prevent pop
                                window.generator.gainNodes.forEach(gainNode => {
                                    if (gainNode && gainNode.gain) {
                                        gainNode.gain.cancelScheduledValues(currentTime);
                                        gainNode.gain.setValueAtTime(gainNode.gain.value, currentTime);
                                        gainNode.gain.linearRampToValueAtTime(0, currentTime + 0.05);
                                    }
                                });
                            }
                        } catch (e) {
                            console.log('Error fading out audio:', e);
                        }
                    }
                } else {
                    // Premium: try to keep audio active
                    if (window.generator && window.generator.audioContext) {
                        setTimeout(() => {
                            if (window.generator.audioContext.state === 'suspended') {
                                window.generator.audioContext.resume().catch(err => {
                                    console.log('Failed to resume audio context:', err);
                                });
                            }
                        }, 100);
                    }
                }
            } else {
                // App is focused again - resume audio smoothly
                console.log('App focused - resuming audio context');
                if (window.generator && window.generator.audioContext) {
                    if (window.generator.audioContext.state === 'suspended') {
                        window.generator.audioContext.resume().catch(err => {
                            console.log('Failed to resume audio context on focus:', err);
                        });
                    }
                }
            }
        }

        // Initialize progress on load
        loadProgress();

        // Daily wisdom quotes for companion - now uses translations
        function getDailyWisdomQuotes() {
            const t = translations.en;
            return [
                { text: t.wisdom1 || "The frequencies that created the universe are now working through you.", author: t.wisdomAuthor1 || "Genesis Companion" },
                { text: t.wisdom2 || "Every vibration you absorb rewrites your cellular memory.", author: t.wisdomAuthor2 || "Genesis Companion" },
                { text: t.wisdom3 || "37 � 73 = 2701 � the mathematics of divine creation itself.", author: t.wisdomAuthor3 || "Ancient Wisdom" },
                { text: t.wisdom4 || "In the beginning was the Word, and the Word was a frequency.", author: t.wisdomAuthor4 || "Genesis 1:1" },
                { text: t.wisdom5 || "Your body is 70% water � a perfect receiver for sacred sound.", author: t.wisdomAuthor5 || "Genesis Companion" },
                { text: t.wisdom6 || "Consistency is the key to transformation. One session at a time.", author: t.wisdomAuthor6 || "Genesis Companion" },
                { text: t.wisdom7 || "The same patterns in creation exist within you.", author: t.wisdomAuthor7 || "Sacred Geometry" },
                { text: t.wisdom8 || "Sound creates form. Frequency creates reality.", author: t.wisdomAuthor8 || "Cymatics" },
                { text: t.wisdom9 || "3,773 days taught me that divine timing is mathematical.", author: t.wisdomAuthor9 || "The Discovery" },
                { text: t.wisdom10 || "Let the Trinity frequencies restore your original blueprint.", author: t.wisdomAuthor10 || "Genesis Companion" },
                { text: t.wisdom11 || "You are not just listening � you are remembering who you are.", author: t.wisdomAuthor11 || "Genesis Companion" },
                { text: t.wisdom12 || "The 36 Hz beat frequency bridges earth and heaven.", author: t.wisdomAuthor12 || "Trinity Foundation" },
                { text: t.wisdom13 || "Every cell in your body responds to sacred mathematics.", author: t.wisdomAuthor13 || "Genesis Companion" },
                { text: t.wisdom14 || "What if the frequencies of Genesis 1:1 could heal you?", author: t.wisdomAuthor14 || "The Journey" }
            ];
        }

        // Get today's wisdom quote
        function getDailyWisdom() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
            const quotes = getDailyWisdomQuotes();
            return quotes[dayOfYear % quotes.length];
        }

        // Get time-based greeting
        function getTimeGreeting() {
            const hour = new Date().getHours();
            const t = translations.en;
            if (hour < 12) return { greeting: t.greetingMorning || "Good morning", emoji: "☀️" };
            if (hour < 17) return { greeting: t.greetingAfternoon || "Good afternoon", emoji: "🌤️" };
            if (hour < 21) return { greeting: t.greetingEvening || "Good evening", emoji: "🌅" };
            return { greeting: t.greetingEvening || "Good night", emoji: "🌙" };
        }

        // Render personalized companion header
        function renderCompanionHeader() {
            const greetingContainer = document.getElementById('companionGreeting');
            const wisdomContainer = document.getElementById('companionDailyWisdom');
            const statsContainer = document.getElementById('companionQuickStats');
            const actionsContainer = document.getElementById('companionQuickActions');

            if (!greetingContainer) return;

            const t = translations.en;

            // Time-based greeting with stats
            const timeInfo = getTimeGreeting();
            const totalSessions = userProgress.totalSessions || 0;
            const totalMinutes = Math.floor((userProgress.totalSeconds || 0) / 60);
            const streak = userProgress.currentStreak || 0;

            // Get dynamic title based on achievements
            const userTitle = getLevelTitle();
            
            greetingContainer.innerHTML = `
                ${timeInfo.emoji} ${timeInfo.greeting}, ${userTitle}
                <span style="font-size: 14px; color: #c4b5fd; font-weight: 400; display: block; margin-top: 4px;">
                    ${streak > 0 ? `🔥 ${streak} ${t.dayStreak || 'day streak'}` : (t.beginJourney || 'Begin your sacred journey today')}
                </span>
            `;

            // Daily wisdom
            const wisdom = getDailyWisdom();
            wisdomContainer.innerHTML = `"${wisdom.text}" <span style="color: #fbbf24; font-size: 12px;">� ${wisdom.author}</span>`;

            // Quick stats
            statsContainer.innerHTML = `
                <div style="text-align: center; padding: 10px 15px; background: rgba(139,92,246,0.15); border-radius: 10px; min-width: 80px;">
                    <div style="font-size: 22px; font-weight: 700; color: #fbbf24;">${totalSessions}</div>
                    <div style="font-size: 11px; color: #c4b5fd;">${t.statSessions || 'Sessions'}</div>
                </div>
                <div style="text-align: center; padding: 10px 15px; background: rgba(139,92,246,0.15); border-radius: 10px; min-width: 80px;">
                    <div style="font-size: 22px; font-weight: 700; color: #fbbf24;">${totalMinutes}</div>
                    <div style="font-size: 11px; color: #c4b5fd;">${t.statMinutes || 'Minutes'}</div>
                </div>
                <div style="text-align: center; padding: 10px 15px; background: rgba(139,92,246,0.15); border-radius: 10px; min-width: 80px;">
                    <div style="font-size: 22px; font-weight: 700; color: #fbbf24;">${userProgress.frequenciesUsed ? userProgress.frequenciesUsed.size || 0 : 0}</div>
                    <div style="font-size: 11px; color: #c4b5fd;">${t.statFrequencies || 'Frequencies'}</div>
                </div>
            `;

            // Quick action buttons (removed Start Session - user can use main PLAY button)
            actionsContainer.innerHTML = `
                <button onclick="showDailyChallengeModal();" style="background: linear-gradient(90deg, #fbbf24, #f59e0b); color: #1a0033; border: none; border-radius: 20px; padding: 10px 18px; font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                    <span>🎯</span> ${t.btnDailyChallenge || 'Daily Challenge'}
                </button>
                <button onclick="if(typeof showFullAchievements === 'function') showFullAchievements();" style="background: linear-gradient(90deg, #8b5cf6, #6b46c1); color: #fff; border: none; border-radius: 20px; padding: 10px 18px; font-size: 14px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 6px;">
                    <span>🏆</span> ${t.btnAchievements || 'Achievements'}
                </button>
                </button>
            `;
        }

        // Start quick session from companion
        function startQuickSession() {
            // Close the companion panel first
            const panel = document.getElementById('instructionsPanel');
            if (panel) panel.style.display = 'none';
            
            // Find Genesis Creation in trinityRecipes
            const biblicalCategory = trinityRecipes['Biblical & Original'];
            const genesisRecipe = biblicalCategory ? biblicalCategory.find(r => r.name.includes('Genesis Creation')) : null;
            
            if (genesisRecipe && window.generator) {
                window.generator.selectRecipe(genesisRecipe);
                setTimeout(() => {
                    window.generator.play();
                }, 300);
            }
        }

        // Show daily challenge modal
        function showDailyChallengeModal() {
            try {
            // Remove any existing modal first
            const existingModal = document.getElementById('dailyChallengeModal');
            if (existingModal) existingModal.remove();
            
            // Close companion panel properly (including its overlay)
            const overlay = document.getElementById('instructionsOverlay');
            if (overlay) {
                window.toggleInstructions();
            }
            
            let challenge;
            try {
                challenge = typeof renderDailyChallenge === 'function' ? renderDailyChallenge() : '<p style="color:#fff;">Complete a session today to unlock your daily challenge!</p>';
            } catch (e) {
                challenge = '<p style="color:#fff;">Your daily challenge awaits! Complete a session to see today\'s sacred mission.</p>';
            }
            
            const modal = document.createElement('div');
            modal.id = 'dailyChallengeModal';
            modal.className = 'daily-challenge-modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: #1a0a2e;
                z-index: 2000000;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            `;
            
            // Close function
            function closeDailyChallengeModal() {
                const m = document.getElementById('dailyChallengeModal');
                if (m) {
                    m.remove();
                }
                // Also remove companion overlay if it exists
                const overlay = document.getElementById('instructionsOverlay');
                if (overlay) {
                    overlay.remove();
                }
                // Ensure page is scrollable and visible
                document.body.style.overflow = '';
                window.scrollTo(0, 0);
            }
            
            // Store close function globally
            window.closeDailyChallengeModal = closeDailyChallengeModal;

            const t = translations.en;
            modal.innerHTML = `
                <div style="background: linear-gradient(135deg, rgba(26,0,51,0.98), rgba(139,92,246,0.3)); border-radius: 18px; padding: 30px; max-width: 500px; width: 100%; position: relative; z-index: 2000001; color: #fff; text-align: center; border: 2px solid rgba(251,191,36,0.3);">
                    <h2 style="font-size: 24px; color: #fbbf24; font-weight: 800; margin-bottom: 20px;">🌟 ${t.todaysSacredChallenge || "Today's Sacred Challenge"}</h2>
                    <div style="line-height: 1.6;">
                        ${challenge}
                    </div>
                    <button onclick="window.closeDailyChallengeModal();" style="margin-top: 25px; background: linear-gradient(90deg, #8b5cf6, #6b46c1); color: #fff; border: none; border-radius: 25px; padding: 15px 35px; font-size: 18px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(139,92,246,0.4);">
                        ${t.returnToTracks || '← Return to Tracks'}
                    </button>
                </div>
            `;
            
            // Click outside to close
            modal.addEventListener('click', function(e) {
                if (e.target === modal) closeDailyChallengeModal();
            });

            document.body.appendChild(modal);
            } catch (error) {
                console.error('Error showing daily challenge:', error);
                alert('Unable to load daily challenge. Please refresh the page and try again.');
            }
        }

        // Render Instructions Categories (like recipes)
        function renderInstructionsCategories() {
            const container = document.getElementById('instructionsAccordion');
            if (!container) return;
            container.innerHTML = '';

            // Render personalized header first
            renderCompanionHeader();
            
            // Get current translations
            const t = translations.en;
            
            // Get translated category names
            const catQuickStart = t.catQuickStart || '🚀 Quick Start';
            const catTheScience = t.catTheScience || '🔬 The Science';
            const catTheStory = t.catTheStory || '📖 The Story';
            const catHelp = t.catHelp || '❓ Help';

            // Define instruction categories - organized for optimal user experience
            // Order: Quick actions first, then understanding, then deeper content
            const instructionCategories = {
                [catQuickStart]: [
                    { id: 'quickStart', icon: '🚀', title: instructionsSections.find(s => s.id === 'quickStart')?.title || 'Your First Session', content: instructionsSections.find(s => s.id === 'quickStart')?.content || instructionsSections.find(s => s.id === 'quickStart')?.getContent?.() || '' },
                    { id: 'usageTips', icon: '💡', title: instructionsSections.find(s => s.id === 'usageTips')?.title || 'Best Practices', content: instructionsSections.find(s => s.id === 'usageTips')?.content || instructionsSections.find(s => s.id === 'usageTips')?.getContent?.() || '' },
                    { id: 'categories', icon: '🎵', title: instructionsSections.find(s => s.id === 'categories')?.title || 'Frequency Categories', content: instructionsSections.find(s => s.id === 'categories')?.content || instructionsSections.find(s => s.id === 'categories')?.getContent?.() || '' }
                ],
                [catTheScience]: [
                    { id: 'trinity', icon: '🔱', title: instructionsSections.find(s => s.id === 'trinity')?.title || 'The Trinity Foundation', content: instructionsSections.find(s => s.id === 'trinity')?.content || instructionsSections.find(s => s.id === 'trinity')?.getContent?.() || '' },
                    { id: 'whyWorks', icon: '🔬', title: instructionsSections.find(s => s.id === 'whyWorks')?.title || 'Why 37 & 73 Hz Work', content: instructionsSections.find(s => s.id === 'whyWorks')?.content || instructionsSections.find(s => s.id === 'whyWorks')?.getContent?.() || '' },
                    { id: 'waterCharging', icon: '💧', title: instructionsSections.find(s => s.id === 'waterCharging')?.title || 'Water Charging', content: instructionsSections.find(s => s.id === 'waterCharging')?.content || instructionsSections.find(s => s.id === 'waterCharging')?.getContent?.() || '' },
                    { id: 'crystalCharging', icon: '💎', title: instructionsSections.find(s => s.id === 'crystalCharging')?.title || 'Crystal Charging', content: instructionsSections.find(s => s.id === 'crystalCharging')?.content || instructionsSections.find(s => s.id === 'crystalCharging')?.getContent?.() || '' },
                    { id: 'progress', icon: '📊', title: instructionsSections.find(s => s.id === 'progress')?.title || 'Your Journey', content: instructionsSections.find(s => s.id === 'progress')?.content || instructionsSections.find(s => s.id === 'progress')?.getContent?.() || '' }
                ],
                [catTheStory]: [
                    { id: 'welcome', icon: '✨', title: instructionsSections.find(s => s.id === 'welcome')?.title || 'About Genesis Frequencies', content: instructionsSections.find(s => s.id === 'welcome')?.content || instructionsSections.find(s => s.id === 'welcome')?.getContent?.() || '' },
                    { id: 'myJourney', icon: '📖', title: instructionsSections.find(s => s.id === 'myJourney')?.title || 'The Discovery', content: instructionsSections.find(s => s.id === 'myJourney')?.content || instructionsSections.find(s => s.id === 'myJourney')?.getContent?.() || '' }
                ],
                [catHelp]: [
                    { id: 'faq', icon: '❓', title: instructionsSections.find(s => s.id === 'faq')?.title || 'FAQ', content: instructionsSections.find(s => s.id === 'faq')?.content || instructionsSections.find(s => s.id === 'faq')?.getContent?.() || '' },
                    { id: 'share', icon: '📤', title: instructionsSections.find(s => s.id === 'share')?.title || 'Share', content: instructionsSections.find(s => s.id === 'share')?.content || instructionsSections.find(s => s.id === 'share')?.getContent?.() || '' },
                    { id: 'credits', icon: '📜', title: instructionsSections.find(s => s.id === 'credits')?.title || 'Credits', content: instructionsSections.find(s => s.id === 'credits')?.content || instructionsSections.find(s => s.id === 'credits')?.getContent?.() || '' }
                ]
            };

            // Create category tabs
            Object.keys(instructionCategories).forEach((categoryName, categoryIndex) => {
                const categoryTab = document.createElement('div');
                categoryTab.className = 'category-tab';

                // All categories start collapsed for cleaner UX
                // User can expand what they want to see

                categoryTab.innerHTML = `
                    <div class="category-header" style="background: linear-gradient(135deg, rgba(139,92,246,0.2), rgba(251,191,36,0.1));">
                        <div class="category-title">
                            <span>${categoryName}</span>
                        </div>
                        <div class="category-arrow">▼</div>
                    </div>
                    <div class="category-content">
                        <div class="category-tracks"></div>
                    </div>
                `;

                const header = categoryTab.querySelector('.category-header');
                header.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    categoryTab.classList.toggle('expanded');
                });

                const tracksContainer = categoryTab.querySelector('.category-tracks');

                // Add sections to category
                instructionCategories[categoryName].forEach((section) => {
                    if (!section.content) return; // Skip if section doesn't exist

                    const sectionElement = document.createElement('div');
                    sectionElement.className = 'recipe-item';
                    sectionElement.style.cssText = 'cursor: pointer; transition: all 0.2s ease;';
                    sectionElement.innerHTML = `
                        <div class="recipe-info" style="flex: 1;">
                            <div class="recipe-name" style="font-size: 15px;">${section.icon} ${section.title}</div>
                        </div>
                        <div class="recipe-buttons">
                            <button class="track-btn info-btn" title="Read this section" style="font-size: 16px;">ℹ️</button>
                        </div>
                    `;

                    // Add hover effect
                    sectionElement.addEventListener('mouseenter', () => {
                        sectionElement.style.background = 'rgba(139,92,246,0.15)';
                    });
                    sectionElement.addEventListener('mouseleave', () => {
                        sectionElement.style.background = '';
                    });

                    const infoBtn = sectionElement.querySelector('.info-btn');

                    infoBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showInstructionModal(section);
                    });

                    // Also allow clicking the info area to open
                    const infoArea = sectionElement.querySelector('.recipe-info');
                    infoArea.addEventListener('click', (e) => {
                        e.stopPropagation();
                        showInstructionModal(section);
                    });

                    tracksContainer.appendChild(sectionElement);
                });

                container.appendChild(categoryTab);
            });
        }

        // Show instruction modal
        function showInstructionModal(section) {
            // Create modal overlay
            const modal = document.createElement('div');
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                z-index: 3000000;
                display: flex;
                align-items: flex-start;
                justify-content: center;
                padding: 20px;
                overflow-y: auto;
            `;

            modal.innerHTML = `
                <div style="background: rgba(26,0,51,0.97); border-radius: 18px; padding: 30px; max-width: 800px; width: 100%; max-height: none; overflow-y: visible; position: relative; color: #fff; margin: 20px auto;">
                    <button class="btn-close" style="background: none; border: none; color: #c4b5fd; font-size: 28px; cursor: pointer; position: absolute; top: 15px; right: 20px;">✕</button>
                    <div style="text-align: center; margin-bottom: 20px;">
                        <h2 style="font-size: 24px; color: #fbbf24; font-weight: 800; margin: 0;">
                            ${section.icon} ${section.title}
                        </h2>
                    </div>
                    <div style="line-height: 1.6;">
                        ${section.content}
                    </div>
                </div>
            `;

            // Close modal functionality
            const closeBtn = modal.querySelector('.btn-close');
            closeBtn.addEventListener('click', () => {
                document.body.removeChild(modal);
                document.body.style.overflow = '';
            });

            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    document.body.removeChild(modal);
                    document.body.style.overflow = '';
                }
            });

            document.body.style.overflow = 'hidden';
            document.body.appendChild(modal);
            
            // Scroll to top of modal
            modal.scrollTop = 0;
            window.scrollTo(0, 0);
        }

        // Search/filter instructions
        function filterInstructions(query) {
            const panels = document.querySelectorAll('.accordion-panel');
            panels.forEach(panel => {
                const title = panel.querySelector('.accordion-header').textContent.toLowerCase();
                const content = panel.querySelector('.accordion-content').textContent.toLowerCase();
                if (title.includes(query) || content.includes(query)) {
                    panel.style.display = '';
                } else {
                    panel.style.display = 'none';
                }
            });
        }

        // Add search input to instructions panel
        function addInstructionsSearch() {
        // Removed: instructions search bar logic
        }

        // Call rendering on panel open
        // toggleInstructions is defined at the top

        // Helper function to get recipe translation key prefix
        function getRecipeTranslationKey(recipeName) {
            const keyMap = {
                // Chakra Frequencies
                'Root Chakra': 'recipeRootChakra',
                'Sacral Chakra': 'recipeSacralChakra',
                'Solar Plexus Chakra': 'recipeSolarPlexus',
                'Heart Chakra': 'recipeHeartChakra',
                'Throat Chakra': 'recipeThroatChakra',
                'Third Eye Chakra': 'recipeThirdEyeChakra',
                'Crown Chakra': 'recipeCrownChakra',
                // Biblical & Original
                'Genesis Creation': 'recipeGenesisCreation',
                'Divine Abundance': 'recipeDivineAbundance',
                '12 Apostles': 'recipe12Apostles',
                '7 Churches': 'recipe7Churches',
                '40 Days': 'recipe40Days',
                '3 Days': 'recipe3Days',
                // Solfeggio & Healing
                'Sacred Healing': 'recipeSacredHealing',
                'Love Frequency': 'recipeLoveFrequency',
                'Liberation (396)': 'recipeLiberation396',
                'Resolution (417)': 'recipeResolution417',
                'Transformation (639)': 'recipeTransformation639',
                'Awakening (852)': 'recipeAwakening852',
                'Higher Self': 'recipeHigherSelf',
                'Intuition': 'recipeIntuition',
                // Angel Numbers
                'Angel Numbers': 'recipeAngel111',
                'Angel 222': 'recipeAngel222',
                'Angel 333': 'recipeAngel333',
                'Angel 444': 'recipeAngel444',
                'Angel 555': 'recipeAngel555',
                'Angel 666': 'recipeAngel666',
                'Angel 777': 'recipeAngel777',
                'Angel 888': 'recipeAngel888',
                'Angel 999': 'recipeAngel999',
                // Master Numbers
                'Master 11:11': 'recipeMaster11',
                'Master 22': 'recipeMaster22',
                'Master 33': 'recipeMaster33',
                'Master 44': 'recipeMaster44',
                'Master 55': 'recipeMaster55',
                // Cosmic & Planetary
                'Earth Resonance': 'recipeEarthResonance',
                'Venus Love': 'recipeVenusLove',
                'Mars Action': 'recipeMarsAction',
                'Fibonacci 144': 'recipeFibonacci144',
                'Pi 314': 'recipePi314',
                'Golden Ratio': 'recipeGoldenRatio',
                // Wellness & States
                'Pain Relief': 'recipePainRelief',
                'Stress Relief': 'recipeStressRelief',
                'Sleep Deep': 'recipeSleepDeep',
                'Focus Clear': 'recipeFocusClear',
                'Memory Boost': 'recipeMemoryBoost',
                'Miracle Tone': 'recipeMiracleTone'
            };
            return keyMap[recipeName] || null;
        }

        // Store scroll position for modal restore
        let savedScrollPosition = 0;
        
        function showInfoModal(recipe) {
            const modal = document.getElementById('infoModal');
            const title = document.getElementById('modalTitle');
            const freqs = document.getElementById('modalFreqs');
            const body = document.getElementById('modalBody');
            
            // Save current scroll position
            savedScrollPosition = window.scrollY || window.pageYOffset;
            
            title.textContent = recipe.name;
            freqs.textContent = `${recipe.frequencies.join(' Hz + ')} Hz`;
            
            // Prevent body scroll when modal opens
            document.body.style.overflow = 'hidden';
            
            if (recipe.fullInfo) {
                const t = translations.en;
                const keyPrefix = getRecipeTranslationKey(recipe.name);
                
                // Get translated content or fall back to English
                let whatItIs, benefits, howToUse;
                if (keyPrefix && t[keyPrefix + 'What']) {
                    whatItIs = t[keyPrefix + 'What'];
                    benefits = t[keyPrefix + 'Benefits'];
                    howToUse = t[keyPrefix + 'How'];
                } else {
                    // Fallback to original English content
                    whatItIs = recipe.fullInfo.whatItIs;
                    benefits = recipe.fullInfo.benefits;
                    howToUse = recipe.fullInfo.howToUse;
                }
                
                body.innerHTML = `
                    <h3>${t.infoWhatItIs || 'What It Is'}</h3>
                    <p>${whatItIs}</p>
                    
                    <h3>${t.infoBenefits || 'Benefits'}</h3>
                    <p>${benefits}</p>
                    
                    <h3>${t.infoHowToUse || 'How To Use'}</h3>
                    <p>${howToUse}</p>
                `;
            } else {
                body.innerHTML = `<p>${recipe.description}</p>`;
            }
            
            modal.style.display = 'flex';
            
            // Scroll modal content to top
            const modalContent = modal.querySelector('.info-modal-content');
            if (modalContent) {
                modalContent.scrollTop = 0;
            }
        }
        
        function closeInfoModal() {
            const modal = document.getElementById('infoModal');
            modal.style.display = 'none';
            // Restore body scroll
            document.body.style.overflow = '';
            // Restore scroll position
            window.scrollTo(0, savedScrollPosition);
        }
        
        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('infoModal');
            if (e.target === modal) {
                closeInfoModal();
            }
        });

        // Close modal with ESC key for accessibility
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' || e.keyCode === 27) {
                const infoModal = document.getElementById('infoModal');
                const upgradeModal = document.getElementById('upgradeModal');
                const immersiveWelcome = document.getElementById('immersiveWelcome');
                
                if (infoModal && infoModal.classList.contains('active')) {
                    closeInfoModal();
                }
                if (upgradeModal && upgradeModal.style.display === 'flex') {
                    closeUpgradeModal();
                }
                if (immersiveWelcome && immersiveWelcome.classList.contains('active')) {
                    skipToApp();
                }
            }
        });

        class FrequencyGenerator {
            constructor() {
                this.audioContext = null;
                this.oscillators = [];
                this.gainNodes = [];
                this.isPlaying = false;
                this.selectedRecipe = null;
                this.countdownInterval = null;
                this.startTime = null;
                this.totalDuration = 0;
                
                this.initializeElements();
                this.loadRecipes();
                this.attachEventListeners();
            }

            initializeElements() {
                this.elements = {
                    freq1: document.getElementById('freq1'),
                    freq2: document.getElementById('freq2'),
                    freq3: document.getElementById('freq3'),
                    volume1: document.getElementById('volume1'),
                    volume2: document.getElementById('volume2'),
                    volume3: document.getElementById('volume3'),
                    volume1Value: document.getElementById('volume1Value'),
                    volume2Value: document.getElementById('volume2Value'),
                    volume3Value: document.getElementById('volume3Value'),
                    duration: document.getElementById('duration'),
                    playBtn: document.getElementById('playBtn'),
                    stopBtn: document.getElementById('stopBtn'),
                    exportBtn: document.getElementById('exportBtn'),
                    resetBtn: document.getElementById('resetBtn'),
                    status: document.getElementById('status'),
                    recipes: document.getElementById('recipes')
                };
            }

            loadRecipes() {
                this.elements.recipes.innerHTML = '';
                
                // Define category order
                const categoryOrder = [
                    "Biblical & Original",
                    "Angel Numbers",
                    "Cosmic & Planetary",
                    "Master Numbers",
                    "Solfeggio & Healing",
                    "Wellness & States",
                    "Chakra Frequencies"
                ];
                
                // Create category tabs in specified order
                categoryOrder.forEach((category, categoryIndex) => {
                    if (!trinityRecipes[category]) {
                        console.warn('Category not found in trinityRecipes:', category);
                        return;
                    }
                    const categoryTab = document.createElement('div');
                    categoryTab.className = 'category-tab';
                    
                    const categoryIcons = {
                        "Biblical & Original": "✡️",
                        "Solfeggio & Healing": "💜",
                        "Angel Numbers": "👼",
                        "Master Numbers": "🔢",
                        "Cosmic & Planetary": "🌌",
                        "Wellness & States": "🧘",
                        "Chakra Frequencies": "🌈"
                    };

                    const categoryKeys = {
                        "Biblical & Original": "catBiblical",
                        "Solfeggio & Healing": "catSolfeggio",
                        "Angel Numbers": "catAngel",
                        "Master Numbers": "catMaster",
                        "Cosmic & Planetary": "catCosmic",
                        "Wellness & States": "catWellness",
                        "Chakra Frequencies": "catChakra"
                    };
                    
                    categoryTab.innerHTML = `
                        <div class="category-header">
                            <div class="category-title">
                                <span class="category-icon">${categoryIcons[category] || '✨'}</span>
                                <span data-translate="${categoryKeys[category]}">${category}</span>
                                <span class="category-icon">${categoryIcons[category] || '✨'}</span>
                            </div>
                            <div class="category-arrow">▼</div>
                        </div>
                        <div class="category-content">
                            <div class="category-tracks"></div>
                        </div>
                    `;
                    
                    const header = categoryTab.querySelector('.category-header');
                    header.addEventListener('click', () => {
                        categoryTab.classList.toggle('expanded');
                    });
                    
                    const tracksContainer = categoryTab.querySelector('.category-tracks');
                    
                    // Add recipes to category
                    trinityRecipes[category].forEach((recipe) => {
                        const recipeElement = document.createElement('div');
                        recipeElement.className = 'recipe-item';
                        recipeElement.innerHTML = `
                            <div class="recipe-info">
                                <div class="recipe-name" data-translate="track${recipe.name.replace(/[^a-zA-Z0-9]/g, '').replace(/\s+/g, '')}">${recipe.name}</div>
                                <div class="recipe-freqs">${recipe.frequencies.join(' Hz + ')} Hz</div>
                            </div>
                            <div class="recipe-buttons">
                                <button class="track-btn play-btn" title="Play this track">▶️</button>
                                <button class="track-btn info-btn" title="Learn more">ℹ️</button>
                            </div>
                        `;
                        
                        const playBtn = recipeElement.querySelector('.play-btn');
                        const infoBtn = recipeElement.querySelector('.info-btn');
                        
                        if (!infoBtn) {
                            console.error('Info button not found for recipe:', recipe.name);
                        }
                        
                        playBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            this.selectRecipe(recipe);
                            // Auto-play after selection
                            setTimeout(() => this.play(), 300);
                        });
                        
                        if (infoBtn) {
                            infoBtn.addEventListener('click', (e) => {
                                e.stopPropagation();
                                e.preventDefault();
                                showInfoModal(recipe);
                            });
                        }
                        
                        // Also allow clicking the info area to load without playing
                        const infoArea = recipeElement.querySelector('.recipe-info');
                        infoArea.addEventListener('click', (e) => {
                            e.stopPropagation();
                            this.selectRecipe(recipe);
                        });
                        
                        tracksContainer.appendChild(recipeElement);
                    });
                    
                    this.elements.recipes.appendChild(categoryTab);
                });
            }

            selectRecipe(recipe) {
                // Remove previous selection
                document.querySelectorAll('.recipe-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                // Add selection to clicked recipe - find it by name
                document.querySelectorAll('.recipe-item').forEach(item => {
                    const nameElement = item.querySelector('.recipe-name');
                    if (nameElement && nameElement.textContent === recipe.name) {
                        item.classList.add('active');
                    }
                });
                
                // Load recipe frequencies
                const frequencies = [
                    recipe.frequencies[0] || 37,
                    recipe.frequencies[1] || 73,
                    recipe.frequencies[2] || 0
                ];
                
                this.elements.freq1.value = frequencies[0];
                this.elements.freq2.value = frequencies[1];
                this.elements.freq3.value = frequencies[2];
                
                // Apply therapeutic volume balancing (from Python generator)
                const activeFreqs = frequencies.filter(f => f > 0);
                const foundationFreq = Math.min(...activeFreqs);
                
                frequencies.forEach((freq, i) => {
                    if (freq > 0) {
                        let amplitude = 1.0;
                        
                        // Determine base amplitude based on frequency range
                        if (freq === foundationFreq || freq <= 100) {
                            amplitude = 1.0;
                        } else if (freq <= 400) {
                            amplitude = 0.2;
                        } else if (freq <= 1000) {
                            amplitude = 0.1;
                        } else {
                            amplitude = 0.05;
                        }
                        
                        // Scale non-foundation frequencies by number of active frequencies
                        // BUT only if they're NOT in the =100 Hz range (keep 37 & 73 at 100%)
                        if (freq !== foundationFreq && freq > 100) {
                            amplitude = amplitude / activeFreqs.length;
                        }
                        
                        // Convert to percentage (0-100) and set volume
                        const volumePercent = Math.round(amplitude * 100);
                        const volumeElement = [this.elements.volume1, this.elements.volume2, this.elements.volume3][i];
                        const volumeValueElement = [this.elements.volume1Value, this.elements.volume2Value, this.elements.volume3Value][i];
                        
                        volumeElement.value = volumePercent;
                        volumeValueElement.textContent = `${volumePercent}%`;
                    }
                });
                
                this.selectedRecipe = recipe;
                this.updateStatus(`? Selected: ${recipe.name} (Auto-balanced volumes)`);
            }

            attachEventListeners() {
                this.elements.playBtn.addEventListener('click', () => this.play());
                this.elements.stopBtn.addEventListener('click', () => this.stop());
                this.elements.exportBtn.addEventListener('click', () => this.export());
                this.elements.resetBtn.addEventListener('click', () => this.reset());
                
                // Individual volume controls
                this.elements.volume1.addEventListener('input', (e) => {
                    this.elements.volume1Value.textContent = `${e.target.value}%`;
                    this.updateVolume();
                });
                
                this.elements.volume2.addEventListener('input', (e) => {
                    this.elements.volume2Value.textContent = `${e.target.value}%`;
                    this.updateVolume();
                });
                
                this.elements.volume3.addEventListener('input', (e) => {
                    this.elements.volume3Value.textContent = `${e.target.value}%`;
                    this.updateVolume();
                });
                
                // Duration format validation
                this.elements.duration.addEventListener('input', (e) => {
                    this.validateTimeFormat(e.target);
                    
                    // For free users on non-Genesis tracks, enforce 30 second limit
                    const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                                       localStorage.getItem('gfgn_license_tier') === 'premium' || 
                                       localStorage.getItem('gfgn_license_tier') === 'ultimate';
                    
                    if (!hasPremium) {
                        const currentFreqs = [
                            parseFloat(this.elements.freq1.value),
                            parseFloat(this.elements.freq2.value),
                            parseFloat(this.elements.freq3.value)
                        ].filter(f => f > 0);
                        
                        const isGenesisCreation = currentFreqs.length === 2 && 
                                                  currentFreqs.includes(37) && 
                                                  currentFreqs.includes(73);
                        
                        if (!isGenesisCreation) {
                            // Force 30 seconds for non-Genesis tracks
                            e.target.value = '00:30';
                        }
                    }
                });

                // Duration quick buttons
                document.querySelectorAll('.duration-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const time = e.target.dataset.time;
                        const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                                           localStorage.getItem('gfgn_license_tier') === 'premium' || 
                                           localStorage.getItem('gfgn_license_tier') === 'ultimate';
                        
                        // Check if current recipe is Genesis Creation (37+73 only)
                        const currentFreqs = [
                            parseFloat(this.elements.freq1.value),
                            parseFloat(this.elements.freq2.value),
                            parseFloat(this.elements.freq3.value)
                        ].filter(f => f > 0);
                        
                        const isGenesisCreation = currentFreqs.length === 2 && 
                                                  currentFreqs.includes(37) && 
                                                  currentFreqs.includes(73);
                        
                        // Genesis Creation gets full duration control even in free version
                        // Other tracks in free version are locked to 30 seconds
                        if (!hasPremium && !isGenesisCreation) {
                            showUpgradeModal();
                            return;
                        }
                        
                        this.elements.duration.value = time;
                        this.updateStatus(`⏱️ Duration set to ${time}`);
                        
                        // Remove active class from all duration buttons
                        document.querySelectorAll('.duration-btn').forEach(b => b.classList.remove('active'));
                        // Add active class to clicked button
                        e.target.classList.add('active');
                    });
                });
                
                // Auto-select first recipe (Genesis Creation)
                setTimeout(() => {
                    const firstCategory = Object.keys(trinityRecipes)[0];
                    const firstRecipe = trinityRecipes[firstCategory][0];
                    this.selectRecipe(firstRecipe);
                }, 100);
                
                // Track user interactions for silent mode detection
                const trackInteraction = () => {
                    localStorage.setItem('lastUserInteraction', Date.now().toString());
                };
                
                // Track various user interactions
                ['click', 'touchstart', 'keydown', 'scroll'].forEach(event => {
                    document.addEventListener(event, trackInteraction, { passive: true });
                });
            }

            async play() {
                // Haptic feedback for mobile
                if ('vibrate' in navigator) {
                    navigator.vibrate(50);
                }

                if (this.isPlaying) {
                    this.stop();
                    return;
                }

                // Check premium status using license tier system
                const isPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                                  localStorage.getItem('gfgn_license_tier') === 'premium' || 
                                  localStorage.getItem('gfgn_license_tier') === 'ultimate';
                
                // Get current frequencies
                const frequencies = [
                    parseFloat(this.elements.freq1.value),
                    parseFloat(this.elements.freq2.value),
                    parseFloat(this.elements.freq3.value)
                ].filter(freq => freq > 0);
                
                // Check if this is the Genesis Creation track (37+73 only)
                const isGenesisCreation = frequencies.length === 2 && 
                                          frequencies.includes(37) && 
                                          frequencies.includes(73);
                
                if (!isPremium && !isGenesisCreation) {
                    // Non-Genesis tracks: Force 30-second duration, no alerts, just play
                    this.elements.duration.value = '00:30';
                }
                // Genesis Creation track: No restrictions, use whatever duration user set
                
                try {
                    // Initialize audio context with better iOS/Safari handling
                    if (!this.audioContext) {
                        this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
                        
                        // Add state change listener to handle interruptions gracefully
                        this.audioContext.addEventListener('statechange', async () => {
                            console.log('AudioContext state changed to:', this.audioContext.state);
                            if (this.audioContext.state === 'interrupted' || this.audioContext.state === 'suspended') {
                                // Audio was interrupted (e.g., phone call, silent mode switch)
                                console.log('Audio interrupted - attempting to resume...');
                                // Auto-resume after interruption
                                try {
                                    await this.audioContext.resume();
                                    console.log('Audio resumed after interruption');
                                } catch (e) {
                                    console.log('Could not resume audio:', e);
                                }
                            }
                        });
                    }
                    
                    // Always resume audio context if not running (required for iOS/Safari)
                    if (this.audioContext.state !== 'running') {
                        console.log('AudioContext state:', this.audioContext.state, '- attempting to resume...');
                        await this.audioContext.resume();
                        console.log('AudioContext resumed. New state:', this.audioContext.state);
                        
                        // If still not running after resume attempt, show prominent modal
                        if (this.audioContext.state !== 'running') {
                            this.showSilentModeWarning();
                            return;
                        }
                    }
                    
                    // Test audio playback capability
                    const testResult = await this.testAudioPlayback();
                    if (!testResult.canPlay) {
                        this.showSilentModeWarning();
                        return;
                    }

                    // Enable background audio for premium users (use new tier system)
                    const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                                       localStorage.getItem('gfgn_license_tier') === 'premium' || 
                                       localStorage.getItem('gfgn_license_tier') === 'ultimate';
                    if (hasPremium && !backgroundAudioEnabled) {
                        backgroundAudioEnabled = true;
                        enableBackgroundAudio();
                        console.log('Premium background audio automatically enabled');
                    }
                    
                    // Get frequencies
                    const frequencies = [
                        parseFloat(this.elements.freq1.value),
                        parseFloat(this.elements.freq2.value),
                        parseFloat(this.elements.freq3.value)
                    ].filter(freq => freq > 0);
                    
                    if (frequencies.length === 0) {
                        this.updateStatus('⚠️ Please enter at least one frequency');
                        return;
                    }
                    
                    // Create oscillators and gain nodes with individual volumes
                    const volumes = [
                        parseFloat(this.elements.volume1.value) / 100,
                        parseFloat(this.elements.volume2.value) / 100,
                        parseFloat(this.elements.volume3.value) / 100
                    ];
                    
                    console.log('Volume levels:', volumes, 'from sliders:', [
                        this.elements.volume1.value,
                        this.elements.volume2.value,
                        this.elements.volume3.value
                    ]);
                    
                    const currentTime = this.audioContext.currentTime;
                    const fadeInDuration = 0.5;  // 0.5 second fade in
                    const fadeOutDuration = 0.1; // 0.1 second fade out
                    const totalDuration = this.parseDuration();
                    
                    frequencies.forEach((freq, index) => {
                        const oscillator = this.audioContext.createOscillator();
                        const gainNode = this.audioContext.createGain();
                        
                        oscillator.type = 'sine';
                        oscillator.frequency.setValueAtTime(freq, currentTime);
                        
                        console.log(`Creating oscillator ${index + 1}: ${freq} Hz, volume: ${volumes[index]}`);
                        
                        // Start at 0 volume and fade in
                        gainNode.gain.setValueAtTime(0, currentTime);
                        gainNode.gain.linearRampToValueAtTime(volumes[index], currentTime + fadeInDuration);
                        
                        // Schedule fade out before ending
                        const fadeOutStart = currentTime + totalDuration - fadeOutDuration;
                        gainNode.gain.setValueAtTime(volumes[index], fadeOutStart);
                        gainNode.gain.linearRampToValueAtTime(0, currentTime + totalDuration);
                        
                        oscillator.connect(gainNode);
                        gainNode.connect(this.audioContext.destination);
                        
                        oscillator.start(currentTime);
                        oscillator.stop(currentTime + totalDuration);
                        
                        this.oscillators.push(oscillator);
                        this.gainNodes.push(gainNode);
                    });
                    
                    this.isPlaying = true;
                    this.elements.playBtn.textContent = '⏸ PAUSE';

                    // Add playing class to current recipe's play button
                    document.querySelectorAll('.track-btn.play-btn').forEach(btn => {
                        btn.classList.remove('playing');
                    });
                    if (this.selectedRecipe) {
                        const selectedRecipeElement = Array.from(document.querySelectorAll('.recipe-item')).find(item => {
                            const nameElement = item.querySelector('.recipe-name');
                            return nameElement && nameElement.textContent === this.selectedRecipe.name;
                        });
                        if (selectedRecipeElement) {
                            const playBtn = selectedRecipeElement.querySelector('.play-btn');
                            if (playBtn) {
                                playBtn.classList.add('playing');
                                playBtn.textContent = '⏸';
                                playBtn.title = 'Pause this track';
                            }
                        }
                    }
                    
                    // Show Now Playing bar
                    const nowPlayingBar = document.getElementById('nowPlayingBar');
                    const nowPlayingTrack = document.getElementById('nowPlayingTrack');
                    if (nowPlayingBar && nowPlayingTrack) {
                        nowPlayingTrack.textContent = this.selectedRecipe ? this.selectedRecipe.name : 'Custom Frequencies';
                        nowPlayingBar.classList.add('active');
                    }
                    
                    // Start countdown timer
                    this.totalDuration = this.parseDuration();
                    this.startTime = Date.now();
                    this.startCountdown();
                    
                    // Auto-stop after duration
                    const duration = this.totalDuration * 1000;
                    setTimeout(() => {
                        if (this.isPlaying) {
                            this.stop();
                            // Record session in new achievement system
                            if (window.GenesisAchievements && this.selectedRecipe) {
                                const frequencies = this.selectedRecipe.frequencies || [];
                                const trackId = this.selectedRecipe.name.toLowerCase().replace(/\s+/g, '');
                                // Map category (simplified for now)
                                let category = 'biblical'; // default
                                if (this.selectedRecipe.name.includes('Angel') || this.selectedRecipe.name.includes('11:11')) {
                                    category = 'angelNumbers';
                                } else if (this.selectedRecipe.name.includes('Cosmic') || this.selectedRecipe.name.includes('Planetary')) {
                                    category = 'cosmic';
                                } else if (this.selectedRecipe.name.includes('Solfeggio') || this.selectedRecipe.name.includes('Chakra')) {
                                    category = 'solfeggio';
                                }

                                window.GenesisAchievements.recordSession(
                                    this.totalDuration,
                                    frequencies,
                                    trackId,
                                    category,
                                    {
                                        intentionSet: false, // TODO: track user intentions
                                        waterCharging: false, // TODO: track water charging
                                        journalEntry: null // TODO: track journal entries
                                    }
                                );
                            }
                        }
                    }, duration);
                    
                } catch (error) {
                    console.error('Playback error:', error);
                    this.updateStatus('⚠️ Playback error - please try again');
                }
            }

            stop() {
                // Fade out smoothly before stopping
                const fadeOutTime = 0.1;
                const currentTime = this.audioContext ? this.audioContext.currentTime : 0;
                
                this.gainNodes.forEach(gain => {
                    try {
                        gain.gain.cancelScheduledValues(currentTime);
                        gain.gain.setValueAtTime(gain.gain.value, currentTime);
                        gain.gain.linearRampToValueAtTime(0, currentTime + fadeOutTime);
                    } catch (e) {
                        console.warn('Error during fade out:', e);
                    }
                });
                
                // Stop oscillators after fade out
                setTimeout(() => {
                    this.oscillators.forEach(osc => {
                        try {
                            osc.stop();
                            osc.disconnect();
                        } catch (e) {
                            console.warn('Error stopping oscillator:', e);
                        }
                    });
                    
                    this.gainNodes.forEach(gain => {
                        try {
                            gain.disconnect();
                        } catch (e) {
                            console.warn('Error disconnecting gain node:', e);
                        }
                    });
                    
                    this.oscillators = [];
                    this.gainNodes = [];
                }, fadeOutTime * 1000);
                
                this.isPlaying = false;
                
                // Remove playing class from all play buttons and reset text
                document.querySelectorAll('.track-btn.play-btn').forEach(btn => {
                    btn.classList.remove('playing');
                    btn.textContent = '▶';
                    btn.title = 'Play this track';
                });
                
                // Clear countdown timer
                if (this.countdownInterval) {
                    clearInterval(this.countdownInterval);
                    this.countdownInterval = null;
                }
                
                // Restore original duration value
                if (this.originalDuration) {
                    this.elements.duration.value = this.originalDuration;
                }
                
                this.elements.playBtn.textContent = '▶ PLAY';
                this.updateStatus('⏹ Stopped - Ready to Generate');
                
                // Hide Now Playing bar
                const nowPlayingBar = document.getElementById('nowPlayingBar');
                if (nowPlayingBar) {
                    nowPlayingBar.classList.remove('active');
                }
            }

            startCountdown() {
                // Store original duration to restore later
                this.originalDuration = this.elements.duration.value;
                
                const updateCountdown = () => {
                    if (!this.isPlaying) return;
                    
                    const elapsed = (Date.now() - this.startTime) / 1000;
                    const remaining = Math.max(0, this.totalDuration - elapsed);
                    
                    const minutes = Math.floor(remaining / 60);
                    const seconds = Math.floor(remaining % 60);
                    const timeStr = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                    
                    // Update duration input with countdown
                    this.elements.duration.value = timeStr;
                    
                    // Update Now Playing bar time
                    const nowPlayingTime = document.getElementById('nowPlayingTime');
                    if (nowPlayingTime) {
                        nowPlayingTime.textContent = timeStr;
                    }
                    
                    const frequencies = [
                        parseFloat(this.elements.freq1.value),
                        parseFloat(this.elements.freq2.value),
                        parseFloat(this.elements.freq3.value)
                    ].filter(freq => freq > 0);
                    
                    this.updateStatus(`🎵 Playing ${frequencies.join(' Hz + ')} Hz | ⏱️ ${timeStr} remaining`);
                    
                    if (remaining <= 0) {
                        clearInterval(this.countdownInterval);
                        this.countdownInterval = null;
                    }
                };
                
                updateCountdown();
                this.countdownInterval = setInterval(updateCountdown, 1000);
            }

            updateVolume() {
                if (this.isPlaying) {
                    const volumes = [
                        parseFloat(this.elements.volume1.value) / 100,
                        parseFloat(this.elements.volume2.value) / 100,
                        parseFloat(this.elements.volume3.value) / 100
                    ];
                    
                    this.gainNodes.forEach((gainNode, index) => {
                        gainNode.gain.setValueAtTime(volumes[index], this.audioContext.currentTime);
                    });
                }
            }

            isDeviceInSilentMode() {
                // Check if device is likely in silent mode
                // This is a heuristic since there's no direct API for silent mode detection
                
                // Check if we're on a mobile device
                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                if (!isMobile) return false;
                
                // Try to detect if audio output is muted or very low
                // We can check the device's audio capabilities and user preferences
                try {
                    // Check if the device has vibration API (mobile indicator)
                    const hasVibration = 'vibrate' in navigator;
                    
                    // Check if we're in a WebView or PWA context where silent mode might be enforced
                    const isStandalone = window.matchMedia('(display-mode: standalone)').matches || 
                                       window.navigator.standalone === true;
                    
                    // On iOS, silent mode often prevents audio playback in certain contexts
                    // On Android, we can check if the audio context fails to start
                    if (this.audioContext && this.audioContext.state === 'suspended') {
                        return true; // Audio context suspended might indicate silent mode
                    }
                    
                    // Check if the user has recently interacted (recent interaction suggests not silent)
                    const lastInteraction = localStorage.getItem('lastUserInteraction');
                    if (lastInteraction) {
                        const timeSinceInteraction = Date.now() - parseInt(lastInteraction);
                        // If more than 5 minutes since interaction, might be in silent mode
                        if (timeSinceInteraction > 5 * 60 * 1000) {
                            return true;
                        }
                    }
                    
                    return false;
                } catch (e) {
                    console.log('Silent mode detection error:', e);
                    return false;
                }
            }

            validateTimeFormat(input) {
                const value = input.value;
                const timeRegex = /^([0-9]{1,2}):([0-5][0-9])$/;
                
                if (!timeRegex.test(value)) {
                    // Auto-format common patterns
                    if (value.length === 1) {
                        input.value = `0${value}:00`;
                    } else if (value.length === 2 && !value.includes(':')) {
                        input.value = `${value}:00`;
                    } else if (value.includes(':') && value.split(':')[1].length === 1) {
                        const [min, sec] = value.split(':');
                        input.value = `${min}:0${sec}`;
                    }
                }
            }

            parseDuration() {
                const value = this.elements.duration.value;
                const timeRegex = /^([0-9]{1,2}):([0-5][0-9])$/;
                
                if (timeRegex.test(value)) {
                    const [min, sec] = value.split(':').map(Number);
                    return min * 60 + sec;
                }
                
                // Fallback to default 5 minutes
                return 300;
            }
            
            async testAudioPlayback() {
                try {
                    // Create a silent test oscillator
                    const testOsc = this.audioContext.createOscillator();
                    const testGain = this.audioContext.createGain();
                    testGain.gain.value = 0.001; // Almost silent
                    
                    testOsc.connect(testGain);
                    testGain.connect(this.audioContext.destination);
                    
                    testOsc.start();
                    testOsc.stop(this.audioContext.currentTime + 0.1);
                    
                    // Wait a moment to see if audio context stays running
                    await new Promise(resolve => setTimeout(resolve, 150));
                    
                    const canPlay = this.audioContext.state === 'running';
                    console.log('Audio playback test:', canPlay ? 'PASS' : 'FAIL', 'State:', this.audioContext.state);
                    
                    return { canPlay, state: this.audioContext.state };
                } catch (e) {
                    console.error('Audio playback test error:', e);
                    return { canPlay: false, state: 'error', error: e };
                }
            }
            
            showSilentModeWarning() {
                const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
                const isAndroid = /Android/i.test(navigator.userAgent);
                
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.95);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 2147483647;
                    padding: 20px;
                `;
                
                modal.innerHTML = `
                    <div style="
                        background: linear-gradient(135deg, #dc2626, #991b1b);
                        border-radius: 24px;
                        padding: 40px 30px;
                        max-width: 450px;
                        width: 100%;
                        text-align: center;
                        border: 3px solid #fbbf24;
                        box-shadow: 0 20px 60px rgba(220, 38, 38, 0.6);
                    ">
                        <div style="font-size: 72px; margin-bottom: 20px; animation: pulse 1.5s ease-in-out infinite;">🔇</div>
                        <h2 style="color: #fbbf24; font-size: 26px; font-weight: 800; margin-bottom: 15px;">
                            Audio Blocked!
                        </h2>
                        <p style="color: #fff; font-size: 17px; line-height: 1.7; margin-bottom: 25px; font-weight: 600;">
                            ${isIOS ? 
                                'Your iPhone is in <span style="color:#fbbf24; font-weight:800;">Silent Mode</span>. Genesis frequencies cannot play when Silent Mode is enabled.' : 
                                'Audio playback is blocked. This may be due to Silent Mode or system audio restrictions.'
                            }
                        </p>
                        
                        <div style="background: rgba(0,0,0,0.3); border-radius: 16px; padding: 20px; margin-bottom: 25px; text-align: left;">
                            <div style="color: #fbbf24; font-weight: 700; margin-bottom: 12px; font-size: 15px; text-align: center;">
                                ${isIOS ? '🔊 TO FIX (CHOOSE ONE):' : '🔊 TO FIX:'}
                            </div>
                            ${isIOS ? `
                                <div style="color: #fff; font-size: 15px; line-height: 1.9; padding-left: 10px;">
                                    <div style="margin-bottom: 12px;">
                                        <span style="color: #fbbf24; font-weight: 700;">Option 1:</span> Turn off Silent Mode<br>
                                        <span style="font-size: 13px; color: #d1d5db;">Use the physical switch on the left side of your iPhone</span>
                                    </div>
                                    <div style="margin-bottom: 12px;">
                                        <span style="color: #fbbf24; font-weight: 700;">Option 2:</span> Plug in headphones or earbuds<br>
                                        <span style="font-size: 13px; color: #d1d5db;">Wired or Bluetooth will work</span>
                                    </div>
                                    <div>
                                        <span style="color: #fbbf24; font-weight: 700;">Option 3:</span> Connect to a Bluetooth speaker
                                    </div>
                                </div>
                            ` : `
                                <div style="color: #fff; font-size: 15px; line-height: 1.9; padding-left: 10px;">
                                    � Turn off Silent/Do Not Disturb mode<br>
                                    � Increase system volume<br>
                                    � Enable audio in browser settings<br>
                                    � Try plugging in headphones
                                </div>
                            `}
                        </div>
                        
                        <button onclick="this.closest('div[style*=fixed]').remove()" style="
                            width: 100%;
                            background: linear-gradient(90deg, #fbbf24, #f59e0b);
                            color: #1a0033;
                            border: none;
                            border-radius: 20px;
                            padding: 18px;
                            font-size: 18px;
                            font-weight: 800;
                            cursor: pointer;
                            box-shadow: 0 6px 24px rgba(251,191,36,0.5);
                        ">I'll Fix It & Try Again</button>
                    </div>
                `;
                
                document.body.appendChild(modal);
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) modal.remove();
                });
            }

            export() {
                // Check if user has Premium or Ultimate access (export available to both)
                const hasPremium = typeof hasPremiumAccess === 'function' ? hasPremiumAccess() : 
                                   localStorage.getItem('gfgn_license_tier') === 'premium' || 
                                   localStorage.getItem('gfgn_license_tier') === 'ultimate';
                if (!hasPremium) {
                    showUpgradeModal();
                    return;
                }

                // Create downloadable WAV file with current frequencies
                const frequencies = [
                    parseFloat(this.elements.freq1.value),
                    parseFloat(this.elements.freq2.value),
                    parseFloat(this.elements.freq3.value)
                ].filter(freq => freq > 0);
                
                if (frequencies.length === 0) {
                    this.updateStatus('⚠️ Please enter frequencies first');
                    return;
                }
                
                // Generate WAV file (simplified for demo)
                const sampleRate = 44100;
                const duration = this.parseDuration();
                const numSamples = sampleRate * duration;

                // Create WAV buffer
                const buffer = new ArrayBuffer(44 + numSamples * 2);
                const view = new DataView(buffer);

                // WAV header
                const writeString = (offset, string) => {
                    for (let i = 0; i < string.length; i++) {
                        view.setUint8(offset + i, string.charCodeAt(i));
                    }
                };

                writeString(0, 'RIFF');
                view.setUint32(4, 36 + numSamples * 2, true);
                writeString(8, 'WAVE');
                writeString(12, 'fmt ');
                view.setUint32(16, 16, true);
                view.setUint16(20, 1, true);
                view.setUint16(22, 1, true);
                view.setUint32(24, sampleRate, true);
                view.setUint32(28, sampleRate * 2, true);
                view.setUint16(32, 2, true);
                view.setUint16(34, 16, true);
                writeString(36, 'data');
                view.setUint32(40, numSamples * 2, true);

                // Generate sine wave data
                const volumes = [
                    parseFloat(this.elements.volume1.value) / 100,
                    parseFloat(this.elements.volume2.value) / 100,
                    parseFloat(this.elements.volume3.value) / 100
                ];

                let offset = 44;

                for (let i = 0; i < numSamples; i++) {
                    let sample = 0;
                    const time = i / sampleRate;

                    frequencies.forEach((freq, index) => {
                        sample += Math.sin(2 * Math.PI * freq * time) * volumes[index];
                    });

                    sample = sample / frequencies.length * 0.8; // Scale to avoid clipping
                    const intSample = Math.floor(sample * 32767);
                    view.setInt16(offset, intSample, true);
                    offset += 2;
                }

                // Download the WAV file
                const blob = new Blob([buffer], { type: 'audio/wav' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `genesis_${frequencies.join('_')}_hz.wav`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);

                // Track export action for achievements
                if (window.GenesisAchievements) {
                    window.GenesisAchievements.userProgress.wavExports++;
                    window.GenesisAchievements.saveProgress();
                    window.GenesisAchievements.checkAllAchievements();
                }

                this.updateStatus(`? Exported: ${frequencies.join(' + ')} Hz`);
            }

            reset() {
                this.stop();
                
                // Reset to Trinity defaults
                this.elements.freq1.value = 37;
                this.elements.freq2.value = 73;
                this.elements.freq3.value = 0;
                this.elements.volume1.value = 50;
                this.elements.volume2.value = 50;
                this.elements.volume3.value = 50;
                this.elements.volume1Value.textContent = '50%';
                this.elements.volume2Value.textContent = '50%';
                this.elements.volume3Value.textContent = '50%';
                this.elements.duration.value = '05:00';
                
                // Clear recipe selection
                document.querySelectorAll('.recipe-item').forEach(item => {
                    item.classList.remove('active');
                });
                
                this.selectedRecipe = null;
                this.updateStatus('🔄 Reset to Trinity Foundation');
            }

            updateStatus(message) {
                this.elements.status.textContent = message;
                this.elements.status.className = this.isPlaying ? 'status playing floating' : 'status stopped';
            }
        }

        // Homescreen PWA Prompt System
        let deferredPrompt;
        let pwaPromptShown = false;

        function initializePWAPrompt() {
            // Check if already installed
            if (window.matchMedia('(display-mode: standalone)').matches || 
                window.navigator.standalone === true) {
                if (window.GenesisAchievements) {
                    window.GenesisAchievements.userProgress.installedPWA = true;
                    window.GenesisAchievements.saveProgress();
                    window.GenesisAchievements.checkAllAchievements();
                }
                hideHomescreenButton();
                return;
            }

            // Listen for the beforeinstallprompt event
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                
                // Show prompt after some usage (3 sessions)
                if (userProgress.totalSessions >= 3 && !pwaPromptShown) {
                    setTimeout(() => showPWAPrompt(), 2000);
                }
            });

            // Listen for successful installation
            window.addEventListener('appinstalled', () => {
                if (window.GenesisAchievements) {
                    window.GenesisAchievements.userProgress.installedPWA = true;
                    window.GenesisAchievements.saveProgress();
                    window.GenesisAchievements.checkAllAchievements();
                }
                hidePWAPrompt();
                hideHomescreenButton();
                showToast('🏠 App added to home screen! Achievement unlocked!', 'success');
            });
        }

        function hideHomescreenButton() {
            const btn = document.getElementById('homescreenBtn');
            if (btn) btn.style.display = 'none';
        }

        function showPWAPrompt() {
            if (pwaPromptShown) return;
            pwaPromptShown = true;

            const prompt = document.createElement('div');
            prompt.id = 'pwaPrompt';
            prompt.innerHTML = `
                <div style="position: fixed; bottom: 15px; left: 15px; right: 15px; 
                           background: linear-gradient(135deg, rgba(251,191,36,0.95), rgba(139,92,246,0.9)); 
                           border: 2px solid rgba(251,191,36,0.5); border-radius: 12px; 
                           padding: 12px 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.3); 
                           z-index: 1000; backdrop-filter: blur(10px); display: flex; align-items: center; gap: 12px;">
                    <div style="flex-shrink: 0; font-size: 32px;">
                        📲
                    </div>
                    <div style="flex: 1;">
                        <div style="color: #1a0033; font-size: 15px; font-weight: 700;">
                            Add to Home Screen
                        </div>
                        <div style="color: #1a0033; font-size: 12px; opacity: 0.8;">
                            Quick access from your home screen
                        </div>
                    </div>
                    <div style="display: flex; gap: 8px; flex-shrink: 0;">
                        <button onclick="installPWA()" style="background: #1a0033; color: #fbbf24; 
                                 border: none; border-radius: 16px; padding: 8px 14px; 
                                 font-weight: 600; cursor: pointer; font-size: 13px;">
                            Install
                        </button>
                        <button onclick="hidePWAPrompt()" style="background: rgba(26,0,51,0.5); 
                                 color: #1a0033; border: none; border-radius: 16px; 
                                 padding: 8px 12px; font-weight: 600; cursor: pointer; font-size: 13px;">
                            ?
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(prompt);
        }

        function hidePWAPrompt() {
            const prompt = document.getElementById('pwaPrompt');
            if (prompt) prompt.remove();
        }

        async function installPWA() {
            if (!deferredPrompt) return;
            
            deferredPrompt.prompt();
            const { outcome } = await deferredPrompt.userChoice;
            
            if (outcome === 'accepted') {
                if (window.GenesisAchievements) {
                    window.GenesisAchievements.userProgress.installedPWA = true;
                    window.GenesisAchievements.saveProgress();
                    window.GenesisAchievements.checkAllAchievements();
                }
                showToast('🏠 App added to home screen! Achievement unlocked!', 'success');
            }
            
            deferredPrompt = null;
            hidePWAPrompt();
        }

        // Subtle Notification System
        let notificationInterval;
        let lastNotificationTime = 0;

        function initializeNotifications() {
            // Check if notifications are already granted
            if (Notification.permission === 'granted') {
                startNotificationSchedule();
                return;
            }

            // Request permission on first significant usage (2 sessions)
            if (userProgress.totalSessions >= 2 && Notification.permission === 'default') {
                setTimeout(() => requestNotificationPermission(), 3000);
            }
        }

        function requestNotificationPermission() {
            if ('Notification' in window) {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        showToast('🔔 Notifications enabled! You\'ll receive gentle reminders.', 'info');
                        startNotificationSchedule();
                    }
                });
            }
        }

        function startNotificationSchedule() {
            // Send notifications every 2-4 days, but only if user hasn't used app recently
            notificationInterval = setInterval(() => {
                const now = Date.now();
                const daysSinceLastUse = (now - new Date(userProgress.lastSession || 0)) / (1000 * 60 * 60 * 24);
                
                // Only notify if it's been 2+ days since last use
                if (daysSinceLastUse >= 2 && (now - lastNotificationTime) > (1000 * 60 * 60 * 24 * 2)) {
                    sendGentleNotification();
                }
            }, 1000 * 60 * 60 * 6); // Check every 6 hours
        }

        function sendGentleNotification() {
            if (Notification.permission !== 'granted') return;

            const messages = [
                {
                    title: '🌟 Your frequencies are waiting',
                    body: 'Take a moment to connect with the sacred vibrations of Genesis.',
                    icon: '/Genesis.png'
                },
                {
                    title: '💙 How are you feeling today?',
                    body: 'A short frequency session can help center your energy.',
                    icon: '/Genesis.png'
                },
                {
                    title: '🎯 Continue your journey',
                    body: 'Each session brings you closer to harmonic balance.',
                    icon: '/Genesis.png'
                },
                {
                    title: '⭐ Ready for unlimited access?',
                    body: 'Upgrade to premium for custom durations and all features.',
                    icon: '/Genesis.png'
                },
                {
                    title: '🎵 Sacred frequencies calling',
                    body: 'Your daily practice awaits. Just 5-10 minutes of peace.',
                    icon: '/Genesis.png'
                }
            ];

            const message = messages[Math.floor(Math.random() * messages.length)];
            
            const notification = new Notification(message.title, {
                body: message.body,
                icon: message.icon,
                badge: '/Genesis.png',
                tag: 'genesis-reminder', // Prevents spam if multiple
                requireInteraction: false,
                silent: true // Gentle, not disruptive
            });

            lastNotificationTime = Date.now();

            // Auto-close after 10 seconds
            setTimeout(() => notification.close(), 10000);

            // Click handler to open app
            notification.onclick = () => {
                window.focus();
                notification.close();
            };
        }

        // Toast notification system for in-app messages
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed; top: 20px; right: 20px; 
                background: ${type === 'success' ? 'rgba(34,197,94,0.9)' : 
                           type === 'error' ? 'rgba(239,68,68,0.9)' : 'rgba(251,191,36,0.9)'}; 
                color: white; padding: 15px 20px; border-radius: 10px; 
                box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 10000; 
                font-weight: 600; max-width: 300px; backdrop-filter: blur(10px);
            `;
            toast.textContent = message;
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.style.transition = 'opacity 0.5s';
                toast.style.opacity = '0';
                setTimeout(() => toast.remove(), 500);
            }, 4000);
        }

        // Make functions globally available
        window.installPWA = installPWA;
        window.showPWAPrompt = showPWAPrompt;
        window.hidePWAPrompt = hidePWAPrompt;
        window.requestNotificationPermission = requestNotificationPermission;
        window.showToast = showToast;

// ---------------------------------------------------------------
// LICENSE VALIDATION SYSTEM
// ---------------------------------------------------------------

const LICENSE_API_URL = 'https://api.quantummerlin.com';

// Generate device fingerprint for device limiting
function generateDeviceFingerprint() {
    const data = [
        navigator.userAgent,
        navigator.language,
        screen.width + 'x' + screen.height,
        screen.colorDepth,
        new Date().getTimezoneOffset(),
        navigator.hardwareConcurrency || 'unknown',
        navigator.platform
    ].join('|');
    
    // Simple hash function
    let hash = 0;
    for (let i = 0; i < data.length; i++) {
        const char = data.charCodeAt(i);
        hash = ((hash << 5) - hash) + char;
        hash = hash & hash;
    }
    return 'dev_' + Math.abs(hash).toString(36);
}

const deviceFingerprint = generateDeviceFingerprint();

// Get current license tier from localStorage
function getCurrentTier() {
    return localStorage.getItem('gfgn_license_tier') || 'free';
}

// Check if user has premium access (includes old 'ultimate' keys for backward compatibility)
function hasPremiumAccess() {
    const tier = getCurrentTier();
    return tier === 'premium' || tier === 'ultimate';
}

// Format license key with auto-dashes after every 4 characters
function formatLicenseKey(input) {
    // Remove all non-alphanumeric characters and convert to uppercase
    let value = input.value.replace(/[^A-Za-z0-9]/g, '').toUpperCase();
    
    // Add dashes after every 4 characters
    let formatted = '';
    for (let i = 0; i < value.length && i < 16; i++) {
        if (i > 0 && i % 4 === 0) {
            formatted += '-';
        }
        formatted += value[i];
    }
    
    input.value = formatted;
}

// Show license modal
function showLicenseModal() {
    const modal = document.getElementById('licenseModal');
    if (modal) {
        modal.style.display = 'flex';
        
        // Clear previous input
        const keyInput = document.getElementById('licenseKeyFull');
        if (keyInput) keyInput.value = '';
        document.getElementById('licenseError').style.display = 'none';
        document.getElementById('licenseSuccess').style.display = 'none';
        
        // Show current tier if applicable
        const currentTier = getCurrentTier();
        const tierDisplay = document.getElementById('licenseCurrentTier');
        const tierName = document.getElementById('currentTierName');
        
        if (currentTier !== 'free') {
            tierDisplay.style.display = 'block';
            tierName.textContent = currentTier.charAt(0).toUpperCase() + currentTier.slice(1);
        } else {
            tierDisplay.style.display = 'none';
        }
        
        // Focus input
        setTimeout(() => {
            if (keyInput) keyInput.focus();
        }, 100);
    }
}

// Close license modal
function closeLicenseModal() {
    const modal = document.getElementById('licenseModal');
    if (modal) {
        modal.style.display = 'none';
    }
}

// Activate license
async function activateLicense() {
    const rawInput = document.getElementById('licenseKeyFull').value.trim().toUpperCase();
    
    const errorEl = document.getElementById('licenseError');
    const successEl = document.getElementById('licenseSuccess');
    const activateBtn = document.getElementById('activateLicenseBtn');
    
    // Clear previous messages
    errorEl.style.display = 'none';
    successEl.style.display = 'none';
    
    // Validate input
    if (!rawInput) {
        errorEl.textContent = 'Please paste your license key';
        errorEl.style.display = 'block';
        return;
    }
    
    // Parse the key - accept with or without QMFG prefix
    let fullLicenseKey = rawInput;
    
    // If they pasted just the last 3 segments, add QMFG
    if (!rawInput.startsWith('QMFG-') && rawInput.split('-').length === 3) {
        fullLicenseKey = 'QMFG-' + rawInput;
    }
    
    // Validate format: QMFG-XXXX-XXXX-XXXX
    const parts = fullLicenseKey.split('-');
    if (parts.length !== 4 || parts[0] !== 'QMFG' || parts[1].length !== 4 || parts[2].length !== 4 || parts[3].length !== 4) {
        errorEl.textContent = 'Invalid key format. Expected: QMFG-XXXX-XXXX-XXXX';
        errorEl.style.display = 'block';
        return;
    }
    
    // Check if already has premium
    if (hasPremiumAccess()) {
        errorEl.textContent = 'You already have Premium access! All features are unlocked.';
        errorEl.style.display = 'block';
        return;
    }
    
    // Show loading state
    activateBtn.disabled = true;
    activateBtn.innerHTML = '⏳ Validating...';
    
    try {
        const response = await fetch(`${LICENSE_API_URL}/api/validate`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                license_key: fullLicenseKey,
                device_fingerprint: deviceFingerprint,
                device_info: navigator.userAgent.substring(0, 100)
            })
        });
        
        const data = await response.json();
        
        if (data.valid) {
            // Success! Save to localStorage
            localStorage.setItem('gfgn_license_key', fullLicenseKey);
            localStorage.setItem('gfgn_license_tier', data.tier);
            localStorage.setItem('gfgn_devices_used', data.devices_used);
            localStorage.setItem('gfgn_devices_max', data.devices_max);
            
            if (data.tier === 'premium' || data.tier === 'ultimate') {
                localStorage.setItem('premiumAccessGranted', 'true');
            }
            if (data.tier === 'ultimate') {
                localStorage.setItem('ultimateAccessGranted', 'true');
            }
            
            // Show success message with Share & Earn option
            successEl.innerHTML = `
                <div style="text-align: center; padding: 10px 0;">
                    <div style="font-size: 48px; margin-bottom: 10px;">✅</div>
                    <div style="font-size: 20px; color: #10b981; font-weight: 700; margin-bottom: 8px;">License Activated!</div>
                    <div style="font-size: 14px; color: #e5e7eb; margin-bottom: 5px;">${data.message}</div>
                    <div style="font-size: 12px; color: #9ca3af;">
                        Tier: <span style="color: ${data.tier === 'ultimate' ? '#fbbf24' : '#a78bfa'}; font-weight: 600;">${data.tier.toUpperCase()}</span> | Devices: ${data.devices_used}/${data.devices_max}
                    </div>
                </div>
                <div style="margin-top: 20px; padding-top: 15px; border-top: 1px solid rgba(16,185,129,0.3);">
                    <button id="continueAfterActivation" onclick="finishActivation()" style="
                        width: 100%;
                        background: linear-gradient(90deg, #10b981, #059669);
                        color: white;
                        border: none;
                        padding: 14px 24px;
                        border-radius: 25px;
                        font-size: 16px;
                        font-weight: 700;
                        cursor: pointer;
                        margin-bottom: 10px;
                    ">➡️ Continue to App</button>
                </div>
            `;
            successEl.style.display = 'block';
            
            // Hide the activate button since we now have Continue button
            activateBtn.style.display = 'none';
            
        } else {
            // Error
            errorEl.textContent = data.error || 'Invalid license key';
            errorEl.style.display = 'block';
            activateBtn.disabled = false;
            activateBtn.innerHTML = '🔑 Activate License';
        }
        
    } catch (error) {
        console.error('License validation error:', error);
        
        // Fallback: Check format only (offline mode)
        if (fullLicenseKey.match(/^QMFG-(PREM|ULTI)-[A-Z0-9]{4}-[A-Z0-9]{4}$/)) {
            const tier = key1.startsWith('ULTI') ? 'ultimate' : 'premium';
            
            errorEl.innerHTML = `
                ⚠️ Server unavailable. Using offline mode.<br>
                <span style="font-size: 12px;">Your license will be verified when online.</span>
            `;
            errorEl.style.color = '#fbbf24';
            errorEl.style.display = 'block';
            
            // Save offline activation
            localStorage.setItem('gfgn_license_key', fullLicenseKey);
            localStorage.setItem('gfgn_license_tier', tier);
            localStorage.setItem('gfgn_offline_activation', 'true');
            
            if (tier === 'premium' || tier === 'ultimate') {
                localStorage.setItem('premiumAccessGranted', 'true');
            }
            if (tier === 'ultimate') {
                localStorage.setItem('ultimateAccessGranted', 'true');
            }
            
            setTimeout(() => {
                closeLicenseModal();
                location.reload();
            }, 2500);
        } else {
            errorEl.textContent = 'Connection error. Please check your internet and try again.';
            errorEl.style.display = 'block';
            activateBtn.disabled = false;
            activateBtn.innerHTML = '🔑 Activate License';
        }
    }
}

// Update UI based on license tier (simplified: free or premium only)
function updateUIForLicenseTier() {
    const tier = getCurrentTier();
    
    // Get CTA sections
    const ctaTop = document.getElementById('premiumCtaTop');
    const ctaBottom = document.getElementById('premiumCtaBottom');
    
    // Premium or Ultimate keys both grant full access
    if (tier === 'premium' || tier === 'ultimate') {
        // Hide all upgrade prompts
        if (ctaTop) ctaTop.style.display = 'none';
        if (ctaBottom) ctaBottom.style.display = 'none';
        
        // Unlock all premium features
        unlockPremiumControls();
        
        // Trigger achievement only once
        if (typeof window.awardAchievement === 'function' && !localStorage.getItem('gfgn_premium_achievement_awarded')) {
            window.awardAchievement('premium_unlock');
            localStorage.setItem('gfgn_premium_achievement_awarded', 'true');
        }
    }
    // Free users see default locked UI
}

// Unlock Premium controls (volume sliders, duration - NOT export button or frequency inputs)
function unlockPremiumControls() {
    document.querySelectorAll('.premium-lock').forEach(el => {
        // SKIP the export button - keep it locked as $19.99 premium feature
        if (el.id === 'exportBtn') return;
        
        // Remove the lock overlay and enable interaction
        el.classList.remove('premium-lock');
        el.classList.add('premium-unlocked');
        el.onclick = null; // Remove the upgrade modal trigger
        el.style.opacity = '1';
        el.style.pointerEvents = 'auto';
        el.style.cursor = 'default';
        
        // Enable volume sliders and buttons, but NOT frequency number inputs
        el.querySelectorAll('input[type="range"], button').forEach(input => {
            input.disabled = false;
        });
        
        // Keep frequency inputs readonly - users select from presets only
        el.querySelectorAll('input[type="number"]').forEach(input => {
            input.readOnly = true;
            input.style.pointerEvents = 'none';
        });
    });
    
    // Keep export button LOCKED - $19.99 premium feature
    const exportBtn = document.getElementById('exportBtn');
    if (exportBtn) {
        exportBtn.classList.add('premium-lock');
        exportBtn.classList.remove('premium-unlocked');
        exportBtn.onclick = function() { showExportUpgradeModal(); };
    }
    
    // Initialize screen awake toggle
    initScreenAwakeToggle();
}

// Check license on page load
async function checkLicenseOnLoad() {
    const storedKey = localStorage.getItem('gfgn_license_key');
    const storedTier = localStorage.getItem('gfgn_license_tier');
    
    if (storedKey && storedTier && storedTier !== 'free') {
        // Verify with server (non-blocking)
        try {
            const response = await fetch(`${LICENSE_API_URL}/api/check`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    license_key: storedKey,
                    device_fingerprint: deviceFingerprint
                })
            });
            
            const data = await response.json();
            
            if (!data.activated) {
                // Device not activated - might be new device or limit reached
                console.log('License needs revalidation');
            }
        } catch (e) {
            // Offline - trust local storage
            console.log('Offline mode - using cached license');
        }
    }
    
    // Update UI regardless
    updateUIForLicenseTier();
}

// Function called when user clicks Continue after activation
function finishActivation() {
    closeLicenseModal();
    // Small delay then reload to apply all changes
    setTimeout(() => {
        location.reload();
    }, 100);
}

// Make functions globally available
window.showLicenseModal = showLicenseModal;
window.closeLicenseModal = closeLicenseModal;
window.activateLicense = activateLicense;
window.hasPremiumAccess = hasPremiumAccess;
window.getCurrentTier = getCurrentTier;
window.finishActivation = finishActivation;

// Initialize generator when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Check license status
    checkLicenseOnLoad();
    
    // Initialize the frequency generator first
    window.generator = new FrequencyGenerator();
    
    // Initialize screen awake toggle for premium users
    setTimeout(() => {
        initScreenAwakeToggle();
    }, 500);
    
    // Set Genesis Creation (37 + 73 Hz) as the default track - the beginning of the journey
    setTimeout(() => {
        const biblicalCategory = trinityRecipes['Biblical & Original'];
        const genesisRecipe = biblicalCategory ? biblicalCategory.find(r => r.name.includes('Genesis Creation')) : null;
        if (genesisRecipe && window.generator) {
            window.generator.selectRecipe(genesisRecipe);
        }
    }, 100);
    
    // Cleanup on page unload to prevent memory leaks
    window.addEventListener('beforeunload', function() {
        if (window.generator && window.generator.isPlaying) {
            window.generator.stop();
        }
        // Clear any notification intervals
        if (typeof notificationInterval !== 'undefined' && notificationInterval) {
            clearInterval(notificationInterval);
        }
        // Remove visibility change listeners
        if (typeof handleVisibilityChange !== 'undefined') {
            document.removeEventListener('visibilitychange', handleVisibilityChange);
        }
    });
    
    // Update progress section if available
    if (typeof instructionsSections !== 'undefined') {
        renderInstructionsCategories(); // Update progress section with loaded data
    }
    
    // Populate achievements preview
    const achievementsPreview = document.getElementById('achievementsPreview');
    if (achievementsPreview && typeof renderAchievementQuickStats !== 'undefined') {
        achievementsPreview.innerHTML = renderAchievementQuickStats();
    }
    
    // Load saved language preference
    const savedLanguage = localStorage.getItem('preferredLanguage');
    if (savedLanguage && translations[savedLanguage]) {
        changeLanguage(savedLanguage);
    }

    // Register Service Worker for PWA functionality
    // if ('serviceWorker' in navigator && (location.protocol === 'http:' || location.protocol === 'https:')) {
    //     navigator.serviceWorker.register('/sw.js', { scope: '/' })
    //         .then(registration => {
    //             console.log('Service Worker registered:', registration);
    //         })
    //         .catch(error => {
    //             console.log('Service Worker registration failed:', error);
    //         });
    // }

    // Initialize homescreen and notification features
    initializePWAPrompt();
    initializeNotifications();

    // Safari-safe storage helper functions
    function safeGetItem(key) {
        try {
            return localStorage.getItem(key);
        } catch (e) {
            console.log('localStorage blocked, trying sessionStorage');
            try {
                return sessionStorage.getItem(key);
            } catch (e2) {
                console.log('All storage blocked');
                return null;
            }
        }
    }
    
    function safeSetItem(key, value) {
        try {
            localStorage.setItem(key, value);
        } catch (e) {
            try {
                sessionStorage.setItem(key, value);
            } catch (e2) {
                console.log('Cannot save to storage');
            }
        }
    }

    // Show immersive welcome on first visit, welcome back toast for return visits
    console.log('DOMContentLoaded fired - checking storage');
    
    // Check for test parameter to force clean state
    const urlParams = new URLSearchParams(window.location.search);
    if (urlParams.has('test')) {
        console.log('Test parameter detected - forcing clean state');
        try { localStorage.clear(); } catch(e) {}
        try { sessionStorage.clear(); } catch(e) {}
    }
    
    // Debug: Add global function to clear localStorage
    window.clearOnboarding = function() {
        try { localStorage.removeItem('onboardingComplete'); } catch(e) {}
        try { sessionStorage.removeItem('onboardingComplete'); } catch(e) {}
        console.log('Onboarding cleared - refresh page to see welcome flow');
    };
    
    const onboardingComplete = safeGetItem('onboardingComplete') === 'true';
    const forceShowWelcome = new URLSearchParams(window.location.search).get('showWelcome') === 'true';
    console.log('Modal initialization - onboardingComplete:', onboardingComplete);
    console.log('Force show welcome:', forceShowWelcome);
    
    // Get modal element
    const welcomeModal = document.getElementById('immersiveWelcome');
    console.log('Welcome modal element:', welcomeModal);
    
    if (!onboardingComplete || forceShowWelcome) {
        // First time user - show welcome sequence
        console.log('New user - showing welcome modal');
        
        // Hide upgrade modal first
        const upgradeModal = document.getElementById('upgradeBenefitsModal');
        if (upgradeModal) {
            upgradeModal.classList.remove('active');
            upgradeModal.style.display = 'none';
        }
        
        // Show welcome modal with multiple fallback methods for Safari
        if (welcomeModal) {
            // Method 1: Add active class
            welcomeModal.classList.add('active');
            
            // Method 2: Set inline styles directly (Safari fallback)
            welcomeModal.style.cssText = 'display: block !important; visibility: visible !important; opacity: 1 !important; position: fixed !important; top: 0 !important; left: 0 !important; width: 100% !important; height: 100% !important; z-index: 9999999 !important; background: rgba(0,0,0,0.95) !important; padding: 20px !important; overflow-y: auto !important; box-sizing: border-box !important;';
            
            // Method 3: Force reflow/repaint for Safari
            welcomeModal.offsetHeight;
            
            // Prevent scrolling behind modal
            document.body.style.overflow = 'hidden';
            
            console.log('Welcome modal should now be visible');
            console.log('Modal display:', window.getComputedStyle(welcomeModal).display);
        }
    } else {
        // Returning user - show welcome back toast after a brief delay
        console.log('Returning user - showing welcome toast');
        setTimeout(() => {
            const t = translations.en;
            showToast((t.welcomeBack || 'Welcome back! Ready to explore sacred frequencies?') + ' 🌟');
        }, 1000);
    }

    // Handle premium-locked inputs - FORCE UNLOCK ALL FOR FREE VERSION
    unlockPremiumControls();
    
    // Hide upgrade CTAs and affiliate sections since everything is free now
    const premiumCtaTop = document.getElementById('premiumCtaTop');
    const premiumCtaBottom = document.getElementById('premiumCtaBottom');
    if (premiumCtaTop) premiumCtaTop.style.display = 'none';
    if (premiumCtaBottom) premiumCtaBottom.style.display = 'none';
    
    // Hide affiliate section
    document.querySelectorAll('[onclick*="showAffiliateModal"]').forEach(el => {
        if (el.closest('div[style*="border: 2px solid #10b981"]')) {
            el.closest('div[style*="border: 2px solid #10b981"]').style.display = 'none';
        }
    });

    // Listen for storage changes (when license tier changes)
    window.addEventListener('storage', function(e) {
        if (e.key === 'gfgn_license_tier' || e.key === 'premiumAccessGranted') {
            updatePremiumFeatures();
            if (typeof updateUIForLicenseTier === 'function') {
                updateUIForLicenseTier();
            }
        }
    });

    // Debug check after initialization (Safari-safe)
    setTimeout(() => {
        console.log('Modal state check:');
        const welcomeModal = document.getElementById('immersiveWelcome');
        const upgradeModal = document.getElementById('upgradeBenefitsModal');
        console.log('- immersiveWelcome exists:', !!welcomeModal);
        console.log('- immersiveWelcome active:', welcomeModal ? welcomeModal.classList.contains('active') : 'N/A');
        console.log('- immersiveWelcome display:', welcomeModal ? window.getComputedStyle(welcomeModal).display : 'N/A');
        console.log('- upgradeBenefitsModal active:', upgradeModal ? upgradeModal.classList.contains('active') : 'N/A');
        try {
            console.log('- onboardingComplete in storage:', localStorage.getItem('onboardingComplete') || sessionStorage.getItem('onboardingComplete'));
        } catch(e) {
            console.log('- storage access blocked');
        }
    }, 200);
});

// ============================================
// EXPORT FUNCTIONS
// ============================================

            // Export functions to window for external access
            window.GenesisAchievements = {
                renderAchievementCard: typeof renderAchievementCard !== 'undefined' ? renderAchievementCard : function() {},
                renderAchievementsDashboard: typeof renderAchievementsDashboard !== 'undefined' ? renderAchievementsDashboard : function() {},
                renderAchievementQuickStats: typeof renderAchievementQuickStats !== 'undefined' ? renderAchievementQuickStats : function() {},
                getAchievementProgress: typeof getAchievementProgress !== 'undefined' ? getAchievementProgress : function() { return 0; },
                showAchievementModal: typeof showAchievementModal !== 'undefined' ? showAchievementModal : function() {},
                showFullAchievements: typeof showFullAchievements !== 'undefined' ? showFullAchievements : function() {},
                checkAchievements: typeof checkAchievements !== 'undefined' ? checkAchievements : function() { return true; },
                updateAchievementProgress: typeof updateAchievementProgress !== 'undefined' ? updateAchievementProgress : function() {},
                userProgress: {},
                saveProgress: function() {},
                checkAllAchievements: function() {}
            };

console.log('✨ Achievement Teaser System Loaded!');
console.log('🎯 Locked, In Progress, Almost There, and Unlocked states active!');

// ---------------------------------------------------------------
// FLOATING PARTICLES SYSTEM - 50 particles
// ---------------------------------------------------------------
function initFloatingParticles() {
    const container = document.getElementById('particles-container');
    if (!container) return;
    
    const particleCount = 50;
    const colors = ['particle-gold', 'particle-purple', 'particle-white'];
    
    for (let i = 0; i < particleCount; i++) {
        const particle = document.createElement('div');
        particle.className = `floating-particle ${colors[Math.floor(Math.random() * colors.length)]}`;
        
        // Random positioning
        particle.style.left = `${Math.random() * 100}%`;
        
        // Random size (2-6px)
        const size = 2 + Math.random() * 4;
        particle.style.width = `${size}px`;
        particle.style.height = `${size}px`;
        
        // Random animation duration (15-30s)
        const duration = 15 + Math.random() * 15;
        particle.style.animationDuration = `${duration}s`;
        
        // Random delay
        particle.style.animationDelay = `${Math.random() * duration}s`;
        
        container.appendChild(particle);
    }
}

// ---------------------------------------------------------------
// LUCIDE ICONS INITIALIZATION
// ---------------------------------------------------------------
function initLucideIcons() {
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
        console.log('✅ Lucide icons initialized');
    }
}

// Icon mapping for replacing emojis in dynamic content
const iconMap = {
    '??': '<i data-lucide="music" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="volume-2" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="timer" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="target" class="lucide-icon icon-gold"></i>',
    '?': '<i data-lucide="sparkles" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="star" class="lucide-icon icon-gold"></i>',
    '?': '<i data-lucide="star" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="gem" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="diamond" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="palette" class="lucide-icon icon-pink"></i>',
    '??': '<i data-lucide="heart" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="flower-2" class="lucide-icon icon-pink"></i>',
    '??': '<i data-lucide="leaf" class="lucide-icon icon-green"></i>',
    '??': '<i data-lucide="droplet" class="lucide-icon icon-blue"></i>',
    '??': '<i data-lucide="flame" class="lucide-icon" style="color:#f97316"></i>',
    '?': '<i data-lucide="zap" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="moon" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="sun" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="sunrise" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="book-open" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="bar-chart-3" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="trophy" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="crown" class="lucide-icon icon-gold"></i>',
    '???': '<i data-lucide="award" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="medal" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="lock" class="lucide-icon"></i>',
    '??': '<i data-lucide="unlock" class="lucide-icon icon-green"></i>',
    '??': '<i data-lucide="calendar" class="lucide-icon icon-purple"></i>',
    '?': '<i data-lucide="clock" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="clock-1" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="clock-12" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="lightbulb" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="heart" class="lucide-icon icon-green"></i>',
    '??': '<i data-lucide="heart" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="rocket" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="gift" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="megaphone" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="orbit" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="bird" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="triangle" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="infinity" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="trending-up" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="door-open" class="lucide-icon icon-purple"></i>',
    '???': '<i data-lucide="bird" class="lucide-icon"></i>',
    '??': '<i data-lucide="refresh-cw" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="graduation-cap" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="flip-horizontal" class="lucide-icon icon-gold"></i>',
    '?': '<i data-lucide="help-circle" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="message-circle" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="party-popper" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="hand" class="lucide-icon icon-gold"></i>',
    '?': '<i data-lucide="check-circle" class="lucide-icon icon-green"></i>',
    '?': '<i data-lucide="x-circle" class="lucide-icon" style="color:#ef4444"></i>',
    '??': '<i data-lucide="arrow-right" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="arrow-left" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="play" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="pause" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="square" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="repeat" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="external-link" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="smartphone" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="laptop" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="headphones" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="bell" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="settings" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="globe" class="lucide-icon icon-blue"></i>',
    '??': '<i data-lucide="save" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="download" class="lucide-icon icon-green"></i>',
    '??': '<i data-lucide="upload" class="lucide-icon icon-purple"></i>',
    '???': '<i data-lucide="trash-2" class="lucide-icon" style="color:#ef4444"></i>',
    '??': '<i data-lucide="pencil" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="search" class="lucide-icon icon-purple"></i>',
    '??': '<i data-lucide="coins" class="lucide-icon icon-gold"></i>',
    '??': '<i data-lucide="sprout" class="lucide-icon icon-green"></i>',
    '??': '<i data-lucide="sparkle" class="lucide-icon icon-gold"></i>'
};

// Function to replace emojis with Lucide icon tags
function replaceEmojisWithIcons() {
    const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT, null, false);
    const nodesToReplace = [];
    let node;
    
    // Collect nodes first to avoid mutation during traversal
    while (node = walker.nextNode()) {
        if (node.parentElement && !node.parentElement.closest('script, style, [data-no-emojis]')) {
            for (const emoji in iconMap) {
                if (node.textContent.includes(emoji)) {
                    nodesToReplace.push(node);
                    break;
                }
            }
        }
    }
    
    // Now replace the nodes
    nodesToReplace.forEach(textNode => {
        let text = textNode.textContent;
        const fragments = [];
        let lastIndex = 0;
        
        // Find all emojis and their positions
        const matches = [];
        for (const [emoji, iconHtml] of Object.entries(iconMap)) {
            const regex = new RegExp(emoji.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
            let match;
            while ((match = regex.exec(text)) !== null) {
                matches.push({ index: match.index, emoji, iconHtml, length: emoji.length });
            }
        }
        
        // Sort by position
        matches.sort((a, b) => a.index - b.index);
        
        // Build the replacement
        const parent = textNode.parentNode;
        const tempContainer = document.createElement('span');
        
        matches.forEach(match => {
            // Add text before emoji
            if (match.index > lastIndex) {
                tempContainer.appendChild(document.createTextNode(text.substring(lastIndex, match.index)));
            }
            // Add icon element
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = match.iconHtml;
            if (tempDiv.firstChild) {
                tempContainer.appendChild(tempDiv.firstChild);
            }
            lastIndex = match.index + match.length;
        });
        
        // Add remaining text
        if (lastIndex < text.length) {
            tempContainer.appendChild(document.createTextNode(text.substring(lastIndex)));
        }
        
        // Replace the text node with new content
        if (matches.length > 0) {
            while (tempContainer.firstChild) {
                parent.insertBefore(tempContainer.firstChild, textNode);
            }
            parent.removeChild(textNode);
        }
    });
}

// Initialize everything when DOM is ready
document.addEventListener('DOMContentLoaded', function() {
    // Initialize floating particles
    initFloatingParticles();
    
    // Replace emojis with icon tags first
    replaceEmojisWithIcons();
    
    // Initialize Lucide icons immediately after replacement
    setTimeout(() => {
        initLucideIcons();
        console.log('✨ Icons replaced and initialized');
    }, 200);
    
    // Re-initialize icons when dynamic content is added
    const observer = new MutationObserver(function(mutations) {
        let needsUpdate = false;
        mutations.forEach(function(mutation) {
            if (mutation.addedNodes.length > 0) {
                needsUpdate = true;
            }
        });
        if (needsUpdate) {
            setTimeout(initLucideIcons, 50);
        }
    });
    
    observer.observe(document.body, {
        childList: true,
        subtree: true
    });
    
    console.log('🌟 Genesis Visual Effects System Initialized');
    console.log('✨ 50 Floating Particles Active');
});

</script>

<!-- Affiliate Interest Modal -->
<div id="affiliateModal" style="
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    z-index: 12000;
    align-items: center;
    justify-content: center;
    padding: 15px;
    overflow-y: auto;
">
    <div style="
        background: linear-gradient(135deg, rgba(26,0,51,0.98), rgba(16,185,129,0.15));
        border-radius: 16px;
        padding: 24px 20px;
        max-width: 360px;
        width: 92%;
        text-align: center;
        border: 2px solid rgba(16,185,129,0.5);
        box-shadow: 0 0 30px rgba(16,185,129,0.3);
        margin: auto;
        max-height: 90vh;
        overflow-y: auto;
    ">
        <button onclick="closeAffiliateModal()" style="
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #9ca3af;
            font-size: 24px;
            cursor: pointer;
        ">�</button>
        
        <div style="font-size: 40px; margin-bottom: 10px;">🤝</div>
        <h2 style="color: #10b981; font-size: 20px; margin-bottom: 8px;">Affiliate Program Coming Soon!</h2>
        
        <div id="affiliateFormSection">
            <p style="color: #c4b5fd; font-size: 14px; line-height: 1.5; margin-bottom: 15px;">
                Love Genesis Frequencies?<br>
                We're planning an <strong style="color: #10b981;">affiliate program</strong> where you can earn 
                <strong style="color: #fbbf24;">30% commission</strong> per sale!
            </p>
            
            <div style="background: rgba(16,185,129,0.1); border-radius: 10px; padding: 12px; margin-bottom: 15px;">
                <div style="color: #10b981; font-weight: 700; margin-bottom: 5px; font-size: 14px;">💰 Potential Earnings:</div>
                <div style="color: #fff; font-size: 13px;">
                    Premium: <strong style="color: #fbbf24;">$3</strong> � Ultimate: <strong style="color: #fbbf24;">$6</strong> per sale
                </div>
            </div>
            
            <p style="color: #9ca3af; font-size: 13px; margin-bottom: 12px;">
                Register your interest to be notified when it launches!
            </p>
            
            <input type="email" id="affiliateEmail" placeholder="your@email.com" style="
                width: 100%;
                padding: 12px;
                border-radius: 10px;
                border: 2px solid rgba(16,185,129,0.4);
                background: rgba(16,185,129,0.1);
                color: #fff;
                font-size: 15px;
                margin-bottom: 12px;
                box-sizing: border-box;
            ">
            
            <button onclick="submitAffiliateInterest()" style="
                width: 100%;
                background: linear-gradient(90deg, #10b981, #059669);
                color: white;
                border: none;
                border-radius: 25px;
                padding: 12px;
                font-size: 15px;
                font-weight: 700;
                cursor: pointer;
                box-shadow: 0 4px 15px rgba(16,185,129,0.3);
            ">
                🚀 Register My Interest
            </button>
            
            <p style="color: #6b7280; font-size: 11px; margin-top: 12px;">
                ? No spam, just one email when the program launches
            </p>
        </div>
        
        <div id="affiliateSuccessSection" style="display: none;">
            <div style="font-size: 50px; margin-bottom: 10px;">✅</div>
            <h3 style="color: #10b981; font-size: 18px; margin-bottom: 8px;">Interest Registered!</h3>
            <p style="color: #c4b5fd; font-size: 14px; line-height: 1.5;">
                Thanks for registering!<br>
                We'll email you when the affiliate program launches.<br>
                <span style="color: #9ca3af; font-size: 12px;">Expected: 2026</span>
            </p>
            <button onclick="closeAffiliateModal()" style="
                margin-top: 20px;
                background: rgba(16,185,129,0.2);
                color: #10b981;
                border: 1px solid rgba(16,185,129,0.5);
                border-radius: 20px;
                padding: 12px 30px;
                font-size: 14px;
                font-weight: 600;
                cursor: pointer;
            ">Close</button>
        </div>
    </div>
</div>

<script>
// Affiliate Modal Functions
function showAffiliateModal() {
    document.getElementById('affiliateModal').style.display = 'flex';
    document.getElementById('affiliateFormSection').style.display = 'block';
    document.getElementById('affiliateSuccessSection').style.display = 'none';
    document.getElementById('affiliateEmail').value = '';
}

function closeAffiliateModal() {
    document.getElementById('affiliateModal').style.display = 'none';
}

async function submitAffiliateInterest() {
    const email = document.getElementById('affiliateEmail').value.trim();
    
    if (!email || !email.includes('@')) {
        alert('Please enter a valid email address');
        return;
    }
    
    // Save to localStorage as backup
    const affiliates = JSON.parse(localStorage.getItem('affiliate_interests') || '[]');
    affiliates.push({ email, date: new Date().toISOString() });
    localStorage.setItem('affiliate_interests', JSON.stringify(affiliates));
    
    // Try to send to backend
    try {
        await fetch('https://api.quantummerlin.com/api/affiliate-interest', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email })
        });
    } catch (e) {
        console.log('Affiliate interest saved locally');
    }
    
    // Show success
    document.getElementById('affiliateFormSection').style.display = 'none';
    document.getElementById('affiliateSuccessSection').style.display = 'block';
}

window.showAffiliateModal = showAffiliateModal;
window.closeAffiliateModal = closeAffiliateModal;
</script>

<!-- Lucide Icons -->
<script src="https://unpkg.com/lucide@latest/dist/umd/lucide.min.js" onload="if(typeof lucide !== 'undefined') { lucide.createIcons(); console.log('Lucide icons initialized via onload'); }"></script>

</body>
</html>
