<!DOCTYPE html>
<html lang="en">
<head>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3480541530392777" crossorigin="anonymous"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#FF4500">
    <title>Party Power Results | Stranger Patterns üî¶</title>
    <meta name="description" content="Discover your adventuring party's supernatural synergy! See your power score, role assignments, and survival forecast. üî¶">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700;900&family=Cinzel:wght@400;500;600;700&family=Cormorant+Garamond:ital,wght@0,400;0,500;0,600;1,400;1,500&display=swap" rel="stylesheet">
    <link rel="icon" type="image/jpeg" href="stranger.jpg">
    <link rel="manifest" href="manifest.json">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Cormorant Garamond', serif;
            background: #0a0508;
            background-image: 
                linear-gradient(transparent 60%, rgba(220, 20, 60, 0.04) 60%),
                repeating-linear-gradient(90deg, transparent, transparent 50px, rgba(255, 69, 0, 0.04) 50px, rgba(255, 69, 0, 0.04) 51px),
                repeating-linear-gradient(0deg, transparent, transparent 50px, rgba(220, 20, 60, 0.04) 50px, rgba(220, 20, 60, 0.04) 51px),
                radial-gradient(circle at 20% 50%, rgba(220, 20, 60, 0.25) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 69, 0, 0.25) 0%, transparent 50%);
            min-height: 100vh;
            padding: 20px;
            color: #e0e0e0;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            margin-bottom: 15px;
            background: linear-gradient(135deg, #FF4500 0%, #DC143C 50%, #8B0000 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header .subtitle {
            font-size: 1.1rem;
            color: #FF6B35;
            font-style: italic;
        }
        
        .progress-bar {
            background: rgba(255, 69, 0, 0.2);
            border-radius: 10px;
            height: 8px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF4500, #DC143C, #8B0000);
            border-radius: 10px;
            width: 100%;
        }
        
        .progress-text {
            text-align: center;
            color: #9ca3af;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }
        
        /* Loading Animation */
        .loading {
            text-align: center;
            padding: 60px 20px;
        }
        
        .loading h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.8rem;
            color: #FF4500;
            margin-bottom: 30px;
        }
        
        .loading-bar {
            width: 200px;
            height: 6px;
            background: rgba(255, 69, 0, 0.2);
            border-radius: 3px;
            margin: 0 auto 20px;
            overflow: hidden;
        }
        
        .loading-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #FF4500, #DC143C, #8B0000);
            width: 0%;
            animation: loadProgress 3s ease-out forwards;
        }
        
        @keyframes loadProgress {
            0% { width: 0%; }
            100% { width: 100%; }
        }
        
        .loading-text {
            color: #9ca3af;
            font-style: italic;
        }

        .teaser-reveal {
            margin-top: 30px;
            padding: 20px;
            background: rgba(255, 69, 0, 0.1);
            border: 1px solid rgba(255, 69, 0, 0.3);
            border-radius: 15px;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.5s ease;
        }
        .teaser-reveal.show {
            opacity: 1;
            transform: translateY(0);
        }
        .teaser-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .teaser-text {
            color: #FF4500;
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
        }

        /* Rarity Badge */
        .rarity-badge {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-family: 'Cinzel', serif;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 15px;
            animation: rarityPulse 2s ease-in-out infinite;
        }
        .rarity-badge.legendary {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #000;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        .rarity-badge.epic {
            background: linear-gradient(135deg, #FF4500 0%, #DC143C 100%);
            color: #fff;
            box-shadow: 0 0 15px rgba(255, 69, 0, 0.5);
        }
        .rarity-badge.rare {
            background: linear-gradient(135deg, #DC143C 0%, #8B0000 100%);
            color: #fff;
        }
        @keyframes rarityPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Social Proof */
        .social-proof {
            text-align: center;
            padding: 15px;
            background: rgba(255, 69, 0, 0.1);
            border-radius: 10px;
            margin: 20px 0;
            font-size: 0.9rem;
            color: #9ca3af;
        }
        .social-proof strong {
            color: #FF4500;
        }

        /* Archetype Comparison */
        .archetype-comparison {
            background: linear-gradient(135deg, rgba(255, 69, 0, 0.15) 0%, rgba(220, 20, 60, 0.15) 100%);
            border: 2px solid rgba(255, 69, 0, 0.4);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            text-align: center;
        }
        .archetype-comparison h3 {
            font-family: 'Cinzel Decorative', serif;
            color: #FF4500;
            margin-bottom: 15px;
        }
        .archetype-match {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        .your-party, .archetype-name {
            padding: 15px 25px;
            border-radius: 15px;
            font-family: 'Cinzel', serif;
            font-weight: 600;
        }
        .your-party {
            background: rgba(255, 69, 0, 0.2);
            border: 1px solid #FF4500;
            color: #FF4500;
        }
        .archetype-name {
            background: rgba(220, 20, 60, 0.2);
            border: 1px solid #DC143C;
            color: #DC143C;
        }
        .match-equals {
            font-size: 1.5rem;
            color: #FFD700;
        }
        .match-percent {
            color: #FFD700;
            font-size: 1.2rem;
            margin-top: 15px;
        }
        
        /* Results Section */
        .results {
            display: none;
        }
        
        .results.show {
            display: block;
        }
        
        /* Power Score */
        .power-score-section {
            text-align: center;
            padding: 40px;
            background: rgba(20, 10, 15, 0.8);
            border: 2px solid rgba(255, 69, 0, 0.3);
            border-radius: 20px;
            margin-bottom: 30px;
        }
        
        .power-label {
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            color: #FF6B35;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .power-score {
            font-family: 'Cinzel Decorative', serif;
            font-size: 5rem;
            background: linear-gradient(135deg, #FF4500, #DC143C, #8B0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            line-height: 1;
        }
        
        .power-percent {
            font-size: 2rem;
        }
        
        .power-rating {
            margin-top: 15px;
            font-size: 1.4rem;
            color: #FFD700;
        }
        
        .power-desc {
            margin-top: 15px;
            font-size: 1.1rem;
            color: #9ca3af;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
        }
        
        /* Party Name Section */
        .party-name-section {
            background: rgba(255, 69, 0, 0.1);
            border: 2px solid rgba(255, 69, 0, 0.3);
            border-radius: 20px;
            padding: 35px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .party-name-label {
            font-family: 'Cinzel', serif;
            font-size: 1.1rem;
            color: #FF4500;
            margin-bottom: 15px;
        }
        
        .party-name {
            font-family: 'Cinzel Decorative', serif;
            font-size: clamp(2rem, 8vw, 3.5rem);
            color: white;
            text-shadow: 0 0 30px rgba(255, 69, 0, 0.5);
            margin-bottom: 15px;
        }
        
        .party-meaning {
            color: #9ca3af;
            font-style: italic;
        }
        
        .alt-names {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 69, 0, 0.2);
        }
        
        .alt-names-label {
            font-size: 0.9rem;
            color: #6b7280;
            margin-bottom: 10px;
        }
        
        .alt-names-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        
        .alt-name {
            padding: 8px 16px;
            background: rgba(220, 20, 60, 0.15);
            border: 1px solid rgba(220, 20, 60, 0.3);
            border-radius: 20px;
            color: #DC143C;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .alt-name:hover {
            background: rgba(220, 20, 60, 0.25);
            transform: scale(1.05);
        }
        
        /* Role Assignments */
        .roles-section {
            background: rgba(20, 10, 15, 0.8);
            border: 2px solid rgba(255, 69, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .roles-section h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.6rem;
            color: #FF4500;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .roles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .role-card {
            background: rgba(10, 5, 10, 0.6);
            border: 1px solid rgba(255, 69, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            transition: all 0.3s;
        }
        
        .role-card:hover {
            border-color: #FF4500;
            transform: translateY(-3px);
        }
        
        .role-card.leader {
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.05);
        }
        
        .role-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .role-icon {
            font-size: 1.8rem;
        }
        
        .role-info {
            flex: 1;
        }
        
        .member-name {
            font-family: 'Cinzel', serif;
            font-size: 1.2rem;
            color: #e0e0e0;
        }
        
        .role-title {
            font-size: 0.9rem;
            color: #FF4500;
            font-weight: 600;
        }
        
        .relationship-tag {
            font-size: 0.8rem;
            color: #DC143C;
            font-style: italic;
        }
        
        .role-desc {
            font-size: 0.9rem;
            color: #9ca3af;
            line-height: 1.5;
        }
        
        .role-stats {
            display: flex;
            gap: 8px;
            margin-top: 12px;
            flex-wrap: wrap;
        }
        
        .stat-tag {
            padding: 4px 10px;
            background: rgba(255, 69, 0, 0.15);
            border-radius: 12px;
            font-size: 0.75rem;
            color: #FF6B35;
        }
        
        /* Chemistry Breakdown */
        .chemistry-section {
            background: rgba(220, 20, 60, 0.05);
            border: 2px solid rgba(220, 20, 60, 0.2);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .chemistry-section h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.6rem;
            color: #DC143C;
            text-align: center;
            margin-bottom: 25px;
        }
        
        .chemistry-pairs {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .chem-pair {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: rgba(10, 5, 10, 0.6);
            border-radius: 12px;
        }
        
        .chem-names {
            min-width: 180px;
            font-family: 'Cinzel', serif;
            color: #e0e0e0;
        }
        
        .chem-bar-container {
            flex: 1;
            height: 10px;
            background: rgba(255, 69, 0, 0.2);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .chem-bar {
            height: 100%;
            background: linear-gradient(90deg, #FF4500, #DC143C);
            border-radius: 5px;
            transition: width 1s ease;
        }
        
        .chem-percent {
            min-width: 50px;
            text-align: right;
            font-family: 'Cinzel', serif;
            color: #DC143C;
        }
        
        /* Mission Forecast */
        .mission-section {
            background: rgba(20, 10, 15, 0.8);
            border: 2px solid rgba(255, 69, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .mission-section h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.6rem;
            color: #FF4500;
            margin-bottom: 20px;
        }
        
        .mission-date {
            font-family: 'Cinzel Decorative', serif;
            font-size: 2rem;
            color: #FFD700;
            margin-bottom: 15px;
        }
        
        .mission-analysis {
            color: #9ca3af;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Survival Analysis */
        .survival-section {
            background: rgba(20, 10, 15, 0.7);
            border: 2px solid rgba(255, 69, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
        }
        .survival-section h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.5rem;
            color: #FF4500;
            margin-bottom: 20px;
            text-align: center;
        }
        .survival-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .survival-card {
            background: rgba(255, 69, 0, 0.1);
            border: 1px solid rgba(255, 69, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
        }
        .survival-card h4 {
            color: #FFD700;
            font-family: 'Cinzel', serif;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }
        .survival-card p {
            color: #9ca3af;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Threat Forecast */
        .threat-section {
            background: rgba(20, 10, 15, 0.7);
            border: 2px solid rgba(220, 20, 60, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
        }
        .threat-section h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.5rem;
            color: #DC143C;
            margin-bottom: 20px;
            text-align: center;
        }
        .threat-timeline {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .threat-phase {
            background: rgba(255, 69, 0, 0.1);
            border-left: 4px solid #FF4500;
            padding: 15px 20px;
            border-radius: 0 10px 10px 0;
        }
        .threat-phase.danger {
            border-left-color: #DC143C;
            background: rgba(220, 20, 60, 0.1);
        }
        .phase-title {
            color: #FF4500;
            font-family: 'Cinzel', serif;
            font-weight: 600;
            margin-bottom: 5px;
        }
        .phase-desc {
            color: #9ca3af;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        /* Strategy Tips */
        .strategy-section {
            background: rgba(20, 10, 15, 0.7);
            border: 2px solid rgba(255, 215, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 25px;
        }
        .strategy-section h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.5rem;
            color: #FFD700;
            margin-bottom: 20px;
            text-align: center;
        }
        .strategy-tips {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .strategy-tip {
            background: rgba(255, 69, 0, 0.1);
            border: 1px solid rgba(255, 69, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }
        .strategy-tip-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        .strategy-tip-title {
            color: #FFD700;
            font-family: 'Cinzel', serif;
            font-size: 0.95rem;
            margin-bottom: 8px;
        }
        .strategy-tip-desc {
            color: #9ca3af;
            font-size: 0.85rem;
            line-height: 1.4;
        }
        
        /* Share Section */
        .share-section {
            background: rgba(20, 10, 15, 0.8);
            border: 2px solid rgba(255, 69, 0, 0.3);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .share-section h2 {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: #FF4500;
            margin-bottom: 20px;
        }
        
        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .share-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 20px;
            border: none;
            border-radius: 10px;
            font-family: 'Cinzel', serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
        }
        
        .share-btn.twitter {
            background: #1DA1F2;
            color: #fff;
        }
        
        .share-btn.copy {
            background: rgba(255, 69, 0, 0.2);
            color: #FF4500;
            border: 1px solid rgba(255, 69, 0, 0.3);
        }
        
        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        /* Actions */
        .actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-top: 30px;
        }
        
        .action-btn {
            padding: 15px 30px;
            border-radius: 10px;
            font-family: 'Cinzel', serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            text-align: center;
        }
        
        .action-btn.primary {
            background: linear-gradient(135deg, #FF4500 0%, #DC143C 100%);
            border: none;
            color: white;
        }
        
        .action-btn.secondary {
            background: rgba(255, 69, 0, 0.15);
            border: 1px solid rgba(255, 69, 0, 0.3);
            color: #FF6B35;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
        }

        /* Explore More */
        .explore-more-section {
            background: rgba(20, 10, 15, 0.9);
            border: 2px solid rgba(255, 69, 0, 0.3);
            border-radius: 20px;
            padding: 35px;
            margin-top: 40px;
            text-align: center;
        }
        .explore-more-section h2 {
            font-family: 'Cinzel Decorative', serif;
            font-size: 1.6rem;
            color: #FF4500;
            margin-bottom: 10px;
        }
        .explore-subtitle {
            color: #FF6B35;
            font-style: italic;
            margin-bottom: 25px;
        }
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
        }
        .tool-card-mini {
            background: rgba(255, 69, 0, 0.1);
            border: 1px solid rgba(255, 69, 0, 0.3);
            border-radius: 15px;
            padding: 20px 15px;
            text-decoration: none;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        .tool-card-mini:hover {
            background: rgba(255, 69, 0, 0.2);
            border-color: #FF4500;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(255, 69, 0, 0.3);
        }
        .tool-icon {
            font-size: 2rem;
        }
        .tool-name {
            font-family: 'Cinzel', serif;
            font-size: 0.95rem;
            color: #DC143C;
            font-weight: 600;
        }
        .tool-desc {
            font-size: 0.8rem;
            color: #9ca3af;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚ö° Your Party's Power Reading</h1>
            <p class="subtitle">The Upside Down has revealed your group's destiny! üî¶</p>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>
        <p class="progress-text">Complete! Your party analysis is ready ‚ö°</p>
        
        <!-- Loading -->
        <div class="loading" id="loading">
            <h2 id="loadingTitle">‚ö° Analyzing Your Party...</h2>
            <div class="loading-bar">
                <div class="loading-bar-fill" id="loadingBarFill"></div>
            </div>
            <p class="loading-text" id="loadingText">Scanning the Upside Down...</p>
            
            <div class="teaser-reveal" id="teaserReveal">
                <div class="teaser-icon">üëÄ</div>
                <p class="teaser-text" id="teaserText"></p>
            </div>
        </div>
        
        <!-- Results -->
        <div class="results" id="results">
            <!-- Power Score -->
            <div class="power-score-section">
                <div class="power-label">‚ö° Party Power Score ‚ö°</div>
                <div class="power-score">
                    <span id="powerValue">87</span><span class="power-percent">%</span>
                </div>
                <div class="power-rating" id="powerRating">üî• LEGENDARY SURVIVORS</div>
                <p class="power-desc" id="powerDesc">Your party could survive almost anything the Upside Down throws at you!</p>
                
                <div class="rarity-badge legendary" id="rarityBadge">‚≠ê TOP 3% OF ALL PARTIES</div>
            </div>

            <!-- Social Proof -->
            <div class="social-proof" id="socialProof">
                <strong id="partiesBuiltCount">28,453</strong> parties assembled ‚Ä¢ Only <strong id="topPercentage">12%</strong> are this powerful!
            </div>

            <!-- Archetype Comparison -->
            <div class="archetype-comparison" id="archetypeComparison">
                <h3>üî¶ Your Party Archetype</h3>
                <div class="archetype-match">
                    <div class="your-party" id="yourPartyName">YOUR PARTY</div>
                    <div class="match-equals">‚âà</div>
                    <div class="archetype-name" id="archetypeName">The Hawkins Heroes</div>
                </div>
                <p class="match-percent"><span id="matchPercent">89</span>% archetype alignment!</p>
                <p id="matchReason" style="color: #9ca3af; font-size: 0.9rem; margin-top: 10px;"></p>
            </div>
            
            <!-- Party Name -->
            <div class="party-name-section">
                <div class="party-name-label">Your Legendary Party Name ‚ö°</div>
                <div class="party-name" id="partyName">THE SURVIVORS</div>
                <p class="party-meaning" id="partyMeaning">Bound by fate to face the darkness together</p>
                
                <div class="alt-names">
                    <p class="alt-names-label">Other powerful names:</p>
                    <div class="alt-names-list" id="altNames">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </div>
            
            <!-- Role Assignments -->
            <div class="roles-section">
                <h2>üé≠ Party Role Assignments</h2>
                <div class="roles-grid" id="rolesGrid">
                    <!-- Filled by JS -->
                </div>
            </div>
            
            <!-- Chemistry Breakdown -->
            <div class="chemistry-section">
                <h2>‚ö° Party Chemistry Breakdown</h2>
                <div class="chemistry-pairs" id="chemistryPairs">
                    <!-- Filled by JS -->
                </div>
            </div>

            <!-- Survival Analysis -->
            <div class="survival-section">
                <h2>üõ°Ô∏è Survival Analysis</h2>
                <div class="survival-content" id="survivalContent">
                    <!-- Filled by JS -->
                </div>
            </div>

            <!-- Threat Forecast -->
            <div class="threat-section">
                <h2>‚ö†Ô∏è Threat Forecast</h2>
                <div class="threat-content" id="threatContent">
                    <!-- Filled by JS -->
                </div>
            </div>

            <!-- Strategy Tips -->
            <div class="strategy-section">
                <h2>üéØ Survival Strategy</h2>
                <div class="strategy-content" id="strategyContent">
                    <!-- Filled by JS -->
                </div>
            </div>
            
            <!-- Mission Forecast -->
            <div class="mission-section" id="missionSection">
                <h2>üìÖ Mission Day Forecast</h2>
                <div class="mission-date" id="missionDate">January 31, 2026</div>
                <p class="mission-analysis" id="missionAnalysis">The supernatural forces are aligned for your adventure!</p>
            </div>
            
            <!-- Share Section -->
            <div class="share-section">
                <h2>Share Your Party! ‚ö°</h2>
                <div class="share-buttons">
                    <button class="share-btn twitter" onclick="shareToTwitter()">
                        ùïè Share on X
                    </button>
                    <button class="share-btn copy" onclick="copyResults()">
                        üìã Copy Results
                    </button>
                </div>
            </div>
            
            <div class="actions">
                <a href="party-builder.html" class="action-btn secondary">Build New Party</a>
                <a href="tools_index.html" class="action-btn primary">Explore More Tools ‚ö°</a>
            </div>

            <!-- Explore More -->
            <div class="explore-more-section">
                <h2>üî¶ Discover More Strange Powers!</h2>
                <p class="explore-subtitle">Your party reading is just the beginning... ‚ö°</p>
                <div class="tools-grid">
                    <a href="compatibility-calculator.html" class="tool-card-mini">
                        <span class="tool-icon">‚ö°</span>
                        <span class="tool-name">Compatibility</span>
                        <span class="tool-desc">Test two adventurers' survival bond!</span>
                    </a>
                    <a href="life-path-calculator.html" class="tool-card-mini">
                        <span class="tool-icon">üîÆ</span>
                        <span class="tool-name">Life Path</span>
                        <span class="tool-desc">Discover your supernatural destiny!</span>
                    </a>
                    <a href="zodiac-calculator.html" class="tool-card-mini">
                        <span class="tool-icon">‚≠ê</span>
                        <span class="tool-name">Zodiac</span>
                        <span class="tool-desc">Your cosmic survival profile!</span>
                    </a>
                    <a href="moon-sign-reading.html" class="tool-card-mini">
                        <span class="tool-icon">üåô</span>
                        <span class="tool-name">Moon Sign</span>
                        <span class="tool-desc">Your hidden supernatural side!</span>
                    </a>
                    <a href="rising-sign-reading.html" class="tool-card-mini">
                        <span class="tool-icon">üåÖ</span>
                        <span class="tool-name">Rising Sign</span>
                        <span class="tool-desc">Your first impression in danger!</span>
                    </a>
                    <a href="yes-no-oracle.html" class="tool-card-mini">
                        <span class="tool-icon">üé±</span>
                        <span class="tool-name">Yes/No Oracle</span>
                        <span class="tool-desc">Ask the Upside Down!</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        // Get data from session storage
        const members = JSON.parse(sessionStorage.getItem('partyBuilderMembers') || '[]');
        const missionDate = sessionStorage.getItem('partyBuilderDate') || '';
        const dateType = sessionStorage.getItem('partyBuilderDateType') || 'skip';
        
        // Redirect if no members
        if (members.length === 0) {
            window.location.href = 'party-builder.html';
        }
        
        // Calculate all results
        function calculateResults() {
            members.forEach(m => {
                m.lifePath = calculateLifePath(m.dob);
                m.destinyNumber = calculateDestinyNumber(m.name);
            });
            
            const synergy = calculateSynergy();
            const roles = assignRoles();
            const names = generatePartyNames();
            const chemistry = calculateChemistry();
            const missionAnalysis = analyzeMissionDate();
            
            return { synergy, roles, names, chemistry, missionAnalysis };
        }
        
        function calculateLifePath(dob) {
            const digits = dob.replace(/-/g, '').split('').map(Number);
            let sum = digits.reduce((a, b) => a + b, 0);
            return reduceToSingle(sum);
        }
        
        function calculateDestinyNumber(name) {
            const values = { a:1,b:2,c:3,d:4,e:5,f:6,g:7,h:8,i:9,j:1,k:2,l:3,m:4,n:5,o:6,p:7,q:8,r:9,s:1,t:2,u:3,v:4,w:5,x:6,y:7,z:8 };
            const letters = name.toLowerCase().replace(/[^a-z]/g, '');
            let sum = 0;
            for (let char of letters) {
                sum += values[char] || 0;
            }
            return reduceToSingle(sum);
        }
        
        function reduceToSingle(num) {
            while (num > 9 && num !== 11 && num !== 22 && num !== 33) {
                num = String(num).split('').reduce((a, b) => a + parseInt(b), 0);
            }
            return num;
        }
        
        function calculateSynergy() {
            let totalCompat = 0;
            let pairs = 0;
            
            for (let i = 0; i < members.length; i++) {
                for (let j = i + 1; j < members.length; j++) {
                    const compat = getPairCompatibility(members[i].lifePath, members[j].lifePath);
                    totalCompat += compat;
                    pairs++;
                }
            }
            
            let avgCompat = pairs > 0 ? totalCompat / pairs : 70;
            
            const masterCount = members.filter(m => [11, 22, 33].includes(m.lifePath)).length;
            avgCompat += masterCount * 3;
            
            const uniqueNumbers = new Set(members.map(m => m.lifePath)).size;
            avgCompat += (uniqueNumbers / members.length) * 10;
            
            return Math.min(99, Math.max(50, Math.round(avgCompat)));
        }
        
        function getPairCompatibility(a, b) {
            if (a === b) return 85;
            
            const perfect = [[1,5], [2,4], [3,6], [1,9], [2,8], [3,9], [4,8], [5,7], [6,9]];
            if (perfect.some(p => (p[0]===a && p[1]===b) || (p[0]===b && p[1]===a))) return 90;
            
            const good = [[1,3], [2,6], [4,6], [5,9], [7,9], [1,7], [3,5]];
            if (good.some(p => (p[0]===a && p[1]===b) || (p[0]===b && p[1]===a))) return 80;
            
            return 70;
        }
        
        function assignRoles() {
            const rolePool = [
                { role: 'The Leader', icon: 'üëë', traits: ['decisive', 'brave', 'strategic'] },
                { role: 'The Brain', icon: 'üß†', traits: ['clever', 'analytical', 'inventive'] },
                { role: 'The Power', icon: '‚ö°', traits: ['supernatural', 'intense', 'protective'] },
                { role: 'The Heart', icon: 'üíú', traits: ['empathetic', 'loyal', 'connecting'] },
                { role: 'The Wildcard', icon: 'üé≤', traits: ['unpredictable', 'brave', 'funny'] },
                { role: 'The Protector', icon: 'üõ°Ô∏è', traits: ['strong', 'reliable', 'selfless'] },
                { role: 'The Investigator', icon: 'üîç', traits: ['curious', 'persistent', 'insightful'] },
                { role: 'The Survivor', icon: 'üî•', traits: ['resilient', 'adaptive', 'determined'] },
                { role: 'The Strategist', icon: 'üéØ', traits: ['tactical', 'calm', 'wise'] },
                { role: 'The Scout', icon: 'üî¶', traits: ['fast', 'observant', 'courageous'] },
                { role: 'The Healer', icon: 'üíö', traits: ['nurturing', 'supportive', 'calming'] },
                { role: 'The Rebel', icon: 'üè¥', traits: ['defiant', 'resourceful', 'fierce'] }
            ];
            
            const lifePathRoles = {
                1: ['The Leader', 'The Strategist'],
                2: ['The Heart', 'The Healer'],
                3: ['The Wildcard', 'The Scout'],
                4: ['The Protector', 'The Survivor'],
                5: ['The Scout', 'The Rebel'],
                6: ['The Heart', 'The Healer'],
                7: ['The Brain', 'The Investigator'],
                8: ['The Leader', 'The Protector'],
                9: ['The Power', 'The Heart'],
                11: ['The Power', 'The Brain'],
                22: ['The Leader', 'The Strategist'],
                33: ['The Heart', 'The Healer']
            };
            
            const assignedRoles = [];
            const usedRoles = new Set();
            
            const sorted = [...members].sort((a, b) => {
                const priority = { 1: 1, 8: 2, 11: 3, 22: 4 };
                return (priority[a.lifePath] || 99) - (priority[b.lifePath] || 99);
            });
            
            sorted.forEach((member, idx) => {
                // Check if user assigned a role
                let bestRole = member.partyRole || lifePathRoles[member.lifePath]?.[0] || 'The Survivor';
                
                if (idx === 0 && [1, 8, 11, 22].includes(member.lifePath) && !member.partyRole) {
                    bestRole = 'The Leader';
                }
                
                let roleData = rolePool.find(r => r.role === bestRole && !usedRoles.has(r.role));
                if (!roleData) {
                    roleData = rolePool.find(r => !usedRoles.has(r.role)) || rolePool[rolePool.length - 1];
                }
                
                usedRoles.add(roleData.role);
                
                const descriptions = {
                    1: `Born to lead in crisis. ${member.name} rallies the party when things get dark.`,
                    2: `The emotional anchor. ${member.name} keeps everyone connected and hopeful.`,
                    3: `Unpredictable but essential. ${member.name} finds solutions no one else sees.`,
                    4: `The steady rock. ${member.name} never gives up, no matter the odds.`,
                    5: `Quick and resourceful. ${member.name} scouts ahead and adapts fast.`,
                    6: `The nurturing soul. ${member.name} heals wounds both physical and emotional.`,
                    7: `The analytical mind. ${member.name} decodes mysteries and patterns.`,
                    8: `Powerful presence. ${member.name} intimidates threats and protects the party.`,
                    9: `Connected to something greater. ${member.name} senses things others miss.`,
                    11: `Psychic intuition. ${member.name} has gifts that defy explanation.`,
                    22: `Master strategist. ${member.name} builds the plan that saves everyone.`,
                    33: `Supernatural healer. ${member.name}'s presence strengthens the whole party.`
                };
                
                assignedRoles.push({
                    member: member.name,
                    role: roleData.role,
                    icon: roleData.icon,
                    traits: roleData.traits,
                    description: descriptions[member.lifePath] || `A vital member of the survival team.`,
                    lifePath: member.lifePath,
                    isLeader: roleData.role === 'The Leader',
                    relationship: member.relationship || ''
                });
            });
            
            return members.map(m => assignedRoles.find(r => r.member === m.name));
        }
        
        function generatePartyNames() {
            const memberCount = members.length;
            const initials = members.map(m => m.name[0].toUpperCase()).join('');
            const totalLifePath = members.reduce((sum, m) => sum + m.lifePath, 0);
            const partyNumber = reduceToSingle(totalLifePath);
            
            const names = [
                {
                    name: `THE ${partyNumber >= 7 ? 'UPSIDE DOWNERS' : 'SURVIVORS'}`,
                    meaning: `United under ${partyNumber} energy - ready to face any darkness`
                },
                {
                    name: `PARTY OF ${memberCount}`,
                    meaning: `${memberCount} adventurers bound by fate`
                },
                {
                    name: initials.length <= 6 ? `THE ${initials} CREW` : `CREW ${initials.slice(0, 4)}`,
                    meaning: `Your initials form a powerful symbol`
                },
                {
                    name: 'THE STRANGE ONES',
                    meaning: 'Those who see what others cannot'
                },
                {
                    name: 'THE GATEKEEPERS',
                    meaning: 'Guardians between worlds'
                }
            ];
            
            return names;
        }
        
        function calculateChemistry() {
            const pairs = [];
            
            for (let i = 0; i < members.length; i++) {
                for (let j = i + 1; j < members.length; j++) {
                    const compat = getPairCompatibility(members[i].lifePath, members[j].lifePath);
                    pairs.push({
                        member1: members[i].name.split(' ')[0],
                        member2: members[j].name.split(' ')[0],
                        percent: compat
                    });
                }
            }
            
            pairs.sort((a, b) => b.percent - a.percent);
            return pairs.slice(0, 8);
        }
        
        function analyzeMissionDate() {
            if (!missionDate || dateType === 'skip') {
                return { formatted: '', dayNumber: 0, analysis: '' };
            }
            
            const date = new Date(missionDate);
            const formatted = date.toLocaleDateString('en-US', { 
                weekday: 'long',
                month: 'long', 
                day: 'numeric', 
                year: 'numeric' 
            });
            
            const daySum = date.getDate() + (date.getMonth() + 1) + date.getFullYear();
            const dayNumber = reduceToSingle(daySum);
            
            const analyses = {
                1: `${dayNumber} energy day - New beginnings and leadership! Your party will take decisive action. Victory favors the bold!`,
                2: `${dayNumber} partnership energy - Teamwork is essential today. Trust your party members completely.`,
                3: `${dayNumber} creative energy - Unexpected solutions will save the day. Think outside the box!`,
                4: `${dayNumber} foundation energy - Build your defenses strong. Preparation is everything.`,
                5: `${dayNumber} change energy - Expect the unexpected! Stay flexible and ready to adapt.`,
                6: `${dayNumber} harmony energy - Protect what you love. Family and friends give you strength.`,
                7: `${dayNumber} mystery energy - The veil is thin. Secrets will be revealed. Trust your intuition!`,
                8: `${dayNumber} power energy - Maximum supernatural activity! Your party's abilities are amplified.`,
                9: `${dayNumber} completion energy - This could be a turning point. Major revelations await.`,
                11: `MASTER NUMBER ${dayNumber}! Psychic energy at peak levels. The impossible becomes possible.`,
                22: `MASTER BUILDER ${dayNumber}! Your actions today have lasting consequences. Build wisely.`,
                33: `RARE MASTER ${dayNumber}! Miraculous energy surrounds your party. Healing and hope prevail.`
            };
            
            return {
                formatted,
                dayNumber,
                analysis: analyses[dayNumber] || analyses[reduceToSingle(dayNumber)]
            };
        }
        
        // Render results
        function renderResults(data) {
            document.getElementById('powerValue').textContent = data.synergy;
            
            const ratings = [
                [90, 'üî• LEGENDARY SURVIVORS', 'Your party could survive almost anything the Upside Down throws at you!'],
                [80, '‚ö° ELITE ADVENTURERS', 'You\'ve got what it takes to face the darkness and win!'],
                [70, 'üõ°Ô∏è CAPABLE PARTY', 'Strong foundation with great survival potential!'],
                [60, 'üî¶ GROWING TEAM', 'Your unique differences make you stronger together!'],
                [0, 'üåô EMERGING HEROES', 'Every legendary party started somewhere. Your story begins now!']
            ];
            
            const rating = ratings.find(r => data.synergy >= r[0]);
            document.getElementById('powerRating').textContent = rating[1];
            document.getElementById('powerDesc').textContent = rating[2];
            
            // Party name
            document.getElementById('partyName').textContent = data.names[0].name;
            document.getElementById('partyMeaning').textContent = data.names[0].meaning;
            
            document.getElementById('altNames').innerHTML = data.names.slice(1).map(n => 
                `<span class="alt-name" onclick="selectName('${n.name}', '${n.meaning}')">${n.name}</span>`
            ).join('');
            
            // Roles
            document.getElementById('rolesGrid').innerHTML = data.roles.map(r => `
                <div class="role-card ${r.isLeader ? 'leader' : ''}">
                    <div class="role-header">
                        <span class="role-icon">${r.icon}</span>
                        <div class="role-info">
                            <div class="member-name">${r.member}</div>
                            <div class="role-title">${r.role}</div>
                            ${r.relationship ? `<div class="relationship-tag">${r.relationship}</div>` : ''}
                        </div>
                    </div>
                    <p class="role-desc">${r.description}</p>
                    <div class="role-stats">
                        ${r.traits.map(t => `<span class="stat-tag">${t}</span>`).join('')}
                        <span class="stat-tag">LP ${r.lifePath}</span>
                    </div>
                </div>
            `).join('');
            
            // Chemistry
            document.getElementById('chemistryPairs').innerHTML = data.chemistry.map(c => `
                <div class="chem-pair">
                    <div class="chem-names">${c.member1} √ó ${c.member2}</div>
                    <div class="chem-bar-container">
                        <div class="chem-bar" style="width: ${c.percent}%"></div>
                    </div>
                    <div class="chem-percent">${c.percent}%</div>
                </div>
            `).join('');

            // Survival Analysis
            renderSurvival(data);
            
            // Threat Forecast
            renderThreats(data);
            
            // Strategy Tips
            renderStrategy(data);
            
            // Mission
            if (data.missionAnalysis.formatted) {
                document.getElementById('missionDate').textContent = data.missionAnalysis.formatted;
                document.getElementById('missionAnalysis').textContent = data.missionAnalysis.analysis;
            } else {
                document.getElementById('missionSection').style.display = 'none';
            }
        }

        function renderSurvival(data) {
            const memberCount = members.length;
            const avgLifePath = Math.round(members.reduce((sum, m) => sum + m.lifePath, 0) / memberCount);
            const hasLeader = data.roles.some(r => r.role === 'The Leader');
            const hasBrain = data.roles.some(r => r.role === 'The Brain');
            const hasPower = data.roles.some(r => r.role === 'The Power');
            
            const survivalHTML = `
                <div class="survival-grid">
                    <div class="survival-card">
                        <h4>‚ö° Combat Readiness</h4>
                        <p>${hasPower || data.synergy >= 85 ? 'Your party has SERIOUS firepower! Whether it\'s supernatural abilities or raw determination, you can handle physical threats.' : data.synergy >= 70 ? 'Good combat potential! Focus on teamwork and you\'ll overcome any monster.' : 'Build your strength through unity. Your bond is your greatest weapon!'}</p>
                    </div>
                    <div class="survival-card">
                        <h4>üß† Problem Solving</h4>
                        <p>${hasBrain ? 'You have a certified genius! Complex puzzles and coded messages don\'t stand a chance.' : avgLifePath >= 7 ? 'Strong analytical energy in your party. Trust your collective intuition!' : 'Street smarts over book smarts. Your practical solutions will surprise everyone!'}</p>
                    </div>
                    <div class="survival-card">
                        <h4>üíú Emotional Resilience</h4>
                        <p>${data.synergy >= 80 ? 'Your emotional bond is UNBREAKABLE! No mind flayer tricks can turn you against each other.' : data.synergy >= 70 ? 'Strong trust foundation! Keep communicating and stay connected.' : 'Growing closer through adversity. Each challenge strengthens your bond.'}</p>
                    </div>
                    <div class="survival-card">
                        <h4>üî¶ Adaptability</h4>
                        <p>${memberCount >= 5 ? 'Large party = diverse skills! You can handle any situation by splitting up smartly.' : memberCount >= 3 ? 'Perfect-sized party for stealth AND power. You\'re flexible and effective.' : 'Small but mighty! Your tight bond means instant coordination.'}</p>
                    </div>
                </div>
            `;
            document.getElementById('survivalContent').innerHTML = survivalHTML;
        }

        function renderThreats(data) {
            const masterNumbers = members.filter(m => [11, 22, 33].includes(m.lifePath)).length;
            const highEnergy = members.filter(m => m.lifePath >= 7).length;
            
            const threatHTML = `
                <div class="threat-timeline">
                    <div class="threat-phase">
                        <div class="phase-title">üåô Minor Disturbances</div>
                        <div class="phase-desc">${data.synergy >= 80 ? 'Your party handles small threats effortlessly. Demogorgon dogs? Child\'s play.' : 'Stay alert to small signs. Your growing awareness will catch threats early.'}</div>
                    </div>
                    <div class="threat-phase">
                        <div class="phase-title">‚ö†Ô∏è Major Encounters</div>
                        <div class="phase-desc">${masterNumbers > 0 ? 'Master number energy in your party means you\'re MADE for major battles. You attract powerful forces - but can handle them!' : 'When the big threats come, remember: your teamwork is your superpower. Trust each other completely.'}</div>
                    </div>
                    <div class="threat-phase danger">
                        <div class="phase-title">üî• Gate-Level Events</div>
                        <div class="phase-desc">${highEnergy >= 2 ? 'Your party has the supernatural juice to face gate-level threats. You might be the ones who close the next portal!' : 'Gate-level events need all hands on deck. Call in reinforcements, but YOU are the core team that matters.'}</div>
                    </div>
                    <div class="threat-phase">
                        <div class="phase-title">‚ú® Victory Aftermath</div>
                        <div class="phase-desc">${members.length >= 4 ? 'Your party is built for the long haul. After the battle, you\'ll heal together and emerge stronger.' : 'Tight-knit parties recover faster. Your deep bonds are your healing power.'}</div>
                    </div>
                </div>
            `;
            document.getElementById('threatContent').innerHTML = threatHTML;
        }

        function renderStrategy(data) {
            const strategyHTML = `
                <div class="strategy-tips">
                    <div class="strategy-tip">
                        <div class="strategy-tip-icon">üìª</div>
                        <div class="strategy-tip-title">Communication</div>
                        <div class="strategy-tip-desc">${data.synergy >= 80 ? 'Your party syncs naturally! Brief looks convey volumes. Use this!' : 'Establish clear signals. When things go dark, you need to coordinate fast.'}</div>
                    </div>
                    <div class="strategy-tip">
                        <div class="strategy-tip-icon">üî¶</div>
                        <div class="strategy-tip-title">Equipment</div>
                        <div class="strategy-tip-desc">${members.some(m => m.lifePath === 4) ? 'Someone in your party is PREPARED. Trust their gear choices!' : 'Stock flashlights, walkie-talkies, and snacks. Seriously, the snacks matter.'}</div>
                    </div>
                    <div class="strategy-tip">
                        <div class="strategy-tip-icon">üè†</div>
                        <div class="strategy-tip-title">Safe Zones</div>
                        <div class="strategy-tip-desc">${members.some(m => m.lifePath === 6) ? 'Your nurturer knows the best hiding spots. Trust their instincts on safety!' : 'Establish fallback points before you go in. Always have an exit strategy.'}</div>
                    </div>
                    <div class="strategy-tip">
                        <div class="strategy-tip-icon">ü§ù</div>
                        <div class="strategy-tip-title">Unity Rule</div>
                        <div class="strategy-tip-desc">${data.synergy >= 85 ? 'NEVER split up unless absolutely necessary. Your power multiplies together!' : 'Practice your formations. Know who covers who. Teamwork wins battles.'}</div>
                    </div>
                </div>
            `;
            document.getElementById('strategyContent').innerHTML = strategyHTML;
        }
        
        function selectName(name, meaning) {
            document.getElementById('partyName').textContent = name;
            document.getElementById('partyMeaning').textContent = meaning;
        }
        
        // Share functions
        function shareToTwitter() {
            const text = `Just assembled my adventuring party "${document.getElementById('partyName').textContent}" with ${document.getElementById('powerValue').textContent}% power! ‚ö°üî¶\n\nBuild yours: quantummerlin.com/stranger/party-builder.html`;
            window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(text)}`, '_blank');
        }
        
        function copyResults() {
            const text = `
‚ö° MY PARTY: ${document.getElementById('partyName').textContent}
üî¶ Power Score: ${document.getElementById('powerValue').textContent}%

Party Members:
${members.map(m => `‚Ä¢ ${m.name}${m.relationship ? ` (${m.relationship})` : ''}`).join('\n')}

Build your party: quantummerlin.com/stranger/party-builder.html
            `.trim();
            
            navigator.clipboard.writeText(text);
            alert('Results copied! Share with your party! ‚ö°');
        }

        // Archetypes
        const partyArchetypes = [
            { name: 'The Hawkins Heroes', traits: [1, 5, 11], size: 4, vibe: 'classic adventurers', reason: 'Your balanced party echoes the legendary Hawkins crew' },
            { name: 'The Power Squad', traits: [8, 11, 22], size: 3, vibe: 'supernatural force', reason: 'Your psychic energy matches the most powerful parties' },
            { name: 'The Survival Team', traits: [4, 6, 9], size: 5, vibe: 'resilient fighters', reason: 'Your determination mirrors legendary survivor groups' },
            { name: 'The Brain Trust', traits: [7, 11, 3], size: 4, vibe: 'problem solvers', reason: 'Your analytical power rivals the greatest mystery solvers' },
            { name: 'The Family Unit', traits: [2, 6, 33], size: 4, vibe: 'protective bond', reason: 'Your family-like bond creates unbreakable unity' },
            { name: 'The Rebels', traits: [1, 5, 8], size: 4, vibe: 'defiant heroes', reason: 'Your rebellious spirit matches the greatest resistance fighters' },
            { name: 'The Guardians', traits: [4, 8, 6], size: 5, vibe: 'protective warriors', reason: 'Your protective instincts match legendary guardian parties' },
            { name: 'The Seekers', traits: [7, 5, 9], size: 3, vibe: 'truth hunters', reason: 'Your truth-seeking energy mirrors the greatest investigator parties' }
        ];

        const loadingStages = [
            { text: 'Scanning the Upside Down...', percent: 15, delay: 0 },
            { text: 'Calculating life path numbers...', percent: 30, delay: 800 },
            { text: 'Analyzing supernatural bonds...', percent: 45, delay: 1600 },
            { text: 'Something strange is emerging... üëÄ', percent: 55, delay: 2400, isTeaser: true },
            { text: 'Comparing to legendary parties...', percent: 70, delay: 3200 },
            { text: 'Your party is powerful... calculating how powerful...', percent: 85, delay: 4000, isTeaser: true },
            { text: 'Finalizing your reading ‚ö°', percent: 100, delay: 4800 }
        ];

        function findArchetypeMatch(synergy) {
            const memberLifePaths = members.map(m => m.lifePath);
            const memberCount = members.length;
            
            let bestMatch = partyArchetypes[0];
            let bestScore = 0;
            
            partyArchetypes.forEach(archetype => {
                let score = 0;
                archetype.traits.forEach(trait => {
                    if (memberLifePaths.includes(trait)) score += 20;
                });
                const sizeDiff = Math.abs(archetype.size - memberCount);
                score += Math.max(0, 30 - sizeDiff * 5);
                score += synergy * 0.3;
                
                if (score > bestScore) {
                    bestScore = score;
                    bestMatch = archetype;
                }
            });
            
            const matchPercent = Math.min(97, Math.max(75, Math.round(bestScore * 0.8)));
            return { archetype: bestMatch, percent: matchPercent };
        }

        function calculateRarity(synergy) {
            if (synergy >= 90) return { badge: 'legendary', text: '‚≠ê TOP 3% OF ALL PARTIES', percent: 3 };
            if (synergy >= 85) return { badge: 'legendary', text: 'üî• TOP 7% OF ALL PARTIES', percent: 7 };
            if (synergy >= 80) return { badge: 'epic', text: '‚ö° TOP 12% OF ALL PARTIES', percent: 12 };
            if (synergy >= 75) return { badge: 'epic', text: 'üî¶ TOP 18% OF ALL PARTIES', percent: 18 };
            if (synergy >= 70) return { badge: 'rare', text: 'üõ°Ô∏è TOP 25% OF ALL PARTIES', percent: 25 };
            return { badge: 'rare', text: 'üåô UNIQUE ENERGY DETECTED', percent: 35 };
        }

        function generateSocialProof() {
            const baseCount = 28000 + Math.floor(Math.random() * 2000);
            return { total: baseCount.toLocaleString() };
        }

        function runProgressiveLoading(data) {
            const textEl = document.getElementById('loadingText');
            const barEl = document.getElementById('loadingBarFill');
            const teaserEl = document.getElementById('teaserReveal');
            const teaserTextEl = document.getElementById('teaserText');

            const teasers = [
                `Your party has ${members.filter(m => [11,22,33].includes(m.lifePath)).length > 0 ? 'SUPERNATURAL POWER' : 'strong synergy patterns'}! ‚ö°`,
                `Only ${calculateRarity(data.synergy).percent}% of parties are this powerful...`
            ];

            let teaserIndex = 0;
            loadingStages.forEach((stage) => {
                setTimeout(() => {
                    textEl.textContent = stage.text;
                    barEl.style.width = stage.percent + '%';
                    barEl.style.transition = 'width 0.5s ease-out';
                    
                    if (stage.isTeaser && teaserIndex < teasers.length) {
                        teaserTextEl.textContent = teasers[teaserIndex];
                        teaserEl.classList.add('show');
                        teaserIndex++;
                    }
                }, stage.delay);
            });
        }

        function renderPsychologicalElements(data) {
            const rarity = calculateRarity(data.synergy);
            const rarityEl = document.getElementById('rarityBadge');
            rarityEl.textContent = rarity.text;
            rarityEl.className = 'rarity-badge ' + rarity.badge;

            const social = generateSocialProof();
            document.getElementById('partiesBuiltCount').textContent = social.total;
            document.getElementById('topPercentage').textContent = rarity.percent + '%';

            const match = findArchetypeMatch(data.synergy);
            document.getElementById('yourPartyName').textContent = data.names[0].name;
            document.getElementById('archetypeName').textContent = match.archetype.name;
            document.getElementById('matchPercent').textContent = match.percent;
            document.getElementById('matchReason').textContent = match.archetype.reason;
        }
        
        // Initialize
        const data = calculateResults();
        runProgressiveLoading(data);
        
        setTimeout(() => {
            renderResults(data);
            renderPsychologicalElements(data);
            
            document.getElementById('loading').style.display = 'none';
            document.getElementById('results').classList.add('show');
        }, 5500);
    </script>

    <!-- Legal Footer -->
    <footer class="legal-footer">
        <div class="feedback-section">
            <p class="feedback-text">üõ†Ô∏è Found an issue or have a suggestion?</p>
            <a href="mailto:fixit@quantummerlin.com?subject=Party%20Builder%20Feedback" class="footer-feedback-btn">üìß fixit@quantummerlin.com</a>
        </div>
        <div class="legal-links">
            <a href="terms.html">Terms of Service</a>
            <span class="separator">|</span>
            <a href="privacy.html">Privacy Policy</a>
            <span class="separator">|</span>
            <a href="disclaimer.html">Disclaimer</a>
        </div>
        <p class="copyright">&copy; 2026 Stranger Patterns üî¶</p>
        <div class="coffee-section">
            <a href="https://buymeacoffee.com/quantummerlin" target="_blank" class="coffee-btn">‚òï Buy Us a Coffee</a>
        </div>
    </footer>
    <style>
        .legal-footer {
            margin-top: 50px;
            padding: 30px 20px;
            text-align: center;
            border-top: 1px solid rgba(255, 69, 0, 0.2);
            background: rgba(10, 5, 10, 0.8);
        }
        .feedback-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 69, 0, 0.15);
        }
        .feedback-text {
            color: #9ca3af;
            font-size: 0.9rem;
            margin-bottom: 10px;
        }
        .footer-feedback-btn {
            display: inline-block;
            color: #FF4500;
            text-decoration: none;
            font-family: 'Cinzel', serif;
            font-size: 0.95rem;
            padding: 10px 20px;
            border: 1px solid rgba(255, 69, 0, 0.4);
            border-radius: 25px;
            transition: all 0.3s;
        }
        .footer-feedback-btn:hover {
            background: rgba(255, 69, 0, 0.15);
            border-color: #FF4500;
            transform: translateY(-2px);
        }
        .legal-links {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .legal-links a {
            color: #9ca3af;
            text-decoration: none;
            font-family: 'Cinzel', serif;
            font-size: 0.9rem;
            transition: color 0.3s;
        }
        .legal-links a:hover {
            color: #FF4500;
        }
        .legal-links .separator {
            color: rgba(255, 69, 0, 0.4);
        }
        .copyright {
            color: #DC143C;
            font-size: 0.85rem;
            font-style: italic;
            margin-bottom: 20px;
        }
        .coffee-section {
            padding-top: 15px;
            border-top: 1px solid rgba(255, 69, 0, 0.15);
        }
        .coffee-btn {
            display: inline-block;
            background: linear-gradient(135deg, #FF4500 0%, #f59e0b 100%);
            color: #0a0508;
            text-decoration: none;
            font-family: 'Cinzel', serif;
            font-weight: 600;
            font-size: 0.95rem;
            padding: 12px 25px;
            border-radius: 25px;
            transition: all 0.3s;
        }
        .coffee-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 69, 0, 0.4);
        }
    </style>
</body>
</html>
