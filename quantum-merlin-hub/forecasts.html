<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Forecaster | Your Personalized Cosmic Forecast</title>
    <meta name="description" content="Get your personalized cosmic forecast using Western astrology, Chinese zodiac, numerology, and gematria. Multi-system forecasting for daily, weekly, monthly, and yearly insights.">
    <meta name="keywords" content="quantum forecaster, daily horoscope, personalized forecast, astrology, numerology, chinese zodiac, gematria, cosmic guidance">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Quantum Forecaster | Multi-System Cosmic Guidance">
    <meta property="og:description" content="The only forecaster that uses 8 mystical systems. From surface to soul: forecasts that go as deep as you want.">
    <meta property="og:url" content="https://quantummerlin.com/forecasts">
    <meta property="og:type" content="website">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700;800;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Swiss Ephemeris for accurate astronomical calculations -->
    <script src="https://cdn.jsdelivr.net/npm/swisseph@2.10.3-2/dist/swisseph.min.js"></script>
    
    <style>
        :root {
            --cosmic-bg: #000000;
            --neon-cyan: #00f5ff;
            --neon-purple: #9d00ff;
            --neon-gold: #ffd700;
            --neon-pink: #ff0066;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: rgba(255, 255, 255, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: var(--cosmic-bg);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Animated Cosmic Background */
        .cosmic-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            background: radial-gradient(ellipse at center, #1a0033 0%, #000000 100%);
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .star {
            position: absolute;
            background: white;
            border-radius: 50%;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 10;
        }

        /* Hero Section */
        .hero {
            text-align: center;
            margin-bottom: 60px;
            padding: 40px 20px;
        }

        .hero h1 {
            font-family: 'Orbitron', monospace;
            font-size: 3rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple), var(--neon-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 20px;
            filter: drop-shadow(0 0 30px rgba(0, 245, 255, 0.6));
            animation: glow-pulse 3s ease-in-out infinite;
        }

        @keyframes glow-pulse {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(0, 245, 255, 0.4)); }
            50% { filter: drop-shadow(0 0 40px rgba(0, 245, 255, 0.8)); }
        }

        .hero .tagline {
            font-size: 1.3rem;
            color: var(--text-secondary);
            margin-bottom: 30px;
        }

        .hero .systems {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .system-badge {
            background: rgba(0, 245, 255, 0.1);
            border: 2px solid rgba(0, 245, 255, 0.3);
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            color: var(--neon-cyan);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }

        .system-badge:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 30px rgba(0, 245, 255, 0.5);
            border-color: var(--neon-cyan);
        }

        /* Input Section */
        .input-section {
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.08) 0%, rgba(157, 0, 255, 0.08) 100%);
            backdrop-filter: blur(30px);
            border: 2px solid rgba(0, 245, 255, 0.4);
            border-radius: 25px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 8px 32px rgba(0, 245, 255, 0.2);
        }

        .input-section h2 {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            color: var(--neon-gold);
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--neon-cyan);
            margin-bottom: 10px;
        }

        .input-group input,
        .input-group select,
        .input-group textarea {
            width: 100%;
            padding: 15px;
            font-size: 1rem;
            font-family: 'Rajdhani', sans-serif;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 12px;
            color: white;
            transition: all 0.3s ease;
        }

        .input-group input:focus,
        .input-group select:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 245, 255, 0.3);
        }

        .input-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .optional-badge {
            display: inline-block;
            font-size: 0.8rem;
            color: rgba(255, 215, 0, 0.7);
            margin-left: 8px;
        }

        .help-text {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.6);
            margin-top: 5px;
        }

        /* Expandable Sections */
        .expandable {
            margin-top: 30px;
        }

        .expand-btn {
            background: rgba(157, 0, 255, 0.2);
            border: 2px solid rgba(157, 0, 255, 0.4);
            color: var(--neon-purple);
            padding: 15px 30px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 0 auto;
            touch-action: manipulation;
            -webkit-tap-highlight-color: rgba(157, 0, 255, 0.3);
            user-select: none;
            -webkit-user-select: none;
            min-height: 48px;
            position: relative;
            z-index: 100;
        }

        .expand-btn:active {
            background: rgba(157, 0, 255, 0.4);
            transform: scale(0.98);
        }

        .expand-btn:hover {
            background: rgba(157, 0, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(157, 0, 255, 0.4);
        }

        .expanded-content {
            display: none;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .expanded-content.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Accuracy Indicator */
        .accuracy-indicator {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .accuracy-indicator h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.2rem;
            color: var(--neon-gold);
            margin-bottom: 15px;
        }

        .accuracy-bar {
            background: rgba(255, 255, 255, 0.1);
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .accuracy-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--neon-cyan), var(--neon-gold));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
        }

        .data-checklist {
            list-style: none;
        }

        .data-checklist li {
            padding: 8px 0;
            font-size: 1rem;
        }

        .data-checklist li:before {
            content: "✅ ";
            margin-right: 10px;
        }

        .data-checklist li.missing:before {
            content: "⚠️ ";
        }

        /* Generate Button */
        .generate-btn {
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple));
            border: none;
            color: white;
            padding: 18px 50px;
            font-size: 1.3rem;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: block;
            margin: 30px auto;
            box-shadow: 0 0 30px rgba(0, 245, 255, 0.4);
        }

        .generate-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 50px rgba(0, 245, 255, 0.6);
        }

        .generate-btn:active {
            transform: scale(0.98);
        }

        /* Timeframe Selector */
        .timeframe-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin: 30px 0;
        }

        .timeframe-btn {
            background: rgba(0, 245, 255, 0.1);
            border: 2px solid rgba(0, 245, 255, 0.3);
            color: var(--neon-cyan);
            padding: 12px 30px;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .timeframe-btn:hover,
        .timeframe-btn.active {
            background: rgba(0, 245, 255, 0.2);
            border-color: var(--neon-cyan);
            box-shadow: 0 0 20px rgba(0, 245, 255, 0.4);
        }

        /* Forecast Output */
        .forecast-output {
            display: none;
        }

        .forecast-output.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .forecast-header {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(255, 0, 102, 0.1) 100%);
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
        }

        .forecast-header h2 {
            font-family: 'Orbitron', monospace;
            font-size: 2rem;
            background: linear-gradient(135deg, var(--neon-gold), var(--neon-pink));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .forecast-meta {
            font-size: 1.1rem;
            color: var(--text-secondary);
        }

        /* Overview Section */
        .overview-section {
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.15) 0%, rgba(157, 0, 255, 0.15) 100%);
            border: 2px solid var(--neon-cyan);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .overview-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--neon-cyan);
            margin-bottom: 20px;
        }

        .overview-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: var(--text-secondary);
        }

        /* System Sections */
        .system-section {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 18px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .system-section:hover {
            border-color: rgba(0, 245, 255, 0.3);
        }

        .system-header {
            padding: 20px 25px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 245, 255, 0.05);
        }

        .system-header h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.3rem;
            color: var(--neon-cyan);
        }

        .system-toggle {
            font-size: 1.5rem;
            transition: transform 0.3s ease;
        }

        .system-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            padding: 0 25px;
        }

        .system-section.expanded .system-content {
            max-height: 2000px;
            padding: 25px;
        }

        .system-section.expanded .system-toggle {
            transform: rotate(180deg);
        }

        .system-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .system-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .system-item h4 {
            color: var(--neon-gold);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .system-item p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Action Item */
        .action-section {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 0, 102, 0.15) 100%);
            border: 2px solid var(--neon-gold);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }

        .action-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--neon-gold);
            margin-bottom: 20px;
        }

        .action-item {
            background: rgba(0, 0, 0, 0.4);
            border-left: 4px solid var(--neon-gold);
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 8px;
        }

        .action-item h4 {
            color: var(--neon-cyan);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .action-item p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Save Button */
        .save-btn {
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid var(--neon-gold);
            color: var(--neon-gold);
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px auto;
            display: block;
        }

        .save-btn:hover {
            background: rgba(255, 215, 0, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero .tagline {
                font-size: 1.1rem;
            }

            .input-section {
                padding: 25px 20px;
            }

            .input-row {
                grid-template-columns: 1fr;
            }

            .timeframe-selector {
                flex-direction: column;
            }

            .timeframe-btn {
                width: 100%;
            }
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            width: 60px;
            height: 60px;
            margin: 0 auto 20px;
            border: 4px solid rgba(0, 245, 255, 0.2);
            border-top: 4px solid var(--neon-cyan);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ========================================
           PHASE 2: Enhanced Forecast Styles
           ======================================== */

        /* Cosmic Timing Section */
        .cosmic-timing-section {
            background: linear-gradient(135deg, rgba(157, 0, 255, 0.15) 0%, rgba(255, 0, 102, 0.15) 100%);
            border: 2px solid var(--neon-purple);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .cosmic-timing-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--neon-purple);
            margin-bottom: 20px;
        }

        .timing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .timing-item {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(157, 0, 255, 0.4);
            border-radius: 15px;
            padding: 20px;
        }

        .timing-item strong {
            display: block;
            color: var(--neon-gold);
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .timing-item p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 8px;
        }

        .timing-item em {
            color: var(--neon-cyan);
            font-style: normal;
        }

        /* Tarot Card Display */
        .tarot-section {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.15) 0%, rgba(255, 215, 0, 0.15) 100%);
            border: 2px solid var(--neon-gold);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .tarot-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--neon-gold);
            margin-bottom: 20px;
            text-align: center;
        }

        .tarot-card-display {
            display: flex;
            gap: 30px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tarot-card {
            background: linear-gradient(145deg, rgba(0, 0, 0, 0.8), rgba(75, 0, 130, 0.4));
            border: 3px solid var(--neon-gold);
            border-radius: 15px;
            padding: 30px 20px;
            min-width: 200px;
            text-align: center;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .tarot-card:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
        }

        .tarot-symbol {
            font-size: 4rem;
            margin-bottom: 15px;
        }

        .tarot-number {
            color: var(--neon-gold);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .tarot-name {
            color: var(--neon-cyan);
            font-size: 1.4rem;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
        }

        .tarot-meaning {
            flex: 1;
            min-width: 280px;
        }

        .tarot-meaning p {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 15px;
        }

        .tarot-meaning strong {
            color: var(--neon-gold);
        }

        /* Planetary Aspects Section */
        .aspects-section {
            background: linear-gradient(135deg, rgba(0, 100, 255, 0.15) 0%, rgba(138, 43, 226, 0.15) 100%);
            border: 2px solid rgba(0, 245, 255, 0.6);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .aspects-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--neon-cyan);
            margin-bottom: 20px;
        }

        .aspects-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .aspect-item {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 245, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
            transition: border-color 0.3s ease;
        }

        .aspect-item:hover {
            border-color: var(--neon-cyan);
        }

        .aspect-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .aspect-symbol {
            font-size: 2rem;
            color: var(--neon-gold);
        }

        .aspect-type {
            color: var(--neon-cyan);
            font-weight: 700;
            font-size: 1.1rem;
        }

        .aspect-planets {
            color: var(--neon-purple);
            font-weight: 600;
            margin-bottom: 8px;
        }

        .aspect-meaning {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Best Day Banner */
        .best-day-banner {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 0, 102, 0.2) 100%);
            border: 3px solid var(--neon-gold);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
        }

        .best-day-banner h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.6rem;
            color: var(--neon-gold);
            margin-bottom: 20px;
        }

        .best-day-content {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 15px;
            padding: 25px;
        }

        .best-day-name {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--neon-cyan);
            margin-bottom: 15px;
            font-family: 'Orbitron', monospace;
        }

        .best-day-content p {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 10px;
        }

        .best-day-content strong {
            color: var(--neon-gold);
        }

        .day-item.best-day {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.15), rgba(0, 245, 255, 0.15));
            border: 2px solid var(--neon-gold);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        .best-day-note {
            color: var(--neon-gold);
            font-weight: 600;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid rgba(255, 215, 0, 0.3);
        }

        /* Cross-Reference Sections */
        .cross-reference-section {
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .cross-reference-section.agreement {
            background: linear-gradient(135deg, rgba(0, 255, 100, 0.1) 0%, rgba(0, 245, 255, 0.1) 100%);
            border: 2px solid rgba(0, 255, 100, 0.4);
        }

        .cross-reference-section.tension {
            background: linear-gradient(135deg, rgba(255, 100, 0, 0.1) 0%, rgba(255, 0, 102, 0.1) 100%);
            border: 2px solid rgba(255, 100, 0, 0.4);
        }

        .cross-reference-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.4rem;
            margin-bottom: 20px;
        }

        .cross-reference-section.agreement h3 {
            color: #00ff64;
        }

        .cross-reference-section.tension h3 {
            color: #ff6400;
        }

        .cross-item {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .cross-item:last-child {
            margin-bottom: 0;
        }

        .system-badges {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 12px;
        }

        .system-badges .badge {
            background: rgba(0, 245, 255, 0.2);
            border: 1px solid rgba(0, 245, 255, 0.5);
            color: var(--neon-cyan);
            padding: 5px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .system-badges .badge.tension {
            background: rgba(255, 100, 0, 0.2);
            border-color: rgba(255, 100, 0, 0.5);
            color: #ff9040;
        }

        /* Weekly/Monthly/Yearly Breakdowns */
        .weekly-breakdown,
        .monthly-breakdown,
        .yearly-breakdown {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .weekly-breakdown h3,
        .monthly-breakdown h3,
        .yearly-breakdown h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.4rem;
            color: var(--neon-cyan);
            margin-bottom: 25px;
        }

        .days-grid,
        .weeks-grid,
        .quarters-grid {
            display: grid;
            gap: 15px;
        }

        .days-grid {
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        }

        .weeks-grid {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .quarters-grid {
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        }

        .day-item,
        .week-item,
        .quarter-item {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 18px;
            transition: all 0.3s ease;
        }

        .day-item:hover,
        .week-item:hover,
        .quarter-item:hover {
            border-color: rgba(0, 245, 255, 0.4);
            transform: translateY(-2px);
        }

        .day-item.today {
            border-color: var(--neon-gold);
            background: rgba(255, 215, 0, 0.1);
        }

        .day-item h4,
        .week-item h4,
        .quarter-item h4 {
            color: var(--neon-gold);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .day-item p,
        .week-item p,
        .quarter-item p {
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 5px;
            font-size: 0.95rem;
        }

        /* Key Dates Section */
        .key-dates-section {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(157, 0, 255, 0.1) 100%);
            border: 2px solid rgba(255, 215, 0, 0.4);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .key-dates-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.4rem;
            color: var(--neon-gold);
            margin-bottom: 20px;
        }

        .key-dates-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .key-date-item {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 20px;
        }

        .key-date-item h4 {
            color: var(--neon-cyan);
            margin-bottom: 12px;
        }

        .key-date-item p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Major Transits Section */
        .major-transits-section {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(157, 0, 255, 0.4);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .major-transits-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.4rem;
            color: var(--neon-purple);
            margin-bottom: 20px;
        }

        .transit-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 20px;
        }

        .transit-item {
            background: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(157, 0, 255, 0.3);
            border-radius: 12px;
            padding: 20px;
        }

        .transit-item h4 {
            color: var(--neon-gold);
            margin-bottom: 12px;
            font-size: 1.1rem;
        }

        .transit-item p {
            color: var(--text-secondary);
            line-height: 1.7;
        }

        /* Enhanced Action Items */
        .action-item.cosmic-timing {
            background: linear-gradient(135deg, rgba(157, 0, 255, 0.2) 0%, rgba(0, 245, 255, 0.2) 100%);
            border-left: 4px solid var(--neon-purple);
        }

        .action-item.challenge {
            background: linear-gradient(135deg, rgba(255, 100, 0, 0.2) 0%, rgba(255, 0, 102, 0.2) 100%);
            border-left: 4px solid #ff6400;
        }

        .action-item.moon-ritual {
            background: linear-gradient(135deg, rgba(157, 0, 255, 0.15) 0%, rgba(0, 0, 80, 0.3) 100%);
            border-left: 4px solid #9d00ff;
        }

        /* ========================================
           MONETIZATION FEATURES STYLES
           ======================================== */

        /* Streak Counter */
        .streak-banner {
            background: linear-gradient(135deg, rgba(255, 100, 0, 0.2) 0%, rgba(255, 215, 0, 0.2) 100%);
            border: 2px solid rgba(255, 165, 0, 0.5);
            border-radius: 15px;
            padding: 15px 25px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 15px;
        }

        .streak-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .streak-fire {
            font-size: 2.5rem;
            animation: fireGlow 1s ease-in-out infinite alternate;
        }

        @keyframes fireGlow {
            from { filter: drop-shadow(0 0 5px #ff6600); }
            to { filter: drop-shadow(0 0 20px #ff9900); }
        }

        .streak-text h4 {
            font-family: 'Orbitron', monospace;
            color: var(--neon-gold);
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .streak-text p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        .streak-reward {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid var(--neon-gold);
            padding: 10px 20px;
            border-radius: 20px;
            color: var(--neon-gold);
            font-weight: 600;
        }

        /* Daily Number & Affirmation Card */
        .daily-insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .daily-card {
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.1) 0%, rgba(157, 0, 255, 0.1) 100%);
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .daily-card::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 3s infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }

        .daily-card h4 {
            font-family: 'Orbitron', monospace;
            color: var(--neon-gold);
            margin-bottom: 15px;
            font-size: 1rem;
            position: relative;
        }

        .cosmic-number {
            font-family: 'Orbitron', monospace;
            font-size: 4rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--neon-cyan), var(--neon-purple), var(--neon-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            position: relative;
        }

        .number-meaning {
            color: var(--text-secondary);
            font-size: 0.95rem;
            position: relative;
        }

        .daily-affirmation {
            font-size: 1.2rem;
            font-style: italic;
            color: var(--text-primary);
            line-height: 1.6;
            position: relative;
            padding: 0 10px;
        }

        .power-hours-list {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            position: relative;
        }

        .power-hour {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid var(--neon-gold);
            padding: 10px 20px;
            border-radius: 25px;
            color: var(--neon-gold);
            font-weight: 600;
        }

        /* Share Card Section */
        .share-section {
            background: linear-gradient(135deg, rgba(255, 0, 102, 0.15) 0%, rgba(157, 0, 255, 0.15) 100%);
            border: 2px solid var(--neon-pink);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
        }

        .share-section h3 {
            font-family: 'Orbitron', monospace;
            color: var(--neon-pink);
            margin-bottom: 15px;
        }

        .share-section p {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .share-btn {
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid;
        }

        .share-btn.twitter {
            background: rgba(29, 161, 242, 0.2);
            border-color: #1da1f2;
            color: #1da1f2;
        }

        .share-btn.facebook {
            background: rgba(66, 103, 178, 0.2);
            border-color: #4267B2;
            color: #4267B2;
        }

        .share-btn.copy {
            background: rgba(0, 245, 255, 0.2);
            border-color: var(--neon-cyan);
            color: var(--neon-cyan);
        }

        .share-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(255, 0, 102, 0.3);
        }

        /* Email Capture */
        .email-capture {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.1) 0%, rgba(0, 245, 255, 0.1) 100%);
            border: 2px solid var(--neon-gold);
            border-radius: 20px;
            padding: 35px;
            margin: 40px 0;
            text-align: center;
        }

        .email-capture h3 {
            font-family: 'Orbitron', monospace;
            color: var(--neon-gold);
            margin-bottom: 10px;
            font-size: 1.4rem;
        }

        .email-capture .subtitle {
            color: var(--text-secondary);
            margin-bottom: 25px;
            font-size: 1.1rem;
        }

        .email-form {
            display: flex;
            justify-content: center;
            gap: 10px;
            flex-wrap: wrap;
            max-width: 500px;
            margin: 0 auto;
        }

        .email-form input[type="email"] {
            flex: 1;
            min-width: 250px;
            padding: 15px 20px;
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 25px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1rem;
        }

        .email-form input[type="email"]:focus {
            outline: none;
            border-color: var(--neon-cyan);
        }

        .email-form button {
            padding: 15px 30px;
            background: linear-gradient(135deg, var(--neon-gold), #ff9500);
            border: none;
            border-radius: 25px;
            color: #000;
            font-weight: 700;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .email-form button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }

        .email-benefits {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Ad Placement Containers */
        .ad-container {
            background: rgba(0, 0, 0, 0.3);
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
            text-align: center;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .ad-container.horizontal {
            min-height: 90px;
        }

        .ad-container.square {
            min-height: 250px;
        }

        .ad-placeholder {
            color: rgba(255, 255, 255, 0.3);
            font-size: 0.8rem;
        }

        /* Compatibility Checker */
        .compatibility-section {
            background: linear-gradient(135deg, rgba(255, 0, 102, 0.1) 0%, rgba(255, 100, 200, 0.1) 100%);
            border: 2px solid var(--neon-pink);
            border-radius: 20px;
            padding: 35px;
            margin: 40px 0;
        }

        .compatibility-section h3 {
            font-family: 'Orbitron', monospace;
            color: var(--neon-pink);
            margin-bottom: 10px;
            font-size: 1.4rem;
            text-align: center;
        }

        .compatibility-section .subtitle {
            color: var(--text-secondary);
            margin-bottom: 25px;
            text-align: center;
        }

        .compatibility-form {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: end;
            margin-bottom: 25px;
        }

        .compat-person {
            text-align: center;
        }

        .compat-person label {
            display: block;
            color: var(--neon-cyan);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .compat-person input {
            width: 100%;
            padding: 12px;
            border: 2px solid rgba(255, 0, 102, 0.3);
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1rem;
            text-align: center;
        }

        .compat-vs {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--neon-pink);
            padding-bottom: 12px;
        }

        .check-compat-btn {
            display: block;
            margin: 0 auto;
            padding: 15px 40px;
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            border: none;
            border-radius: 25px;
            color: white;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .check-compat-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(255, 0, 102, 0.5);
        }

        .compatibility-result {
            display: none;
            margin-top: 30px;
            text-align: center;
        }

        .compatibility-result.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .compat-score {
            font-family: 'Orbitron', monospace;
            font-size: 4rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
        }

        .compat-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .compat-detail-item {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 12px;
            padding: 15px;
        }

        .compat-detail-item h5 {
            color: var(--neon-gold);
            margin-bottom: 8px;
        }

        .compat-detail-item p {
            color: var(--text-secondary);
            font-size: 0.95rem;
        }

        /* Feedback/Rating Section */
        .feedback-section {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 20px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
        }

        .feedback-section h4 {
            color: var(--neon-cyan);
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .rating-stars {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .rating-star {
            font-size: 2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            opacity: 0.4;
        }

        .rating-star:hover,
        .rating-star.active {
            opacity: 1;
            transform: scale(1.2);
        }

        .feedback-input {
            width: 100%;
            max-width: 400px;
            padding: 12px;
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1rem;
            margin-top: 10px;
            display: none;
        }

        .feedback-input.show {
            display: block;
            margin: 10px auto;
        }

        /* Journal Section */
        .journal-section {
            background: linear-gradient(135deg, rgba(157, 0, 255, 0.1) 0%, rgba(0, 100, 255, 0.1) 100%);
            border: 2px solid var(--neon-purple);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
        }

        .journal-section h3 {
            font-family: 'Orbitron', monospace;
            color: var(--neon-purple);
            margin-bottom: 15px;
        }

        .journal-section p {
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .journal-textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid rgba(157, 0, 255, 0.3);
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1rem;
            font-family: 'Rajdhani', sans-serif;
            resize: vertical;
            margin-bottom: 15px;
        }

        .journal-textarea:focus {
            outline: none;
            border-color: var(--neon-purple);
        }

        .journal-btn {
            background: rgba(157, 0, 255, 0.3);
            border: 2px solid var(--neon-purple);
            color: var(--neon-purple);
            padding: 12px 30px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .journal-btn:hover {
            background: rgba(157, 0, 255, 0.5);
            transform: translateY(-2px);
        }

        /* Explore More Tools */
        .explore-tools {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            margin: 40px 0;
        }

        .explore-tools h3 {
            font-family: 'Orbitron', monospace;
            color: var(--neon-cyan);
            margin-bottom: 20px;
            text-align: center;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .tool-card {
            background: rgba(0, 245, 255, 0.1);
            border: 1px solid rgba(0, 245, 255, 0.3);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-cyan);
            box-shadow: 0 10px 30px rgba(0, 245, 255, 0.2);
        }

        .tool-card .icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .tool-card h4 {
            color: var(--neon-gold);
            margin-bottom: 5px;
        }

        .tool-card p {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* Mobile Responsive Enhancements */
        @media (max-width: 768px) {
            .timing-grid,
            .days-grid,
            .weeks-grid,
            .quarters-grid,
            .transit-grid,
            .key-dates-grid {
                grid-template-columns: 1fr;
            }

            .cosmic-timing-section,
            .cross-reference-section,
            .weekly-breakdown,
            .monthly-breakdown,
            .yearly-breakdown,
            .key-dates-section,
            .major-transits-section {
                padding: 20px;
            }

            .system-badges {
                flex-direction: column;
            }

            .day-item,
            .week-item,
            .quarter-item,
            .timing-item,
            .transit-item,
            .key-date-item {
                padding: 15px;
            }

            .streak-banner {
                flex-direction: column;
                text-align: center;
            }

            .daily-insights-grid {
                grid-template-columns: 1fr;
            }

            .compatibility-form {
                grid-template-columns: 1fr;
            }

            .compat-vs {
                padding: 10px 0;
            }

            .email-form {
                flex-direction: column;
            }

            .email-form input[type="email"] {
                min-width: auto;
            }
        }

        /* ========================================
           INTRO ANIMATION & LOADING SPINNER
           ======================================== */
        
        .intro-overlay, .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            overflow: hidden;
        }

        .intro-animation, .loading-animation {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        /* Singularity Dot - Starts small, expands */
        .singularity {
            width: 10px;
            height: 10px;
            background: radial-gradient(circle, #fff 0%, #00f5ff 50%, #9d00ff 100%);
            border-radius: 50%;
            box-shadow: 
                0 0 20px #00f5ff,
                0 0 40px #9d00ff,
                0 0 60px #00f5ff,
                0 0 80px #9d00ff;
            animation: singularityExpand 3s ease-in-out forwards;
        }

        /* Loading spinner: Stop before text reveal */
        .loading-overlay .singularity {
            animation: singularityExpandShort 2.5s ease-in-out infinite;
        }

        @keyframes singularityExpand {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            25% {
                transform: scale(5);
                box-shadow: 
                    0 0 40px #00f5ff,
                    0 0 80px #9d00ff,
                    0 0 120px #00f5ff;
            }
            50% {
                transform: scale(15);
                opacity: 0.8;
                box-shadow: 
                    0 0 100px #00f5ff,
                    0 0 200px #9d00ff,
                    0 0 300px #ffd700;
            }
            75% {
                transform: scale(30) rotate(180deg);
                opacity: 0.4;
                box-shadow: 
                    0 0 200px #00f5ff,
                    0 0 400px #9d00ff;
            }
            100% {
                transform: scale(100) rotate(360deg);
                opacity: 0;
            }
        }

        /* Shorter version for loading spinner - loops infinitely */
        @keyframes singularityExpandShort {
            0% {
                transform: scale(1);
                opacity: 1;
            }
            25% {
                transform: scale(5);
                box-shadow: 
                    0 0 40px #00f5ff,
                    0 0 80px #9d00ff,
                    0 0 120px #00f5ff;
            }
            50% {
                transform: scale(15);
                opacity: 0.8;
                box-shadow: 
                    0 0 100px #00f5ff,
                    0 0 200px #9d00ff,
                    0 0 300px #ffd700;
            }
            75% {
                transform: scale(30) rotate(180deg);
                opacity: 0.4;
                box-shadow: 
                    0 0 200px #00f5ff,
                    0 0 400px #9d00ff;
            }
            100% {
                transform: scale(1) rotate(360deg);
                opacity: 1;
            }
        }

        /* Quantum Merlin Text - Appears after singularity */
        .quantum-text {
            position: absolute;
            font-family: 'Orbitron', monospace;
            font-size: 3rem;
            font-weight: 900;
            letter-spacing: 8px;
            background: linear-gradient(135deg, #00f5ff 0%, #9d00ff 50%, #ffd700 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            opacity: 0;
            animation: textReveal 2s ease-in 3s forwards;
            text-shadow: 0 0 40px rgba(0, 245, 255, 0.6);
        }

        @keyframes textReveal {
            0% {
                opacity: 0;
                transform: scale(0.5);
                filter: blur(20px);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.2);
                filter: blur(10px);
            }
            100% {
                opacity: 1;
                transform: scale(1);
                filter: blur(0);
            }
        }

        /* Skip Button */
        .skip-btn {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: #fff;
            padding: 10px 25px;
            border-radius: 25px;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 10001;
        }

        .skip-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #00f5ff;
            box-shadow: 0 0 20px rgba(0, 245, 255, 0.5);
        }

        /* Loading text below spinner */
        .loading-text {
            margin-top: 40px;
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.2rem;
            color: rgba(255, 255, 255, 0.8);
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Hide intro overlay after animation */
        .intro-overlay.hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .quantum-text {
                font-size: 1.8rem;
                letter-spacing: 4px;
            }
            
            .skip-btn {
                top: 15px;
                right: 15px;
                padding: 8px 20px;
                font-size: 0.9rem;
            }
        }

        /* ========================================
           INPUT VALIDATION & ERROR MESSAGES
           ======================================== */
        
        .input-error {
            border-color: #ff0066 !important;
            box-shadow: 0 0 10px rgba(255, 0, 102, 0.3) !important;
        }

        .error-message {
            color: #ff0066;
            font-size: 0.9rem;
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
            animation: shake 0.3s ease;
        }

        .error-message::before {
            content: '⚠️';
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* ========================================
           HOW TO USE SECTION
           ======================================== */
        
        .how-to-use-section {
            background: linear-gradient(135deg, rgba(0, 245, 255, 0.05), rgba(157, 0, 255, 0.05));
            border: 2px solid rgba(0, 245, 255, 0.3);
            border-radius: 25px;
            padding: 40px;
            margin: 40px 0;
        }

        .how-to-use-section h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            color: var(--neon-gold);
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
        }

        .usage-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .usage-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(0, 245, 255, 0.2);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .usage-card:hover {
            transform: translateY(-5px);
            border-color: var(--neon-cyan);
            box-shadow: 0 10px 30px rgba(0, 245, 255, 0.2);
        }

        .usage-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .usage-card h4 {
            color: var(--neon-cyan);
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .usage-card p {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .usage-tips {
            background: rgba(255, 215, 0, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.3);
            border-radius: 15px;
            padding: 25px;
        }

        .usage-tips h4 {
            color: var(--neon-gold);
            font-size: 1.3rem;
            margin-bottom: 15px;
        }

        .usage-tips ul {
            list-style: none;
            padding: 0;
        }

        .usage-tips li {
            color: var(--text-secondary);
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .usage-tips li::before {
            content: '✨';
            position: absolute;
            left: 0;
        }

        /* Enhanced Confidence Indicator */
        .confidence-breakdown {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .confidence-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 8px;
            font-size: 0.9rem;
        }

        .confidence-item.provided {
            border-left: 3px solid #00f5ff;
        }

        .confidence-item.missing {
            border-left: 3px solid rgba(255, 255, 255, 0.2);
            opacity: 0.6;
        }

        .conf-label {
            flex: 1;
            margin-left: 8px;
        }

        .conf-value {
            color: var(--neon-gold);
            font-weight: 600;
        }

        .confidence-note {
            text-align: center;
            margin-top: 15px;
            font-size: 0.95rem;
            color: var(--neon-cyan);
        }
    </style>
</head>
<body>
    <!-- Intro Animation Overlay (First Visit) -->
    <div id="introOverlay" class="intro-overlay">
        <div class="intro-animation">
            <div class="singularity"></div>
            <div class="quantum-text">QUANTUMMERLIN</div>
        </div>
        <button id="skipIntro" class="skip-btn">Skip →</button>
    </div>

    <!-- Loading Spinner (During Forecast Generation) -->
    <div id="loadingSpinner" class="loading-overlay" style="display: none;">
        <div class="loading-animation">
            <div class="singularity"></div>
            <p class="loading-text">Calculating cosmic alignments...</p>
        </div>
    </div>

    <div class="cosmic-bg"></div>
    <div class="stars" id="stars"></div>

    <div class="container">
        <!-- Streak Banner - Daily Return Mechanic -->
        <div class="streak-banner" id="streakBanner">
            <div class="streak-info">
                <span class="streak-fire">🔥</span>
                <div class="streak-text">
                    <h4 id="streakTitle">Welcome Back!</h4>
                    <p id="streakMessage">Check in daily to build your cosmic alignment streak</p>
                </div>
            </div>
            <div class="streak-reward" id="streakReward">
                Day 1
            </div>
        </div>

        <!-- Hero Section -->
        <div class="hero">
            <h1>QUANTUM FORECASTER</h1>
            <p class="tagline">Your personalized cosmic forecast based on ALL your data</p>
            <div class="systems">
                <div class="system-badge">⭐ Western Astrology</div>
                <div class="system-badge">🐉 Chinese Zodiac</div>
                <div class="system-badge">🔢 Numerology</div>
                <div class="system-badge">📜 Gematria</div>
            </div>
        </div>

        <!-- Daily Insights Cards (shown after first visit) -->
        <div class="daily-insights-grid" id="dailyInsights" style="display: none;">
            <div class="daily-card">
                <h4>TODAY'S COSMIC NUMBER</h4>
                <div class="cosmic-number" id="cosmicNumber">7</div>
                <p class="number-meaning" id="numberMeaning">Reflection & Spirituality</p>
            </div>
            <div class="daily-card">
                <h4>YOUR DAILY AFFIRMATION</h4>
                <p class="daily-affirmation" id="dailyAffirmation">"I trust the universe to guide my path today."</p>
            </div>
            <div class="daily-card">
                <h4>YOUR POWER HOURS</h4>
                <div class="power-hours-list" id="powerHours">
                    <span class="power-hour">9 AM</span>
                    <span class="power-hour">2 PM</span>
                    <span class="power-hour">7 PM</span>
                </div>
            </div>
        </div>

        <!-- Ad Container - Top (will be replaced with AdSense) -->
        <div class="ad-container horizontal" id="adTop">
            <span class="ad-placeholder">[ Ad Space - 728x90 ]</span>
        </div>

        <!-- Input Section -->
        <div class="input-section" id="inputSection">
            <h2>Generate Your Forecast</h2>
            
            <!-- Accuracy Indicator -->
            <div class="accuracy-indicator" id="accuracyIndicator">
                <h3>Forecast Accuracy</h3>
                <div class="accuracy-bar">
                    <div class="accuracy-fill" id="accuracyFill" style="width: 0%;">0%</div>
                </div>
                <ul class="data-checklist" id="dataChecklist">
                    <li class="missing">⚠️ Birth date not provided</li>
                    <li class="missing">⚠️ Birth time not provided</li>
                    <li class="missing">⚠️ Birth location not provided</li>
                    <li class="missing">⚠️ Name not provided</li>
                </ul>
            </div>

            <!-- Tier 1: Required -->
            <div class="input-group">
                <label for="birthDate">Birth Date *</label>
                <input type="date" id="birthDate" required>
                <p class="help-text">Required - determines your sun sign, life path, and Chinese zodiac</p>
            </div>

            <!-- Tier 2: Enhanced Accuracy -->
            <button class="expand-btn" id="expandEnhanced" onclick="toggleEnhanced()">
                ▼ Add Birth Time & Location for More Accuracy
            </button>
            
            <div class="expanded-content" id="enhancedContent">
                <div class="input-group">
                    <label for="birthTime">Birth Time <span class="optional-badge">(optional)</span></label>
                    <input type="time" id="birthTime">
                    <p class="help-text">Used for rising sign and moon sign calculations</p>
                </div>

                <div class="input-group">
                    <label for="birthLocation">Birth Location <span class="optional-badge">(optional)</span></label>
                    <input type="text" id="birthLocation" placeholder="City, Country">
                    <p class="help-text">Used for birth chart houses and local time calculations</p>
                </div>

                <div class="input-group">
                    <label for="currentLocation">Current Location <span class="optional-badge">(optional)</span></label>
                    <input type="text" id="currentLocation" placeholder="City, Country">
                    <p class="help-text">Used for current transits and local planetary hours</p>
                </div>
            </div>

            <!-- Tier 3: Deep Personalization -->
            <button class="expand-btn" id="expandAdvanced" style="display: none;" onclick="toggleAdvanced()">
                ▼ Add Name & Focus for Deep Personalization
            </button>
            
            <div class="expanded-content" id="advancedContent">
                <div class="input-group">
                    <label for="fullName">Full Name <span class="optional-badge">(optional)</span></label>
                    <div class="input-row">
                        <input type="text" id="firstName" placeholder="First">
                        <input type="text" id="middleName" placeholder="Middle">
                        <input type="text" id="lastName" placeholder="Last">
                    </div>
                    <p class="help-text">Used for gematria and name numerology calculations</p>
                </div>

                <div class="input-group">
                    <label for="focus">Current Focus <span class="optional-badge">(optional)</span></label>
                    <select id="focus">
                        <option value="">Select a focus area...</option>
                        <option value="career">Career & Success</option>
                        <option value="love">Love & Relationships</option>
                        <option value="health">Health & Wellness</option>
                        <option value="spiritual">Spiritual Growth</option>
                        <option value="finances">Finances & Abundance</option>
                    </select>
                    <p class="help-text">Tailors guidance to your specific needs</p>
                </div>

                <div class="input-group">
                    <label for="challenge">Current Challenge <span class="optional-badge">(optional)</span></label>
                    <textarea id="challenge" rows="3" placeholder="Brief description of what you're working through..."></textarea>
                    <p class="help-text">Provides obstacle-specific advice and shadow work</p>
                </div>
            </div>

            <!-- Generate Button -->
            <button class="generate-btn" id="generateBtn">✨ Generate Forecast</button>
        </div>
        <!-- Timeframe Selector -->
        <div class="timeframe-selector" id="timeframeSelector" style="display: none;">
            <button class="timeframe-btn active" data-timeframe="daily">📅 Daily</button>
            <button class="timeframe-btn" data-timeframe="weekly">📆 Weekly</button>
            <button class="timeframe-btn" data-timeframe="monthly">🗓️ Monthly</button>
            <button class="timeframe-btn" data-timeframe="yearly">📊 Yearly</button>
        </div>

        <!-- Forecast Output -->
        <div class="forecast-output" id="forecastOutput">
            <!-- Content will be dynamically generated -->
        </div>

        <!-- How to Use This Forecast -->
        <div class="how-to-use-section" id="howToUse" style="display: none;">
            <h3>🔑 How to Use Your Forecast</h3>
            
            <div class="usage-grid">
                <div class="usage-card">
                    <div class="usage-icon">📅</div>
                    <h4>Daily Forecast</h4>
                    <p>Check each morning to align your day with cosmic energy. Focus on the "Action Item" for specific guidance.</p>
                </div>
                
                <div class="usage-card">
                    <div class="usage-icon">📆</div>
                    <h4>Weekly Forecast</h4>
                    <p>Review on Sunday to plan your week. Note key themes and schedule important activities accordingly.</p>
                </div>
                
                <div class="usage-card">
                    <div class="usage-icon">🗓️</div>
                    <h4>Monthly Forecast</h4>
                    <p>Read at the start of each month. Mark key dates in your calendar and prepare for major themes.</p>
                </div>
                
                <div class="usage-card">
                    <div class="usage-icon">📊</div>
                    <h4>Yearly Forecast</h4>
                    <p>Review on your birthday or New Year. Use it to set intentions and understand your year's overarching themes.</p>
                </div>
            </div>
            
            <div class="usage-tips">
                <h4>💡 Pro Tips</h4>
                <ul>
                    <li>Save forecasts to track patterns over time</li>
                    <li>Combine with your Birth Sigil for deeper alignment</li>
                    <li>Use Genesis Frequencies to amplify your daily energy</li>
                    <li>Journal about how forecasts resonate with your experience</li>
                    <li>Add birth time & location for maximum accuracy</li>
                </ul>
            </div>
        </div>

        <!-- Ad Container - Mid Content -->
        <div class="ad-container horizontal" id="adMid" style="display: none;">
            <span class="ad-placeholder">[ Ad Space - 728x90 ]</span>
        </div>

        <!-- Email Capture Section -->
        <div class="email-capture" id="emailCapture">
            <h3>☀️ Get Your Daily Forecast at Sunrise</h3>
            <p class="subtitle">Never miss your cosmic guidance - delivered free to your inbox every morning</p>
            <form class="email-form" id="emailForm">
                <input type="email" id="emailInput" placeholder="Enter your email" required>
                <button type="submit">Subscribe Free</button>
            </form>
            <div class="email-benefits">
                <span>✓ 100% Free</span>
                <span>✓ Personalized Daily</span>
                <span>✓ Unsubscribe Anytime</span>
            </div>
        </div>

        <!-- Compatibility Checker Section -->
        <div class="compatibility-section" id="compatibilitySection">
            <h3>💕 Love & Compatibility Checker</h3>
            <p class="subtitle">Discover your cosmic compatibility with anyone</p>
            <div class="compatibility-form">
                <div class="compat-person">
                    <label>Your Birth Date</label>
                    <input type="date" id="compatDate1">
                </div>
                <div class="compat-vs">💞</div>
                <div class="compat-person">
                    <label>Their Birth Date</label>
                    <input type="date" id="compatDate2">
                </div>
            </div>
            <button class="check-compat-btn" id="checkCompatBtn">Check Compatibility</button>
            
            <div class="compatibility-result" id="compatResult">
                <div class="compat-score" id="compatScore">85%</div>
                <p id="compatSummary" style="color: var(--text-secondary); font-size: 1.1rem;"></p>
                <div class="compat-details" id="compatDetails">
                    <!-- Dynamically filled -->
                </div>
            </div>
        </div>

        <!-- Ad Container - Bottom -->
        <div class="ad-container square" id="adBottom">
            <span class="ad-placeholder">[ Ad Space - 300x250 ]</span>
        </div>

        <!-- Explore More Tools -->
        <div class="explore-tools">
            <h3>🔮 Explore More Quantum Tools</h3>
            <div class="tools-grid">
                <a href="tarot.html" class="tool-card">
                    <div class="icon">🃏</div>
                    <h4>Tarot Reading</h4>
                    <p>AI-powered card insights</p>
                </a>
                <a href="astrology.html" class="tool-card">
                    <div class="icon">⭐</div>
                    <h4>Birth Chart</h4>
                    <p>Deep natal analysis</p>
                </a>
                <a href="gematria.html" class="tool-card">
                    <div class="icon">🔢</div>
                    <h4>Gematria</h4>
                    <p>Name & number secrets</p>
                </a>
                <a href="crystals.html" class="tool-card">
                    <div class="icon">💎</div>
                    <h4>Crystal Guide</h4>
                    <p>Your power stones</p>
                </a>
                <a href="sigils.html" class="tool-card">
                    <div class="icon">✨</div>
                    <h4>Sigil Generator</h4>
                    <p>Manifest intentions</p>
                </a>
                <a href="chinese.html" class="tool-card">
                    <div class="icon">🐉</div>
                    <h4>Chinese Zodiac</h4>
                    <p>Eastern wisdom</p>
                </a>
            </div>
        </div>

        <!-- Footer -->
        <div style="text-align: center; padding: 40px 20px; color: var(--text-secondary); font-size: 0.9rem;">
            <p>© 2025 Quantum Merlin • For entertainment purposes</p>
            <p style="margin-top: 10px;">
                <a href="../genesis/privacy.html" style="color: var(--neon-cyan); text-decoration: none;">Privacy</a> • 
                <a href="../genesis/terms.html" style="color: var(--neon-cyan); text-decoration: none;">Terms</a> • 
                <a href="../genesis/disclaimer.html" style="color: var(--neon-cyan); text-decoration: none;">Disclaimer</a>
            </p>
        </div>
    </div>

    <script>
        // ========================================
        // INTRO ANIMATION & LOADING CONTROL
        // ========================================
        
        // Check if first visit
        const hasVisited = localStorage.getItem('qm_forecaster_visited');
        const introOverlay = document.getElementById('introOverlay');
        const skipBtn = document.getElementById('skipIntro');
        
        function hideIntro() {
            introOverlay.classList.add('hidden');
            localStorage.setItem('qm_forecaster_visited', 'true');
        }
        
        if (hasVisited) {
            // Not first visit - hide intro immediately
            hideIntro();
        } else {
            // First visit - show full intro animation
            // Auto-hide after 5 seconds (3s singularity + 2s text)
            setTimeout(hideIntro, 5000);
        }
        
        // Skip button functionality
        skipBtn.addEventListener('click', hideIntro);
        
        // Loading spinner control
        function showLoadingSpinner() {
            document.getElementById('loadingSpinner').style.display = 'flex';
        }
        
        function hideLoadingSpinner() {
            document.getElementById('loadingSpinner').style.display = 'none';
        }

        // Generate stars background
        function generateStars() {
            const starsContainer = document.getElementById('stars');
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.width = star.style.height = Math.random() * 3 + 'px';
                star.style.animationDelay = Math.random() * 3 + 's';
                starsContainer.appendChild(star);
            }
        }
        generateStars();

        // ========================================
        // MONETIZATION FEATURES
        // ========================================

        // Streak System - Daily Return Mechanic
        function initStreakSystem() {
            const today = new Date().toDateString();
            let streakData = JSON.parse(localStorage.getItem('qm_streak') || '{}');
            
            if (!streakData.lastVisit) {
                // First visit ever
                streakData = { streak: 1, lastVisit: today, totalVisits: 1 };
            } else {
                const lastVisit = new Date(streakData.lastVisit);
                const todayDate = new Date(today);
                const diffDays = Math.floor((todayDate - lastVisit) / (1000 * 60 * 60 * 24));
                
                if (diffDays === 0) {
                    // Same day visit
                } else if (diffDays === 1) {
                    // Consecutive day - streak continues!
                    streakData.streak++;
                    streakData.lastVisit = today;
                    streakData.totalVisits++;
                } else {
                    // Streak broken
                    streakData.streak = 1;
                    streakData.lastVisit = today;
                    streakData.totalVisits++;
                }
            }
            
            localStorage.setItem('qm_streak', JSON.stringify(streakData));
            updateStreakDisplay(streakData);
            
            // Show daily insights if returning visitor
            if (streakData.totalVisits > 1) {
                document.getElementById('dailyInsights').style.display = 'grid';
                updateDailyInsights();
            }
            
            return streakData;
        }

        function updateStreakDisplay(streakData) {
            const title = document.getElementById('streakTitle');
            const message = document.getElementById('streakMessage');
            const reward = document.getElementById('streakReward');
            
            if (streakData.streak >= 7) {
                title.textContent = '🌟 Cosmic Master!';
                message.textContent = `${streakData.streak}-day streak! Your cosmic alignment is powerful.`;
                reward.innerHTML = `<span style="font-size: 1.2rem;">🔥</span> ${streakData.streak} Days`;
            } else if (streakData.streak >= 3) {
                title.textContent = '✨ Building Momentum!';
                message.textContent = `${streakData.streak}-day streak! Keep it going for stronger readings.`;
                reward.innerHTML = `<span style="font-size: 1.2rem;">🔥</span> ${streakData.streak} Days`;
            } else if (streakData.streak === 1 && streakData.totalVisits > 1) {
                title.textContent = 'Welcome Back!';
                message.textContent = 'Start a new streak by checking in tomorrow.';
                reward.textContent = 'Day 1';
            } else {
                title.textContent = 'Welcome, Seeker!';
                message.textContent = 'Check in daily to build your cosmic alignment streak.';
                reward.textContent = 'Day 1';
            }
        }

        // Daily Insights - Changes Every Day
        function updateDailyInsights() {
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
            
            // Cosmic Number (1-9, based on date)
            const cosmicNumber = ((today.getDate() + today.getMonth() + 1 + today.getFullYear()) % 9) || 9;
            const numberMeanings = {
                1: 'Initiative & New Beginnings',
                2: 'Partnership & Balance',
                3: 'Creativity & Expression',
                4: 'Foundation & Stability',
                5: 'Change & Freedom',
                6: 'Love & Responsibility',
                7: 'Reflection & Spirituality',
                8: 'Abundance & Power',
                9: 'Completion & Wisdom'
            };
            
            document.getElementById('cosmicNumber').textContent = cosmicNumber;
            document.getElementById('numberMeaning').textContent = numberMeanings[cosmicNumber];
            
            // Daily Affirmation
            const affirmations = [
                '"I trust the universe to guide my path today."',
                '"My intuition is my superpower."',
                '"I am aligned with cosmic abundance."',
                '"Every challenge is an opportunity for growth."',
                '"I radiate positive energy and attract the same."',
                '"My unique gifts serve the greater good."',
                '"I am exactly where I need to be."',
                '"The universe conspires in my favor."',
                '"I embrace change as transformation."',
                '"My energy creates my reality."',
                '"I am connected to infinite wisdom."',
                '"Today, I choose to see the magic in everything."'
            ];
            document.getElementById('dailyAffirmation').textContent = affirmations[dayOfYear % affirmations.length];
            
            // Power Hours (based on cosmic number)
            const baseHour = (cosmicNumber * 2) % 12 || 12;
            const powerHoursHTML = [
                `<span class="power-hour">${baseHour} AM</span>`,
                `<span class="power-hour">${(baseHour + 5) % 12 || 12} PM</span>`,
                `<span class="power-hour">${(baseHour + 9) % 12 || 12} PM</span>`
            ].join('');
            document.getElementById('powerHours').innerHTML = powerHoursHTML;
        }

        // Initialize streak on page load
        const streakData = initStreakSystem();

        // Email Capture System
        document.getElementById('emailForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('emailInput').value;
            
            // Store locally (in production, send to backend)
            let emails = JSON.parse(localStorage.getItem('qm_subscribers') || '[]');
            if (!emails.includes(email)) {
                emails.push(email);
                localStorage.setItem('qm_subscribers', JSON.stringify(emails));
            }
            
            // Show success
            this.innerHTML = `
                <div style="color: var(--neon-gold); font-size: 1.2rem; padding: 15px;">
                    ✅ You're subscribed! Check your inbox tomorrow at sunrise.
                </div>
            `;
            
            // Track conversion
            console.log('Email captured:', email);
        });

        // Compatibility Checker
        document.getElementById('checkCompatBtn').addEventListener('click', function() {
            const date1 = document.getElementById('compatDate1').value;
            const date2 = document.getElementById('compatDate2').value;
            
            if (!date1 || !date2) {
                alert('Please enter both birth dates');
                return;
            }
            
            const result = calculateCompatibility(date1, date2);
            displayCompatibilityResult(result);
        });

        function calculateCompatibility(date1, date2) {
            const d1 = new Date(date1);
            const d2 = new Date(date2);
            
            // Get zodiac signs
            const sign1 = getZodiacSign(d1.getMonth() + 1, d1.getDate());
            const sign2 = getZodiacSign(d2.getMonth() + 1, d2.getDate());
            
            // Get life paths
            const lp1 = getLifePathNumber(date1);
            const lp2 = getLifePathNumber(date2);
            
            // Get Chinese zodiac
            const cn1 = getChineseZodiac(d1.getFullYear());
            const cn2 = getChineseZodiac(d2.getFullYear());
            
            // Calculate compatibility scores
            const zodiacCompat = calculateZodiacCompatibility(sign1.name, sign2.name);
            const lifePathCompat = calculateLifePathCompatibility(lp1, lp2);
            const chineseCompat = calculateChineseCompatibility(cn1.animal, cn2.animal);
            
            // Overall score
            const overallScore = Math.round((zodiacCompat + lifePathCompat + chineseCompat) / 3);
            
            return {
                score: overallScore,
                sign1, sign2,
                lp1, lp2,
                cn1, cn2,
                zodiacCompat,
                lifePathCompat,
                chineseCompat
            };
        }

        function calculateZodiacCompatibility(sign1, sign2) {
            const elements = {
                'Aries': 'Fire', 'Leo': 'Fire', 'Sagittarius': 'Fire',
                'Taurus': 'Earth', 'Virgo': 'Earth', 'Capricorn': 'Earth',
                'Gemini': 'Air', 'Libra': 'Air', 'Aquarius': 'Air',
                'Cancer': 'Water', 'Scorpio': 'Water', 'Pisces': 'Water'
            };
            
            const el1 = elements[sign1];
            const el2 = elements[sign2];
            
            if (sign1 === sign2) return 75; // Same sign
            if (el1 === el2) return 90; // Same element
            if ((el1 === 'Fire' && el2 === 'Air') || (el1 === 'Air' && el2 === 'Fire')) return 85;
            if ((el1 === 'Earth' && el2 === 'Water') || (el1 === 'Water' && el2 === 'Earth')) return 85;
            if ((el1 === 'Fire' && el2 === 'Earth') || (el1 === 'Earth' && el2 === 'Fire')) return 60;
            if ((el1 === 'Air' && el2 === 'Water') || (el1 === 'Water' && el2 === 'Air')) return 55;
            return 70; // Other combinations
        }

        function calculateLifePathCompatibility(lp1, lp2) {
            const compatible = {
                1: [3, 5, 7],
                2: [4, 6, 8],
                3: [1, 5, 9],
                4: [2, 6, 8],
                5: [1, 3, 7],
                6: [2, 4, 9],
                7: [1, 5, 9],
                8: [2, 4, 6],
                9: [3, 6, 7]
            };
            
            if (lp1 === lp2) return 80;
            if (compatible[lp1]?.includes(lp2)) return 90;
            return 65;
        }

        function calculateChineseCompatibility(animal1, animal2) {
            const allies = {
                'Rat': ['Dragon', 'Monkey'],
                'Ox': ['Snake', 'Rooster'],
                'Tiger': ['Horse', 'Dog'],
                'Rabbit': ['Goat', 'Pig'],
                'Dragon': ['Rat', 'Monkey'],
                'Snake': ['Ox', 'Rooster'],
                'Horse': ['Tiger', 'Dog'],
                'Goat': ['Rabbit', 'Pig'],
                'Monkey': ['Rat', 'Dragon'],
                'Rooster': ['Ox', 'Snake'],
                'Dog': ['Tiger', 'Horse'],
                'Pig': ['Rabbit', 'Goat']
            };
            
            if (animal1 === animal2) return 75;
            if (allies[animal1]?.includes(animal2)) return 95;
            return 65;
        }

        function displayCompatibilityResult(result) {
            document.getElementById('compatScore').textContent = result.score + '%';
            
            let summaryText = '';
            if (result.score >= 85) summaryText = '🌟 Exceptional Match! You two are cosmically aligned.';
            else if (result.score >= 75) summaryText = '✨ Great Match! Strong compatibility across systems.';
            else if (result.score >= 65) summaryText = '💫 Good Match! Complementary energies with growth potential.';
            else summaryText = '🔮 Challenging Match - but opposites can attract and teach.';
            
            document.getElementById('compatSummary').textContent = summaryText;
            
            document.getElementById('compatDetails').innerHTML = `
                <div class="compat-detail-item">
                    <h5>⭐ Zodiac (${result.zodiacCompat}%)</h5>
                    <p>${result.sign1.name} ${result.sign1.symbol} + ${result.sign2.name} ${result.sign2.symbol}</p>
                </div>
                <div class="compat-detail-item">
                    <h5>🔢 Life Path (${result.lifePathCompat}%)</h5>
                    <p>Path ${result.lp1} + Path ${result.lp2}</p>
                </div>
                <div class="compat-detail-item">
                    <h5>🐉 Chinese (${result.chineseCompat}%)</h5>
                    <p>${result.cn1.animal} + ${result.cn2.animal}</p>
                </div>
            `;
            
            document.getElementById('compatResult').classList.add('show');
            document.getElementById('compatResult').scrollIntoView({ behavior: 'smooth' });
        }

        // Social Sharing Functions
        function generateShareURL() {
            const birthDate = document.getElementById('birthDate').value;
            if (!birthDate) return window.location.href;
            
            const sign = getZodiacSign(new Date(birthDate).getMonth() + 1, new Date(birthDate).getDate());
            return `${window.location.origin}/quantum-merlin-hub/forecasts.html?sign=${sign.name}`;
        }

        function shareToTwitter(text) {
            const url = encodeURIComponent(generateShareURL());
            const tweetText = encodeURIComponent(text || "I just got my Quantum Forecast! 🌌✨ Get your personalized cosmic guidance:");
            window.open(`https://twitter.com/intent/tweet?text=${tweetText}&url=${url}`, '_blank');
        }

        function shareToFacebook() {
            const url = encodeURIComponent(generateShareURL());
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, '_blank');
        }

        function copyForecastLink() {
            navigator.clipboard.writeText(generateShareURL()).then(() => {
                alert('✅ Link copied to clipboard!');
            });
        }

        // Show Ad Container Mid when forecast is generated
        function showMidAd() {
            document.getElementById('adMid').style.display = 'flex';
        }

        // Expandable sections - using global functions for better mobile compatibility
        function toggleEnhanced() {
            const btn = document.getElementById('expandEnhanced');
            const content = document.getElementById('enhancedContent');
            content.classList.toggle('show');
            btn.textContent = content.classList.contains('show') 
                ? '▲ Hide Enhanced Options' 
                : '▼ Add Birth Time & Location for More Accuracy';
            
            if (content.classList.contains('show')) {
                document.getElementById('expandAdvanced').style.display = 'block';
            }
        }

        function toggleAdvanced() {
            const btn = document.getElementById('expandAdvanced');
            const content = document.getElementById('advancedContent');
            content.classList.toggle('show');
            btn.textContent = content.classList.contains('show') 
                ? '▲ Hide Advanced Options' 
                : '▼ Add Name & Focus for Deep Personalization';
        }

        // Add touchstart listeners for mobile (more reliable than click on some devices)
        document.addEventListener('DOMContentLoaded', function() {
            const enhancedBtn = document.getElementById('expandEnhanced');
            const advancedBtn = document.getElementById('expandAdvanced');
            
            if (enhancedBtn) {
                enhancedBtn.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    toggleEnhanced();
                }, { passive: false });
            }
            
            if (advancedBtn) {
                advancedBtn.addEventListener('touchstart', function(e) {
                    e.preventDefault();
                    toggleAdvanced();
                }, { passive: false });
            }
        });

        // Update accuracy indicator
        function updateAccuracy() {
            const birthDate = document.getElementById('birthDate').value;
            const birthTime = document.getElementById('birthTime').value;
            const birthLocation = document.getElementById('birthLocation').value;
            const firstName = document.getElementById('firstName').value;
            
            let accuracy = 0;
            const breakdown = [];
            
            if (birthDate) {
                accuracy += 25;
                breakdown.push({ item: 'Birth Date', status: 'provided', value: 25 });
            } else {
                breakdown.push({ item: 'Birth Date', status: 'missing', value: 25 });
            }
            
            if (birthTime) {
                accuracy += 25;
                breakdown.push({ item: 'Birth Time', status: 'provided', value: 25 });
            } else {
                breakdown.push({ item: 'Birth Time', status: 'missing', value: 25 });
            }
            
            if (birthLocation) {
                accuracy += 25;
                breakdown.push({ item: 'Birth Location', status: 'provided', value: 25 });
            } else {
                breakdown.push({ item: 'Birth Location', status: 'missing', value: 25 });
            }
            
            if (firstName) {
                accuracy += 25;
                breakdown.push({ item: 'Full Name', status: 'provided', value: 25 });
            } else {
                breakdown.push({ item: 'Full Name', status: 'missing', value: 25 });
            }
            
            // Update progress bar with color based on accuracy
            const fill = document.getElementById('accuracyFill');
            fill.style.width = accuracy + '%';
            fill.textContent = accuracy + '%';
            
            if (accuracy >= 75) {
                fill.style.background = 'linear-gradient(90deg, #00f5ff, #9d00ff)';
            } else if (accuracy >= 50) {
                fill.style.background = 'linear-gradient(90deg, #ffd700, #00f5ff)';
            } else {
                fill.style.background = 'linear-gradient(90deg, #ff0066, #ffd700)';
            }
            
            // Enhanced breakdown display
            const checklistHTML = breakdown.map(item => `
                <div class="confidence-item ${item.status}">
                    <span class="conf-icon">${item.status === 'provided' ? '✅' : '⚠️'}</span>
                    <span class="conf-label">${item.item}</span>
                    <span class="conf-value">+${item.value}%</span>
                </div>
            `).join('');
            
            const noteHTML = accuracy < 100 
                ? '<p class="confidence-note">💡 Add missing data to increase forecast accuracy</p>'
                : '<p class="confidence-note">✨ Maximum accuracy achieved!</p>';
            
            document.getElementById('dataChecklist').innerHTML = checklistHTML + noteHTML;
        }

        // Listen for input changes
        ['birthDate', 'birthTime', 'birthLocation', 'firstName'].forEach(id => {
            document.getElementById(id).addEventListener('input', updateAccuracy);
        });

        // ========================================
        // TAROT CARD SYSTEM
        // ========================================
        
        function getTarotCard(birthDate, timeframe = 'daily') {
            const birth = new Date(birthDate);
            const today = new Date();
            
            // Seed based on timeframe
            let seed;
            if (timeframe === 'daily') {
                seed = today.getDate() + today.getMonth() * 31 + birth.getDate();
            } else if (timeframe === 'weekly') {
                const weekNum = Math.floor(today.getDate() / 7);
                seed = weekNum + today.getMonth() * 5 + birth.getDate();
            } else if (timeframe === 'monthly') {
                seed = today.getMonth() + birth.getMonth() + birth.getDate();
            } else {
                seed = today.getFullYear() + birth.getFullYear();
            }
            
            const majorArcana = [
                { number: 0, name: 'The Fool', meaning: 'New beginnings, innocence, spontaneity, free spirit', guidance: 'Embrace the unknown. Take a leap of faith.', symbol: '🃏' },
                { number: 1, name: 'The Magician', meaning: 'Manifestation, resourcefulness, power, inspired action', guidance: 'You have all the tools you need. Act with intention.', symbol: '🎩' },
                { number: 2, name: 'The High Priestess', meaning: 'Intuition, sacred knowledge, divine feminine, subconscious', guidance: 'Trust your inner voice. Look beyond the surface.', symbol: '🔮' },
                { number: 3, name: 'The Empress', meaning: 'Femininity, beauty, nature, nurturing, abundance', guidance: 'Create and nurture. Beauty surrounds you.', symbol: '👑' },
                { number: 4, name: 'The Emperor', meaning: 'Authority, establishment, structure, father figure', guidance: 'Take control. Build solid foundations.', symbol: '⚔️' },
                { number: 5, name: 'The Hierophant', meaning: 'Spiritual wisdom, tradition, conformity, institutions', guidance: 'Seek wisdom from tradition. Honor what works.', symbol: '🏛️' },
                { number: 6, name: 'The Lovers', meaning: 'Love, harmony, relationships, values alignment', guidance: 'Choose with your heart. Align your values.', symbol: '💕' },
                { number: 7, name: 'The Chariot', meaning: 'Control, willpower, success, determination', guidance: 'Move forward with confidence. Victory is yours.', symbol: '🏇' },
                { number: 8, name: 'Strength', meaning: 'Strength, courage, patience, compassion', guidance: 'Inner strength conquers all. Be gentle yet firm.', symbol: '🦁' },
                { number: 9, name: 'The Hermit', meaning: 'Soul searching, introspection, inner guidance', guidance: 'Go within. Your answers are there.', symbol: '🕯️' },
                { number: 10, name: 'Wheel of Fortune', meaning: 'Good luck, karma, life cycles, destiny', guidance: 'Fate is turning. Embrace the change.', symbol: '☸️' },
                { number: 11, name: 'Justice', meaning: 'Justice, fairness, truth, cause and effect', guidance: 'Seek truth and balance. Karma is active.', symbol: '⚖️' },
                { number: 12, name: 'The Hanged Man', meaning: 'Pause, surrender, letting go, new perspective', guidance: 'Release control. See from a new angle.', symbol: '🙃' },
                { number: 13, name: 'Death', meaning: 'Endings, transformation, transition, rebirth', guidance: 'Let go of the old. Transformation awaits.', symbol: '🦋' },
                { number: 14, name: 'Temperance', meaning: 'Balance, moderation, patience, purpose', guidance: 'Find the middle way. Blend opposing forces.', symbol: '🌊' },
                { number: 15, name: 'The Devil', meaning: 'Shadow self, attachment, addiction, materialism', guidance: 'Break free from chains. Face your shadows.', symbol: '😈' },
                { number: 16, name: 'The Tower', meaning: 'Sudden change, upheaval, chaos, revelation', guidance: 'Breakdown leads to breakthrough. Trust the process.', symbol: '⚡' },
                { number: 17, name: 'The Star', meaning: 'Hope, faith, purpose, renewal, spirituality', guidance: 'Hope shines bright. Your wishes are heard.', symbol: '⭐' },
                { number: 18, name: 'The Moon', meaning: 'Illusion, fear, anxiety, subconscious, intuition', guidance: 'Not all is as it seems. Trust your intuition.', symbol: '🌙' },
                { number: 19, name: 'The Sun', meaning: 'Positivity, fun, warmth, success, vitality', guidance: 'Success and joy are yours. Shine brightly.', symbol: '☀️' },
                { number: 20, name: 'Judgment', meaning: 'Judgment, rebirth, inner calling, absolution', guidance: 'Answer your calling. Forgive and be reborn.', symbol: '📯' },
                { number: 21, name: 'The World', meaning: 'Completion, integration, accomplishment, travel', guidance: 'You've come full circle. Celebrate completion.', symbol: '🌍' }
            ];
            
            const index = seed % majorArcana.length;
            return majorArcana[index];
        }

        // ========================================
        // PLANETARY ASPECTS (Simplified)
        // ========================================
        
        function getPlanetaryAspects(birthDate) {
            const birth = new Date(birthDate);
            const today = new Date();
            const dayOfYear = Math.floor((today - new Date(today.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24));
            
            // Simplified aspect calculation based on day of year
            const aspects = [];
            
            // Sun aspects (changes daily)
            if (dayOfYear % 30 < 10) {
                aspects.push({ 
                    type: 'Conjunction', 
                    planets: 'Sun ☉ conjunct Mercury ☿', 
                    meaning: 'Clear communication, mental clarity, important messages',
                    symbol: '☌'
                });
            } else if (dayOfYear % 30 < 20) {
                aspects.push({ 
                    type: 'Trine', 
                    planets: 'Sun ☉ trine Jupiter ♃', 
                    meaning: 'Opportunity, expansion, good fortune, optimism',
                    symbol: '△'
                });
            } else {
                aspects.push({ 
                    type: 'Square', 
                    planets: 'Sun ☉ square Saturn ♄', 
                    meaning: 'Challenges requiring discipline, patience, and hard work',
                    symbol: '□'
                });
            }
            
            // Venus aspects (changes every 3 days)
            if (Math.floor(dayOfYear / 3) % 2 === 0) {
                aspects.push({ 
                    type: 'Sextile', 
                    planets: 'Venus ♀ sextile Mars ♂', 
                    meaning: 'Attraction, passion, creative energy, social connections',
                    symbol: '⚹'
                });
            }
            
            return aspects;
        }

        // ========================================
        // BEST DAY CALCULATOR
        // ========================================
        
        function getBestDayOfWeek(zodiac, chinese, lifePath) {
            const today = new Date();
            const daysOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const dayEmojis = ['☀️', '🌙', '♂️', '☿', '♃', '♀', '♄'];
            
            // Calculate based on life path
            const bestDayIndex = (lifePath + today.getDate()) % 7;
            const bestDay = daysOfWeek[bestDayIndex];
            const emoji = dayEmojis[bestDayIndex];
            
            const energies = {
                0: 'Spiritual connection and rest',
                1: 'Intuition and emotions',
                2: 'Action and courage',
                3: 'Communication and learning',
                4: 'Growth and abundance',
                5: 'Love and harmony',
                6: 'Structure and discipline'
            };
            
            return {
                day: bestDay,
                emoji: emoji,
                energy: energies[bestDayIndex],
                action: `Schedule important activities on ${bestDay} this week for best results.`
            };
        }

        // Calculation functions
        function getZodiacSign(month, day) {
            const signs = [
                { name: 'Capricorn', symbol: '♑', dates: [[12, 22], [1, 19]] },
                { name: 'Aquarius', symbol: '♒', dates: [[1, 20], [2, 18]] },
                { name: 'Pisces', symbol: '♓', dates: [[2, 19], [3, 20]] },
                { name: 'Aries', symbol: '♈', dates: [[3, 21], [4, 19]] },
                { name: 'Taurus', symbol: '♉', dates: [[4, 20], [5, 20]] },
                { name: 'Gemini', symbol: '♊', dates: [[5, 21], [6, 20]] },
                { name: 'Cancer', symbol: '♋', dates: [[6, 21], [7, 22]] },
                { name: 'Leo', symbol: '♌', dates: [[7, 23], [8, 22]] },
                { name: 'Virgo', symbol: '♍', dates: [[8, 23], [9, 22]] },
                { name: 'Libra', symbol: '♎', dates: [[9, 23], [10, 22]] },
                { name: 'Scorpio', symbol: '♏', dates: [[10, 23], [11, 21]] },
                { name: 'Sagittarius', symbol: '♐', dates: [[11, 22], [12, 21]] }
            ];
            
            for (let sign of signs) {
                const [[m1, d1], [m2, d2]] = sign.dates;
                if ((month === m1 && day >= d1) || (month === m2 && day <= d2)) {
                    return sign;
                }
            }
            return signs[0];
        }

        function getChineseZodiac(year) {
            const animals = [
                'Rat', 'Ox', 'Tiger', 'Rabbit', 'Dragon', 'Snake',
                'Horse', 'Goat', 'Monkey', 'Rooster', 'Dog', 'Pig'
            ];
            
            // Correct element based on last digit of year (Heavenly Stems)
            // 0-1: Metal, 2-3: Water, 4-5: Wood, 6-7: Fire, 8-9: Earth
            const elements = ['Metal', 'Metal', 'Water', 'Water', 'Wood', 'Wood', 'Fire', 'Fire', 'Earth', 'Earth'];
            
            // Animal calculation (12-year cycle starting from Rat in 1924)
            const animalIndex = (year - 4) % 12;
            // Element calculation (10-year cycle based on year's last digit)
            const elementIndex = year % 10;
            
            return {
                animal: animals[animalIndex],
                element: elements[elementIndex],
                year: year
            };
        }

        function getLifePathNumber(birthDate) {
            const dateStr = birthDate.replace(/-/g, '');
            let sum = 0;
            for (let char of dateStr) {
                sum += parseInt(char);
            }
            while (sum > 9 && sum !== 11 && sum !== 22 && sum !== 33) {
                sum = sum.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            }
            return sum;
        }

        function getPersonalYear(birthDate) {
            const birth = new Date(birthDate);
            const today = new Date();
            const month = birth.getMonth() + 1;
            const day = birth.getDate();
            const year = today.getFullYear();
            
            let sum = month + day + year;
            while (sum > 9) {
                sum = sum.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            }
            return sum;
        }

        function calculateGematria(name) {
            if (!name) return 0;
            let sum = 0;
            for (let char of name.toUpperCase()) {
                if (char >= 'A' && char <= 'Z') {
                    sum += char.charCodeAt(0) - 64;
                }
            }
            return sum;
        }

        // Geocoding helper - converts location to coordinates
        function getCoordinates(location) {
            const locations = {
                'london': { lat: 51.5074, lon: -0.1278 },
                'uk': { lat: 51.5074, lon: -0.1278 },
                'england': { lat: 51.5074, lon: -0.1278 },
                'new york': { lat: 40.7128, lon: -74.0060 },
                'los angeles': { lat: 34.0522, lon: -118.2437 },
                'california': { lat: 34.0522, lon: -118.2437 },
                'sydney': { lat: -33.8688, lon: 151.2093 },
                'australia': { lat: -33.8688, lon: 151.2093 },
                'mumbai': { lat: 19.0760, lon: 72.8777 },
                'india': { lat: 19.0760, lon: 72.8777 },
                'tokyo': { lat: 35.6762, lon: 139.6503 },
                'japan': { lat: 35.6762, lon: 139.6503 },
                'paris': { lat: 48.8566, lon: 2.3522 },
                'france': { lat: 48.8566, lon: 2.3522 },
                'berlin': { lat: 52.5200, lon: 13.4050 },
                'germany': { lat: 52.5200, lon: 13.4050 },
                'toronto': { lat: 43.6532, lon: -79.3832 },
                'canada': { lat: 43.6532, lon: -79.3832 },
                'mexico city': { lat: 19.4326, lon: -99.1332 },
                'mexico': { lat: 19.4326, lon: -99.1332 },
                'rome': { lat: 41.9028, lon: 12.4964 },
                'italy': { lat: 41.9028, lon: 12.4964 },
                'madrid': { lat: 40.4168, lon: -3.7038 },
                'spain': { lat: 40.4168, lon: -3.7038 },
                'amsterdam': { lat: 52.3676, lon: 4.9041 },
                'netherlands': { lat: 52.3676, lon: 4.9041 },
                'moscow': { lat: 55.7558, lon: 37.6173 },
                'russia': { lat: 55.7558, lon: 37.6173 },
                'beijing': { lat: 39.9042, lon: 116.4074 },
                'china': { lat: 39.9042, lon: 116.4074 },
                'dubai': { lat: 25.2048, lon: 55.2708 },
                'uae': { lat: 25.2048, lon: 55.2708 },
                'singapore': { lat: 1.3521, lon: 103.8198 },
                'hong kong': { lat: 22.3193, lon: 114.1694 },
                'seoul': { lat: 37.5665, lon: 126.9780 },
                'south korea': { lat: 37.5665, lon: 126.9780 },
                'bangkok': { lat: 13.7563, lon: 100.5018 },
                'thailand': { lat: 13.7563, lon: 100.5018 }
            };
            
            if (!location) return { lat: 0, lon: 0 };
            
            const loc = location.toLowerCase();
            for (let key in locations) {
                if (loc.includes(key)) {
                    return locations[key];
                }
            }
            
            return { lat: 0, lon: 0 }; // Default to Greenwich if not found
        }

        // PHASE 2: Rising Sign Calculator with Swiss Ephemeris
        // PHASE 2: Rising Sign Calculator with Swiss Ephemeris
        function getRisingSign(birthDate, birthTime, birthLocation) {
            if (!birthTime) return null;
            
            // Try Swiss Ephemeris for maximum accuracy
            if (typeof swisseph !== 'undefined' && birthLocation) {
                try {
                    const coords = getCoordinates(birthLocation);
                    const birth = new Date(birthDate + ' ' + birthTime);
                    
                    // Calculate Julian Day
                    const year = birth.getFullYear();
                    const month = birth.getMonth() + 1;
                    const day = birth.getDate();
                    const hour = birth.getHours() + birth.getMinutes() / 60;
                    
                    const jd = swisseph.swe_julday(year, month, day, hour, swisseph.SE_GREG_CAL);
                    
                    // Calculate houses (Placidus system)
                    const houses = swisseph.swe_houses(jd, coords.lat, coords.lon, 'P');
                    
                    if (houses && houses.ascendant) {
                        // Convert ascendant degree to zodiac sign
                        const ascDegree = houses.ascendant;
                        const signIndex = Math.floor(ascDegree / 30);
                        
                        const signs = [
                            { name: 'Aries', symbol: '♈' },
                            { name: 'Taurus', symbol: '♉' },
                            { name: 'Gemini', symbol: '♊' },
                            { name: 'Cancer', symbol: '♋' },
                            { name: 'Leo', symbol: '♌' },
                            { name: 'Virgo', symbol: '♍' },
                            { name: 'Libra', symbol: '♎' },
                            { name: 'Scorpio', symbol: '♏' },
                            { name: 'Sagittarius', symbol: '♐' },
                            { name: 'Capricorn', symbol: '♑' },
                            { name: 'Aquarius', symbol: '♒' },
                            { name: 'Pisces', symbol: '♓' }
                        ];
                        
                        return signs[signIndex % 12];
                    }
                } catch (e) {
                    console.log('Swiss Ephemeris calculation failed, using fallback:', e);
                }
            }
            
            // Fallback: Simplified calculation
            const birth = new Date(birthDate);
            const month = birth.getMonth() + 1;
            const day = birth.getDate();
            const sunSign = getZodiacSign(month, day);
            const sunSignIndex = ['Aries', 'Taurus', 'Gemini', 'Cancer', 'Leo', 'Virgo', 
                                  'Libra', 'Scorpio', 'Sagittarius', 'Capricorn', 'Aquarius', 'Pisces'].indexOf(sunSign.name);
            
            const [hours, minutes] = birthTime.split(':').map(Number);
            const totalMinutes = hours * 60 + minutes;
            
            let sunriseMinutes = 6 * 60;
            if (birthLocation) {
                const location = birthLocation.toLowerCase();
                if (location.includes('uk') || location.includes('london')) sunriseMinutes = 7 * 60;
                else if (location.includes('australia') || location.includes('sydney')) sunriseMinutes = 6.5 * 60;
                else if (location.includes('india') || location.includes('mumbai')) sunriseMinutes = 6 * 60;
                else if (location.includes('japan') || location.includes('tokyo')) sunriseMinutes = 6 * 60;
                else if (location.includes('california') || location.includes('los angeles')) sunriseMinutes = 6.5 * 60;
                else if (location.includes('new york') || location.includes('boston')) sunriseMinutes = 6.5 * 60;
            }
            
            const minutesSinceSunrise = (totalMinutes - sunriseMinutes + 1440) % 1440;
            const risingOffset = Math.floor(minutesSinceSunrise / 120);
            const risingIndex = (sunSignIndex + risingOffset) % 12;
            
            const signs = [
                { name: 'Aries', symbol: '♈' },
                { name: 'Taurus', symbol: '♉' },
                { name: 'Gemini', symbol: '♊' },
                { name: 'Cancer', symbol: '♋' },
                { name: 'Leo', symbol: '♌' },
                { name: 'Virgo', symbol: '♍' },
                { name: 'Libra', symbol: '♎' },
                { name: 'Scorpio', symbol: '♏' },
                { name: 'Sagittarius', symbol: '♐' },
                { name: 'Capricorn', symbol: '♑' },
                { name: 'Aquarius', symbol: '♒' },
                { name: 'Pisces', symbol: '♓' }
            ];
            return signs[risingIndex];
        }

        // PHASE 2: Moon Sign Calculator with Swiss Ephemeris
        function getMoonSign(birthDate, birthTime, birthLocation) {
            // Try Swiss Ephemeris for maximum accuracy
            if (typeof swisseph !== 'undefined' && birthTime && birthLocation) {
                try {
                    const coords = getCoordinates(birthLocation);
                    const birth = new Date(birthDate + ' ' + birthTime);
                    
                    // Calculate Julian Day
                    const year = birth.getFullYear();
                    const month = birth.getMonth() + 1;
                    const day = birth.getDate();
                    const hour = birth.getHours() + birth.getMinutes() / 60;
                    
                    const jd = swisseph.swe_julday(year, month, day, hour, swisseph.SE_GREG_CAL);
                    
                    // Calculate Moon position
                    const moonPos = swisseph.swe_calc_ut(jd, swisseph.SE_MOON, swisseph.SEFLG_SWIEPH);
                    
                    if (moonPos && moonPos.longitude !== undefined) {
                        // Convert moon longitude to zodiac sign
                        const moonDegree = moonPos.longitude;
                        const signIndex = Math.floor(moonDegree / 30);
                        
                        const signs = [
                            { name: 'Aries', symbol: '♈', element: 'Fire' },
                            { name: 'Taurus', symbol: '♉', element: 'Earth' },
                            { name: 'Gemini', symbol: '♊', element: 'Air' },
                            { name: 'Cancer', symbol: '♋', element: 'Water' },
                            { name: 'Leo', symbol: '♌', element: 'Fire' },
                            { name: 'Virgo', symbol: '♍', element: 'Earth' },
                            { name: 'Libra', symbol: '♎', element: 'Air' },
                            { name: 'Scorpio', symbol: '♏', element: 'Water' },
                            { name: 'Sagittarius', symbol: '♐', element: 'Fire' },
                            { name: 'Capricorn', symbol: '♑', element: 'Earth' },
                            { name: 'Aquarius', symbol: '♒', element: 'Air' },
                            { name: 'Pisces', symbol: '♓', element: 'Water' }
                        ];
                        
                        return signs[signIndex % 12];
                    }
                } catch (e) {
                    console.log('Swiss Ephemeris moon calculation failed, using fallback:', e);
                }
            }
            
            // Fallback: Simplified calculation
            const birth = new Date(birthDate);
            const epoch = new Date('2000-01-06');
            const daysSinceEpoch = Math.floor((birth - epoch) / (1000 * 60 * 60 * 24));
            
            let hourOffset = 0;
            if (birthTime) {
                const [hours] = birthTime.split(':').map(Number);
                hourOffset = hours / 24;
                
                if (birthLocation) {
                    const location = birthLocation.toLowerCase();
                    if (location.includes('uk') || location.includes('london')) hourOffset += 0;
                    else if (location.includes('india') || location.includes('mumbai')) hourOffset += 5.5/24;
                    else if (location.includes('australia') || location.includes('sydney')) hourOffset += 10/24;
                    else if (location.includes('japan') || location.includes('tokyo')) hourOffset += 9/24;
                    else if (location.includes('los angeles') || location.includes('california')) hourOffset -= 8/24;
                    else if (location.includes('new york') || location.includes('boston')) hourOffset -= 5/24;
                }
            }
            
            const moonCyclePosition = (daysSinceEpoch + hourOffset) % 29.5;
            const moonSignIndex = Math.floor((moonCyclePosition / 29.5) * 12) % 12;
            
            const signs = [
                { name: 'Capricorn', symbol: '♑', element: 'Earth' },
                { name: 'Aquarius', symbol: '♒', element: 'Air' },
                { name: 'Pisces', symbol: '♓', element: 'Water' },
                { name: 'Aries', symbol: '♈', element: 'Fire' },
                { name: 'Taurus', symbol: '♉', element: 'Earth' },
                { name: 'Gemini', symbol: '♊', element: 'Air' },
                { name: 'Cancer', symbol: '♋', element: 'Water' },
                { name: 'Leo', symbol: '♌', element: 'Fire' },
                { name: 'Virgo', symbol: '♍', element: 'Earth' },
                { name: 'Libra', symbol: '♎', element: 'Air' },
                { name: 'Scorpio', symbol: '♏', element: 'Water' },
                { name: 'Sagittarius', symbol: '♐', element: 'Fire' }
            ];
            return signs[moonSignIndex];
        }

        // PHASE 2: Planetary Hour Calculator
        function getPlanetaryHour() {
            const now = new Date();
            const dayOfWeek = now.getDay(); // 0=Sunday, 1=Monday...
            const hour = now.getHours();
            
            // Chaldean order of planets
            const planets = ['Saturn', 'Jupiter', 'Mars', 'Sun', 'Venus', 'Mercury', 'Moon'];
            // Day rulers
            const dayRulers = ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn'];
            
            const dayRulerIndex = planets.indexOf(dayRulers[dayOfWeek]);
            // Sunrise assumed at 6 AM for simplicity
            const hoursFromSunrise = (hour - 6 + 24) % 24;
            const planetaryHourIndex = (dayRulerIndex + hoursFromSunrise) % 7;
            
            const planetData = {
                'Saturn': { symbol: '♄', energy: 'discipline, structure, karmic lessons', color: 'Black/Gray', activity: 'organization, boundary-setting, long-term planning' },
                'Jupiter': { symbol: '♃', energy: 'expansion, luck, wisdom', color: 'Blue/Purple', activity: 'learning, travel planning, abundance work' },
                'Mars': { symbol: '♂', energy: 'action, courage, initiative', color: 'Red', activity: 'physical exercise, assertive conversations, starting projects' },
                'Sun': { symbol: '☉', energy: 'vitality, creativity, self-expression', color: 'Gold/Yellow', activity: 'creative work, leadership, visibility' },
                'Venus': { symbol: '♀', energy: 'love, beauty, harmony', color: 'Green/Pink', activity: 'art, relationships, self-care, beautification' },
                'Mercury': { symbol: '☿', energy: 'communication, intellect, travel', color: 'Orange', activity: 'writing, studying, conversations, commerce' },
                'Moon': { symbol: '☽', energy: 'intuition, emotions, nurturing', color: 'Silver/White', activity: 'rest, reflection, family, psychic work' }
            };
            
            return { planet: planets[planetaryHourIndex], ...planetData[planets[planetaryHourIndex]] };
        }

        // PHASE 2: Cross-System Analysis
        function getCrossSystemAnalysis(zodiac, rising, moon, chinese, lifePath, personalYear) {
            let agreements = [];
            let tensions = [];
            let badges = [];
            
            // Element mapping for Western signs
            const fireSignals = ['Aries', 'Leo', 'Sagittarius'];
            const earthSigns = ['Taurus', 'Virgo', 'Capricorn'];
            const airSigns = ['Gemini', 'Libra', 'Aquarius'];
            const waterSigns = ['Cancer', 'Scorpio', 'Pisces'];
            
            function getWesternElement(sign) {
                if (fireSignals.includes(sign)) return 'Fire';
                if (earthSigns.includes(sign)) return 'Earth';
                if (airSigns.includes(sign)) return 'Air';
                if (waterSigns.includes(sign)) return 'Water';
                return 'Unknown';
            }
            
            const sunElement = getWesternElement(zodiac.name);
            const moonElement = moon ? getWesternElement(moon.name) : null;
            const risingElement = rising ? getWesternElement(rising.name) : null;
            
            // Chinese element compatibility with Western element
            const elementHarmony = {
                'Fire': ['Fire', 'Wood'],
                'Earth': ['Earth', 'Metal'],
                'Air': ['Metal', 'Water'],
                'Water': ['Water', 'Wood']
            };
            
            // Check Western-Chinese element harmony
            if (elementHarmony[sunElement] && elementHarmony[sunElement].includes(chinese.element)) {
                agreements.push({
                    systems: ['Western Astrology', 'Chinese Zodiac'],
                    insight: `Your ${zodiac.name} ${sunElement} energy harmonizes beautifully with your ${chinese.element} ${chinese.animal}. Both systems point toward ${sunElement === 'Fire' ? 'passionate action and leadership' : sunElement === 'Earth' ? 'stability and manifestation' : sunElement === 'Air' ? 'intellectual pursuits and communication' : 'emotional depth and intuition'}.`
                });
                badges.push('⭐🐉');
            } else {
                tensions.push({
                    systems: ['Western Astrology', 'Chinese Zodiac'],
                    insight: `Your ${zodiac.name} ${sunElement} energy creates dynamic tension with your ${chinese.element} ${chinese.animal}. This isn't negative—it provides depth and complexity, pushing you to integrate seemingly opposing forces.`
                });
            }
            
            // Life Path alignment with Sun Sign
            const leaderPaths = [1, 8];
            const creativePaths = [3, 6];
            const seekerPaths = [7, 11];
            const builderPaths = [4, 22];
            
            const leaderSigns = ['Aries', 'Leo', 'Capricorn'];
            const creativeSigns = ['Taurus', 'Leo', 'Libra', 'Pisces'];
            const seekerSigns = ['Sagittarius', 'Aquarius', 'Pisces', 'Scorpio'];
            const builderSigns = ['Taurus', 'Virgo', 'Capricorn'];
            
            if ((leaderPaths.includes(lifePath) && leaderSigns.includes(zodiac.name)) ||
                (creativePaths.includes(lifePath) && creativeSigns.includes(zodiac.name)) ||
                (seekerPaths.includes(lifePath) && seekerSigns.includes(zodiac.name)) ||
                (builderPaths.includes(lifePath) && builderSigns.includes(zodiac.name))) {
                agreements.push({
                    systems: ['Western Astrology', 'Numerology'],
                    insight: `Your Life Path ${lifePath} amplifies your ${zodiac.name} nature—both systems confirm your core purpose. This alignment gives you natural confidence in your path.`
                });
                badges.push('⭐🔢');
            }
            
            // Moon and Chinese element harmony (emotional depth)
            if (moon && moonElement) {
                if ((moonElement === 'Water' && ['Water', 'Wood'].includes(chinese.element)) ||
                    (moonElement === 'Fire' && ['Fire', 'Wood'].includes(chinese.element)) ||
                    (moonElement === 'Earth' && ['Earth', 'Metal'].includes(chinese.element)) ||
                    (moonElement === 'Air' && ['Metal', 'Water'].includes(chinese.element))) {
                    agreements.push({
                        systems: ['Moon Sign', 'Chinese Zodiac'],
                        insight: `Your ${moon.name} Moon resonates with your ${chinese.element} element, suggesting deep emotional alignment with your ancestral wisdom. Your intuitive responses are trustworthy.`
                    });
                }
            }
            
            // Personal Year and Chinese Year harmony
            const currentYear = new Date().getFullYear();
            const currentChinese = getChineseZodiac(currentYear);
            if (chinese.element === currentChinese.element) {
                agreements.push({
                    systems: ['Chinese Zodiac', 'Temporal'],
                    insight: `This is your element year! Your ${chinese.element} energy is amplified by the current ${currentChinese.element} ${currentChinese.animal} year—opportunities align more easily.`
                });
                badges.push('🐉⏰');
            }
            
            return { agreements, tensions, badges };
        }

        // PHASE 2: Moon Phase Calculator
        function getCurrentMoonPhase() {
            const now = new Date();
            const epoch = new Date('2000-01-06'); // Known new moon
            const daysSince = (now - epoch) / (1000 * 60 * 60 * 24);
            const lunation = daysSince % 29.53;
            
            if (lunation < 1.85) return { phase: 'New Moon', symbol: '🌑', energy: 'New beginnings, setting intentions, planting seeds', action: 'Meditate on new goals and write detailed intentions' };
            if (lunation < 7.38) return { phase: 'Waxing Crescent', symbol: '🌒', energy: 'Taking first steps, courage, commitment', action: 'Take the first concrete action toward your intentions' };
            if (lunation < 9.23) return { phase: 'First Quarter', symbol: '🌓', energy: 'Decision time, overcoming obstacles, momentum', action: 'Push through resistance and commit to your path' };
            if (lunation < 14.77) return { phase: 'Waxing Gibbous', symbol: '🌔', energy: 'Refinement, patience, trust the process', action: 'Fine-tune your approach and stay the course' };
            if (lunation < 16.62) return { phase: 'Full Moon', symbol: '🌕', energy: 'Manifestation, clarity, celebration, release', action: 'Celebrate progress and release what no longer serves' };
            if (lunation < 22.15) return { phase: 'Waning Gibbous', symbol: '🌖', energy: 'Gratitude, sharing wisdom, giving back', action: 'Share what you\'ve learned and express gratitude' };
            if (lunation < 23.99) return { phase: 'Last Quarter', symbol: '🌗', energy: 'Release, forgiveness, letting go', action: 'Release old patterns and forgive past mistakes' };
            return { phase: 'Waning Crescent', symbol: '🌘', energy: 'Rest, surrender, preparation for renewal', action: 'Rest deeply and prepare for the new cycle' };
        }

        // Generate forecast
        document.getElementById('generateBtn').addEventListener('click', function() {
            const birthDate = document.getElementById('birthDate').value;
            
            // Validate inputs
            if (!validateInputs()) {
                return;
            }
            
            // Show loading spinner with animation
            showLoadingSpinner();
            document.getElementById('inputSection').style.display = 'none';
            
            // Simulate calculation time (2.5s to match animation)
            setTimeout(() => {
                generateForecast();
                hideLoadingSpinner();
                document.getElementById('timeframeSelector').style.display = 'flex';
                document.getElementById('forecastOutput').classList.add('show');
                document.getElementById('howToUse').style.display = 'block';
                document.getElementById('forecastOutput').scrollIntoView({ behavior: 'smooth' });
            }, 2500);
        });

        // Input Validation
        function validateInputs() {
            clearErrors();
            const errors = [];
            
            const birthDate = document.getElementById('birthDate').value;
            if (!birthDate) {
                errors.push({ field: 'birthDate', message: 'Please enter your birth date' });
            }
            
            const birthTime = document.getElementById('birthTime').value;
            if (birthTime && !isValidTime(birthTime)) {
                errors.push({ field: 'birthTime', message: 'Please enter time in HH:MM format' });
            }
            
            if (errors.length > 0) {
                showErrors(errors);
                return false;
            }
            
            return true;
        }

        function isValidTime(time) {
            return /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(time);
        }

        function clearErrors() {
            document.querySelectorAll('.error-message').forEach(el => el.remove());
            document.querySelectorAll('.input-error').forEach(el => el.classList.remove('input-error'));
        }

        function showErrors(errors) {
            errors.forEach(error => {
                const field = document.getElementById(error.field);
                field.classList.add('input-error');
                
                const errorDiv = document.createElement('div');
                errorDiv.className = 'error-message';
                errorDiv.textContent = error.message;
                field.parentNode.appendChild(errorDiv);
                
                // Scroll to first error
                if (errors[0] === error) {
                    field.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            });
        }

        function generateForecast(timeframe = 'daily') {
            const birthDate = document.getElementById('birthDate').value;
            const birthTime = document.getElementById('birthTime').value;
            const birthLocation = document.getElementById('birthLocation').value;
            const firstName = document.getElementById('firstName').value;
            const middleName = document.getElementById('middleName').value;
            const lastName = document.getElementById('lastName').value;
            const focus = document.getElementById('focus').value;
            const challenge = document.getElementById('challenge').value;
            
            const birth = new Date(birthDate);
            const month = birth.getMonth() + 1;
            const day = birth.getDate();
            const year = birth.getFullYear();
            
            // Calculate all systems
            const zodiac = getZodiacSign(month, day);
            const chinese = getChineseZodiac(year);
            const lifePath = getLifePathNumber(birthDate);
            const personalYear = getPersonalYear(birthDate);
            const fullName = [firstName, middleName, lastName].filter(n => n).join(' ');
            const gematria = calculateGematria(fullName);
            
            // PHASE 2: Advanced calculations
            const risingSign = getRisingSign(birthDate, birthTime, birthLocation);
            const moonSign = getMoonSign(birthDate, birthTime, birthLocation);
            const planetaryHour = getPlanetaryHour();
            const moonPhase = getCurrentMoonPhase();
            const crossAnalysis = getCrossSystemAnalysis(zodiac, risingSign, moonSign, chinese, lifePath, personalYear);
            
            // PHASE 3: New features - Tarot, Aspects, Best Day
            const tarotCard = getTarotCard(birthDate, timeframe);
            const planetaryAspects = getPlanetaryAspects(birthDate);
            const bestDay = getBestDayOfWeek(zodiac, chinese, lifePath);
            
            // Get today's date
            const today = new Date();
            const todayStr = today.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
            
            // Generate forecast content based on timeframe
            let forecastHTML = '';
            
            if (timeframe === 'daily') {
                forecastHTML = generateDailyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear, 
                    gematria, fullName, birthTime, birthLocation, planetaryHour, moonPhase, crossAnalysis, 
                    focus, challenge, birth, todayStr, tarotCard, planetaryAspects);
            } else if (timeframe === 'weekly') {
                forecastHTML = generateWeeklyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear,
                    gematria, fullName, birthTime, moonPhase, crossAnalysis, focus, challenge, birth, tarotCard, bestDay);
            } else if (timeframe === 'monthly') {
                forecastHTML = generateMonthlyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear,
                    gematria, fullName, crossAnalysis, focus, challenge, birth, tarotCard);
            } else {
                forecastHTML = generateYearlyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear,
                    gematria, fullName, crossAnalysis, focus, challenge, birth);
            }
            
            document.getElementById('forecastOutput').innerHTML = forecastHTML;
        }

        // PHASE 2: Daily Forecast Generator
        function generateDailyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear, 
            gematria, fullName, birthTime, birthLocation, planetaryHour, moonPhase, crossAnalysis, 
            focus, challenge, birth, todayStr, tarotCard, planetaryAspects) {
            
            return `
                <div class="forecast-header">
                    <h2>YOUR QUANTUM FORECAST</h2>
                    <div class="forecast-meta">
                        <p>Generated for: ${fullName || 'Seeker'}</p>
                        <p>☉ Sun: ${zodiac.name} ${zodiac.symbol} ${risingSign ? `| ↑ Rising: ${risingSign.name} ${risingSign.symbol}` : ''} ${moonSign ? `| ☽ Moon: ${moonSign.name} ${moonSign.symbol}` : ''}</p>
                        <p>🐉 ${chinese.element} ${chinese.animal} | 🔢 Life Path ${lifePath} | Personal Year ${personalYear}</p>
                        <p>Timeframe: Daily | ${todayStr}</p>
                    </div>
                </div>

                <div class="tarot-section">
                    <h3>🃏 YOUR DAILY TAROT CARD</h3>
                    <div class="tarot-card-display">
                        <div class="tarot-card">
                            <div class="tarot-symbol">${tarotCard.symbol}</div>
                            <div class="tarot-number">${tarotCard.number === 0 ? '0' : tarotCard.number}</div>
                            <div class="tarot-name">${tarotCard.name}</div>
                        </div>
                        <div class="tarot-meaning">
                            <p><strong>Meaning:</strong> ${tarotCard.meaning}</p>
                            <p><strong>Guidance:</strong> ${tarotCard.guidance}</p>
                        </div>
                    </div>
                </div>

                ${planetaryAspects.length > 0 ? `
                <div class="aspects-section">
                    <h3>🌌 PLANETARY ASPECTS - Today's Celestial Geometry</h3>
                    <div class="aspects-grid">
                        ${planetaryAspects.map(aspect => `
                            <div class="aspect-item">
                                <div class="aspect-header">
                                    <span class="aspect-symbol">${aspect.symbol}</span>
                                    <span class="aspect-type">${aspect.type}</span>
                                </div>
                                <p class="aspect-planets">${aspect.planets}</p>
                                <p class="aspect-meaning">${aspect.meaning}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>
                ` : ''}

                <div class="cosmic-timing-section">
                    <h3>⏰ COSMIC TIMING - Right Now</h3>
                    <div class="timing-grid">
                        <div class="timing-item">
                            <strong>${moonPhase.symbol} ${moonPhase.phase}</strong>
                            <p>${moonPhase.energy}</p>
                            <p><em>Action: ${moonPhase.action}</em></p>
                        </div>
                        <div class="timing-item">
                            <strong>${planetaryHour.symbol} Hour of ${planetaryHour.planet}</strong>
                            <p>Energy: ${planetaryHour.energy}</p>
                            <p><em>Best for: ${planetaryHour.activity}</em></p>
                        </div>
                    </div>
                </div>

                ${crossAnalysis.agreements.length > 0 ? `
                <div class="cross-reference-section agreement">
                    <h3>✨ SYSTEM AGREEMENTS - Where Your Cosmic DNA Aligns</h3>
                    ${crossAnalysis.agreements.map(a => `
                        <div class="cross-item">
                            <div class="system-badges">${a.systems.map(s => `<span class="badge">${s}</span>`).join(' + ')}</div>
                            <p>${a.insight}</p>
                        </div>
                    `).join('')}
                </div>
                ` : ''}

                ${crossAnalysis.tensions.length > 0 ? `
                <div class="cross-reference-section tension">
                    <h3>⚡ DYNAMIC TENSIONS - Your Growth Edges</h3>
                    ${crossAnalysis.tensions.map(t => `
                        <div class="cross-item">
                            <div class="system-badges">${t.systems.map(s => `<span class="badge tension">${s}</span>`).join(' ⟷ ')}</div>
                            <p>${t.insight}</p>
                        </div>
                    `).join('')}
                </div>
                ` : ''}

                <div class="overview-section">
                    <h3>🌟 TODAY'S OVERVIEW</h3>
                    <div class="overview-content">
                        <p><strong>Core Energy:</strong> ${getEnhancedOverviewEnergy(zodiac, risingSign, moonSign, chinese, personalYear, moonPhase)}</p>
                        <p><strong>Primary Focus:</strong> ${getEnhancedOverviewFocus(lifePath, personalYear, focus, moonPhase)}</p>
                        <p><strong>Shadow Work:</strong> ${getEnhancedOverviewCaution(zodiac, moonSign, chinese)}</p>
                    </div>
                </div>

                <div class="system-section expanded">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>⭐ WESTERN ASTROLOGY</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getEnhancedWesternAstrologyForecast(zodiac, risingSign, moonSign, birthTime, birthLocation, moonPhase)}
                    </div>
                </div>

                <div class="system-section">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>🐉 CHINESE ZODIAC</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getEnhancedChineseZodiacForecast(chinese, moonPhase)}
                    </div>
                </div>

                <div class="system-section">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>🔢 NUMEROLOGY</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getEnhancedNumerologyForecast(lifePath, personalYear, birth)}
                    </div>
                </div>

                ${fullName ? `
                <div class="system-section">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>📜 GEMATRIA</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getEnhancedGematriaForecast(fullName, gematria, birth)}
                    </div>
                </div>
                ` : ''}

                <div class="action-section">
                    <h3>💡 YOUR DAILY ACTION PLAN</h3>
                    ${getEnhancedActionItems(zodiac, risingSign, moonSign, chinese, lifePath, personalYear, planetaryHour, moonPhase, focus, challenge)}
                </div>

                <button class="save-btn" onclick="saveForecast()">📥 Save to Library</button>
                <button class="generate-btn" onclick="location.reload()">🔄 Generate New Forecast</button>

                <div class="share-section">
                    <h4>✨ Share Your Forecast</h4>
                    <p>Spread the cosmic wisdom!</p>
                    <div class="share-buttons">
                        <button class="share-btn twitter" onclick="shareToTwitter('Just got my ${zodiac.name} ${zodiac.symbol} daily forecast! ${focus} is my focus today. Get your free cosmic reading:')">
                            <span>𝕏</span> Tweet
                        </button>
                        <button class="share-btn facebook" onclick="shareToFacebook()">
                            <span>f</span> Share
                        </button>
                        <button class="share-btn copy" onclick="copyForecastLink()">
                            <span>📋</span> Copy Link
                        </button>
                    </div>
                </div>
            `;
            showMidAd();
        }

        // PHASE 2: Weekly Forecast Generator
        function generateWeeklyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear,
            gematria, fullName, birthTime, moonPhase, crossAnalysis, focus, challenge, birth, tarotCard, bestDay) {
            
            const today = new Date();
            const weekStart = new Date(today);
            weekStart.setDate(today.getDate() - today.getDay());
            const weekEnd = new Date(weekStart);
            weekEnd.setDate(weekStart.getDate() + 6);
            
            const weekStartStr = weekStart.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
            const weekEndStr = weekEnd.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            
            // Generate 7-day breakdown
            let dailyBreakdown = '';
            const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const dayEnergies = ['reflection & rest', 'initiative & new beginnings', 'assertive action', 'communication & learning', 'expansion & opportunity', 'love & harmony', 'discipline & structure'];
            const planetRulers = ['Sun', 'Moon', 'Mars', 'Mercury', 'Jupiter', 'Venus', 'Saturn'];
            
            for (let i = 0; i < 7; i++) {
                const dayDate = new Date(weekStart);
                dayDate.setDate(weekStart.getDate() + i);
                const isToday = dayDate.toDateString() === today.toDateString();
                const isBestDay = dayNames[i] === bestDay.day;
                
                dailyBreakdown += `
                    <div class="day-item ${isToday ? 'today' : ''} ${isBestDay ? 'best-day' : ''}">
                        <h4>${dayNames[i]}${isToday ? ' (Today)' : ''}${isBestDay ? ` ${bestDay.emoji} BEST DAY` : ''} - ${dayDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}</h4>
                        <p><strong>Ruler:</strong> ${planetRulers[i]} | <strong>Energy:</strong> ${dayEnergies[i]}</p>
                        ${isBestDay ? `<p class="best-day-note">✨ <strong>${bestDay.energy}</strong> - ${bestDay.action}</p>` : ''}
                        <p>${getDaySpecificGuidance(zodiac, chinese, lifePath, i, focus)}</p>
                    </div>
                `;
            }
            
            return `
                <div class="forecast-header">
                    <h2>YOUR WEEKLY QUANTUM FORECAST</h2>
                    <div class="forecast-meta">
                        <p>Generated for: ${fullName || 'Seeker'}</p>
                        <p>☉ Sun: ${zodiac.name} ${zodiac.symbol} ${risingSign ? `| ↑ Rising: ${risingSign.name} ${risingSign.symbol}` : ''}</p>
                        <p>🐉 ${chinese.element} ${chinese.animal} | 🔢 Life Path ${lifePath} | Personal Year ${personalYear}</p>
                        <p>Week: ${weekStartStr} - ${weekEndStr}</p>
                    </div>
                </div>

                <div class="best-day-banner">
                    <h3>🌟 YOUR POWER DAY THIS WEEK</h3>
                    <div class="best-day-content">
                        <div class="best-day-name">${bestDay.emoji} ${bestDay.day}</div>
                        <p><strong>${bestDay.energy}</strong></p>
                        <p>${bestDay.action}</p>
                    </div>
                </div>

                <div class="tarot-section">
                    <h3>🃏 YOUR WEEKLY TAROT CARD</h3>
                    <div class="tarot-card-display">
                        <div class="tarot-card">
                            <div class="tarot-symbol">${tarotCard.symbol}</div>
                            <div class="tarot-number">${tarotCard.number === 0 ? '0' : tarotCard.number}</div>
                            <div class="tarot-name">${tarotCard.name}</div>
                        </div>
                        <div class="tarot-meaning">
                            <p><strong>Theme:</strong> ${tarotCard.meaning}</p>
                            <p><strong>Guidance:</strong> ${tarotCard.guidance}</p>
                        </div>
                    </div>
                </div>

                <div class="overview-section">
                    <h3>🌟 WEEK AT A GLANCE</h3>
                    <div class="overview-content">
                        <p><strong>Theme:</strong> ${getWeeklyTheme(zodiac, chinese, personalYear, moonPhase)}</p>
                        <p><strong>Opportunity:</strong> ${getWeeklyOpportunity(lifePath, personalYear, focus)}</p>
                        <p><strong>Challenge:</strong> ${getWeeklyChallenge(zodiac, chinese, challenge)}</p>
                        <p><strong>Key Day:</strong> ${getKeyDayOfWeek(zodiac, lifePath)}</p>
                    </div>
                </div>

                ${crossAnalysis.agreements.length > 0 ? `
                <div class="cross-reference-section agreement">
                    <h3>✨ THIS WEEK'S COSMIC ALIGNMENTS</h3>
                    ${crossAnalysis.agreements.slice(0, 2).map(a => `
                        <div class="cross-item">
                            <div class="system-badges">${a.systems.map(s => `<span class="badge">${s}</span>`).join(' + ')}</div>
                            <p>${a.insight}</p>
                        </div>
                    `).join('')}
                </div>
                ` : ''}

                <div class="weekly-breakdown">
                    <h3>📅 7-DAY BREAKDOWN</h3>
                    <div class="days-grid">
                        ${dailyBreakdown}
                    </div>
                </div>

                <div class="system-section expanded">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>⭐ WESTERN ASTROLOGY - Weekly Transits</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getWeeklyWesternForecast(zodiac, risingSign, moonSign)}
                    </div>
                </div>

                <div class="system-section">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>🔢 NUMEROLOGY - Weekly Vibration</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getWeeklyNumerologyForecast(lifePath, personalYear, weekStart)}
                    </div>
                </div>

                <div class="action-section">
                    <h3>💡 WEEKLY PRIORITIES</h3>
                    ${getWeeklyActionItems(zodiac, chinese, lifePath, focus)}
                </div>

                <button class="save-btn" onclick="saveForecast()">📥 Save to Library</button>
                <button class="generate-btn" onclick="location.reload()">🔄 Generate New Forecast</button>

                <div class="share-section">
                    <h4>✨ Share Your Forecast</h4>
                    <p>Spread the cosmic wisdom!</p>
                    <div class="share-buttons">
                        <button class="share-btn twitter" onclick="shareToTwitter('My ${zodiac.name} ${zodiac.symbol} weekly forecast is in! Get your free cosmic reading:')">
                            <span>𝕏</span> Tweet
                        </button>
                        <button class="share-btn facebook" onclick="shareToFacebook()">
                            <span>f</span> Share
                        </button>
                        <button class="share-btn copy" onclick="copyForecastLink()">
                            <span>📋</span> Copy Link
                        </button>
                    </div>
                </div>
            `;
            showMidAd();
        }

        // PHASE 2: Monthly Forecast Generator
        function generateMonthlyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear,
            gematria, fullName, crossAnalysis, focus, challenge, birth) {
            
            const today = new Date();
            const monthName = today.toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
            const daysInMonth = new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate();
            
            // Calculate personal month
            const personalMonth = ((today.getMonth() + 1) + personalYear) % 9 || 9;
            
            // Four week themes
            const weekThemes = getMonthlyWeekThemes(zodiac, chinese, personalMonth, focus);
            
            return `
                <div class="forecast-header">
                    <h2>YOUR MONTHLY QUANTUM FORECAST</h2>
                    <div class="forecast-meta">
                        <p>Generated for: ${fullName || 'Seeker'}</p>
                        <p>☉ Sun: ${zodiac.name} ${zodiac.symbol} ${risingSign ? `| ↑ Rising: ${risingSign.name} ${risingSign.symbol}` : ''}</p>
                        <p>🐉 ${chinese.element} ${chinese.animal} | 🔢 Life Path ${lifePath} | Personal Year ${personalYear}</p>
                        <p>Month: ${monthName} | Personal Month: ${personalMonth}</p>
                    </div>
                </div>

                <div class="overview-section">
                    <h3>🌟 ${monthName.toUpperCase()} OVERVIEW</h3>
                    <div class="overview-content">
                        <p><strong>Month Theme:</strong> ${getMonthlyTheme(personalMonth, zodiac, chinese)}</p>
                        <p><strong>Primary Energy:</strong> ${getMonthlyEnergy(zodiac, chinese, personalMonth)}</p>
                        <p><strong>Growth Area:</strong> ${getMonthlyGrowth(lifePath, personalMonth, focus)}</p>
                        <p><strong>Watch For:</strong> ${getMonthlyCaution(zodiac, moonSign, personalMonth)}</p>
                    </div>
                </div>

                ${crossAnalysis.agreements.length > 0 ? `
                <div class="cross-reference-section agreement">
                    <h3>✨ MONTHLY COSMIC ALIGNMENTS</h3>
                    ${crossAnalysis.agreements.map(a => `
                        <div class="cross-item">
                            <div class="system-badges">${a.systems.map(s => `<span class="badge">${s}</span>`).join(' + ')}</div>
                            <p>${a.insight}</p>
                        </div>
                    `).join('')}
                </div>
                ` : ''}

                <div class="monthly-breakdown">
                    <h3>📅 4-WEEK BREAKDOWN</h3>
                    <div class="weeks-grid">
                        ${weekThemes.map((theme, i) => `
                            <div class="week-item">
                                <h4>Week ${i + 1}: ${theme.title}</h4>
                                <p><strong>Focus:</strong> ${theme.focus}</p>
                                <p><strong>Action:</strong> ${theme.action}</p>
                                <p><strong>Key Days:</strong> ${theme.keyDays}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="key-dates-section">
                    <h3>🔑 KEY DATES THIS MONTH</h3>
                    ${getMonthlyKeyDates(zodiac, chinese, lifePath, today)}
                </div>

                <div class="system-section expanded">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>⭐ ASTROLOGICAL TRANSITS</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getMonthlyWesternForecast(zodiac, risingSign, moonSign, today)}
                    </div>
                </div>

                <div class="system-section">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>🔢 NUMEROLOGY - Personal Month ${personalMonth}</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getMonthlyNumerologyForecast(lifePath, personalYear, personalMonth)}
                    </div>
                </div>

                <div class="action-section">
                    <h3>💡 MONTHLY INTENTIONS</h3>
                    ${getMonthlyActionItems(zodiac, chinese, lifePath, personalMonth, focus)}
                </div>

                <button class="save-btn" onclick="saveForecast()">📥 Save to Library</button>
                <button class="generate-btn" onclick="location.reload()">🔄 Generate New Forecast</button>

                <div class="share-section">
                    <h4>✨ Share Your Forecast</h4>
                    <p>Spread the cosmic wisdom!</p>
                    <div class="share-buttons">
                        <button class="share-btn twitter" onclick="shareToTwitter('My ${zodiac.name} ${zodiac.symbol} monthly forecast reveals so much! Get your free cosmic reading:')">
                            <span>𝕏</span> Tweet
                        </button>
                        <button class="share-btn facebook" onclick="shareToFacebook()">
                            <span>f</span> Share
                        </button>
                        <button class="share-btn copy" onclick="copyForecastLink()">
                            <span>📋</span> Copy Link
                        </button>
                    </div>
                </div>
            `;
            showMidAd();
        }

        // PHASE 2: Yearly Forecast Generator  
        function generateYearlyForecast(zodiac, risingSign, moonSign, chinese, lifePath, personalYear,
            gematria, fullName, crossAnalysis, focus, challenge, birth) {
            
            const currentYear = new Date().getFullYear();
            const currentChinese = getChineseZodiac(currentYear);
            
            // Quarterly breakdown
            const quarters = getYearlyQuarters(zodiac, chinese, lifePath, personalYear, focus);
            
            return `
                <div class="forecast-header">
                    <h2>YOUR ${currentYear} QUANTUM FORECAST</h2>
                    <div class="forecast-meta">
                        <p>Generated for: ${fullName || 'Seeker'}</p>
                        <p>☉ Sun: ${zodiac.name} ${zodiac.symbol} ${risingSign ? `| ↑ Rising: ${risingSign.name} ${risingSign.symbol}` : ''}</p>
                        <p>🐉 ${chinese.element} ${chinese.animal} in Year of ${currentChinese.element} ${currentChinese.animal}</p>
                        <p>🔢 Life Path ${lifePath} | Personal Year ${personalYear}</p>
                    </div>
                </div>

                <div class="overview-section">
                    <h3>🌟 ${currentYear} - YOUR YEAR OF ${getYearlyThemeTitle(personalYear).toUpperCase()}</h3>
                    <div class="overview-content">
                        <p><strong>Year Theme:</strong> ${getYearlyTheme(personalYear, zodiac, chinese)}</p>
                        <p><strong>Core Lesson:</strong> ${getYearlyLesson(lifePath, personalYear)}</p>
                        <p><strong>Major Opportunity:</strong> ${getYearlyOpportunity(zodiac, chinese, personalYear, focus)}</p>
                        <p><strong>Growth Edge:</strong> ${getYearlyChallenge(zodiac, moonSign, lifePath)}</p>
                    </div>
                </div>

                ${crossAnalysis.agreements.length > 0 ? `
                <div class="cross-reference-section agreement">
                    <h3>✨ ${currentYear} COSMIC ALIGNMENTS</h3>
                    ${crossAnalysis.agreements.map(a => `
                        <div class="cross-item">
                            <div class="system-badges">${a.systems.map(s => `<span class="badge">${s}</span>`).join(' + ')}</div>
                            <p>${a.insight}</p>
                        </div>
                    `).join('')}
                </div>
                ` : ''}

                <div class="yearly-breakdown">
                    <h3>📅 QUARTERLY ROADMAP</h3>
                    <div class="quarters-grid">
                        ${quarters.map((q, i) => `
                            <div class="quarter-item">
                                <h4>Q${i + 1}: ${q.title}</h4>
                                <p><strong>Months:</strong> ${q.months}</p>
                                <p><strong>Theme:</strong> ${q.theme}</p>
                                <p><strong>Focus:</strong> ${q.focus}</p>
                                <p><strong>Peak Time:</strong> ${q.peak}</p>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="major-transits-section">
                    <h3>🪐 MAJOR TRANSITS & EVENTS</h3>
                    ${getYearlyTransits(zodiac, currentYear)}
                </div>

                <div class="system-section expanded">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>⭐ WESTERN ASTROLOGY - ${currentYear} Overview</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getYearlyWesternForecast(zodiac, risingSign, moonSign, currentYear)}
                    </div>
                </div>

                <div class="system-section">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>🐉 CHINESE ZODIAC - Year of ${currentChinese.element} ${currentChinese.animal}</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getYearlyChineseForecast(chinese, currentChinese)}
                    </div>
                </div>

                <div class="system-section">
                    <div class="system-header" onclick="toggleSystem(this)">
                        <h3>🔢 NUMEROLOGY - Personal Year ${personalYear}</h3>
                        <span class="system-toggle">▼</span>
                    </div>
                    <div class="system-content">
                        ${getYearlyNumerologyForecast(lifePath, personalYear)}
                    </div>
                </div>

                <div class="action-section">
                    <h3>💡 ${currentYear} STRATEGIC PRIORITIES</h3>
                    ${getYearlyActionItems(zodiac, chinese, lifePath, personalYear, focus)}
                </div>

                <button class="save-btn" onclick="saveForecast()">📥 Save to Library</button>
                <button class="generate-btn" onclick="location.reload()">🔄 Generate New Forecast</button>

                <div class="share-section">
                    <h4>✨ Share Your ${currentYear} Forecast</h4>
                    <p>Your year ahead awaits - spread the wisdom!</p>
                    <div class="share-buttons">
                        <button class="share-btn twitter" onclick="shareToTwitter('My ${zodiac.name} ${zodiac.symbol} yearly forecast for ${currentYear} is incredible! Personal Year ${personalYear} energy. Get your free cosmic reading:')">
                            <span>𝕏</span> Tweet
                        </button>
                        <button class="share-btn facebook" onclick="shareToFacebook()">
                            <span>f</span> Share
                        </button>
                        <button class="share-btn copy" onclick="copyForecastLink()">
                            <span>📋</span> Copy Link
                        </button>
                    </div>
                </div>
            `;
            showMidAd();
        }

        function toggleSystem(header) {
            const section = header.parentElement;
            section.classList.toggle('expanded');
        }

        // PHASE 2: Enhanced Forecast Content Generators
        function getEnhancedOverviewEnergy(zodiac, risingSign, moonSign, chinese, personalYear, moonPhase) {
            const baseEnergy = `${zodiac.name} determination meets ${chinese.element} ${chinese.animal} wisdom`;
            const moonInfluence = moonSign ? `, filtered through ${moonSign.name} emotional lens` : '';
            const risingInfluence = risingSign ? `. Your ${risingSign.name} rising presents this energy to the world with characteristic ${getRisingStyle(risingSign.name)}` : '';
            const phaseInfluence = `. The ${moonPhase.phase} amplifies ${moonPhase.energy.split(',')[0].toLowerCase()}`;
            return baseEnergy + moonInfluence + risingInfluence + phaseInfluence + '.';
        }

        function getRisingStyle(sign) {
            const styles = {
                'Aries': 'boldness and directness',
                'Taurus': 'steadiness and sensuality',
                'Gemini': 'wit and adaptability',
                'Cancer': 'nurturing warmth',
                'Leo': 'charisma and presence',
                'Virgo': 'precision and helpfulness',
                'Libra': 'grace and diplomacy',
                'Scorpio': 'intensity and mystery',
                'Sagittarius': 'optimism and adventure',
                'Capricorn': 'authority and composure',
                'Aquarius': 'uniqueness and vision',
                'Pisces': 'empathy and dreaminess'
            };
            return styles[sign] || 'unique expression';
        }

        function getEnhancedOverviewFocus(lifePath, personalYear, focus, moonPhase) {
            const lifePathFocus = getLifePathFocus(lifePath);
            const yearFocus = getPersonalYearFocus(personalYear);
            const phaseFocus = moonPhase.action;
            
            if (focus) {
                const focusMap = {
                    'career': `Professional advancement through ${lifePathFocus}. ${yearFocus}`,
                    'love': `Heart-centered connections aligned with your ${lifePathFocus}. ${yearFocus}`,
                    'health': `Physical vitality supporting your ${lifePathFocus}. ${yearFocus}`,
                    'spiritual': `Inner wisdom development through ${lifePathFocus}. ${yearFocus}`,
                    'finances': `Abundance manifestation via ${lifePathFocus}. ${yearFocus}`
                };
                return focusMap[focus] || `${lifePathFocus}. ${yearFocus}`;
            }
            return `${lifePathFocus}. ${yearFocus} Action: ${phaseFocus}`;
        }

        function getLifePathFocus(lifePath) {
            const focuses = {
                1: 'pioneering innovation and independent leadership',
                2: 'collaborative partnerships and diplomatic balance',
                3: 'creative expression and inspiring communication',
                4: 'building solid foundations and practical systems',
                5: 'embracing change and freedom-seeking exploration',
                6: 'nurturing responsibility and service to community',
                7: 'deep analysis and spiritual understanding',
                8: 'material mastery and authoritative achievement',
                9: 'humanitarian vision and compassionate completion',
                11: 'intuitive illumination and inspirational guidance',
                22: 'visionary building and large-scale manifestation',
                33: 'master teaching and healing transformation'
            };
            return focuses[lifePath] || 'purposeful growth';
        }

        function getPersonalYearFocus(personalYear) {
            const focuses = {
                1: 'This is your year to initiate—plant seeds boldly.',
                2: 'Patience and partnership are your tools—cultivate relationships.',
                3: 'Express yourself creatively—your voice matters now.',
                4: 'Build systematically—foundations created now last.',
                5: 'Embrace transformation—freedom awaits the adaptable.',
                6: 'Nurture what matters—home and heart call.',
                7: 'Go within—spiritual depth is available.',
                8: 'Manifest materially—your power is visible.',
                9: 'Complete and release—clearing creates space.'
            };
            return focuses[personalYear] || 'Transformative growth unfolds.';
        }

        function getEnhancedOverviewCaution(zodiac, moonSign, chinese) {
            const sunShadow = getZodiacShadow(zodiac.name);
            const moonShadow = moonSign ? getZodiacShadow(moonSign.name) : '';
            const chineseShadow = getChineseShadow(chinese.animal);
            
            return `Watch for ${sunShadow} (sun shadow)${moonSign ? ` and ${moonShadow} (emotional trigger)` : ''}. Your ${chinese.animal} nature may amplify ${chineseShadow}. Awareness transforms shadow into strength.`;
        }

        function getZodiacShadow(sign) {
            const shadows = {
                'Aries': 'impatience and impulsive reactions',
                'Taurus': 'stubbornness and resistance to change',
                'Gemini': 'scattered focus and superficiality',
                'Cancer': 'emotional overwhelm and clinginess',
                'Leo': 'ego attachment and need for validation',
                'Virgo': 'perfectionism and self-criticism',
                'Libra': 'people-pleasing and indecision',
                'Scorpio': 'obsessive control and jealousy',
                'Sagittarius': 'overcommitment and restlessness',
                'Capricorn': 'workaholism and emotional suppression',
                'Aquarius': 'detachment and rebelliousness',
                'Pisces': 'escapism and boundary dissolution'
            };
            return shadows[sign] || 'unconscious patterns';
        }

        function getChineseShadow(animal) {
            const shadows = {
                'Rat': 'anxiety about resources',
                'Ox': 'inflexibility under pressure',
                'Tiger': 'reckless aggression',
                'Rabbit': 'avoidance of conflict',
                'Dragon': 'arrogance and overreach',
                'Snake': 'manipulation tendencies',
                'Horse': 'commitment fears',
                'Goat': 'dependency patterns',
                'Monkey': 'trickster energy',
                'Rooster': 'critical perfectionism',
                'Dog': 'pessimistic worry',
                'Pig': 'overindulgence'
            };
            return shadows[animal] || 'habitual reactions';
        }

        // PHASE 2: Enhanced Western Astrology Forecast
        function getEnhancedWesternAstrologyForecast(zodiac, risingSign, moonSign, birthTime, birthLocation, moonPhase) {
            let html = `
                <div class="system-item">
                    <h4>☉ Sun in ${zodiac.name} ${zodiac.symbol}</h4>
                    <p>${getDetailedZodiacDescription(zodiac.name)}</p>
                    <p><strong>Today's Solar Activation:</strong> ${getSolarActivation(zodiac.name)}</p>
                </div>
            `;
            
            if (risingSign) {
                html += `
                    <div class="system-item">
                        <h4>↑ Rising Sign: ${risingSign.name} ${risingSign.symbol}</h4>
                        <p>${getRisingSignDescription(risingSign.name)}</p>
                        <p><strong>Public Presence Today:</strong> ${getRisingActivation(risingSign.name)}</p>
                    </div>
                `;
            }
            
            if (moonSign) {
                html += `
                    <div class="system-item">
                        <h4>☽ Moon Sign: ${moonSign.name} ${moonSign.symbol}</h4>
                        <p>${getMoonSignDescription(moonSign.name)}</p>
                        <p><strong>Emotional Navigation:</strong> ${getMoonActivation(moonSign.name, moonPhase)}</p>
                    </div>
                `;
            }
            
            html += `
                <div class="system-item">
                    <h4>🌙 Current Moon Phase: ${moonPhase.symbol} ${moonPhase.phase}</h4>
                    <p>${moonPhase.energy}</p>
                    <p><strong>Moon Phase Guidance:</strong> ${moonPhase.action}</p>
                </div>
                <div class="system-item">
                    <h4>🪐 Planetary Transits</h4>
                    <p>${getTransitForecast(zodiac.name)}</p>
                </div>
            `;
            
            return html;
        }

        function getDetailedZodiacDescription(sign) {
            const descriptions = {
                'Aries': 'As a Cardinal Fire sign ruled by Mars, you carry the spark of initiation and the courage to begin. Your soul\'s purpose involves pioneering new territory and inspiring others through bold action. Today, your natural leadership is activated.',
                'Taurus': 'As a Fixed Earth sign ruled by Venus, you embody stability, sensuality, and the art of building lasting value. Your soul\'s purpose involves creating beauty and security. Today, your grounding energy provides anchor for others.',
                'Gemini': 'As a Mutable Air sign ruled by Mercury, you are the cosmic messenger—curious, adaptable, and intellectually vibrant. Your soul\'s purpose involves connecting ideas and people. Today, your communication gifts shine.',
                'Cancer': 'As a Cardinal Water sign ruled by the Moon, you carry deep emotional intelligence and nurturing wisdom. Your soul\'s purpose involves creating emotional safety and honoring the past. Today, your intuition speaks clearly.',
                'Leo': 'As a Fixed Fire sign ruled by the Sun, you radiate creative life force and natural authority. Your soul\'s purpose involves authentic self-expression and generous heart-leadership. Today, your light inspires others.',
                'Virgo': 'As a Mutable Earth sign ruled by Mercury, you hold the gift of discernment, service, and practical wisdom. Your soul\'s purpose involves healing through attention to detail. Today, your analytical gifts are needed.',
                'Libra': 'As a Cardinal Air sign ruled by Venus, you carry the scales of justice, beauty, and relational harmony. Your soul\'s purpose involves creating balance and beauty in the world. Today, your diplomatic skills mediate.',
                'Scorpio': 'As a Fixed Water sign ruled by Pluto and Mars, you hold transformative power and psychological depth. Your soul\'s purpose involves healing through facing shadow. Today, your intensity transforms.',
                'Sagittarius': 'As a Mutable Fire sign ruled by Jupiter, you carry the archer\'s vision—philosophical, adventurous, and truth-seeking. Your soul\'s purpose involves expanding understanding. Today, your optimism lifts spirits.',
                'Capricorn': 'As a Cardinal Earth sign ruled by Saturn, you embody ambition, discipline, and mastery through time. Your soul\'s purpose involves building structures that serve the collective. Today, your authority is respected.',
                'Aquarius': 'As a Fixed Air sign ruled by Uranus and Saturn, you are the visionary revolutionary—innovative, humanitarian, and future-oriented. Your soul\'s purpose involves awakening collective consciousness. Today, your uniqueness inspires.',
                'Pisces': 'As a Mutable Water sign ruled by Neptune and Jupiter, you hold the ocean of collective consciousness—mystical, compassionate, and boundless. Your soul\'s purpose involves channeling divine love. Today, your spiritual sensitivity peaks.'
            };
            return descriptions[sign] || 'Your unique cosmic signature speaks today.';
        }

        function getSolarActivation(sign) {
            const activations = {
                'Aries': 'Your initiative and courage are amplified. Take that first step you\'ve been contemplating. Leadership opportunities present themselves—step forward with confidence.',
                'Taurus': 'Your senses are heightened. Pay attention to physical comfort, financial matters, and anything related to beauty or nature. Steady progress yields results today.',
                'Gemini': 'Your mind is electric. Conversations flow easily, ideas spark, and connections form naturally. Share your thoughts—they carry more weight than usual.',
                'Cancer': 'Your emotional radar is finely tuned. Home and family matters take priority. Trust your gut feelings—they\'re carrying important information today.',
                'Leo': 'Your creative heart opens wide. Express yourself boldly. Romance and creative projects flourish under today\'s energy. You\'re more magnetic than usual.',
                'Virgo': 'Your analytical abilities peak. Details that others miss are crystal clear to you. Health routines and organizational tasks flow with unusual ease.',
                'Libra': 'Your social grace is enhanced. Partnerships and negotiations favor you. Beauty matters more today—surround yourself with aesthetically pleasing environments.',
                'Scorpio': 'Your transformative power intensifies. Deep conversations, research, and psychological insights come naturally. Trust your instincts about hidden matters.',
                'Sagittarius': 'Your adventurous spirit soars. Learning, travel planning, and philosophical discussions energize you. Your optimism is contagious—spread it generously.',
                'Capricorn': 'Your ambition finds clear expression. Career moves and long-term planning favor you. Your natural authority commands respect—use it wisely.',
                'Aquarius': 'Your innovative mind activates. Original ideas flow, and group activities energize you. Your uniqueness is your superpower today—don\'t dim it.',
                'Pisces': 'Your spiritual channels open wide. Intuitive downloads, creative inspiration, and compassionate connections define your day. Trust the mystical.'
            };
            return activations[sign] || 'Your unique gifts activate today.';
        }

        function getRisingSignDescription(sign) {
            return `Your ${sign} Rising shapes how you meet the world and how others first perceive you. This is your social armor and your automatic response system—it colors every first impression and every new situation.`;
        }

        function getRisingActivation(sign) {
            const activations = {
                'Aries': 'You appear more dynamic and assertive today. First impressions favor bold introductions. People see your courage clearly.',
                'Taurus': 'You radiate calm stability. Others seek your grounding presence. Your physical presence carries weight.',
                'Gemini': 'Your wit and adaptability shine in social situations. Networking flows naturally. Quick thinking impresses.',
                'Cancer': 'Your nurturing energy is visible. Others feel safe with you. Emotional availability opens doors.',
                'Leo': 'Your charisma is undeniable. You naturally command attention. Creative self-expression attracts opportunity.',
                'Virgo': 'Your competence is evident. Others trust your attention to detail. Helpful suggestions are well-received.',
                'Libra': 'Your charm and grace smooth every interaction. Partnership opportunities arise. Beauty and diplomacy win.',
                'Scorpio': 'Your intensity creates intrigue. Others sense your depth. Powerful presence commands respect.',
                'Sagittarius': 'Your optimism is infectious. Adventure calls and others want to follow. Enthusiasm opens doors.',
                'Capricorn': 'Your professionalism shines. Career-related first impressions succeed. Authority is recognized.',
                'Aquarius': 'Your uniqueness attracts the right people. Innovative ideas are welcomed. Originality distinguishes you.',
                'Pisces': 'Your empathy draws others in. Creative and spiritual connections form easily. Compassion is visible.'
            };
            return activations[sign] || 'Your presentation aligns with your authentic self.';
        }

        function getMoonSignDescription(sign) {
            return `Your ${sign} Moon governs your emotional nature, instinctive reactions, and innermost needs. This is your private self—how you feel, what makes you secure, and how you nurture yourself and others.`;
        }

        function getMoonActivation(sign, moonPhase) {
            const baseActivation = {
                'Aries': 'Emotional energy runs high and fast. Process feelings through action. Don\'t let irritation fester—address it directly but kindly.',
                'Taurus': 'Seek comfort and security. Emotional stability comes through sensory pleasure. Take time for self-care rituals.',
                'Gemini': 'Talk through your feelings. Writing, conversations, and mental stimulation help process emotions. Avoid overthinking.',
                'Cancer': 'Emotions run deep and strong. Honor your need for nurturing—give and receive. Home is your sanctuary.',
                'Leo': 'Express your feelings creatively. Recognition and appreciation feed your emotional well-being. Share your heart.',
                'Virgo': 'Organize your way to emotional clarity. Practical tasks soothe anxiety. Helpful service lifts your mood.',
                'Libra': 'Seek balance in relationships. Harmony in your environment supports emotional peace. Beautiful surroundings help.',
                'Scorpio': 'Emotional intensity needs healthy outlets. Deep conversations, creative expression, or physical release help. Transform feelings into power.',
                'Sagittarius': 'Optimism is your emotional default. Freedom and adventure lift your spirits. Don\'t let others limit your joy.',
                'Capricorn': 'Emotional strength comes through achievement. Structure supports your feelings. Allow yourself to feel beneath the composure.',
                'Aquarius': 'Process emotions through intellectual understanding. Space and freedom matter. Connect with friends who understand.',
                'Pisces': 'Emotional sensitivity is heightened. Boundaries matter. Creative and spiritual practices channel overwhelming feelings.'
            };
            return (baseActivation[sign] || 'Honor your emotional needs.') + ` The ${moonPhase.phase} especially supports ${moonPhase.energy.split(',')[0].toLowerCase()}.`;
        }

        function getTransitForecast(sign) {
            const today = new Date();
            const dayOfWeek = today.getDay();
            const transits = [
                `Mercury's current position enhances communication and mental clarity for ${sign}. Ideas flow and connections strengthen.`,
                `Venus brings harmony to relationships and finances. Beauty and pleasure are favored for ${sign} today.`,
                `Mars energizes action and assertion. ${sign} has extra physical and motivational energy available.`,
                `Jupiter expands opportunities and optimism. ${sign} may encounter luck and growth in unexpected areas.`,
                `Saturn calls for discipline and structure. ${sign} benefits from focused, long-term thinking today.`,
                `The current planetary alignment supports ${sign}'s creative expression and authentic self-presentation.`,
                `Neptune's influence enhances ${sign}'s intuition and spiritual sensitivity. Dreams may carry messages.`
            ];
            return transits[dayOfWeek] + ' Trust your instincts about timing—the cosmic clock is working in your favor.';
        }

        // PHASE 2: Enhanced Chinese Zodiac Forecast
        function getEnhancedChineseZodiacForecast(chinese, moonPhase) {
            return `
                <div class="system-item">
                    <h4>Your Animal: ${chinese.animal}</h4>
                    <p>${getDetailedChineseDescription(chinese.animal)}</p>
                </div>
                <div class="system-item">
                    <h4>Your Element: ${chinese.element}</h4>
                    <p>${getDetailedElementDescription(chinese.element)}</p>
                </div>
                <div class="system-item">
                    <h4>Today's Animal Energy</h4>
                    <p>${getDailyAnimalEnergy(chinese.animal)}</p>
                </div>
                <div class="system-item">
                    <h4>Elemental Harmony</h4>
                    <p>${getElementalHarmony(chinese.element)}</p>
                </div>
                <div class="system-item">
                    <h4>Auspicious Directions & Colors</h4>
                    <p><strong>Lucky Direction:</strong> ${getLuckyDirection(chinese.animal)}<br>
                    <strong>Lucky Colors:</strong> ${getChineseColor(chinese.element)}<br>
                    <strong>Lucky Numbers:</strong> ${getLuckyNumbers(chinese.animal)}<br>
                    <strong>Avoid:</strong> ${getUnluckyElements(chinese.animal)}</p>
                </div>
            `;
        }

        function getDetailedChineseDescription(animal) {
            const descriptions = {
                'Rat': 'The Rat is first in the zodiac—clever, quick-witted, and resourceful. You possess natural charm and the ability to turn any situation to your advantage. Your instincts for opportunity are finely honed, and your social intelligence opens doors others don\'t even see.',
                'Ox': 'The Ox embodies diligence, dependability, and quiet strength. You are the foundation upon which great things are built. Your patience and persistence are legendary—you accomplish through steady effort what others cannot achieve through force.',
                'Tiger': 'The Tiger is brave, competitive, and unpredictable. You are a natural leader who inspires others through sheer presence and courage. Your protective instincts are fierce, and your confidence can move mountains.',
                'Rabbit': 'The Rabbit brings elegance, sensitivity, and diplomatic skill. You navigate social situations with grace and possess artistic sensibility that enriches everything you touch. Your gentle strength should not be underestimated.',
                'Dragon': 'The Dragon is the most powerful and auspicious sign—ambitious, energetic, and natural leaders. You carry imperial energy and the expectation of greatness. Your charisma is magnetic and your potential limitless.',
                'Snake': 'The Snake is wise, intuitive, and enigmatic. You possess deep intelligence and the patience to wait for perfect timing. Your insight into human nature and strategic mind make you formidable in any arena.',
                'Horse': 'The Horse embodies freedom, energy, and passionate independence. You need room to run and causes to champion. Your enthusiasm is infectious and your work ethic impressive when inspired.',
                'Goat': 'The Goat (or Sheep) brings creativity, gentleness, and artistic vision. You are the aesthetic heart of the zodiac—sensitive to beauty and harmony. Your compassion and imagination enrich the world.',
                'Monkey': 'The Monkey is clever, curious, and endlessly entertaining. You solve problems through wit and innovation, always finding the creative angle. Your intelligence is versatile and your charm disarming.',
                'Rooster': 'The Rooster is observant, hardworking, and confident. You speak your truth and honor your word. Your attention to detail and organizational skills are unmatched when focused.',
                'Dog': 'The Dog embodies loyalty, honesty, and a strong moral compass. You are the protector and the truth-teller—fiercely devoted to those you love. Your integrity is your greatest asset.',
                'Pig': 'The Pig brings generosity, sincerity, and good fortune. You enjoy life\'s pleasures without apology and share your abundance freely. Your kind heart and genuine nature attract lasting relationships.'
            };
            return descriptions[animal] || 'Your animal spirit carries unique wisdom.';
        }

        function getDetailedElementDescription(element) {
            const descriptions = {
                'Metal': 'Metal element brings determination, focus, and righteousness. You have strong will, clear values, and the ability to cut through confusion. Your precision and persistence make you formidable in achieving goals.',
                'Water': 'Water element brings wisdom, flexibility, and deep intuition. You adapt to circumstances while maintaining your essential nature. Your emotional intelligence and ability to flow around obstacles are your strengths.',
                'Wood': 'Wood element brings growth, creativity, and expansive vision. You are naturally optimistic and ethical, with a drive toward progress. Your generosity and idealism inspire others to reach higher.',
                'Fire': 'Fire element brings passion, charisma, and dynamic energy. You light up any room and inspire action in others. Your enthusiasm is contagious and your courage admirable.',
                'Earth': 'Earth element brings stability, patience, and practical wisdom. You are the reliable center around which others orbit. Your grounding presence and nurturing nature support everyone around you.'
            };
            return descriptions[element] || 'Your element adds unique qualities to your nature.';
        }

        function getDailyAnimalEnergy(animal) {
            const today = new Date();
            const dailyAnimals = ['Rat', 'Ox', 'Tiger', 'Rabbit', 'Dragon', 'Snake', 'Horse', 'Goat', 'Monkey', 'Rooster', 'Dog', 'Pig'];
            const todayAnimal = dailyAnimals[today.getDate() % 12];
            
            const compatibility = getAnimalCompatibility(animal, todayAnimal);
            return `Today carries ${todayAnimal} energy. ${compatibility} Your ${animal} wisdom ${getAnimalAdvice(animal, todayAnimal)}.`;
        }

        function getAnimalCompatibility(sign1, sign2) {
            // Simplified compatibility
            const allies = {
                'Rat': ['Dragon', 'Monkey'],
                'Ox': ['Snake', 'Rooster'],
                'Tiger': ['Horse', 'Dog'],
                'Rabbit': ['Goat', 'Pig'],
                'Dragon': ['Rat', 'Monkey'],
                'Snake': ['Ox', 'Rooster'],
                'Horse': ['Tiger', 'Dog'],
                'Goat': ['Rabbit', 'Pig'],
                'Monkey': ['Rat', 'Dragon'],
                'Rooster': ['Ox', 'Snake'],
                'Dog': ['Tiger', 'Horse'],
                'Pig': ['Rabbit', 'Goat']
            };
            
            if (sign1 === sign2) return 'This is a same-sign day—your energy is doubled and amplified.';
            if (allies[sign1]?.includes(sign2)) return `This is a highly auspicious day for you—${sign2} energy harmonizes beautifully with your ${sign1} nature.`;
            return `Moderate energy blend—${sign2}\'s influence offers complementary lessons for your ${sign1} path.`;
        }

        function getAnimalAdvice(yourAnimal, todayAnimal) {
            return `suggests balancing ${yourAnimal} strengths with ${todayAnimal} qualities today`;
        }

        function getElementalHarmony(element) {
            const cycle = {
                'Metal': { generates: 'Water', generated: 'Earth', controls: 'Wood', controlled: 'Fire' },
                'Water': { generates: 'Wood', generated: 'Metal', controls: 'Fire', controlled: 'Earth' },
                'Wood': { generates: 'Fire', generated: 'Water', controls: 'Earth', controlled: 'Metal' },
                'Fire': { generates: 'Earth', generated: 'Wood', controls: 'Metal', controlled: 'Water' },
                'Earth': { generates: 'Metal', generated: 'Fire', controls: 'Water', controlled: 'Wood' }
            };
            
            const c = cycle[element];
            return `Your ${element} element generates ${c.generates} (supportive energy) and is generated by ${c.generated} (receiving energy). You naturally control ${c.controls} and are controlled by ${c.controlled}. Today, lean into ${c.generates} activities for flowing creation.`;
        }

        function getLuckyDirection(animal) {
            const directions = {
                'Rat': 'North, Northwest',
                'Ox': 'Southeast, North',
                'Tiger': 'South, East',
                'Rabbit': 'East, Southeast, South',
                'Dragon': 'North, West, Northwest',
                'Snake': 'South, Southwest',
                'Horse': 'South, East',
                'Goat': 'East, Southeast',
                'Monkey': 'North, West',
                'Rooster': 'West, Southwest',
                'Dog': 'East, South',
                'Pig': 'Southeast, Northeast'
            };
            return directions[animal] || 'All directions hold potential';
        }

        function getLuckyNumbers(animal) {
            const numbers = {
                'Rat': '2, 3, 7',
                'Ox': '1, 4, 9',
                'Tiger': '1, 3, 4',
                'Rabbit': '3, 4, 9',
                'Dragon': '1, 6, 7',
                'Snake': '2, 8, 9',
                'Horse': '2, 3, 7',
                'Goat': '2, 7, 8',
                'Monkey': '4, 9',
                'Rooster': '5, 7, 8',
                'Dog': '3, 4, 9',
                'Pig': '2, 5, 8'
            };
            return numbers[animal] || '1, 8, 9';
        }

        function getUnluckyElements(animal) {
            const avoid = {
                'Rat': 'Horse direction (South), number 5, yellow/brown colors',
                'Ox': 'Goat direction, number 6, green colors when in conflict',
                'Tiger': 'Monkey energy, Southwest direction',
                'Rabbit': 'Rooster energy, West direction',
                'Dragon': 'Dog energy, Southeast direction when in conflict',
                'Snake': 'Pig energy, Northwest direction',
                'Horse': 'Rat energy, North direction',
                'Goat': 'Ox energy, Northeast direction',
                'Monkey': 'Tiger energy, Northeast direction',
                'Rooster': 'Rabbit energy, East direction',
                'Dog': 'Dragon energy, Southeast direction',
                'Pig': 'Snake energy, Southeast direction'
            };
            return avoid[animal] || 'Nothing specific—remain balanced';
        }

        // PHASE 2: Enhanced Numerology Forecast
        function getEnhancedNumerologyForecast(lifePath, personalYear, birth) {
            const today = new Date();
            const personalMonth = ((today.getMonth() + 1) + personalYear) % 9 || 9;
            const personalDay = (birth.getDate() + today.getDate() + (today.getMonth() + 1)) % 9 || 9;
            
            return `
                <div class="system-item">
                    <h4>Life Path ${lifePath}</h4>
                    <p>${getDetailedLifePathDescription(lifePath)}</p>
                </div>
                <div class="system-item">
                    <h4>Personal Year ${personalYear}</h4>
                    <p>${getDetailedPersonalYearDescription(personalYear)}</p>
                </div>
                <div class="system-item">
                    <h4>Personal Month ${personalMonth}</h4>
                    <p>${getPersonalMonthDescription(personalMonth, personalYear)}</p>
                </div>
                <div class="system-item">
                    <h4>Personal Day ${personalDay}</h4>
                    <p>${getDetailedPersonalDayDescription(personalDay)}</p>
                </div>
                <div class="system-item">
                    <h4>Today's Universal Number</h4>
                    <p>${getUniversalDayGuidance(today)}</p>
                </div>
            `;
        }

        function getDetailedLifePathDescription(number) {
            const descriptions = {
                1: '<strong>The Pioneer & Leader</strong> - You are here to develop independence, individuality, and leadership. Your soul chose this path to learn self-reliance and to inspire others through original action. You are meant to be first—first to try, first to lead, first to stand alone when necessary. Success comes when you trust your innovative ideas and have the courage to implement them.',
                2: '<strong>The Diplomat & Peacemaker</strong> - You are here to develop cooperation, sensitivity, and harmony. Your soul chose this path to learn the art of partnership and the power of patience. You are meant to bring balance—to situations, relationships, and groups. Success comes when you trust your intuition and allow your natural healing presence to work.',
                3: '<strong>The Communicator & Creator</strong> - You are here to develop self-expression, creativity, and joy. Your soul chose this path to learn that your voice matters and your artistic vision enriches the world. You are meant to inspire—through words, art, performance, or simple presence. Success comes when you share your gifts without fear.',
                4: '<strong>The Builder & Organizer</strong> - You are here to develop discipline, stability, and practical mastery. Your soul chose this path to learn that lasting value is built step by step. You are meant to create foundations—systems, structures, traditions that serve others. Success comes when you honor the process over the shortcut.',
                5: '<strong>The Freedom Seeker & Adventurer</strong> - You are here to develop versatility, freedom, and constructive change. Your soul chose this path to learn that variety is indeed the spice of life and stagnation is the enemy. You are meant to experience—travel, taste, try everything. Success comes when you embrace change as the only constant.',
                6: '<strong>The Nurturer & Healer</strong> - You are here to develop responsibility, love, and service. Your soul chose this path to learn that home, family, and community are sacred. You are meant to nurture—people, places, beauty, harmony. Success comes when you balance giving with receiving.',
                7: '<strong>The Seeker & Mystic</strong> - You are here to develop wisdom, spirituality, and analytical depth. Your soul chose this path to look beneath the surface and trust the invisible. You are meant to understand—life\'s mysteries, human nature, spiritual truth. Success comes when you trust your inner knowing over external validation.',
                8: '<strong>The Powerhouse & Manifestor</strong> - You are here to develop material mastery, authority, and abundance. Your soul chose this path to learn that power is responsibility and abundance is meant to be shared. You are meant to build empires—business, financial, structural. Success comes when you use power for collective benefit.',
                9: '<strong>The Humanitarian & Wise One</strong> - You are here to develop universal love, completion, and letting go. Your soul chose this path to learn that giving without attachment is the highest form of receiving. You are meant to serve—causes larger than yourself. Success comes when you release what has ended and trust the new.',
                11: '<strong>The Illuminator & Inspirational Leader</strong> - Master Number. You are here to channel higher wisdom and inspire through example. Your intuition is a direct line to spiritual truth. You are meant to light the way for others while managing heightened sensitivity. Success comes when you trust your visions and share them courageously.',
                22: '<strong>The Master Builder & Visionary</strong> - Master Number. You are here to turn dreams into reality on a grand scale. You combine the intuition of 11 with the practical power of 4. You are meant to build structures that serve humanity. Success comes when you think big while attending to details.',
                33: '<strong>The Master Teacher & Healer</strong> - Master Number. You are here to heal and teach through love. You combine the higher octaves of 6\'s nurturing with spiritual mastery. You are meant to be a channel for cosmic compassion. Success comes when you embody the love you teach.'
            };
            return descriptions[number] || 'Your life path carries unique purpose and lessons.';
        }

        function getDetailedPersonalYearDescription(number) {
            const descriptions = {
                1: '<strong>Year of New Beginnings</strong> - This is your launch year. Seeds planted now set the tone for the next 9-year cycle. Initiative is rewarded. Independence is necessary. It\'s time to start that project, make that change, step into that new identity. Don\'t wait for permission—pioneer forward.',
                2: '<strong>Year of Partnership</strong> - This is your year of patience, cooperation, and relationship focus. Growth comes through others. Rushing defeats you; waiting rewards you. Pay attention to the details and the partnerships—both hold your keys.',
                3: '<strong>Year of Expression</strong> - This is your year to speak, create, and share. Your voice carries extra weight. Creative projects flourish. Joy is not optional—it\'s necessary medicine. Express yourself in every possible way.',
                4: '<strong>Year of Foundation</strong> - This is your year to build, organize, and establish. Hard work pays off. Structure matters. Create the systems and foundations that will support future dreams. This is a working year—embrace it.',
                5: '<strong>Year of Change</strong> - This is your year of freedom, adventure, and transformation. Expect the unexpected. Flexibility is survival. Travel, variety, and new experiences call. Don\'t cling to what needs to change.',
                6: '<strong>Year of Responsibility</strong> - This is your year of home, family, and service. Relationships demand attention. Beautify your environment. Take responsibility for what\'s yours. Love in action is your theme.',
                7: '<strong>Year of Inner Work</strong> - This is your year of reflection, study, and spiritual deepening. Solitude is productive. Analysis yields insight. Trust your inner wisdom over external advice. Rest is not laziness—it\'s essential.',
                8: '<strong>Year of Abundance</strong> - This is your year of power, manifestation, and material success. Financial and career opportunities peak. Authority increases. Use your power wisely—karma is immediate this year.',
                9: '<strong>Year of Completion</strong> - This is your year of endings, release, and humanitarian service. Let go of what\'s finished. Clear the decks. Serve causes larger than yourself. What you release makes room for Year 1\'s new beginnings.'
            };
            return descriptions[number] || 'This year carries transformative potential.';
        }

        function getPersonalMonthDescription(month, year) {
            const base = month + year;
            const reduced = base > 9 ? (base.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0)) : base;
            
            const themes = {
                1: 'Initiation energy peaks this month. Start projects, assert yourself, lead.',
                2: 'Patience and partnership are this month\'s teachers. Collaborate, wait, receive.',
                3: 'Express and create this month. Your voice and vision matter now.',
                4: 'Build and organize this month. Structure supports your dreams.',
                5: 'Change accelerates this month. Adapt, explore, embrace variety.',
                6: 'Home and relationships need attention this month. Nurture what matters.',
                7: 'Go within this month. Study, reflect, trust your intuition.',
                8: 'Manifestation power peaks this month. Focus on career and finances.',
                9: 'Complete and release this month. Clear space for the new.'
            };
            
            return themes[reduced] || 'This month brings unique lessons and opportunities.';
        }

        function getDetailedPersonalDayDescription(number) {
            const descriptions = {
                1: '<strong>Initiative Day</strong> - Today favors bold action, new starts, and independent thinking. Lead with your ideas. Don\'t wait for group consensus—move first.',
                2: '<strong>Partnership Day</strong> - Today favors cooperation, patience, and attention to others. Listen more than you speak. Relationships progress through small gestures.',
                3: '<strong>Expression Day</strong> - Today favors creativity, communication, and social activity. Share your ideas. Write, speak, create. Joy is productive today.',
                4: '<strong>Work Day</strong> - Today favors practical tasks, organization, and steady progress. Get things done. Details matter. Build systematically.',
                5: '<strong>Change Day</strong> - Today favors flexibility, variety, and embracing the unexpected. Routine is your enemy. Adventure calls. Adapt quickly.',
                6: '<strong>Service Day</strong> - Today favors helping others, beautifying spaces, and nurturing connections. Home and family take priority. Love in action.',
                7: '<strong>Reflection Day</strong> - Today favors solitude, study, and inner work. Quiet productivity beats social noise. Trust your intuition.',
                8: '<strong>Power Day</strong> - Today favors career moves, financial decisions, and authoritative action. Your influence is magnified. Use it wisely.',
                9: '<strong>Completion Day</strong> - Today favors finishing projects, releasing what\'s done, and humanitarian thinking. Clear the old to welcome the new.'
            };
            return descriptions[number] || 'Today brings unique numerological energy.';
        }

        function getUniversalDayGuidance(today) {
            const universalDay = (today.getDate() + (today.getMonth() + 1) + today.getFullYear()) % 9 || 9;
            const guidance = {
                1: `Universal Day ${universalDay}: Collective energy supports new beginnings and leadership. The world is ready for pioneers today.`,
                2: `Universal Day ${universalDay}: Collective energy supports partnership and peace. Diplomacy succeeds globally today.`,
                3: `Universal Day ${universalDay}: Collective energy supports expression and creativity. Communication flows worldwide today.`,
                4: `Universal Day ${universalDay}: Collective energy supports building and structure. Practical progress is favored today.`,
                5: `Universal Day ${universalDay}: Collective energy supports change and freedom. Expect surprises globally today.`,
                6: `Universal Day ${universalDay}: Collective energy supports service and family. Community matters today.`,
                7: `Universal Day ${universalDay}: Collective energy supports reflection and spirituality. Wisdom surfaces today.`,
                8: `Universal Day ${universalDay}: Collective energy supports power and abundance. Material matters progress today.`,
                9: `Universal Day ${universalDay}: Collective energy supports completion and compassion. Endings and humanitarian focus today.`
            };
            return guidance[universalDay] || 'Today carries unique universal energy.';
        }

        // PHASE 2: Enhanced Gematria Forecast
        function getEnhancedGematriaForecast(name, value, birth) {
            const today = new Date();
            const dateValue = today.getFullYear() + (today.getMonth() + 1) + today.getDate();
            const resonance = (value + dateValue) % 999;
            const reducedName = reduceToSingleDigit(value);
            const reducedDate = reduceToSingleDigit(dateValue);
            const combinedReduced = reduceToSingleDigit(resonance);
            
            return `
                <div class="system-item">
                    <h4>Your Name Value: ${value} (reduces to ${reducedName})</h4>
                    <p>${getNameValueInterpretation(value, reducedName, name)}</p>
                </div>
                <div class="system-item">
                    <h4>Today's Date Value: ${dateValue} (reduces to ${reducedDate})</h4>
                    <p>${getDateValueInterpretation(dateValue, reducedDate)}</p>
                </div>
                <div class="system-item">
                    <h4>Name + Date Resonance: ${resonance} (reduces to ${combinedReduced})</h4>
                    <p>${getResonanceInterpretation(resonance, combinedReduced)}</p>
                </div>
                <div class="system-item">
                    <h4>Today's Gematria Guidance</h4>
                    <p>${getGematriaGuidance(reducedName, reducedDate, combinedReduced)}</p>
                </div>
            `;
        }

        function reduceToSingleDigit(num) {
            while (num > 9 && num !== 11 && num !== 22 && num !== 33) {
                num = num.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0);
            }
            return num;
        }

        function getNameValueInterpretation(value, reduced, name) {
            const themes = {
                1: 'leadership, independence, and pioneering spirit',
                2: 'partnership, diplomacy, and receptive energy',
                3: 'creativity, expression, and joyful communication',
                4: 'stability, structure, and practical foundation',
                5: 'freedom, change, and dynamic experience',
                6: 'nurturing, responsibility, and harmonious service',
                7: 'wisdom, spirituality, and analytical depth',
                8: 'power, abundance, and material mastery',
                9: 'completion, humanitarianism, and universal love',
                11: 'illumination, intuition, and inspirational leadership',
                22: 'master building, practical vision, and large-scale impact',
                33: 'master teaching, healing presence, and cosmic love'
            };
            return `The name "${name}" carries a vibrational signature of ${themes[reduced] || 'unique purpose'}. This frequency is your energetic calling card—it influences how others perceive you and what you naturally attract.`;
        }

        function getDateValueInterpretation(value, reduced) {
            const themes = {
                1: 'initiation and new beginning energy',
                2: 'partnership and patience vibration',
                3: 'creative expression and communication flow',
                4: 'building and organization frequency',
                5: 'change and freedom vibration',
                6: 'service and harmony energy',
                7: 'reflection and spiritual depth',
                8: 'manifestation and power frequency',
                9: 'completion and release energy'
            };
            return `Today's date creates a field of ${themes[reduced] || 'transformative energy'}. This universal vibration colors everything that happens today—work with it rather than against it.`;
        }

        function getResonanceInterpretation(resonance, reduced) {
            const quality = resonance % 7 === 0 ? 'exceptionally harmonious' : 
                           resonance % 3 === 0 ? 'creatively flowing' :
                           resonance % 2 === 0 ? 'balanced and receptive' : 'dynamically charged';
            return `Your name frequency meeting today's date frequency creates a ${quality} resonance field. This ${reduced}-energy combination supports activities aligned with ${getReducedTheme(reduced)}.`;
        }

        function getReducedTheme(num) {
            const themes = {
                1: 'leadership, starting projects, and individual initiative',
                2: 'teamwork, patience, and relational harmony',
                3: 'creative expression, communication, and joyful sharing',
                4: 'practical work, organization, and foundation building',
                5: 'adventure, flexibility, and embracing change',
                6: 'service, home, family, and nurturing connections',
                7: 'study, reflection, and spiritual development',
                8: 'career advancement, financial decisions, and manifestation',
                9: 'completion, generosity, and humanitarian service'
            };
            return themes[num] || 'transformative growth';
        }

        function getGematriaGuidance(nameNum, dateNum, combinedNum) {
            if (nameNum === dateNum) {
                return `Your name frequency perfectly matches today's date frequency—this is an amplification day. Your natural gifts are doubled. Lean into your strengths with confidence.`;
            }
            if (combinedNum === 1) {
                return `Combined resonance points to initiation. Today is excellent for beginning new projects or asserting your leadership.`;
            }
            return `Today's combined ${combinedNum}-frequency suggests focusing on ${getReducedTheme(combinedNum)}. Let your natural ${getReducedTheme(nameNum)} meet the day's ${getReducedTheme(dateNum)} energy.`;
        }

        // PHASE 2: Enhanced Action Items
        function getEnhancedActionItems(zodiac, risingSign, moonSign, chinese, lifePath, personalYear, planetaryHour, moonPhase, focus, challenge) {
            let items = [];
            
            items.push(`
                <div class="action-item cosmic-timing">
                    <h4>⏰ Right Now: Hour of ${planetaryHour.planet} ${planetaryHour.symbol}</h4>
                    <p><strong>Best for:</strong> ${planetaryHour.activity}</p>
                    <p><strong>Energy:</strong> ${planetaryHour.energy}</p>
                    <p><strong>Wear/Use:</strong> ${planetaryHour.color} colors</p>
                </div>
            `);
            
            items.push(`
                <div class="action-item">
                    <h4>🌅 Morning Power Hour (6-9 AM)</h4>
                    <p>${getEnhancedMorningAction(zodiac.name, risingSign, lifePath)}</p>
                </div>
            `);
            
            items.push(`
                <div class="action-item">
                    <h4>☀️ Peak Productivity (10 AM - 2 PM)</h4>
                    <p>${getEnhancedAfternoonAction(zodiac.name, chinese, personalYear, focus)}</p>
                </div>
            `);
            
            items.push(`
                <div class="action-item">
                    <h4>🌙 Evening Integration (6-9 PM)</h4>
                    <p>${getEnhancedEveningAction(moonSign, moonPhase, lifePath)}</p>
                </div>
            `);
            
            if (challenge) {
                items.push(`
                    <div class="action-item challenge">
                        <h4>⚡ Challenge-Specific Guidance</h4>
                        <p><strong>Regarding:</strong> "${challenge}"</p>
                        <p>${getEnhancedChallengeGuidance(zodiac, chinese, moonSign, lifePath, moonPhase, challenge)}</p>
                    </div>
                `);
            }
            
            items.push(`
                <div class="action-item moon-ritual">
                    <h4>${moonPhase.symbol} Moon Phase Ritual</h4>
                    <p><strong>Phase:</strong> ${moonPhase.phase}</p>
                    <p><strong>Action:</strong> ${moonPhase.action}</p>
                </div>
            `);
            
            return items.join('');
        }

        function getEnhancedMorningAction(sun, rising, lifePath) {
            const sunAction = {
                'Aries': 'Start with physical movement—even 10 minutes activates your fire',
                'Taurus': 'Begin with sensory pleasure—quality coffee, comfortable clothing, beauty',
                'Gemini': 'Read or journal first thing—your mind needs morning stimulation',
                'Cancer': 'Check in emotionally—how do you feel? Honor it before moving',
                'Leo': 'Set creative intentions—what do you want to express today?',
                'Virgo': 'Review your plan—organization in the morning creates afternoon freedom',
                'Libra': 'Create beauty in your space—aesthetics affect your energy',
                'Scorpio': 'Deep meditation or shadow journaling—access your depths',
                'Sagittarius': 'Read something inspiring—philosophy, adventure, wisdom',
                'Capricorn': 'Review goals and priorities—strategic morning sets up success',
                'Aquarius': 'Brainstorm innovation—your morning mind is most original',
                'Pisces': 'Spiritual practice or creativity—connect to source first'
            };
            
            const risingBoost = rising ? ` Your ${rising.name} rising adds ${getRisingStyle(rising.name)} to how you present this energy.` : '';
            const lifePathBoost = ` Life Path ${lifePath} suggests focusing on ${getLifePathFocus(lifePath).split(' and ')[0]}.`;
            
            return (sunAction[sun] || 'Begin with centering practices') + risingBoost + lifePathBoost;
        }

        function getEnhancedAfternoonAction(sun, chinese, personalYear, focus) {
            let baseAction = `Peak ${sun} energy combines with ${chinese.element} ${chinese.animal} persistence. `;
            
            if (focus === 'career') baseAction += 'Schedule important meetings and career-advancing work now.';
            else if (focus === 'love') baseAction += 'Make meaningful connections—reach out with authentic intention.';
            else if (focus === 'health') baseAction += 'This is optimal workout time—your energy supports physical achievement.';
            else if (focus === 'spiritual') baseAction += 'Practice presence in action—make ordinary tasks sacred.';
            else if (focus === 'finances') baseAction += 'Financial decisions and income-generating activities favor you now.';
            else baseAction += 'Your most important work belongs here—give it your peak energy.';
            
            baseAction += ` Personal Year ${personalYear} energy: ${getPersonalYearFocus(personalYear)}`;
            return baseAction;
        }

        function getEnhancedEveningAction(moonSign, moonPhase, lifePath) {
            const moonAction = moonSign ? `Your ${moonSign.name} Moon needs ${getMoonNeed(moonSign.name)} in the evening. ` : '';
            return moonAction + `The ${moonPhase.phase} supports ${moonPhase.energy.split(',')[0].toLowerCase()}. Life Path ${lifePath} benefits from evening reflection on ${getLifePathFocus(lifePath).split(' and ')[0]}.`;
        }

        function getMoonNeed(sign) {
            const needs = {
                'Aries': 'active unwinding—exercise or energetic activity',
                'Taurus': 'comfort rituals—good food, soft textures, beauty',
                'Gemini': 'conversation or reading—mental processing time',
                'Cancer': 'nurturing environment—home, family, emotional safety',
                'Leo': 'creative expression or appreciation—feel special',
                'Virgo': 'organization and closure—tie up loose ends',
                'Libra': 'harmony and beauty—peaceful environment',
                'Scorpio': 'depth and intimacy—meaningful connection',
                'Sagittarius': 'inspiration and adventure—even if just in books or plans',
                'Capricorn': 'achievement review—acknowledge what you accomplished',
                'Aquarius': 'freedom and friendship—social connection on your terms',
                'Pisces': 'creative or spiritual practice—transcendence'
            };
            return needs[sign] || 'rest and integration';
        }

        function getEnhancedChallengeGuidance(zodiac, chinese, moonSign, lifePath, moonPhase, challenge) {
            return `Your ${zodiac.name} determination and ${chinese.animal} wisdom suggest approaching "${challenge}" through strategic patience rather than force. ` +
                   `${moonSign ? `Your ${moonSign.name} Moon may create emotional reactions—acknowledge them, then choose response over reaction. ` : ''}` +
                   `Life Path ${lifePath} indicates this challenge is teaching you something essential about ${getLifePathFocus(lifePath)}. ` +
                   `The ${moonPhase.phase} specifically supports ${moonPhase.action.toLowerCase()} as your approach.`;
        }

        function getNumerologyForecast(lifePath, personalYear, birthDate) {
            const today = new Date();
            const birth = new Date(birthDate);
            const personalDay = (birth.getDate() + today.getDate() + (today.getMonth() + 1)) % 9 || 9;
            
            return `
                <div class="system-item">
                    <h4>Life Path ${lifePath}</h4>
                    <p>${getLifePathDescription(lifePath)} This is your soul's purpose and natural operating frequency.</p>
                </div>
                <div class="system-item">
                    <h4>Personal Year ${personalYear}</h4>
                    <p>${getPersonalYearDescription(personalYear)} This year's theme shapes how today's energy manifests for you.</p>
                </div>
                <div class="system-item">
                    <h4>Personal Day ${personalDay}</h4>
                    <p>${getPersonalDayDescription(personalDay)} Today's specific vibration guides your actions and decisions.</p>
                </div>
            `;
        }

        function getGematriaForecast(name, value, birthDate) {
            const today = new Date();
            const dateValue = today.getFullYear() + (today.getMonth() + 1) + today.getDate();
            const resonance = (value + dateValue) % 999;
            
            return `
                <div class="system-item">
                    <h4>Your Name Value: ${value}</h4>
                    <p>The gematria value of "${name}" carries the frequency of ${getGematriaTheme(value)}. This is your vibrational signature.</p>
                </div>
                <div class="system-item">
                    <h4>Today's Date Value: ${dateValue}</h4>
                    <p>Today carries the frequency of ${getGematriaTheme(dateValue)}, creating a specific energetic field for manifestation.</p>
                </div>
                <div class="system-item">
                    <h4>Name + Date Resonance: ${resonance}</h4>
                    <p>The interaction between your name and today creates a ${resonance % 7 === 0 ? 'highly favorable' : 'supportive'} resonance field. This amplifies your natural abilities in ${getGematriaApplication(resonance % 7)}.</p>
                </div>
            `;
        }

        function getActionItems(zodiac, chinese, lifePath, personalYear, focus, challenge) {
            let items = [];
            
            items.push(`
                <div class="action-item">
                    <h4>Morning (6-9 AM)</h4>
                    <p>Begin with ${getMorningAction(zodiac.name, lifePath)}. Your ${zodiac.name} sun and Life Path ${lifePath} are most aligned during early hours.</p>
                </div>
            `);
            
            items.push(`
                <div class="action-item">
                    <h4>Afternoon (12-3 PM)</h4>
                    <p>${getAfternoonAction(chinese.animal, personalYear, focus)}. This is your peak creative/productive window.</p>
                </div>
            `);
            
            items.push(`
                <div class="action-item">
                    <h4>Evening (6-9 PM)</h4>
                    <p>${getEveningAction(zodiac.name, lifePath)}. Use this time for integration and reflection.</p>
                </div>
            `);
            
            if (challenge) {
                items.push(`
                    <div class="action-item">
                        <h4>Challenge-Specific Guidance</h4>
                        <p>Regarding "${challenge}": ${getChallengeGuidance(zodiac.name, chinese.animal, lifePath)}</p>
                    </div>
                `);
            }
            
            return items.join('');
        }

        // Helper functions for descriptions
        function getZodiacDescription(sign) {
            const descriptions = {
                'Aries': 'Bold and pioneering,',
                'Taurus': 'Grounded and persistent,',
                'Gemini': 'Curious and adaptable,',
                'Cancer': 'Nurturing and intuitive,',
                'Leo': 'Creative and confident,',
                'Virgo': 'Analytical and detail-oriented,',
                'Libra': 'Harmonious and diplomatic,',
                'Scorpio': 'Intense and transformative,',
                'Sagittarius': 'Philosophical and adventurous,',
                'Capricorn': 'Ambitious and disciplined,',
                'Aquarius': 'Innovative and humanitarian,',
                'Pisces': 'Compassionate and mystical,'
            };
            return descriptions[sign] || '';
        }

        function getZodiacTrait(sign) {
            const traits = {
                'Aries': 'bold action and leadership',
                'Taurus': 'stability and sensory pleasure',
                'Gemini': 'communication and learning',
                'Cancer': 'emotional depth and nurturing',
                'Leo': 'creative expression and recognition',
                'Virgo': 'service and practical improvement',
                'Libra': 'balance and partnership',
                'Scorpio': 'depth and transformation',
                'Sagittarius': 'expansion and wisdom-seeking',
                'Capricorn': 'achievement and structure',
                'Aquarius': 'innovation and collective progress',
                'Pisces': 'spirituality and compassion'
            };
            return traits[sign] || 'growth';
        }

        function getChineseDescription(animal) {
            const descriptions = {
                'Rat': 'Clever and resourceful,',
                'Ox': 'Diligent and dependable,',
                'Tiger': 'Brave and confident,',
                'Rabbit': 'Gentle and compassionate,',
                'Dragon': 'Ambitious and charismatic,',
                'Snake': 'Wise and intuitive,',
                'Horse': 'Energetic and free-spirited,',
                'Goat': 'Creative and gentle,',
                'Monkey': 'Intelligent and playful,',
                'Rooster': 'Confident and organized,',
                'Dog': 'Loyal and honest,',
                'Pig': 'Generous and sincere,'
            };
            return descriptions[animal] || '';
        }

        function getElementQuality(element) {
            const qualities = {
                'Metal': 'structure and precision',
                'Water': 'adaptability and depth',
                'Wood': 'growth and expansion',
                'Fire': 'passion and transformation',
                'Earth': 'stability and grounding'
            };
            return qualities[element] || 'balance';
        }

        function getChineseColor(element) {
            const colors = {
                'Metal': 'White, Gold, Silver',
                'Water': 'Black, Blue, Purple',
                'Wood': 'Green, Teal',
                'Fire': 'Red, Orange, Pink',
                'Earth': 'Yellow, Brown, Beige'
            };
            return colors[element] || 'Rainbow';
        }

        function getChineseActivity(animal) {
            const activities = {
                'Rat': 'networking and strategic planning',
                'Ox': 'focused work and building foundations',
                'Tiger': 'taking bold action and leadership',
                'Rabbit': 'creative projects and social connections',
                'Dragon': 'ambitious pursuits and public visibility',
                'Snake': 'deep thinking and strategic moves',
                'Horse': 'travel and freedom-seeking',
                'Goat': 'artistic expression and collaboration',
                'Monkey': 'problem-solving and innovation',
                'Rooster': 'organization and communication',
                'Dog': 'loyalty-building and community service',
                'Pig': 'generosity and celebration'
            };
            return activities[animal] || 'purposeful action';
        }

        function getLifePathDescription(number) {
            const descriptions = {
                1: 'The Leader - Independent and pioneering.',
                2: 'The Diplomat - Cooperative and harmonious.',
                3: 'The Communicator - Creative and expressive.',
                4: 'The Builder - Practical and grounded.',
                5: 'The Freedom Seeker - Adventurous and dynamic.',
                6: 'The Nurturer - Responsible and caring.',
                7: 'The Seeker - Analytical and spiritual.',
                8: 'The Powerhouse - Ambitious and authoritative.',
                9: 'The Humanitarian - Compassionate and wise.',
                11: 'The Illuminator - Intuitive and inspirational.',
                22: 'The Master Builder - Visionary and powerful.',
                33: 'The Master Teacher - Compassionate healer.'
            };
            return descriptions[number] || 'The Seeker';
        }

        function getPersonalYearDescription(number) {
            const descriptions = {
                1: 'New Beginnings - This is a year of fresh starts and initiative.',
                2: 'Partnership - Focus on cooperation and relationships.',
                3: 'Creative Expression - Time for communication and creativity.',
                4: 'Foundation Building - Establish stability and structure.',
                5: 'Change and Freedom - Embrace transformation and adventure.',
                6: 'Responsibility - Focus on home, family, and service.',
                7: 'Spiritual Growth - Deepen inner knowledge and reflection.',
                8: 'Power and Abundance - Manifest material success.',
                9: 'Completion - Release the old and prepare for new cycles.'
            };
            return descriptions[number] || 'Transformation';
        }

        function getPersonalDayDescription(number) {
            const descriptions = {
                1: 'Initiative and Leadership - Take charge of your day.',
                2: 'Cooperation - Work with others harmoniously.',
                3: 'Expression - Communicate your ideas creatively.',
                4: 'Organization - Focus on practical tasks.',
                5: 'Flexibility - Adapt to changing circumstances.',
                6: 'Service - Help others and nurture relationships.',
                7: 'Reflection - Spend time in contemplation.',
                8: 'Achievement - Focus on tangible results.',
                9: 'Completion - Finish what you started.'
            };
            return descriptions[number] || 'Balance';
        }

        function getGematriaTheme(value) {
            const reduced = value.toString().split('').reduce((a, b) => parseInt(a) + parseInt(b), 0) % 9 || 9;
            const themes = [
                '', 'leadership and new beginnings', 'partnership and balance', 
                'creative expression', 'stability and foundation', 'change and freedom',
                'nurturing and responsibility', 'wisdom and spirituality', 
                'power and manifestation', 'completion and humanitarianism'
            ];
            return themes[reduced] || 'transformation';
        }

        function getGematriaApplication(value) {
            const applications = [
                'manifesting new opportunities', 'building partnerships',
                'creative communication', 'establishing foundations',
                'embracing change', 'service to others',
                'spiritual insight', 'material success'
            ];
            return applications[value % applications.length];
        }

        function getMorningAction(sign, lifePath) {
            const morning = {
                'Aries': 'physical exercise or energetic movement',
                'Taurus': 'grounding meditation or sensory ritual',
                'Gemini': 'journaling or learning something new',
                'Cancer': 'emotional check-in or creative visualization',
                'Leo': 'affirmations or creative planning',
                'Virgo': 'organization or detailed planning',
                'Libra': 'beauty ritual or harmonizing your space',
                'Scorpio': 'deep meditation or shadow work',
                'Sagittarius': 'inspirational reading or goal-setting',
                'Capricorn': 'strategic planning or reviewing goals',
                'Aquarius': 'innovation brainstorming or future visioning',
                'Pisces': 'spiritual practice or artistic expression'
            };
            return morning[sign] || 'mindful meditation';
        }

        function getAfternoonAction(animal, personalYear, focus) {
            if (focus === 'career') return 'Focus on your most important work task or have that crucial conversation';
            if (focus === 'love') return 'Reach out to someone you care about with authentic vulnerability';
            if (focus === 'health') return 'Take a mindful movement break or prepare a nourishing meal';
            if (focus === 'spiritual') return 'Practice presence or study spiritual teachings';
            return 'Work on your highest priority project with focused energy';
        }

        function getEveningAction(sign, lifePath) {
            return 'Journal about today\'s insights and set intentions for tomorrow. Your ' + sign + ' nature benefits from reflection and conscious closure.';
        }

        function getChallengeGuidance(sign, animal, lifePath) {
            return 'Your ' + sign + ' determination combined with ' + animal + ' wisdom suggests approaching this challenge through patience and strategic action rather than force. Life Path ' + lifePath + ' indicates this obstacle is teaching you a specific soul lesson about your purpose.';
        }

        // ========================================
        // PHASE 2: WEEKLY/MONTHLY/YEARLY HELPERS
        // ========================================

        // Weekly Helpers
        function getWeeklyTheme(zodiac, chinese, personalYear, moonPhase) {
            return `Your ${zodiac.name} drive meets ${chinese.element} ${chinese.animal} persistence this week. Personal Year ${personalYear} energy shapes opportunities. The ${moonPhase.phase} sets the emotional tone for the week's beginning.`;
        }

        function getWeeklyOpportunity(lifePath, personalYear, focus) {
            const focusMap = {
                'career': 'Career advancement through strategic visibility',
                'love': 'Deepening existing connections or meeting new potentials',
                'health': 'Establishing sustainable wellness routines',
                'spiritual': 'Breakthrough insights through consistent practice',
                'finances': 'Identifying new income streams or reducing expenses'
            };
            return (focusMap[focus] || 'Multi-dimensional growth across life areas') + `. Life Path ${lifePath} in Year ${personalYear} creates momentum for ${getLifePathFocus(lifePath)}.`;
        }

        function getWeeklyChallenge(zodiac, chinese, challenge) {
            const base = `${zodiac.name} impatience meeting ${chinese.animal} intensity may create friction.`;
            return challenge ? `${base} Your stated challenge ("${challenge}") may surface for resolution this week.` : base;
        }

        function getKeyDayOfWeek(zodiac, lifePath) {
            const signDays = {
                'Aries': 'Tuesday (Mars day)', 'Taurus': 'Friday (Venus day)', 'Gemini': 'Wednesday (Mercury day)',
                'Cancer': 'Monday (Moon day)', 'Leo': 'Sunday (Sun day)', 'Virgo': 'Wednesday (Mercury day)',
                'Libra': 'Friday (Venus day)', 'Scorpio': 'Tuesday (Mars day)', 'Sagittarius': 'Thursday (Jupiter day)',
                'Capricorn': 'Saturday (Saturn day)', 'Aquarius': 'Saturday (Saturn day)', 'Pisces': 'Thursday (Jupiter day)'
            };
            return `${signDays[zodiac.name] || 'Wednesday'} - Your ${zodiac.name} energy peaks. Schedule important matters here.`;
        }

        function getDaySpecificGuidance(zodiac, chinese, lifePath, dayIndex, focus) {
            const dayGuidance = [
                // Sunday
                `Rest and reflect. ${zodiac.name} energy recharges through intentional pause. Set intentions for the week ahead.`,
                // Monday
                `New week energy. ${zodiac.name} initiative meets ${chinese.animal} determination. Launch new efforts.`,
                // Tuesday
                `Mars energy amplifies action. ${zodiac.name} assertiveness is supported. Address challenging tasks.`,
                // Wednesday
                `Mercury enhances communication. ${zodiac.name} ideas flow easily. Schedule important conversations.`,
                // Thursday
                `Jupiter expands opportunity. ${zodiac.name} optimism attracts luck. Think bigger today.`,
                // Friday
                `Venus brings harmony. ${zodiac.name} relationships are favored. Celebrate connections.`,
                // Saturday
                `Saturn rewards discipline. ${zodiac.name} structure-building succeeds. Handle responsibilities.`
            ];
            
            let guidance = dayGuidance[dayIndex];
            if (focus === 'career' && dayIndex < 5) guidance += ' Focus on career advancement.';
            if (focus === 'love' && dayIndex >= 5) guidance += ' Relationship opportunities peak.';
            return guidance;
        }

        function getWeeklyWesternForecast(zodiac, risingSign, moonSign) {
            return `
                <div class="system-item">
                    <h4>☉ ${zodiac.name} Sun - Weekly Activation</h4>
                    <p>This week emphasizes ${getZodiacTrait(zodiac.name)}. Your ${zodiac.name} energy is particularly strong mid-week when planetary alignments favor your natural tendencies.</p>
                </div>
                ${risingSign ? `
                <div class="system-item">
                    <h4>↑ ${risingSign.name} Rising - Social Dynamics</h4>
                    <p>Your public presentation carries extra ${getRisingStyle(risingSign.name)} this week. First impressions are impactful—use this for important meetings or introductions.</p>
                </div>
                ` : ''}
                ${moonSign ? `
                <div class="system-item">
                    <h4>☽ ${moonSign.name} Moon - Emotional Themes</h4>
                    <p>Your emotional landscape this week involves ${getMoonNeed(moonSign.name)}. Mood fluctuations are normal—honor your inner rhythms.</p>
                </div>
                ` : ''}
            `;
        }

        function getWeeklyNumerologyForecast(lifePath, personalYear, weekStart) {
            const weekNum = Math.ceil((weekStart.getDate() + weekStart.getMonth() * 31) / 7) % 9 || 9;
            return `
                <div class="system-item">
                    <h4>Weekly Vibration: ${weekNum}</h4>
                    <p>This week carries ${weekNum}-energy: ${getReducedTheme(weekNum)}. Combined with your Life Path ${lifePath} and Personal Year ${personalYear}, this creates conditions for ${getLifePathFocus(lifePath)}.</p>
                </div>
            `;
        }

        function getWeeklyActionItems(zodiac, chinese, lifePath, focus) {
            return `
                <div class="action-item">
                    <h4>Priority 1: Early Week (Mon-Tue)</h4>
                    <p>Launch initiatives. Your ${zodiac.name} pioneering energy is strongest. Set the week's trajectory through bold action.</p>
                </div>
                <div class="action-item">
                    <h4>Priority 2: Mid-Week (Wed-Thu)</h4>
                    <p>Communicate and expand. Mercury and Jupiter days favor ${chinese.animal} wisdom in conversations and growth opportunities.</p>
                </div>
                <div class="action-item">
                    <h4>Priority 3: Late Week (Fri-Sat)</h4>
                    <p>Harmonize and structure. Venus and Saturn days support relationship building and completing what you started.</p>
                </div>
                <div class="action-item">
                    <h4>Weekly Intention</h4>
                    <p>${focus ? `Focus on ${focus}: ` : ''}By week's end, aim to have made tangible progress in ${getLifePathFocus(lifePath)}. Your Life Path ${lifePath} is activated when you ${getLifePathAction(lifePath)}.</p>
                </div>
            `;
        }

        function getLifePathAction(lifePath) {
            const actions = {
                1: 'take independent initiative without waiting for permission',
                2: 'nurture partnerships and practice patience',
                3: 'express yourself creatively and share your joy',
                4: 'build systematic structures and complete practical tasks',
                5: 'embrace change and try something completely new',
                6: 'serve others and beautify your environment',
                7: 'spend time in contemplation and trust your intuition',
                8: 'make power moves and focus on material manifestation',
                9: 'give generously and release what\'s complete'
            };
            return actions[lifePath] || 'align with your authentic purpose';
        }

        // Monthly Helpers
        function getMonthlyTheme(personalMonth, zodiac, chinese) {
            const themes = {
                1: 'New Beginnings & Initiative',
                2: 'Partnership & Patience',
                3: 'Expression & Creativity',
                4: 'Foundation & Structure',
                5: 'Change & Freedom',
                6: 'Responsibility & Service',
                7: 'Reflection & Spirituality',
                8: 'Power & Manifestation',
                9: 'Completion & Release'
            };
            return `Personal Month ${personalMonth}: ${themes[personalMonth] || 'Transformation'}. Your ${zodiac.name} sun and ${chinese.element} ${chinese.animal} nature color how this theme manifests for you specifically.`;
        }

        function getMonthlyEnergy(zodiac, chinese, personalMonth) {
            return `${zodiac.name} determination meets ${chinese.animal} wisdom in a ${personalMonth}-month context. This creates ${personalMonth <= 3 ? 'initiating' : personalMonth <= 6 ? 'building' : 'completing'} energy for the weeks ahead.`;
        }

        function getMonthlyGrowth(lifePath, personalMonth, focus) {
            const growth = focus ? `Significant progress in ${focus} through ` : 'Primary development through ';
            return growth + getReducedTheme(personalMonth) + `. Life Path ${lifePath} finds expression through ${getLifePathFocus(lifePath).split(' and ')[0]}.`;
        }

        function getMonthlyCaution(zodiac, moonSign, personalMonth) {
            const caution = `Month ${personalMonth} tendency: ${personalMonth % 2 === 0 ? 'over-patience leading to stagnation' : 'over-initiative leading to burnout'}. `;
            return caution + `Your ${zodiac.name} nature${moonSign ? ` combined with ${moonSign.name} Moon emotions` : ''} may amplify this—stay aware.`;
        }

        function getMonthlyWeekThemes(zodiac, chinese, personalMonth, focus) {
            return [
                {
                    title: 'Initiation',
                    focus: `Launch this month's primary ${focus || 'growth'} projects`,
                    action: `Set clear intentions aligned with ${zodiac.name} nature`,
                    keyDays: 'Days 1-3 and 7 are most auspicious'
                },
                {
                    title: 'Development',
                    focus: `Build momentum in started projects`,
                    action: `Apply ${chinese.animal} patience to growing efforts`,
                    keyDays: 'Mid-week days favor expansion'
                },
                {
                    title: 'Cultivation',
                    focus: `Refine and adjust based on feedback`,
                    action: `Use ${chinese.element} wisdom for course corrections`,
                    keyDays: 'New Moon or Full Moon window'
                },
                {
                    title: 'Harvest & Preparation',
                    focus: `Complete what's ready, prepare for next month`,
                    action: `${zodiac.name} reflection on progress made`,
                    keyDays: 'Final 3 days for completion energy'
                }
            ];
        }

        function getMonthlyKeyDates(zodiac, chinese, lifePath, today) {
            const year = today.getFullYear();
            const month = today.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            // Find key numerological dates
            const powerDays = [];
            for (let d = 1; d <= daysInMonth; d++) {
                const dayEnergy = (d + (month + 1) + year) % 9 || 9;
                if (dayEnergy === lifePath || dayEnergy === 1 || dayEnergy === 8) {
                    powerDays.push({ day: d, energy: dayEnergy });
                }
            }
            
            const powerDaysStr = powerDays.slice(0, 5).map(p => 
                `<strong>${p.day}:</strong> Day ${p.energy} energy (${p.energy === lifePath ? 'Life Path alignment' : p.energy === 1 ? 'initiative' : 'manifestation'})`
            ).join('<br>');
            
            return `
                <div class="key-dates-grid">
                    <div class="key-date-item">
                        <h4>Power Days</h4>
                        <p>${powerDaysStr}</p>
                    </div>
                    <div class="key-date-item">
                        <h4>Your ${zodiac.name} Power Windows</h4>
                        <p>Early morning and late afternoon favor ${zodiac.name} initiatives. Schedule important decisions during your peak hours.</p>
                    </div>
                </div>
            `;
        }

        function getMonthlyWesternForecast(zodiac, risingSign, moonSign, today) {
            const monthName = today.toLocaleDateString('en-US', { month: 'long' });
            return `
                <div class="system-item">
                    <h4>☉ ${zodiac.name} Sun - ${monthName} Transits</h4>
                    <p>The Sun's current position activates themes of ${getZodiacTrait(zodiac.name)} throughout ${monthName}. Key planetary aspects support your natural ${zodiac.name} expression mid-month.</p>
                </div>
                ${risingSign ? `
                <div class="system-item">
                    <h4>↑ ${risingSign.name} Rising - Monthly Public Theme</h4>
                    <p>This month emphasizes your ${getRisingStyle(risingSign.name)} in public settings. Career and social opportunities align with authentic self-presentation.</p>
                </div>
                ` : ''}
            `;
        }

        function getMonthlyNumerologyForecast(lifePath, personalYear, personalMonth) {
            return `
                <div class="system-item">
                    <h4>Personal Month ${personalMonth} within Personal Year ${personalYear}</h4>
                    <p>${getPersonalMonthDescription(personalMonth, personalYear)}</p>
                    <p>This month's ${personalMonth}-energy combines with your Year ${personalYear} themes to create specific conditions for growth in ${getReducedTheme(personalMonth)}.</p>
                </div>
                <div class="system-item">
                    <h4>Life Path ${lifePath} Monthly Expression</h4>
                    <p>Your Life Path ${lifePath} finds this month's expression through ${getLifePathFocus(lifePath)}. Look for opportunities that align with your core purpose.</p>
                </div>
            `;
        }

        function getMonthlyActionItems(zodiac, chinese, lifePath, personalMonth, focus) {
            return `
                <div class="action-item">
                    <h4>Week 1 Intention</h4>
                    <p>Launch: Set clear goals for ${focus || 'personal growth'} this month. Your ${zodiac.name} initiative is supported.</p>
                </div>
                <div class="action-item">
                    <h4>Week 2 Intention</h4>
                    <p>Build: Apply ${chinese.element} ${chinese.animal} persistence to growing your initiatives. Patience pays off.</p>
                </div>
                <div class="action-item">
                    <h4>Week 3 Intention</h4>
                    <p>Refine: Make adjustments based on what's working. Life Path ${lifePath} wisdom guides decisions.</p>
                </div>
                <div class="action-item">
                    <h4>Week 4 Intention</h4>
                    <p>Complete: Harvest what's ready and prepare for next month. Personal Month ${personalMonth} energy supports ${personalMonth <= 4 ? 'initiating new cycles' : personalMonth <= 7 ? 'cultivating growth' : 'completing and releasing'}.</p>
                </div>
            `;
        }

        // Yearly Helpers
        function getYearlyThemeTitle(personalYear) {
            const titles = {
                1: 'New Beginnings', 2: 'Partnership', 3: 'Expression',
                4: 'Foundation', 5: 'Change', 6: 'Responsibility',
                7: 'Spirituality', 8: 'Manifestation', 9: 'Completion'
            };
            return titles[personalYear] || 'Transformation';
        }

        function getYearlyTheme(personalYear, zodiac, chinese) {
            return `Personal Year ${personalYear} activates ${getYearlyThemeTitle(personalYear).toLowerCase()} energy for you. Your ${zodiac.name} sun nature and ${chinese.element} ${chinese.animal} wisdom shape how this year unfolds. This is ${personalYear <= 3 ? 'a building phase' : personalYear <= 6 ? 'a development phase' : 'a completion phase'} in your 9-year cycle.`;
        }

        function getYearlyLesson(lifePath, personalYear) {
            return `Life Path ${lifePath} meeting Personal Year ${personalYear} creates specific soul curriculum around ${getLifePathFocus(lifePath)}. This year teaches you to ${getLifePathAction(lifePath)} with ${personalYear <= 5 ? 'active' : 'receptive'} energy.`;
        }

        function getYearlyOpportunity(zodiac, chinese, personalYear, focus) {
            const base = `Your ${zodiac.name} drive combined with ${chinese.animal} intuition in Year ${personalYear} creates unprecedented opportunity for `;
            if (focus === 'career') return base + 'professional advancement and recognition.';
            if (focus === 'love') return base + 'deep, meaningful relationship evolution.';
            if (focus === 'health') return base + 'sustainable vitality transformation.';
            if (focus === 'spiritual') return base + 'profound spiritual awakening.';
            if (focus === 'finances') return base + 'abundance breakthrough.';
            return base + 'multi-dimensional life transformation.';
        }

        function getYearlyChallenge(zodiac, moonSign, lifePath) {
            return `Your growth edge this year: integrating ${getZodiacShadow(zodiac.name)}${moonSign ? ` while managing ${getZodiacShadow(moonSign.name)} emotional patterns` : ''}. Life Path ${lifePath} asks you to ${getLifePathAction(lifePath)} even when it feels uncomfortable.`;
        }

        function getYearlyQuarters(zodiac, chinese, lifePath, personalYear, focus) {
            return [
                {
                    title: 'Foundation',
                    months: 'Jan - Mar',
                    theme: `Plant seeds for Year ${personalYear} themes`,
                    focus: `${zodiac.name} initiative launches new cycles`,
                    peak: 'Equinox window (mid-March)'
                },
                {
                    title: 'Growth',
                    months: 'Apr - Jun',
                    theme: 'Develop what was initiated in Q1',
                    focus: `${chinese.animal} persistence builds momentum`,
                    peak: 'Solstice window (mid-June)'
                },
                {
                    title: 'Harvest',
                    months: 'Jul - Sep',
                    theme: 'Reap results from H1 efforts',
                    focus: `Life Path ${lifePath} purpose becomes visible`,
                    peak: 'Equinox window (mid-September)'
                },
                {
                    title: 'Integration',
                    months: 'Oct - Dec',
                    theme: 'Complete year and prepare for next',
                    focus: `Personal Year ${personalYear} lessons crystallize`,
                    peak: 'Solstice window (mid-December)'
                }
            ];
        }

        function getYearlyTransits(zodiac, currentYear) {
            return `
                <div class="transit-grid">
                    <div class="transit-item">
                        <h4>Mercury Retrogrades (${currentYear})</h4>
                        <p>Three periods of review and revision. For ${zodiac.name}, these times favor completing old projects over starting new ones. Communication and technology need extra attention.</p>
                    </div>
                    <div class="transit-item">
                        <h4>Eclipse Season</h4>
                        <p>Two eclipse seasons bring powerful change. Watch for major life shifts during these windows. ${zodiac.name} experiences these as catalysts for authentic expression.</p>
                    </div>
                    <div class="transit-item">
                        <h4>Jupiter's Blessing</h4>
                        <p>Jupiter's position this year expands opportunity in specific life areas. For ${zodiac.name}, this brings growth through ${getZodiacTrait(zodiac.name)}.</p>
                    </div>
                    <div class="transit-item">
                        <h4>Saturn's Lessons</h4>
                        <p>Saturn demands maturity and responsibility. For ${zodiac.name}, this means developing discipline around your natural ${getZodiacTrait(zodiac.name)} tendencies.</p>
                    </div>
                </div>
            `;
        }

        function getYearlyWesternForecast(zodiac, risingSign, moonSign, currentYear) {
            return `
                <div class="system-item">
                    <h4>☉ ${zodiac.name} Sun - ${currentYear} Overview</h4>
                    <p>${getDetailedZodiacDescription(zodiac.name)}</p>
                    <p>This year's planetary configurations particularly support your ${getZodiacTrait(zodiac.name)}. Key windows of opportunity occur when planets transit compatible signs.</p>
                </div>
                ${risingSign ? `
                <div class="system-item">
                    <h4>↑ ${risingSign.name} Rising - Yearly Evolution</h4>
                    <p>Your public evolution this year involves refining your ${getRisingStyle(risingSign.name)}. Career and social positioning improve through authentic self-presentation.</p>
                </div>
                ` : ''}
                ${moonSign ? `
                <div class="system-item">
                    <h4>☽ ${moonSign.name} Moon - Emotional Journey</h4>
                    <p>Your emotional landscape this year explores themes of ${getMoonNeed(moonSign.name)}. Monthly lunar cycles highlight different aspects of your inner world.</p>
                </div>
                ` : ''}
            `;
        }

        function getYearlyChineseForecast(yourChinese, currentChinese) {
            const isElementMatch = yourChinese.element === currentChinese.element;
            const compatibility = isElementMatch ? 'highly favorable—your element is amplified!' : 'dynamic—blending your natural element with the year\'s energy.';
            
            return `
                <div class="system-item">
                    <h4>Your Sign in the Year of ${currentChinese.element} ${currentChinese.animal}</h4>
                    <p>As a ${yourChinese.element} ${yourChinese.animal}, this year's energy is ${compatibility}</p>
                    <p>${isElementMatch ? 'This is a power year for you—your natural abilities are doubled.' : `Learn to integrate ${currentChinese.element} qualities with your ${yourChinese.element} nature for optimal results.`}</p>
                </div>
                <div class="system-item">
                    <h4>Year Animal Relationship</h4>
                    <p>${getAnimalCompatibility(yourChinese.animal, currentChinese.animal)}</p>
                </div>
                <div class="system-item">
                    <h4>Yearly Lucky Elements</h4>
                    <p><strong>Colors:</strong> ${getChineseColor(yourChinese.element)} (always), ${getChineseColor(currentChinese.element)} (this year)<br>
                    <strong>Numbers:</strong> ${getLuckyNumbers(yourChinese.animal)}<br>
                    <strong>Directions:</strong> ${getLuckyDirection(yourChinese.animal)}</p>
                </div>
            `;
        }

        function getYearlyNumerologyForecast(lifePath, personalYear) {
            return `
                <div class="system-item">
                    <h4>Life Path ${lifePath} - Core Purpose</h4>
                    <p>${getDetailedLifePathDescription(lifePath)}</p>
                </div>
                <div class="system-item">
                    <h4>Personal Year ${personalYear} - Annual Theme</h4>
                    <p>${getDetailedPersonalYearDescription(personalYear)}</p>
                </div>
                <div class="system-item">
                    <h4>Yearly Numerological Guidance</h4>
                    <p>Life Path ${lifePath} meeting Personal Year ${personalYear} creates a year focused on ${getReducedTheme(personalYear)}. Your purpose (${getLifePathFocus(lifePath)}) finds expression through this year's themes.</p>
                </div>
            `;
        }

        function getYearlyActionItems(zodiac, chinese, lifePath, personalYear, focus) {
            return `
                <div class="action-item">
                    <h4>Q1 Priority (Jan-Mar)</h4>
                    <p><strong>Theme:</strong> Plant Seeds<br>
                    Initiate key ${focus || 'life'} projects. Your ${zodiac.name} energy supports bold beginnings. Life Path ${lifePath} opens doors through ${getLifePathAction(lifePath)}.</p>
                </div>
                <div class="action-item">
                    <h4>Q2 Priority (Apr-Jun)</h4>
                    <p><strong>Theme:</strong> Cultivate Growth<br>
                    Nurture Q1 seeds with ${chinese.animal} patience. Avoid starting too many new things—depth over breadth.</p>
                </div>
                <div class="action-item">
                    <h4>Q3 Priority (Jul-Sep)</h4>
                    <p><strong>Theme:</strong> Harvest Results<br>
                    Collect fruits of H1 labor. Year ${personalYear} rewards become visible. Celebrate progress while maintaining momentum.</p>
                </div>
                <div class="action-item">
                    <h4>Q4 Priority (Oct-Dec)</h4>
                    <p><strong>Theme:</strong> Complete & Prepare<br>
                    Finish Year ${personalYear} lessons. Clear space for next year's Year ${(personalYear % 9) + 1} themes. Honor what you've learned.</p>
                </div>
                <div class="action-item">
                    <h4>Year-Long Intention</h4>
                    <p>Personal Year ${personalYear} asks you to master ${getYearlyThemeTitle(personalYear).toLowerCase()}. Your ${zodiac.name} nature, ${chinese.element} ${chinese.animal} wisdom, and Life Path ${lifePath} purpose all converge this year. Trust the process.</p>
                </div>
            `;
        }

        // Timeframe switcher
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('timeframe-btn')) {
                document.querySelectorAll('.timeframe-btn').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                const timeframe = e.target.dataset.timeframe;
                
                // Show loading spinner during recalculation
                showLoadingSpinner();
                setTimeout(() => {
                    generateForecast(timeframe);
                    hideLoadingSpinner();
                }, 1500);
            }
        });

        // Save forecast
        function saveForecast() {
            alert('✅ Forecast saved to your library!\n\nThis feature will integrate with the Quantum Jukebox library system.');
        }
    </script>
</body>
</html>
