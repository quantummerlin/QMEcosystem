<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Full Energy Reading | Quantum Merlin</title>
    <meta name="description" content="Your complete energy leak analysis with birth numerology, cosmic patterns, and personalized recovery protocols.">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-VW4LGE7L1T"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-VW4LGE7L1T');
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Orbitron:wght@400;600;700&family=Exo+2:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: linear-gradient(135deg, #0a0a0f 0%, #1a0a2e 50%, #0a0a0f 100%);
            color: #e0d4f7;
            font-family: 'Exo 2', sans-serif;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }
        .container { max-width: 800px; margin: 0 auto; padding-top: 80px; }
        
        .qm-header {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background: rgba(10, 10, 15, 0.95); backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(236, 72, 153, 0.3); padding: 15px 20px;
        }
        .qm-header-inner { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .qm-logo { display: flex; align-items: center; gap: 10px; text-decoration: none; }
        .qm-logo-icon { font-size: 1.5rem; }
        .qm-logo-text { font-family: 'Orbitron', monospace; font-size: 1.1rem; font-weight: 700; background: linear-gradient(135deg, #ec4899, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .qm-support { background: linear-gradient(135deg, #FFDD00, #FFA500); color: #000; padding: 8px 16px; border-radius: 20px; text-decoration: none; font-weight: 600; font-size: 0.85rem; }
        
        .page-header { text-align: center; margin-bottom: 40px; }
        .page-icon { font-size: 4rem; margin-bottom: 20px; }
        .page-title { font-family: 'Cinzel', serif; font-size: 2.2rem; background: linear-gradient(135deg, #ec4899, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 15px; }
        .page-subtitle { color: #f59e0b; font-size: 1.1rem; max-width: 500px; margin: 0 auto; }
        
        .previous-reading { background: linear-gradient(145deg, rgba(236, 72, 153, 0.1), rgba(245, 158, 11, 0.15)); border: 2px solid rgba(236, 72, 153, 0.4); border-radius: 20px; padding: 25px; margin-bottom: 30px; text-align: center; }
        .energy-drain { font-size: 3rem; font-weight: 800; font-family: 'Orbitron', monospace; background: linear-gradient(135deg, #ec4899, #f59e0b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .top-leak { color: #ec4899; font-family: 'Orbitron', monospace; font-size: 1.1rem; letter-spacing: 1px; }
        
        .profile-section { background: rgba(236, 72, 153, 0.1); border: 2px solid rgba(236, 72, 153, 0.3); border-radius: 20px; padding: 30px; margin-bottom: 30px; }
        .section-title { font-family: 'Orbitron', monospace; color: #ec4899; font-size: 1.2rem; margin-bottom: 20px; text-align: center; }
        
        .profile-options { display: flex; gap: 15px; margin-bottom: 25px; flex-wrap: wrap; }
        .profile-option { flex: 1; min-width: 200px; padding: 20px; background: rgba(236, 72, 153, 0.15); border: 2px solid rgba(236, 72, 153, 0.3); border-radius: 15px; cursor: pointer; transition: all 0.3s ease; text-align: center; }
        .profile-option:hover { border-color: #ec4899; transform: translateY(-3px); }
        .profile-option.selected { border-color: #f59e0b; background: rgba(245, 158, 11, 0.2); }
        .profile-option-icon { font-size: 2rem; margin-bottom: 10px; }
        .profile-option-title { color: #f9a8d4; font-weight: 600; }
        .profile-option-desc { color: #ec4899; font-size: 0.85rem; margin-top: 5px; }
        
        .birth-form, .saved-profiles { display: none; }
        .birth-form.active, .saved-profiles.active { display: block; }
        
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; color: #f9a8d4; margin-bottom: 8px; font-weight: 500; }
        .form-input { width: 100%; padding: 15px; background: rgba(236, 72, 153, 0.1); border: 2px solid rgba(236, 72, 153, 0.3); border-radius: 12px; color: #e0d4f7; font-size: 1rem; font-family: 'Exo 2', sans-serif; }
        .form-input:focus { outline: none; border-color: #ec4899; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        
        .profile-card { padding: 20px; background: rgba(236, 72, 153, 0.15); border: 2px solid rgba(236, 72, 153, 0.3); border-radius: 15px; margin-bottom: 15px; cursor: pointer; transition: all 0.3s ease; }
        .profile-card:hover { border-color: #ec4899; transform: translateY(-2px); }
        .profile-card.selected { border-color: #22c55e; background: rgba(34, 197, 94, 0.15); }
        .profile-name { color: #ec4899; font-weight: 600; font-size: 1.1rem; }
        .profile-details { color: #9ca3af; font-size: 0.9rem; margin-top: 5px; }
        .no-profiles { text-align: center; color: #ec4899; padding: 30px; }
        
        .generate-btn { width: 100%; padding: 20px; background: linear-gradient(135deg, #ec4899, #f59e0b); color: white; border: none; border-radius: 30px; font-size: 1.3rem; font-weight: 700; font-family: 'Orbitron', monospace; cursor: pointer; transition: all 0.3s ease; margin-top: 20px; }
        .generate-btn:hover:not(:disabled) { transform: scale(1.02); box-shadow: 0 10px 40px rgba(236, 72, 153, 0.5); }
        .generate-btn:disabled { opacity: 0.5; cursor: not-allowed; }
        
        .results-section { display: none; }
        .results-section.active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .reading-card { background: linear-gradient(145deg, rgba(236, 72, 153, 0.1), rgba(245, 158, 11, 0.1)); border: 2px solid rgba(236, 72, 153, 0.4); border-radius: 20px; padding: 30px; margin-bottom: 25px; }
        .card-header { text-align: center; margin-bottom: 25px; }
        .card-icon { font-size: 3rem; margin-bottom: 10px; }
        .card-title { font-family: 'Cinzel', serif; font-size: 1.5rem; color: #ec4899; }
        
        .forecast-section { background: rgba(0,0,0,0.2); border-radius: 15px; padding: 20px; margin-bottom: 20px; }
        .forecast-label { font-weight: 700; font-size: 0.9em; letter-spacing: 1px; margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .forecast-text { color: #e0d4f7; line-height: 1.8; }
        
        .action-buttons { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; margin: 30px 0; }
        .action-btn { padding: 15px 25px; border-radius: 25px; border: 2px solid rgba(236, 72, 153, 0.3); background: rgba(236, 72, 153, 0.2); color: #f9a8d4; text-decoration: none; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .action-btn:hover { border-color: #ec4899; transform: translateY(-2px); }
        
        .next-tools { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-top: 30px; }
        .tool-link { display: block; padding: 20px 15px; background: rgba(236, 72, 153, 0.15); border: 1px solid rgba(236, 72, 153, 0.3); border-radius: 12px; text-decoration: none; text-align: center; transition: all 0.3s ease; }
        .tool-link:hover { border-color: #ec4899; transform: translateY(-3px); }
        .tool-icon { font-size: 2rem; margin-bottom: 8px; }
        .tool-name { color: #f9a8d4; font-weight: 600; font-size: 0.9rem; }
    </style>
</head>
<body>
    <header class="qm-header">
        <div class="qm-header-inner">
            <a href="/index.html" class="qm-logo">
                <div class="qm-logo-icon">üßô‚Äç‚ôÇÔ∏è</div>
                <span class="qm-logo-text">Quantum Merlin</span>
            </a>
            <a href="https://www.buymeacoffee.com/quantummerlin" target="_blank" class="qm-support">‚òï Support</a>
        </div>
    </header>

    <div class="container">
        <div class="page-header">
            <div class="page-icon">üîã</div>
            <h1 class="page-title">Full Energy Reading</h1>
            <p class="page-subtitle">Add your birth details for a complete energy recovery blueprint</p>
        </div>

        <div class="previous-reading" id="previousReading">
            <div style="color: #ec4899; font-size: 0.9rem; margin-bottom: 10px;">YOUR TOP ENERGY LEAK</div>
            <div class="top-leak" id="topLeak">Loading...</div>
            <div class="energy-drain" id="energyDrain">--</div>
        </div>

        <div id="inputSection">
            <div class="profile-section">
                <div class="section-title">Choose Your Path</div>
                
                <div class="profile-options">
                    <div class="profile-option" onclick="selectOption('saved')" id="optionSaved">
                        <div class="profile-option-icon">üìö</div>
                        <div class="profile-option-title">Load from Library</div>
                        <div class="profile-option-desc">Use a saved profile</div>
                    </div>
                    <div class="profile-option" onclick="selectOption('new')" id="optionNew">
                        <div class="profile-option-icon">‚úèÔ∏è</div>
                        <div class="profile-option-title">Enter Details</div>
                        <div class="profile-option-desc">Input birth information</div>
                    </div>
                </div>

                <div class="saved-profiles" id="savedProfiles">
                    <div id="profilesList"></div>
                </div>

                <div class="birth-form" id="birthForm">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-input" id="fullName" placeholder="Enter your name">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Birth Date</label>
                        <input type="date" class="form-input" id="birthDate">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">Birth Time (optional)</label>
                            <input type="time" class="form-input" id="birthTime">
                        </div>
                        <div class="form-group">
                            <label class="form-label">Birth Place (optional)</label>
                            <input type="text" class="form-input" id="birthPlace" placeholder="City, Country">
                        </div>
                    </div>
                    <div class="form-group">
                        <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                            <input type="checkbox" id="saveProfile" checked>
                            <span class="form-label" style="margin: 0;">Save this profile to Library</span>
                        </label>
                    </div>
                </div>

                <button class="generate-btn" id="generateBtn" onclick="generateFullReading()" disabled>
                    ‚ö° Generate Recovery Blueprint
                </button>
            </div>
        </div>

        <div class="results-section" id="resultsSection"></div>
    </div>

    <script>
        let previousData = null;
        let selectedProfile = null;
        let selectedOption = null;
        let detectedLeaks = [];

        const leakNames = ['Unfinished Business', 'Toxic Relationships', 'Emotional Suppression', 'Misaligned Commitments', 'Mental Time Travel'];

        document.addEventListener('DOMContentLoaded', () => {
            const storedData = sessionStorage.getItem('qm_enhanced_data');
            if (storedData) {
                previousData = JSON.parse(storedData);
                displayPreviousReading();
            } else {
                document.getElementById('previousReading').innerHTML = `
                    <div style="color: #fbbf24;">‚ö†Ô∏è No previous reading found</div>
                    <p style="color: #ec4899; margin-top: 10px;">
                        <a href="/energyleak.html" style="color: #ec4899;">Take the Energy Leak test</a> first for the complete experience.
                    </p>
                `;
            }
            loadSavedProfiles();
        });

        function displayPreviousReading() {
            if (!previousData || !previousData.answers) return;
            const answers = previousData.answers;
            
            detectedLeaks = leakNames.map((name, i) => ({
                name: name,
                score: answers['q' + (i + 1)] || 0
            })).sort((a, b) => b.score - a.score);
            
            const topLeak = detectedLeaks[0];
            const totalDrain = detectedLeaks.slice(0, 3).reduce((sum, l) => sum + l.score, 0);
            const drainPct = Math.round((totalDrain / 15) * 100);
            
            document.getElementById('topLeak').textContent = topLeak.name;
            document.getElementById('energyDrain').textContent = drainPct + '% Drain';
        }

        function selectOption(option) {
            selectedOption = option;
            document.querySelectorAll('.profile-option').forEach(el => el.classList.remove('selected'));
            document.getElementById('option' + option.charAt(0).toUpperCase() + option.slice(1)).classList.add('selected');
            
            if (option === 'saved') {
                document.getElementById('savedProfiles').classList.add('active');
                document.getElementById('birthForm').classList.remove('active');
            } else {
                document.getElementById('savedProfiles').classList.remove('active');
                document.getElementById('birthForm').classList.add('active');
                checkFormValidity();
            }
        }

        function loadSavedProfiles() {
            const library = JSON.parse(localStorage.getItem('qm_library') || '[]');
            const profiles = library.filter(item => item.type === 'profile' || item.birthDate);
            const container = document.getElementById('profilesList');
            
            if (profiles.length === 0) {
                container.innerHTML = `<div class="no-profiles"><div style="font-size: 2rem; margin-bottom: 10px;">üì≠</div><div>No saved profiles found</div></div>`;
                return;
            }
            
            container.innerHTML = profiles.map((profile, index) => `
                <div class="profile-card" onclick="selectProfile(${index})" id="profile-${index}">
                    <div class="profile-name">${profile.name || profile.fullName || 'Unnamed'}</div>
                    <div class="profile-details">${profile.birthDate ? new Date(profile.birthDate).toLocaleDateString() : 'No birth date'}</div>
                </div>
            `).join('');
        }

        function selectProfile(index) {
            const library = JSON.parse(localStorage.getItem('qm_library') || '[]');
            const profiles = library.filter(item => item.type === 'profile' || item.birthDate);
            selectedProfile = profiles[index];
            document.querySelectorAll('.profile-card').forEach(el => el.classList.remove('selected'));
            document.getElementById('profile-' + index).classList.add('selected');
            document.getElementById('generateBtn').disabled = false;
        }

        function checkFormValidity() {
            const name = document.getElementById('fullName').value;
            const birthDate = document.getElementById('birthDate').value;
            document.getElementById('generateBtn').disabled = !(name && birthDate);
        }

        document.getElementById('fullName')?.addEventListener('input', checkFormValidity);
        document.getElementById('birthDate')?.addEventListener('change', checkFormValidity);

        function generateFullReading() {
            let profileData;
            if (selectedOption === 'saved' && selectedProfile) {
                profileData = selectedProfile;
            } else {
                profileData = {
                    fullName: document.getElementById('fullName').value,
                    birthDate: document.getElementById('birthDate').value,
                    birthTime: document.getElementById('birthTime').value,
                    birthPlace: document.getElementById('birthPlace').value
                };
                if (document.getElementById('saveProfile').checked) saveProfileToLibrary(profileData);
            }
            
            const birthDate = new Date(profileData.birthDate);
            const lifePath = calculateLifePath(birthDate);
            const zodiac = getZodiacSign(birthDate);
            const element = getElement(zodiac);
            
            generateResultsHTML(profileData, lifePath, zodiac, element);
        }

        function calculateLifePath(date) {
            const dateStr = date.toISOString().split('T')[0].replace(/-/g, '');
            let sum = dateStr.split('').reduce((acc, digit) => acc + parseInt(digit), 0);
            while (sum > 9 && sum !== 11 && sum !== 22 && sum !== 33) {
                sum = sum.toString().split('').reduce((acc, digit) => acc + parseInt(digit), 0);
            }
            return sum;
        }

        function getZodiacSign(date) {
            const month = date.getMonth() + 1, day = date.getDate();
            if ((month === 3 && day >= 21) || (month === 4 && day <= 19)) return 'Aries';
            if ((month === 4 && day >= 20) || (month === 5 && day <= 20)) return 'Taurus';
            if ((month === 5 && day >= 21) || (month === 6 && day <= 20)) return 'Gemini';
            if ((month === 6 && day >= 21) || (month === 7 && day <= 22)) return 'Cancer';
            if ((month === 7 && day >= 23) || (month === 8 && day <= 22)) return 'Leo';
            if ((month === 8 && day >= 23) || (month === 9 && day <= 22)) return 'Virgo';
            if ((month === 9 && day >= 23) || (month === 10 && day <= 22)) return 'Libra';
            if ((month === 10 && day >= 23) || (month === 11 && day <= 21)) return 'Scorpio';
            if ((month === 11 && day >= 22) || (month === 12 && day <= 21)) return 'Sagittarius';
            if ((month === 12 && day >= 22) || (month === 1 && day <= 19)) return 'Capricorn';
            if ((month === 1 && day >= 20) || (month === 2 && day <= 18)) return 'Aquarius';
            return 'Pisces';
        }

        function getElement(zodiac) {
            const elements = { Aries: 'Fire', Leo: 'Fire', Sagittarius: 'Fire', Taurus: 'Earth', Virgo: 'Earth', Capricorn: 'Earth', Gemini: 'Air', Libra: 'Air', Aquarius: 'Air', Cancer: 'Water', Scorpio: 'Water', Pisces: 'Water' };
            return elements[zodiac] || 'Fire';
        }

        function getRecoveryFrequency(topLeak) {
            const frequencies = {
                'Unfinished Business': '417 Hz',
                'Toxic Relationships': '528 Hz',
                'Emotional Suppression': '639 Hz',
                'Misaligned Commitments': '741 Hz',
                'Mental Time Travel': '852 Hz'
            };
            return frequencies[topLeak] || '528 Hz';
        }

        function getCosmicVulnerability(lifePath, element) {
            const vulnerabilities = {
                Fire: 'Your fire nature makes you susceptible to burning out through over-giving and over-doing. You leak energy when your passion isn\'t reciprocated.',
                Earth: 'Your earth nature makes you prone to taking on others\' burdens. You absorb dense energies from your environment and relationships.',
                Air: 'Your air nature makes you vulnerable to mental loops and overthinking. Ideas and worries can consume your energy reserves.',
                Water: 'Your water nature makes you highly absorbent of emotional energy. You feel everything around you, often at your own expense.'
            };
            return vulnerabilities[element] || vulnerabilities.Fire;
        }

        function generateResultsHTML(profile, lifePath, zodiac, element) {
            document.getElementById('inputSection').style.display = 'none';
            const topLeak = detectedLeaks[0] || { name: 'Energy Drain', score: 3 };
            const frequency = getRecoveryFrequency(topLeak.name);
            const vulnerability = getCosmicVulnerability(lifePath, element);
            const drainPct = detectedLeaks.length ? Math.round((detectedLeaks.slice(0, 3).reduce((sum, l) => sum + l.score, 0) / 15) * 100) : 50;

            const resultsHTML = `
                <div class="reading-card">
                    <div class="card-header">
                        <div class="card-icon">‚ö°</div>
                        <h2 class="card-title">Your Complete Energy Blueprint</h2>
                        <div style="color: #ec4899; margin-top: 10px;">For ${profile.fullName || profile.name}</div>
                    </div>
                    
                    <div class="forecast-section" style="border-left: 3px solid #ec4899;">
                        <div class="forecast-label" style="color: #ec4899;">üìø YOUR COSMIC ENERGY PATTERN</div>
                        <div class="forecast-text">
                            <p>As a <strong style="color: #ec4899;">Life Path ${lifePath}</strong> ${zodiac} (${element}), ${vulnerability}</p>
                            <p style="margin-top: 15px;">Your primary leak - <strong style="color: #f59e0b;">${topLeak.name}</strong> - is amplified by your ${element} nature. ${
                                topLeak.name === 'Unfinished Business' ? `${element} signs often start with tremendous energy but struggle with completion when the initial spark fades.` :
                                topLeak.name === 'Toxic Relationships' ? `${element} signs are particularly affected by relationship dynamics, often giving more than they receive.` :
                                topLeak.name === 'Emotional Suppression' ? `${element} signs may suppress emotions to maintain their preferred self-image or to protect others.` :
                                topLeak.name === 'Misaligned Commitments' ? `${element} signs often say yes to maintain harmony or pursue goals, even at personal cost.` :
                                `${element} signs are prone to mental time travel, replaying the past or projecting into the future.`
                            }</p>
                        </div>
                    </div>
                    
                    <div class="forecast-section" style="border-left: 3px solid #22c55e;">
                        <div class="forecast-label" style="color: #22c55e;">üéµ YOUR RECOVERY FREQUENCY</div>
                        <div class="forecast-text">
                            <p>Your energy restoration frequency is <strong style="color: #22c55e;">${frequency}</strong></p>
                            <p style="margin-top: 10px;">${
                                frequency === '417 Hz' ? 'The "Facilitating Change" frequency - clears stagnation and completes stuck cycles.' :
                                frequency === '528 Hz' ? 'The "Love Frequency" - repairs energetic boundaries and restores self-worth.' :
                                frequency === '639 Hz' ? 'The "Connection Frequency" - releases suppressed emotions and restores flow.' :
                                frequency === '741 Hz' ? 'The "Expression Frequency" - empowers authentic yes and no.' :
                                'The "Present Moment Frequency" - anchors you in the now, stopping energy drain to past/future.'
                            }</p>
                            <p style="margin-top: 10px;">As a ${zodiac}, listen during ${element === 'Fire' ? 'active movement' : element === 'Earth' ? 'grounded stillness' : element === 'Air' ? 'breathwork' : 'water rituals (bath, shower)'} for maximum absorption.</p>
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px; flex-wrap: wrap;">
                            <a href="/genesis" style="padding: 10px 20px; background: linear-gradient(135deg, #22c55e, #059669); color: white; text-decoration: none; border-radius: 20px; font-weight: 600;">üéµ Play in Genesis</a>
                            <button onclick="saveFrequencyToLibrary('${frequency}')" style="padding: 10px 20px; background: rgba(34, 197, 94, 0.2); border: 1px solid #22c55e; color: #22c55e; border-radius: 20px; font-weight: 600; cursor: pointer;">üíæ Save Frequency</button>
                        </div>
                    </div>
                    
                    <div class="forecast-section" style="border-left: 3px solid #f59e0b;">
                        <div class="forecast-label" style="color: #f59e0b;">üßò YOUR ENERGY RECOVERY RITUAL</div>
                        <div class="forecast-text">
                            <p><strong>Daily Practice for ${zodiac} Energy Recovery:</strong></p>
                            <p style="margin: 10px 0;">1. <strong>Morning Seal (2 min):</strong> ${
                                element === 'Fire' ? 'Stand facing the sun (or east). Arms wide, breathe fire into your solar plexus. Say: "I seal my energy. I give only what I choose to give."' :
                                element === 'Earth' ? 'Feet flat on ground. Hands on belly. Breathe into your roots. Say: "I am grounded. My energy is my own."' :
                                element === 'Air' ? 'Three deep breaths with arms rising. Exhale with intention. Say: "I release what is not mine. I keep what serves me."' :
                                'Cup water in hands. Breathe over it. Splash on face or drink. Say: "I flow with ease. I absorb only what nourishes."'
                            }</p>
                            <p style="margin: 10px 0;">2. <strong>Midday Check-In (1 min):</strong> Pause. Ask: "Where am I leaking right now?" Name it without judgment. Take 3 breaths to seal that point.</p>
                            <p style="margin: 10px 0;">3. <strong>Evening Recovery (5 min):</strong> Play ${frequency} while visualizing ${
                                element === 'Fire' ? 'golden flames sealing all exit points of your aura' :
                                element === 'Earth' ? 'roots growing from your feet, drawing energy back up from the earth' :
                                element === 'Air' ? 'a crystalline sphere forming around you, filtering what enters' :
                                'a waterfall of light washing through you, carrying away what isn\'t yours'
                            }.</p>
                        </div>
                    </div>
                    
                    <div class="forecast-section" style="border-left: 3px solid #3b82f6;">
                        <div class="forecast-label" style="color: #3b82f6;">üÉè TAROT GUIDANCE</div>
                        <div class="forecast-text">
                            ${getTarotGuidance(topLeak.name, element)}
                        </div>
                    </div>
                    
                    <div class="forecast-section" style="border-left: 3px solid #a855f7;">
                        <div class="forecast-label" style="color: #a855f7;">üìÖ YOUR POWER TIMING</div>
                        <div class="forecast-text">
                            <p><strong>Best Days for Energy Work:</strong> ${getPowerDays(lifePath)}</p>
                            <p style="margin-top: 10px;"><strong>Moon Phase:</strong> Waning Moon for releasing leaks, New Moon for sealing boundaries.</p>
                            <p style="margin-top: 10px;"><strong>Power Hours:</strong> ${
                                element === 'Fire' ? 'Sunrise and noon when solar chi peaks' :
                                element === 'Earth' ? 'Dawn and dusk during grounding transitions' :
                                element === 'Air' ? 'Late morning when mental clarity is highest' :
                                'Evening and midnight when lunar energy flows'
                            }</p>
                        </div>
                    </div>
                    
                    <div class="forecast-section" style="border-left: 3px solid #fbbf24;">
                        <div class="forecast-label" style="color: #fbbf24;">üí° KEY INSIGHT</div>
                        <div class="forecast-text" style="font-size: 1.2em; font-style: italic; color: #fde68a; text-align: center;">
                            "${getKeyInsight(topLeak.name, drainPct)}"
                        </div>
                    </div>
                </div>
                
                <div class="action-buttons">
                    <a href="/index.html" class="action-btn">üè† Hub</a>
                    <a href="/genesis" class="action-btn">üéµ Frequencies</a>
                    <a href="/library.html" class="action-btn">üìö Library</a>
                    <button class="action-btn" onclick="saveFullReading()" style="background: rgba(34, 197, 94, 0.2); border-color: #22c55e; color: #22c55e;">üíæ Save Reading</button>
                </div>
                
                <div style="background: rgba(236, 72, 153, 0.1); border: 2px solid rgba(236, 72, 153, 0.3); border-radius: 20px; padding: 30px; margin-top: 30px;">
                    <h3 style="color: #ec4899; text-align: center; margin-bottom: 20px; font-family: 'Orbitron', monospace;">Continue Your Journey</h3>
                    <div class="next-tools">
                        <a href="/manifest.html" class="tool-link"><div class="tool-icon">‚ú®</div><div class="tool-name">Manifestation</div></a>
                        <a href="/contract.html" class="tool-link"><div class="tool-icon">üìú</div><div class="tool-name">Unconscious Contract</div></a>
                        <a href="/identity-split-detector.html" class="tool-link"><div class="tool-icon">üé≠</div><div class="tool-name">Identity Split</div></a>
                        <a href="/quantum-merlin-hub/forecasts.html" class="tool-link"><div class="tool-icon">üîÆ</div><div class="tool-name">Cosmic Forecast</div></a>
                    </div>
                </div>
            `;

            document.getElementById('resultsSection').innerHTML = resultsHTML;
            document.getElementById('resultsSection').classList.add('active');
            autoSaveReading(profile, topLeak, lifePath, drainPct);
            document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
        }

        function getTarotGuidance(leakType, element) {
            const guidance = {
                'Unfinished Business': 'The Hanged Man and Death guide your recovery. The Hanged Man says: "Let go of what you cannot complete." Death confirms that endings create space for new energy.',
                'Toxic Relationships': 'The Moon and The Hermit appear for you. The Moon illuminates hidden dynamics. The Hermit says: "Sometimes solitude is medicine, not loneliness."',
                'Emotional Suppression': 'The Star and Temperance bless your path. The Star says: "Pour yourself out‚Äîyou will be refilled." Temperance balances flow and containment.',
                'Misaligned Commitments': 'The Chariot and Justice guide you. The Chariot says: "Your energy is fuel‚Äîchoose your direction wisely." Justice confirms that saying no creates balance.',
                'Mental Time Travel': 'The Hermit and The Wheel of Fortune appear. The Hermit lights the present moment. The Wheel says: "The only real time is now‚Äîpast and future are illusions."'
            };
            return guidance[leakType] || guidance['Unfinished Business'];
        }

        function getPowerDays(lifePath) {
            const days = { 1: 'Sundays', 2: 'Mondays', 3: 'Thursdays', 4: 'Saturdays', 5: 'Wednesdays', 6: 'Fridays', 7: 'Mondays', 8: 'Saturdays', 9: 'Tuesdays', 11: 'The 11th of each month', 22: 'The 22nd of each month' };
            return days[lifePath] || 'Sundays';
        }

        function getKeyInsight(leakType, drainPct) {
            if (drainPct >= 70) return `Your ${leakType} is critical‚Äîbut awareness is the first step to recovery. You've been running on reserve power. It's time to refuel.`;
            if (drainPct >= 50) return `Your energy system is under strain, but recovery is within reach. Small daily practices compound into massive restoration.`;
            return `You're in a strong position to optimize. Sealing your remaining leaks will unlock energy you didn't know you had.`;
        }

        function saveProfileToLibrary(profile) {
            const item = { id: Date.now(), type: 'profile', name: profile.fullName, fullName: profile.fullName, birthDate: profile.birthDate, birthTime: profile.birthTime, birthPlace: profile.birthPlace, timestamp: Date.now(), savedAt: new Date().toISOString() };
            let library = JSON.parse(localStorage.getItem('qm_library') || '[]');
            library.unshift(item);
            localStorage.setItem('qm_library', JSON.stringify(library));
        }

        function saveFrequencyToLibrary(frequency) {
            const item = { id: Date.now(), type: 'frequency', name: frequency + ' - Recovery Frequency', frequency: frequency, source: 'Full Energy Reading', timestamp: Date.now(), savedAt: new Date().toISOString() };
            let library = JSON.parse(localStorage.getItem('qm_library') || '[]');
            library.unshift(item);
            localStorage.setItem('qm_library', JSON.stringify(library));
            showNotification('Frequency saved to Library!');
        }

        function autoSaveReading(profile, topLeak, lifePath, drainPct) {
            const item = { id: Date.now(), type: 'energy-full', name: 'Full Energy Reading', title: `Energy Blueprint: ${topLeak.name}`, topLeak: topLeak.name, drainPct: drainPct, lifePath: lifePath, profile: profile.fullName || profile.name, timestamp: Date.now(), savedAt: new Date().toISOString() };
            let library = JSON.parse(localStorage.getItem('qm_library') || '[]');
            library.unshift(item);
            localStorage.setItem('qm_library', JSON.stringify(library));
        }

        function saveFullReading() { showNotification('Reading saved to Library!'); }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = 'position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #22c55e, #059669); color: white; padding: 15px 30px; border-radius: 30px; font-weight: 600; z-index: 9999; box-shadow: 0 10px 30px rgba(34, 197, 94, 0.5);';
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }
    </script>
    <script src="shared/js/quantum-analytics.js"></script>
</body>
</html>
